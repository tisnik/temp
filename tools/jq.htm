<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Zpracování dat uložených ve formátu JSON nástrojem jq</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Zpracování dat uložených ve formátu JSON nástrojem jq</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V další části nepravidelně vycházejícího seriálu o užitečných utilitách určených pro příkazovou řádku se seznámíme s nástrojem nazvaným jq. Tento nástroj slouží k provádění různých operací nad daty uloženými ve formátu JSON.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Zpracování dat uložených ve formátu JSON nástrojem <strong>jq</strong></a></p>
<p><a href="#k02">2. Instalace nástroje <strong>jq</strong></a></p>
<p><a href="#k03">3. Nástroj <strong>jq</strong> ve funkci unixového filtru</a></p>
<p><a href="#k04">4. Přeformátování souborů ve formátu JSON</a></p>
<p><a href="#k05">5. Volby při formátování čitelných JSONů</a></p>
<p><a href="#k06">*** 6. Vytvoření kompaktního souboru ve formátu JSON</a></p>
<p><a href="#k07">*** 7. </a></p>
<p><a href="#k08">*** 8. </a></p>
<p><a href="#k09">*** 9. </a></p>
<p><a href="#k10">*** 10. </a></p>
<p><a href="#k11">*** 11. </a></p>
<p><a href="#k12">*** 12. </a></p>
<p><a href="#k13">*** 13. </a></p>
<p><a href="#k14">*** 14. </a></p>
<p><a href="#k15">*** 15. </a></p>
<p><a href="#k16">*** 16. </a></p>
<p><a href="#k17">*** 17. </a></p>
<p><a href="#k18">*** 18. </a></p>
<p><a href="#k19">*** 19. </a></p>
<p><a href="#k20">*** 20. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Zpracování dat uložených ve formátu JSON nástrojem <strong>jq</strong></h2>

<p>Dalším užitečným nástrojem určeným primárně pro volání z&nbsp;příkazové
řádky popř.&nbsp;ze shell skriptů je nástroj nazvaný <strong>jq</strong>. Tento
nástroj dokáže zpracovávat data uložená ve <a
href="https://www.json.org/json-en.html">formátu JSON</a>, který je
v&nbsp;současnosti využíván (a někdy též až neskutečným způsobem zneužíván)
v&nbsp;mnoha oblastech výpočetní techniky. <strong>jq</strong> dokáže soubory
JSON naformátovat, aby byly čitelné, naopak dokáže odstranit přebytečné bílé
znaky, ale především dokáže nad daty vytvářet různé dotazy (<i>queries</i>),
které mnohou být mnohdy i velmi komplikované. Zajímavé &ndash; a například
z&nbsp;pohledu administrátorů i užitečné &ndash; je, že nástroj
<strong>jq</strong> je vyvinut v&nbsp;programovacím jazyku C a po jeho překladu
vznikne spustitelný soubor (taktéž nazvaný &bdquo;jq&ldquo;), který pro svůj
běh vyžaduje pouze základní glibc. Díky tomu se značným způsobem zjednodušuje
instalace, nehledě na to, že start i práce <strong>jq</strong> je velmi
rychlá.</p>

<p>Pro <strong>jq</strong> vznikl i balíček určený pro programovací jazyk
Python, který operace (a dotazovací jazyk) zpřístupňuje i skriptům
naprogramovaným v&nbsp;Pythonu. I tímto balíčkem se budeme zabývat
v&nbsp;závěrečné části dnešního článku.</p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Instalace nástroje <strong>jq</strong></h2>

<p>Nástroj <strong>jq</strong> je možné stáhnout v&nbsp;jeho spustitelné podobě
ze stránky <a
href="https://stedolan.github.io/jq/">https://stedolan.github.io/jq/</a>.
Postačuje pouze vybrat si správnou architekturu. Získaný spustitelný soubor
závisí, jak jsme se již ostatně řekli <a href="#k01">v&nbsp;úvodní
kapitole</a>, pouze na glibc. Samozřejmě je také možné použít správce balíčků
vaší distribuce Linuxu, což se týká například Fedory:</p>

<pre>
$ <strong>sudo dnf install jq</strong>
&nbsp;
Last metadata expiration check: 1:36:21 ago on Tue 04 Aug 2020 05:00:30 PM CEST.
Dependencies resolved.
================================================================================
 Package            Arch            Version               Repository       Size
================================================================================
Installing:
 jq                 x86_64          1.5-8.fc27            fedora          158 k
Installing dependencies:
 oniguruma          x86_64          6.6.1-1.fc27          fedora          178 k
&nbsp;
Transaction Summary
================================================================================
Install  2 Packages
&nbsp;
Total download size: 337 k
Installed size: 1.1 M
Is this ok [y/N]: y
</pre>

<p><div class="rs-tip-major">Poznámka: tato starší verze Fedory obsahuje jq
verze 1.5, kdežto nejnovější stabilní verze je 1.6.</div></p>

<p>A pochopitelně je možné zvolit i překlad <strong>jq</strong> přímo ze
zdrojových kódů. Jedná se o pouhých několik kroků:</p>

<pre>
$ <strong>git@github.com:stedolan/jq.git</strong>
$ <strong>cd jq</strong>
$ <strong>autoreconf -fi</strong>
$ <strong>./configure --with-oniguruma=builtin</strong>
$ <strong>make -j8</strong>
$ <strong>make check</strong>
</pre>

<p><div class="rs-tip-major">Poznámka: přepínač <strong>-j8</strong> si
samozřejmě můžete upravit podle počtu dostupných jader, ovšem u tak (relativně)
malého nástroje, jakým <strong>jq</strong> je, je překlad a slinkování
záležitostí několika sekund i v&nbsp;případě použití starších
mikroprocesorů.</div></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Nástroj <strong>jq</strong> ve funkci unixového filtru</h2>

<p><strong>jq</strong> je pojat jako klasický unixový filtr, tj.&nbsp;vstupní
data (ve formátu JSON) dokáže načíst ze standardního vstupu a výsledek můžeme
přesměrovat do standardního výstupu. Ovšem navíc je nutné specifikovat operaci,
která se má provést. Základní operací je naformátování JSONu, což se provede
výrazem zapisovaným jako tečka:</p>

<pre>
$ <strong>cat openapi.json | jq . &gt; new.json</strong>
</pre>

<p>nebo:</p>

<pre>
$ <strong>jq . &lt; openapi.json &gt; new.json</strong>
</pre>

<p>popř. lze namísto přesměrování přímo uvést jméno vstupního souboru nebo souborů:</p>

<pre>
$ <strong>jq . openapi.json &gt; new.json</strong>
</pre>

<p><div class="rs-tip-major">Poznámka: výraz &bdquo;tečka&ldquo; lze zapsat
přímo, ovšem mnohé komplikovanější výrazy již obsahují znaky, které by byly
expandovány vlastním shellem. Proto je vhodné složitější výrazy zapisovat do
jednoduchých uvozovek, v&nbsp;nichž k&nbsp;žádné expanzi nedochází:</div></p>

<pre>
$ <strong>cat openapi.json | jq '.' &gt; new.json</strong>
&nbsp;
$ <strong>jq '.' &lt; openapi.json &gt; new.json</strong>
&nbsp;
$ <strong>jq '.' openapi.json &gt; new.json</strong>
</pre>



<p><a name="k04"></a></p>
<h2 id="k04">4. Přeformátování souborů ve formátu JSON</h2>

<p>Soubory obsahující data ve formátu JSON jsou vytvářeny různými nástroji a
mnohdy se jedná o soubory určené spíše pro strojové zpracování, z&nbsp;nichž
jsou odstraněny bílé znaky použité pouze pro odsazení a naformátování souboru
za účelem jeho větší čitelnosti. Nástroj <strong>jq</strong> dokáže i takové
soubory přeformátovat do čitelnější podoby nebo naopak dokáže bílé znaky ze
souboru odstranit pro zmenšení jeho velikosti. Pro otestování této
funkcionality použijeme demonstrační příklad ukázaný na stránce <a
href="https://programminghistorian.org/en/lessons/json-and-jq">https://programminghistorian.org/en/lessons/json-and-jq</a>.
Soubor ve formátu JSON, který budeme testovat, vypadá následovně. Uložte si ho
pod jménem <strong>nightwatch.json</strong>:</p>

<pre>
{
  "links": {
    "self": "https://www.rijksmuseum.nl/api/nl/collection/SK-C-5",
    "web": "https://www.rijksmuseum.nl/nl/collectie/SK-C-5"
  },
  "id": "nl-SK-C-5",
  "objectNumber": "SK-C-5",
  "title": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’",
  "hasImage": true,
  "principalOrFirstMaker": "Rembrandt Harmensz. van Rijn",
  "longTitle": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’, Rembrandt Harmensz. van Rijn, 1642",
  "showImage": true,
  "permitDownload": true,
  "webImage": {
    "guid": "3ae88fe0-021c-41ae-a4ce-cc70b7bc6295",
    "offsetPercentageX": 50,
    "offsetPercentageY": 100,
    "width": 2500,
    "height": 2034,
    "url": "http://lh6.ggpht.com/ZYWwML8mVFonXzbmg2rQBulNuCSr3rAaf5ppNcUc2Id8qXqudDL1NSYxaqjEXyDLSbeNFzOHRu0H7rbIws0Js4d7s_M=s0"
  },
  "headerImage": {
    "guid": "29a2a516-f1d2-4713-9cbd-7a4458026057",
    "offsetPercentageX": 50,
    "offsetPercentageY": 50,
    "width": 1920,
    "height": 460,
    "url": "http://lh3.ggpht.com/rvCc4t2BWHAgDlzyiPlp1sBhc8ju0aSsu2HxR8rN_ZVPBcujP94pukbmF3Blmhi-GW5cx1_YsYYCDMTPePocwM6d2vk=s0"
  },
  "productionPlaces": [
    "Amsterdam",
    "Root"
  ]
}
</pre>

<p>Pokud použijeme výraz &bdquo;tečka&ldquo;, bude vstupní soubor načten,
deserializován a vypsán zpět v&nbsp;naformátované podobě. Ta by měla být
prakticky shodná se vstupem, který již naformátovaný je:</p>

<pre>
$ <strong>jq . nightwatch.json</strong>
&nbsp;
{
  "links": {
    "self": "https://www.rijksmuseum.nl/api/nl/collection/SK-C-5",
    "web": "https://www.rijksmuseum.nl/nl/collectie/SK-C-5"
  },
  "id": "nl-SK-C-5",
  "objectNumber": "SK-C-5",
  "title": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’",
  "hasImage": true,
  "principalOrFirstMaker": "Rembrandt Harmensz. van Rijn",
  "longTitle": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’, Rembrandt Harmensz. van Rijn, 1642",
  "showImage": true,
  "permitDownload": true,
  "webImage": {
    "guid": "3ae88fe0-021c-41ae-a4ce-cc70b7bc6295",
    "offsetPercentageX": 50,
    "offsetPercentageY": 100,
    "width": 2500,
    "height": 2034,
    "url": "http://lh6.ggpht.com/ZYWwML8mVFonXzbmg2rQBulNuCSr3rAaf5ppNcUc2Id8qXqudDL1NSYxaqjEXyDLSbeNFzOHRu0H7rbIws0Js4d7s_M=s0"
  },
  "headerImage": {
    "guid": "29a2a516-f1d2-4713-9cbd-7a4458026057",
    "offsetPercentageX": 50,
    "offsetPercentageY": 50,
    "width": 1920,
    "height": 460,
    "url": "http://lh3.ggpht.com/rvCc4t2BWHAgDlzyiPlp1sBhc8ju0aSsu2HxR8rN_ZVPBcujP94pukbmF3Blmhi-GW5cx1_YsYYCDMTPePocwM6d2vk=s0"
  },
  "productionPlaces": [
    "Amsterdam",
    "Root"
  ]
}
</pre>

<p>Ve skutečnosti je výstup na terminál obarven:</p>

*** image ***
<p><i>Obrázek 1: Naformátovaný a obarvený výstup z&nbsp;nástroje <strong>jq</strong>.</i></p>

<p>Nyní se můžeme pokusit o napodobení činnosti nástrojů, které produkují
&bdquo;nečitelné&ldquo; JSONy. Ze začátků řádků odstraníme bílé znaky a
následně pospojujeme všechny řádky dohromady. To lze zařídit například tímto
příkazem, v&nbsp;nichž se používají filtry <strong>sed</strong> a
<strong>paste</strong>:</p>

<pre>
$ <strong>sed 's/^[ ]*//g' nightwatch.json | paste -s --delimiters="" > ugly.json</strong>
</pre>

<p>Výsledek bude vypadat následovně:</p>

<pre>
{"links": {"self": "https://www.rijksmuseum.nl/api/nl/collection/SK-C-5","web":
"https://www.rijksmuseum.nl/nl/collectie/SK-C-5"},"id": "nl-SK-C-5","objectNumb
er": "SK-C-5","title": "Schutters van wijk II onder leiding van kapitein Frans 
Banninck Cocq, bekend als de ‘Nachtwacht’","hasImage": true,"principalOrFirstM
aker": "Rembrandt Harmensz. van Rijn","longTitle": "Schutters van wijk II onde
r leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’, Rembra
ndt Harmensz. van Rijn, 1642","showImage": true,"permitDownload": true,"webIma
ge": {"guid": "3ae88fe0-021c-41ae-a4ce-cc70b7bc6295","offsetPercentageX": 50,"
offsetPercentageY": 100,"width": 2500,"height": 2034,"url": "http://lh6.ggpht.
com/ZYWwML8mVFonXzbmg2rQBulNuCSr3rAaf5ppNcUc2Id8qXqudDL1NSYxaqjEXyDLSbeNFzOHRu
0H7rbIws0Js4d7s_M=s0"},"headerImage": {"guid": "29a2a516-f1d2-4713-9cbd-7a4458
026057","offsetPercentageX": 50,"offsetPercentageY": 50,"width": 1920,"height"
: 460,"url": "http://lh3.ggpht.com/rvCc4t2BWHAgDlzyiPlp1sBhc8ju0aSsu2HxR8rN_ZV
PBcujP94pukbmF3Blmhi-GW5cx1_YsYYCDMTPePocwM6d2vk=s0"},"productionPlaces": ["Am
sterdam","Root"]}
</pre>

<p><div class="rs-tip-major">Poznámka: ve skutečnosti jsme takto ušetřili 129 znaků (bajtů).</div></p>

<p>Původní naformátovaný soubor získáme z&nbsp;&bdquo;mimifikovaného&ldquo;
souboru <strong>ugly.json</strong> právě pomocí nástroje
<strong>jq</strong>:</p>

<pre>
$ <strong>jq . ugly.json</strong>
&nbsp;
{
  "links": {
    "self": "https://www.rijksmuseum.nl/api/nl/collection/SK-C-5",
    "web": "https://www.rijksmuseum.nl/nl/collectie/SK-C-5"
  },
  "id": "nl-SK-C-5",
  "objectNumber": "SK-C-5",
  "title": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’",
  "hasImage": true,
  "principalOrFirstMaker": "Rembrandt Harmensz. van Rijn",
  "longTitle": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’, Rembrandt Harmensz. van Rijn, 1642",
  "showImage": true,
  "permitDownload": true,
  "webImage": {
    "guid": "3ae88fe0-021c-41ae-a4ce-cc70b7bc6295",
    "offsetPercentageX": 50,
    "offsetPercentageY": 100,
    "width": 2500,
    "height": 2034,
    "url": "http://lh6.ggpht.com/ZYWwML8mVFonXzbmg2rQBulNuCSr3rAaf5ppNcUc2Id8qXqudDL1NSYxaqjEXyDLSbeNFzOHRu0H7rbIws0Js4d7s_M=s0"
  },
  "headerImage": {
    "guid": "29a2a516-f1d2-4713-9cbd-7a4458026057",
    "offsetPercentageX": 50,
    "offsetPercentageY": 50,
    "width": 1920,
    "height": 460,
    "url": "http://lh3.ggpht.com/rvCc4t2BWHAgDlzyiPlp1sBhc8ju0aSsu2HxR8rN_ZVPBcujP94pukbmF3Blmhi-GW5cx1_YsYYCDMTPePocwM6d2vk=s0"
  },
  "productionPlaces": [
    "Amsterdam",
    "Root"
  ]
}
</pre>



<p><a name="k05"></a></p>
<h2 id="k05">5. Volby při formátování čitelných JSONů</h2>

<p>Při formátování JSONů je možné namísto mezer použít znaky <a
href="https://cs.wikipedia.org/wiki/Tabul%C3%A1tor">tabulátoru</a>:</p>

<pre>
$ <strong>jq --tab . ugly.json</strong>
&nbsp;
{
        "links": {
                "self": "https://www.rijksmuseum.nl/api/nl/collection/SK-C-5",
                "web": "https://www.rijksmuseum.nl/nl/collectie/SK-C-5"
        },
        "id": "nl-SK-C-5",
        "objectNumber": "SK-C-5",
        "title": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’",
        "hasImage": true,
        "principalOrFirstMaker": "Rembrandt Harmensz. van Rijn",
        "longTitle": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’, Rembrandt Harmensz. van Rijn, 1642",
        "showImage": true,
        "permitDownload": true,
        "webImage": {
                "guid": "3ae88fe0-021c-41ae-a4ce-cc70b7bc6295",
                "offsetPercentageX": 50,
                "offsetPercentageY": 100,
                "width": 2500,
                "height": 2034,
                "url": "http://lh6.ggpht.com/ZYWwML8mVFonXzbmg2rQBulNuCSr3rAaf5ppNcUc2Id8qXqudDL1NSYxaqjEXyDLSbeNFzOHRu0H7rbIws0Js4d7s_M=s0"
        },
        "headerImage": {
                "guid": "29a2a516-f1d2-4713-9cbd-7a4458026057",
                "offsetPercentageX": 50,
                "offsetPercentageY": 50,
                "width": 1920,
                "height": 460,
                "url": "http://lh3.ggpht.com/rvCc4t2BWHAgDlzyiPlp1sBhc8ju0aSsu2HxR8rN_ZVPBcujP94pukbmF3Blmhi-GW5cx1_YsYYCDMTPePocwM6d2vk=s0"
        },
        "productionPlaces": [
                "Amsterdam",
                "Root"
        ]
}
</pre>

<pre>
$ jq --indent 4 . ugly.json 
{
    "links": {
        "self": "https://www.rijksmuseum.nl/api/nl/collection/SK-C-5",
        "web": "https://www.rijksmuseum.nl/nl/collectie/SK-C-5"
    },
    "id": "nl-SK-C-5",
    "objectNumber": "SK-C-5",
    "title": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’",
    "hasImage": true,
    "principalOrFirstMaker": "Rembrandt Harmensz. van Rijn",
    "longTitle": "Schutters van wijk II onder leiding van kapitein Frans Banninck Cocq, bekend als de ‘Nachtwacht’, Rembrandt Harmensz. van Rijn, 1642",
    "showImage": true,
    "permitDownload": true,
    "webImage": {
        "guid": "3ae88fe0-021c-41ae-a4ce-cc70b7bc6295",
        "offsetPercentageX": 50,
        "offsetPercentageY": 100,
        "width": 2500,
        "height": 2034,
        "url": "http://lh6.ggpht.com/ZYWwML8mVFonXzbmg2rQBulNuCSr3rAaf5ppNcUc2Id8qXqudDL1NSYxaqjEXyDLSbeNFzOHRu0H7rbIws0Js4d7s_M=s0"
    },
    "headerImage": {
        "guid": "29a2a516-f1d2-4713-9cbd-7a4458026057",
        "offsetPercentageX": 50,
        "offsetPercentageY": 50,
        "width": 1920,
        "height": 460,
        "url": "http://lh3.ggpht.com/rvCc4t2BWHAgDlzyiPlp1sBhc8ju0aSsu2HxR8rN_ZVPBcujP94pukbmF3Blmhi-GW5cx1_YsYYCDMTPePocwM6d2vk=s0"
    },
    "productionPlaces": [
        "Amsterdam",
        "Root"
    ]
}
</pre>



<p><a name="k06"></a></p>
<h2 id="k06">6. Vytvoření kompaktního souboru ve formátu JSON</h2>

<p>Opakem formátování s&nbsp;účelem získání co nejčitelnějšího </p>

<pre>
$ <strong>jq .links nightwatch.json</strong>
&nbsp;
{
  "self": "https://www.rijksmuseum.nl/api/nl/collection/SK-C-5",
  "web": "https://www.rijksmuseum.nl/nl/collectie/SK-C-5"
}
</pre>

<p></p>

<pre>
$ <strong>jq .links.web nightwatch.json</strong>
&nbsp;
"https://www.rijksmuseum.nl/nl/collectie/SK-C-5"
</pre>

<pre>
$ <strong>jq .productionPlaces nightwatch.json</strong>
&nbsp;
[
  "Amsterdam",
  "Root"
]
</pre>

<pre>
$ <strong>jq .productionPlaces[] nightwatch.json</strong>
&nbsp;
"Amsterdam"
"Root"
</pre>

<pre>
$ <strong>jq .productionPlaces[0] nightwatch.json</strong>
&nbsp;
"Amsterdam"
</pre>

<pre>
$ <strong>jq .productionPlaces[1] nightwatch.json</strong>
&nbsp;
"Root"
</pre>

<pre>
$ <strong>jq .productionPlaces[2] nightwatch.json</strong>
&nbsp;
null
</pre>

<pre>
{
    "openapi": "3.0.0",
    "servers": [
        {
            "url": ""
        }
    ],
    "info": {
        "description": "A very simple REST API service",
        "version": "1.0.0",
        "title": "REST API Service",
        "termsOfService": "",
        "contact": {
            "name": "Pavel Tisnovsky"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
        }
    },
    "tags": [],
    "paths": {
        "/": {
            "get": {
                "summary": "Returns valid HTTP 200 ok status when the service is ready",
                "description": "",
                "parameters": [],
                "operationId": "main",
                "responses": {
                    "default": {
                        "description": "Default responsepaste -s --delimiters="" "
                    }
                }
            }
        },
        "/client/cluster": {
            "x-temp": {
                "summary": "Read list of all clusters from database and return it to a client",
                "description": "",
                "parameters": [],
                "operationId": "getClusters",
                "responses": {
                    "default": {
                        "description": "Default response"
                    }
                }
            },
            "get": {
                "summary": "Read list of all clusters from database and return it to a client",
                "description": "",
                "parameters": [],
                "operationId": "getClusters",
                "responses": {
                    "default": {
                        "description": "Default response"
                    }
                }
            }
        },
        "/client/cluster/{name}": {
            "get": {
                "summary": "Read cluster specified by its ID and return it to a client",
                "description": "",
                "parameters": [],
                "operationId": "getClusterById",
                "responses": {
                    "default": {
                        "description": "Default response"
                    }
                }
            },
            "post": {
                "summary": "Create a record with new cluster in a database. The updated list of all clusters is returned to client",
                "description": "",
                "parameters": [],
                "operationId": "newCluster",
                "responses": {
                    "default": {
                        "description": "Default response"
                    }
                }
            },
            "delete": {
                "summary": "Delete a cluster specified by its ID",
                "description": "",
                "parameters": [],
                "operationId": "deleteCluster",
                "responses": {
                    "default": {
                        "description": "Default response"
                    }
                }
            }
        },
        "/client/cluster/search": {
            "get": {
                "summary": "Search for a cluster specified by its ID or name",
                "description": "",
                "parameters": [
                    {
                        "name": "id",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Cluster ID",
                        "allowEmptyValue": true
                    },
                    {
                        "name": "name",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Cluster name",
                        "allowEmptyValue": true
                    }
                ],
                "operationId": "searchCluster",
                "responses": {
                    "default": {
                        "description": "Default response"
                    }
                }
            }
        }
    },
    "externalDocs": {
        "description": "Please see foo bar baz",
        "url": "https://godoc.org/..."
    },
    "security": []
}
</pre>

<pre>
$ <strong>jq . openapi.json</strong>
</pre>

<p></p>

<pre>
$ <strong>jq .info.license.name openapi.json</strong>
&nbsp;
"Apache 2.0"
</pre>

<pre>
$ <strong>jq ".paths[] | .get.summary" openapi.json</strong>
&nbsp;
"Returns valid HTTP 200 ok status when the service is ready"
"Read list of all clusters from database and return it to a client"
"Read cluster specified by its ID and return it to a client"
"Search for a cluster specified by its ID or name"
</pre>

<pre>
$ <strong>jq ".paths[] | .delete.summary" openapi.json</strong>
&nbsp;
null
null
"Delete a cluster specified by its ID"
null
</pre>

<p><a name="k07"></a></p>
<h2 id="k07">7. </h2>

<pre>
$ <strong>jq ".paths.\"/client/cluster/search\"" openapi.json</strong>
&nbsp;
{
  "get": {
    "summary": "Search for a cluster specified by its ID or name",
    "description": "",
    "parameters": [
      {
        "name": "id",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string"
        },
        "description": "Cluster ID",
        "allowEmptyValue": true
      },
      {
        "name": "name",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string"
        },
        "description": "Cluster name",
        "allowEmptyValue": true
      }
    ],
    "operationId": "searchCluster",
    "responses": {
      "default": {
        "description": "Default response"
      }
    }
  }
}
</pre>

<pre>
$ <strong>jq ".paths.\"/client/cluster/search\".get.parameters" openapi.json</strong>
&nbsp;
[
  {
    "name": "id",
    "in": "query",
    "required": false,
    "schema": {
      "type": "string"
    },
    "description": "Cluster ID",
    "allowEmptyValue": true
  },
  {
    "name": "name",
    "in": "query",
    "required": false,
    "schema": {
      "type": "string"
    },
    "description": "Cluster name",
    "allowEmptyValue": true
  }
]
</pre>

<p><a name="k08"></a></p>
<h2 id="k08">8. </h2>

<p><a name="k09"></a></p>
<h2 id="k09">9. </h2>

<p><a name="k10"></a></p>
<h2 id="k10">10. </h2>

<p><a name="k11"></a></p>
<h2 id="k11">11. </h2>

<pre>
$ <strong>wget https://raw.github.com/datasets/geo-boundaries-world-110m/master/countries.geojson</strong>
</pre>

<pre>
$ <strong>file countries.geojson</strong>
&nbsp;
countries.geojson: UTF-8 Unicode text, with very long lines
</pre>

<p><a name="k12"></a></p>
<h2 id="k12">12. </h2>

<p></p>

<pre>
$ <strong>jq .features[1] countries.geojson</strong>
</pre>

<p></p>

<pre>
$ <strong>jq .features[0].geometry.coordinates[0][0] countries.geojson</strong>
&nbsp;
[
  61.210817091725744,
  35.650072333309225
]
</pre>

<pre>
$ <strong>jq .features[0].geometry.coordinates[0][0][] countries.geojson</strong>
&nbsp;
61.210817091725744
35.650072333309225
</pre>

<p><a name="k13"></a></p>
<h2 id="k13">13. </h2>

<pre>
$ <strong>jq .features[0].geometry.coordinates[0][0][0,1] countries.geojson</strong>
&nbsp;
61.210817091725744
35.650072333309225
</pre>

<pre>
$ <strong>jq .features[0,1].geometry.coordinates[0][0][0,1] countries.geojson</strong>
&nbsp;
61.210817091725744
[
  16.326528354567046,
  -5.877470391466218
]
35.650072333309225
[
  16.573179965896145,
  -6.622644545115094
]
</pre>

<pre>
$ <strong>jq .features[0,1,5,10].geometry.coordinates[0][0][0,1] countries.geojson</strong>
&nbsp;
61.210817091725744
[
  16.326528354567046,
  -5.877470391466218
]
43.58274580259273
[
  45.0019873390568,
  39.7400035670496
]
35.650072333309225
[
  16.573179965896145,
  -6.622644545115094
]
41.09214325618257
[
  45.29814497252144,
  39.471751207022436
]
</pre>

<p><a name="k14"></a></p>
<h2 id="k14">14. </h2>



<p><a name="k15"></a></p>
<h2 id="k15">15. </h2>

<pre>
$ <strong>pip3 install --user jq</strong>
&nbsp;
Collecting jq
  Downloading https://files.pythonhosted.org/packages/37/83/e1f7162986c228cc33768b9c53c1167cafe222f8d81f1325a27cfff42f47/jq-1.0.2-cp36-cp36m-manylinux1_x86_64.whl (502kB)
    100% |████████████████████████████████| 512kB 1.5MB/s 
Installing collected packages: jq
Successfully installed jq-1.0.2
</pre>

<pre>
$ <strong>python3</strong>
&nbsp;
Python 3.6.6 (default, Jul 19 2018, 16:29:00) 
[GCC 7.3.1 20180303 (Red Hat 7.3.1-5)] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; <strong>import jq</strong>
&gt;&gt;&gt; <strong>help(jq)</strong>
</pre>

<p></p>

<pre>
Help on module jq:
&nbsp;
NAME
    jq
&nbsp;
FUNCTIONS
    all(...)
&nbsp;
    compile(...)
&nbsp;
    first(...)
&nbsp;
    iter(...)
&nbsp;
    jq(...)
&nbsp;
    text(...)
&nbsp;
DATA
    __test__ = {}
&nbsp;
FILE
</pre>



<p><a name="k16"></a></p>
<h2 id="k16">16. </h2>



<p><a name="k17"></a></p>
<h2 id="k17">17. </h2>



<p><a name="k18"></a></p>
<h2 id="k18">18. </h2>



<p><a name="k19"></a></p>
<h2 id="k19">19. </h2>



<p><a name="k20"></a></p>
<h2 id="k20">20. Odkazy na Internetu</h2>

<ol>

<li>Repositář projektu jq (GitHub)<br />
<a href="https://github.com/stedolan/jq">https://github.com/stedolan/jq</a>
</li>

<li>GitHub stránky projektu jq<br />
<a href="https://stedolan.github.io/jq/">https://stedolan.github.io/jq/</a>
</li>

<li>5 modern alternatives to essential Linux command-line tools<br />
<a href="https://opensource.com/article/20/6/modern-linux-command-line-tools">https://opensource.com/article/20/6/modern-linux-command-line-tools</a>
</li>

<li>Návod k&nbsp;nástroji jq<br />
<a href="https://stedolan.github.io/jq/tutorial/">https://stedolan.github.io/jq/tutorial/</a>
</li>

<li>jq Manual (development version)<br />
<a href="https://stedolan.github.io/jq/manual/">https://stedolan.github.io/jq/manual/</a>
</li>

<li>Introducing JSON<br />
<a href="https://www.json.org/json-en.html">https://www.json.org/json-en.html</a>
</li>

<li>jq.py: a lightweight and flexible JSON processor<br />
<a href="https://github.com/mwilliamson/jq.py">https://github.com/mwilliamson/jq.py</a>
</li>

<li>Discover how to use jq, a JSON manipulation command line, with GeoJSON<br />
<a href="https://webgeodatavore.com/jq-json-manipulation-command-line-with-geojson.html">https://webgeodatavore.com/jq-json-manipulation-command-line-with-geojson.html</a>
</li>

<li>Reshaping JSON with jq<br />
<a href="https://programminghistorian.org/en/lessons/json-and-jq">https://programminghistorian.org/en/lessons/json-and-jq</a>
</li>

<li>Python bindings for jq<br />
<a href="https://pypi.org/project/jq/">https://pypi.org/project/jq/</a>
</li>

<li>edn<br />
<a href="https://github.com/edn-format/edn">https://github.com/edn-format/edn</a>
</li>

<li>Why use JSON over XML?<br />
<a href="https://www.sitepoint.com/json-vs-xml/">https://www.sitepoint.com/json-vs-xml/</a>
</li>

<li>XML and XPath<br />
<a href="https://www.w3schools.com/XML/xml_xpath.asp">https://www.w3schools.com/XML/xml_xpath.asp</a>
</li>

<li>XPath (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/XPath">https://en.wikipedia.org/wiki/XPath</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2020</small></p>
</body>
</html>

