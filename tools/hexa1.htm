<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Hexa editory a další nástroje pro práci s binárními soubory</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
</head>

<body>

<h1>Hexa editory a další nástroje pro práci s binárními soubory</h1>

<h3>Pavel Tišnovský</h3>

<h1>Úvodník</h1>

<p>Na pětidílný miniseriál o debuggerech dostupných programátorům v&nbsp;Linuxu navazuje článek, v&nbsp;němž se budeme zabývat popisem nástrojů určených pro prohlížení a případnou editaci binárních souborů. Tyto nástroje mohou svým uživatelům nabízet různá rozhraní, ovšem významné místo zde náleží takzvaným <i>hexa prohlížečům</i> a <i>hexa editorům</i>, s&nbsp;nimiž se dnes taktéž seznámíme.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Hexa editory a další nástroje pro práci s&nbsp;binárními soubory</a></p>
<p><a href="#k02">2. Standardní operace podporované většinou hexa editorů</a></p>
<p><a href="#k03">3. Nástroje používané pro prohlížení a editaci binárních souborů v&nbsp;minulosti</a></p>
<p><a href="#k04">4. Typický zástupce pokročilého hexa editoru: <strong>HIEW</strong></a></p>
<p><a href="#k05">5. Hexa prohlížeče a editory pro Linux</a></p>
<p><a href="#k06">6. Prohlížeč binárních souborů zabudovaný do Midnight Commanderu</a></p>
<p><a href="#k07">7. Filtr <strong>xxd</strong> pro převod mezi binární a zvolenou číselnou reprezentací</a></p>
<p><a href="#k08">8. Hexa editor <strong>dhex</strong></a></p>
<p><a href="#k09">9. Hexa editor <strong>bvi</strong></a></p>
<p><a href="#k10">10. Textový editor <strong>Vim</strong> ve funkci hexa editoru</a></p>
<p><a href="#k11">11. Obsah druhé části článku</a></p>
<p><a href="#k12">12. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Hexa editory a další nástroje pro práci s&nbsp;binárními soubory</h2>

<p>V&nbsp;dnešním článku se opět budeme věnovat specializovaným nástrojům, které je možné v&nbsp;Linuxu použít jak při vývoji, tak i při administraci systému popř.&nbsp;při hledání chyb a testování různých aplikací, přenosových protokolů či souborových formátů. V&nbsp;předchozím pětidílném miniseriálu byly popsány vybrané debuggery a nadstavby nad těmito debuggery, dnes se budeme zabývat nástroji používanými pro prohlížení popř.&nbsp;pro editaci binárních souborů, tj.&nbsp;takových souborů, které není možné jednoduše zpracovat běžným textovým editorem. Mezi tyto nástroje patří především <i>hexa prohlížeče</i> a <i>hexa editory</i>.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/01_vc1.png"><img class="alignnone size-medium wp-image-5379" src="http://fedora.cz/wp-content/uploads/2015/07/01_vc1-450x281.png" alt="01_vc1" width="450" height="281" /></a>
<p><i>Obrázek 1: Prohlížeč binárních souborů implementovaný ve Volkov Commanderu (DOS/Windows). Ze screenshotu je patrné &bdquo;klasické&ldquo; rozdělení okna na tři sloupce: adresy, hodnoty bajtů a jednotlivé znaky odpovídající pozicím bajtů.</i></p>

<p>Označení &bdquo;hexa&ldquo; si tyto aplikace vysloužily díky tomu, že se v&nbsp;nich původně binární data zobrazovala typickým způsobem ve formě hexadecimálních hodnot (tj.&nbsp;číselných hodnot využívajících při zobrazení šestnáctkovou soustavu) umístěných do sloupců. Ve skutečnosti je však možné mnoho těchto prohlížečů a editorů nakonfigurovat takovým způsobem, že se namísto hexadeciálních hodnot používají hodnoty reprezentované v&nbsp;osmičkové soustavě, v&nbsp;soustavě dvojkové či dokonce v&nbsp;desítkové soustavě (což ovšem v&nbsp;naprosté většině případů není moc praktické).</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/02_vc2.png"><img class="alignnone size-medium wp-image-5380" src="http://fedora.cz/wp-content/uploads/2015/07/02_vc2-450x281.png" alt="02_vc2" width="450" height="281" /></a>
<p><i>Obrázek 2: Velmi užitečná vlastnost některých hexa prohlížečů a editorů: možnost volby kódování znaků (kupodivu jen poměrně malé množství hexa editorů podporuje například UTF-8 či UTF-16).</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Standardní operace podporované většinou hexa editorů</h2>

<p>Jaké operace vlastně můžeme od hexa prohlížečů a hexa editorů očekávat? Především by mělo být možné zobrazit obsah vybraného (binárního) souboru ve formě sekvence bajtů či širších slov, přičemž číselná hodnota každého bajtu či slova může být zobrazena v&nbsp;binární, osmičkové či šestnáctkové (hexadecimální) soustavě. Na většině dnes používaných architektur se ponejvíce používá šestnáctková soustava, a to mj.&nbsp;i z&nbsp;toho důvodu, že tyto architektury zpracovávají slova rozdělená do bajtů a hodnotu každého bajtu je možné v&nbsp;šestnáctkové soustavě zobrazit pouhými dvěma číslicemi a navíc je po krátkém tréninku možné jednoduše při přečtení šestnáctkové číslice zjistit nastavení jednotlivých bitů.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/03_hiew0.png"><img class="alignnone size-medium wp-image-5381" src="http://fedora.cz/wp-content/uploads/2015/07/03_hiew0-450x281.png" alt="03_hiew0" width="450" height="281" /></a>
<p><i>Obrázek 3: Výběr souboru pro editaci hexa editorem HIEW. Tento nástroj bude sloužit jako etalon při porovnávání vlastností dalších (Linuxových) hexa prohlížečů a editorů.</i></p>

<p>Některé hexa prohlížeče a hexa editory navíc zobrazují vybrané hodnoty v&nbsp;desítkové soustavě, což se hodí například při editaci uložených stavů her (změna skóre, energie, počtu životů...). Dále by hexa prohlížeče či editory měly zobrazit i pozici v&nbsp;souboru (offset), popř.&nbsp;hodnotu jednotlivých bajtů interpretovat jako řetězec (vhodné při zkoumání různých protokolů). Bohužel mnoho těchto aplikací doposud neumí dobře zpracovat Unicode a jeho různá kódování. Přidanou hodnotou může být disassembler či jednoduchý dekódovací program.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/04_hiew1.png"><img class="alignnone size-medium wp-image-5382" src="http://fedora.cz/wp-content/uploads/2015/07/04_hiew1-450x281.png" alt="04_hiew1" width="450" height="281" /></a>
<p><i>Obrázek 4: HIEW pracující v&nbsp;režimu zobrazení textu bez zapnutého word-wrappingu. Zobrazen je elektronický manuál dodávaný k&nbsp;tomuto editoru.</i></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Nástroje používané pro prohlížení a editaci binárních souborů v&nbsp;minulosti</h2>

<p>Hexa prohlížeče a hexa editory za sebou mají poměrně dlouhý vývoj, ostatně jejich vznik lze datovat ještě do dob, kdy neexistovaly ani dnes zcela běžné textové editory. Jeden z&nbsp;prvních programů tohoto typu se jmenoval <strong>SUPERZAP</strong> a používat se mohl na mainframech řady IBM OS/360. Podobné nástroje se později používaly i na domácích osmibitových mikropočítačích, a to mnohdy i ve chvíli, kdy by se dnes s&nbsp;velkou pravděpodobností využila jiná vhodnější aplikace, například assembler, textový editor či grafický (bitmapový) editor.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/05_hiew2.png"><img class="alignnone size-medium wp-image-5383" src="http://fedora.cz/wp-content/uploads/2015/07/05_hiew2-450x281.png" alt="05_hiew2" width="450" height="281" /></a>
<p><i>Obrázek 5: HIEW pracující v&nbsp;hexa režimu. Můžeme zde opět, podobně jako u prohlížeče Volkov Commanderu, vidět &bdquo;klasické&ldquo; rozdělení okna na tři sloupce: adresy, hodnoty bajtů a jednotlivé znaky.</i></p>

<p>Hexa prohlížeče a hexa editory se částečně transformovaly na komplexnější nástroje nazývané <i>monitory</i> (ty sice byly navrženy především pro modifikaci obsahu operační paměti, ovšem taktéž umožňovaly načítání a ukládání souborů, takže rozdíly ve skutečnosti nejsou tak velké). Jednou z&nbsp;funkcí odlišujících hexa editor od monitoru je většinou existence disassembleru a možnost spouštění nativních (samozřejmě binárních) programů od určité adresy. Jak však bude patrné z&nbsp;dalšího textu, dnes jsou možnosti některých hexa editorů tak rozsáhlé, že se rozdíly částečně smazávají. A je nutné poznamenat, že hexa monitor kombinovaný s&nbsp;disassemblerem popř.&nbsp;dokonce s&nbsp;jednoduchým assemblerem je velmi mocným nástrojem.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/06_hiew3.png"><img class="alignnone size-medium wp-image-5384" src="http://fedora.cz/wp-content/uploads/2015/07/06_hiew3-450x281.png" alt="06_hiew3" width="450" height="281" /></a>
<p><i>Obrázek 6: HIEW pracující v&nbsp;režimu disassembleru, zde konkrétně se jedná o disassembler 16bitového režimu mikroprocesorů řady 80x86.</i></p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Typický zástupce pokročilého hexa editoru: <strong>HIEW</strong></h2>

<p>Většina hexa editorů stále využívá textový režim. Vzhledem k&nbsp;tomu, že standardní textový režim (realizovaný přímo hardwarovými prostředky) dokáže zobrazit 80 znaků na textovém řádku, byla obrazovka těchto editorů rozdělena na tři části, které tvořily: sloupec s&nbsp;adresou (pořadím bajtu v&nbsp;souboru, tj.&nbsp;vlastně offsetem), 48 sloupců se šestnácti hexadecimálními hodnotami a konečně šestnáct znaků s&nbsp;ASCII hodnotami editovaných bajtů &ndash; podobný formát je ostatně dodržen dodnes, jak bude patrné ze screenshotů uvedených v&nbsp;navazujících kapitolách.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/07_hiew4.png"><img class="alignnone size-medium wp-image-5385" src="http://fedora.cz/wp-content/uploads/2015/07/07_hiew4-450x281.png" alt="07_hiew4" width="450" height="281" /></a>
<p><i>Obrázek 7: Kontextová nápověda k&nbsp;editoru HIEW.</i></p>

<p>Jedním z&nbsp;nejpoužívanějších hexa editorů určených pro domácí mikropočítače IBM PC byl <i>HIEW</i> (<i>Hacker's View</i>), jenž se souborem dokázal pracovat ve čtyřech režimech. Šlo o textový režim bez zalamování řádků, textový režim se zalamováním řádků, hexadecimální režim a konečně režim dissasembleru, v&nbsp;němž se jednotlivé bajty v&nbsp;souboru interpretovaly jako instrukce procesoru <i>80x86</i>. <i>HIEW</i> bylo možné použít mnoha různými způsoby: pro úpravu vlastních binárních souborů, crackování programů :-) (například náhradou některých skoků instrukcemi NOP), úpravu souborů s&nbsp;uloženými stavy různých her (v&nbsp;mém případě například pro zvýšení počtu kreditů v&nbsp;Duně II) či pro opravu poškozených binárních souborů, například po pádu databázových aplikací.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/08_hiew5.png"><img class="alignnone size-medium wp-image-5386" src="http://fedora.cz/wp-content/uploads/2015/07/08_hiew5-450x281.png" alt="08_hiew5" width="450" height="281" /></a>
<p><i>Obrázek 8: HIEW pracující v&nbsp;režimu zobrazení textu se zapnutým word-wrappingem. Toto je dosti neobvyklý režim, který prakticky u žádného dalšího hexa editoru nenalezneme.</i></p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Hexa prohlížeče a editory pro Linux</h2>

<p>Po úvodních informacích se konečně dostáváme k&nbsp;ústřednímu tématu tohoto článku, tj.&nbsp;k&nbsp;popisu hexa editorů dostupných pro operační systém Linux. Hexa prohlížečů a hexa editorů pro Linux existuje poměrně velké množství, přičemž se od sebe jednotlivé nástroje odlišují jak použitím terminálu či plnohodnotného grafického uživatelského rozhraní, tak i nabízenými funkcemi, možnosti interpretovat binární data různými způsoby, nabídkou režimu disassembleru apod. Dnes se zaměříme především na ty hexa prohlížeče a hexa editory, které jsou určeny pro práci v&nbsp;konzoli (terminálu), což je podle mého názoru zrovna pro tento typ aplikací nejlepší (resp.&nbsp;přesněji řečeno nejpraktičtější) volba, zejména ve chvíli, kdy je nutné pracovat s&nbsp;binárními daty na vzdáleném serveru.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/09_mc1.png"><img class="alignnone size-medium wp-image-5387" src="http://fedora.cz/wp-content/uploads/2015/07/09_mc1-450x296.png" alt="09_mc1" width="450" height="296" /></a>
<p><i>Obrázek 9: Hexa prohlížeč, který je součástí souborového manažeru Midnight Commander.</i></p>

<p>Pro Linux však vzniklo i mnoho hexa prohlížečů a editorů, které svým uživatelům nabízí grafické uživatelské rozhraní. Tyto nástroje budou popsány příště. <a href="#k06">V&nbsp;navazující kapitole</a> bude popsán hexa prohlížeč, který je součástí Midnight Commanderu, dále se zmíníme o hexa editorech s&nbsp;názvy <a href="k08">dhex</a> a <a href="#k09">bvi</a> a na závěr si ukážeme, jak je možné nakonfigurovat známý a oblíbený textový editor <i>Vim</i> pro editaci binárních souborů.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/10_mc2.png"><img class="alignnone size-medium wp-image-5388" src="http://fedora.cz/wp-content/uploads/2015/07/10_mc2-450x296.png" alt="10_mc2" width="450" height="296" /></a>
<p><i>Obrázek 10: Možnosti prohledávání nabízené interním hexa prohlížečem Midnight Commanderu.</i></p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Prohlížeč binárních souborů zabudovaný do Midnight Commanderu</h2>

<p>První aplikací dostupnou (nejenom) pro Linux a schopnou zobrazit obsah binárních souborů ve formě hexadecimálního výpisu, je interní prohlížeč, který je součástí známého a mnohými uživateli oblíbeného <i>Midnight Commanderu</i>. Tento prohlížeč je možné využít ve dvou režimech: buď je obsah zvoleného souboru zobrazen jako text nebo se prohlížeč přepne do téměř klasického pohledu používaného i mnohými dalšími hexa prohlížeči a hexa editory. Za zmínku stojí dvě zajímavé vlastnosti. První vlastností je velmi dobrá podpora pro hledání řetězců či sekvence bajtů (viz též obrázek číslo 10 uvedený na konci předchozí kapitoly). Další užitečná vlastnost spočívá v&nbsp;možnosti volby kódování znaků (obrázek číslo 11), protože například při opravě databázových souborů či uložených stavů her je nutné zvolit stejné kódování, jaké je interně použito v&nbsp;dané aplikaci (a ne vždy se jedná o UTF-8, dokonce bych řekl, že toto kódování je u binárních souborů spíše výjimečné).</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/11_mc3.png"><img class="alignnone size-medium wp-image-5389" src="http://fedora.cz/wp-content/uploads/2015/07/11_mc3-450x296.png" alt="11_mc3" width="450" height="296" /></a>
<p><i>Obrázek 11: Velmi důležitá funkce interního hexa prohlížeče &ndash; volba kódování znaků.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/12_mc4.png"><img class="alignnone size-medium wp-image-5390" src="http://fedora.cz/wp-content/uploads/2015/07/12_mc4-450x296.png" alt="12_mc4" width="450" height="296" /></a>
<p><i>Obrázek 12: Nyní se obsah binárního souboru zobrazuje s&nbsp;použitím azbuky (pravý sloupec se znaky).</i></p>



<p><a name="k07"></a></p>
<h2 id="k07">7. Filtr <strong>xxd</strong> pro převod mezi binární a zvolenou číselnou reprezentací</h2>

<p>Ani druhý nástroj, o němž se v&nbsp;dnešním článku zmíníme, nepatří mezi běžné hexa editory. Tímto nástrojem je filtr nazvaný <strong>xxd</strong>. Slovo &bdquo;filtr&ldquo; jsem použil záměrně, neboť <strong>xxd</strong> slouží k&nbsp;převodu binárního souboru na textový soubor, v&nbsp;němž jsou původní data uložena do třech sloupců: adresy, číselných hodnot jednotlivých bajtů či slov a řetězcové podoby těchto bajtů. Co činí <strong>xxd</strong> užitečným je možnost zpětného převodu takto zformátovaného textového souboru zpět do binární podoby (přičemž se v&nbsp;úvahu bere jen prostřední sloupec s&nbsp;číselnými hodnotami bajtů). Díky této vlastnosti je možné jakýkoli binární soubor převést do textové podoby, změnit tento soubor v&nbsp;libovolném oblíbeném textovém editoru a následně provést zpětný převod. Aby toho nebylo málo, je možné použít několik voleb ovlivňujících tvar textového souboru: změnit lze číselnou soustavu, sdružování bajtů do slov atd. Perlička na závěr: <strong>xxd</strong> je jedním z&nbsp;mála programů rozpoznávajících kromě ASCII kódování i EBCDIC (jednou jsem tuto vlastnost dokonce využil pro export dat z&nbsp;mainframu do PC :-).</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/13_xxd1.png"><img class="alignnone size-medium wp-image-5391" src="http://fedora.cz/wp-content/uploads/2015/07/13_xxd1-450x296.png" alt="13_xxd1" width="450" height="296" /></a>
<p><i>Obrázek 13: Nápověda k&nbsp;filtru <strong>xxd</strong>.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/14_xxd2.png"><img class="alignnone size-medium wp-image-5392" src="http://fedora.cz/wp-content/uploads/2015/07/14_xxd2-450x296.png" alt="14_xxd2" width="450" height="296" /></a>
<p><i>Obrázek 14: Volbou <strong>-g1</strong> je možné <strong>xxd</strong> donutit ke způsobu zobrazení známého z&nbsp;ostatních hexa editorů.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/15_xxd3.png"><img class="alignnone size-medium wp-image-5393" src="http://fedora.cz/wp-content/uploads/2015/07/15_xxd3-450x296.png" alt="15_xxd3" width="450" height="296" /></a>
<p><i>Obrázek 15: Volba <strong>-g2</strong> je vhodná v&nbsp;případě, že jsou v&nbsp;binárním souboru uložena 16bitová data.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/16_xxd4.png"><img class="alignnone size-medium wp-image-5394" src="http://fedora.cz/wp-content/uploads/2015/07/16_xxd4-450x296.png" alt="16_xxd4" width="450" height="296" /></a>
<p><i>Obrázek 16: Sdružování bajtů do čtyřbajtových (32bitových) slov.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/17_xxd5.png"><img class="alignnone size-medium wp-image-5395" src="http://fedora.cz/wp-content/uploads/2015/07/17_xxd5-450x296.png" alt="17_xxd5" width="450" height="296" /></a>
<p><i>Obrázek 17: Zajímavá může být i kombinace voleb <strong>-g1 -b</strong>, kdy se namísto šestnáctkové soustavy použije soustava dvojková.</i></p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Hexa editor <strong>dhex</strong></h2>

<p>Konečně se dostáváme ke skutečnému a plnohodnotnému Linuxovému hexa editoru. Tento editor se jmenuje <strong>dhex</strong> a některými svými vlastnosti je podobný výše zmíněnému DOSovému hexa editoru <strong>HIEW</strong>. <strong>dhex</strong> totiž využívá terminál (konzoli) a mnohé jeho funkce jsou namapovány na funkční klávesy F1 až F10. Vzhledem k&nbsp;tomu, že na různých emulátorech terminálu se mohou tyto klávesy chovat odlišným způsobem (posílají jiné sekvence znaků apod.), zobrazí <strong>dhex</strong> při svém prvním spuštění konfigurační dialog, ve kterém uživatel jednotlivé klávesy stlačí a <strong>dhex</strong> se je tak jednoduše &bdquo;naučí&ldquo;. Kromě režimu prohlížení a editace najdeme v&nbsp;tomto hexa editoru i užitečnou kalkulačku, která kromě běžných aritmetických operací používá i bitové posuny a taktéž bitové operace AND, OR, XOR. Změnu barevné palety <strong>dhexu</strong> je možné provést ruční editací jeho konfiguračního souboru, který je kupodivu textový a nikoli binární :-).</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/18_dhex1.png"><img class="alignnone size-medium wp-image-5396" src="http://fedora.cz/wp-content/uploads/2015/07/18_dhex1-450x296.png" alt="18_dhex1" width="450" height="296" /></a>
<p><i>Obrázek 18: Hexa editor <strong>dhex</strong>: integrovaná nápověda (vypisovaná na standardní výstup).</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/19_dhex2.png"><img class="alignnone size-medium wp-image-5397" src="http://fedora.cz/wp-content/uploads/2015/07/19_dhex2-450x296.png" alt="19_dhex2" width="450" height="296" /></a>
<p><i>Obrázek 19: Hexa editor <strong>dhex</strong>: při prvním spuštění je možné tento hexa editor nakonfigurovat, zejména si zvolit mapování funkčních kláves.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/20_dhex3.png"><img class="alignnone size-medium wp-image-5398" src="http://fedora.cz/wp-content/uploads/2015/07/20_dhex3-450x296.png" alt="20_dhex3" width="450" height="296" /></a>
<p><i>Obrázek 20: Hexa editor <strong>dhex</strong>: základní způsob zobrazení nabízený tímto hexa editorem.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/21_dhex4.png"><img class="alignnone size-medium wp-image-5399" src="http://fedora.cz/wp-content/uploads/2015/07/21_dhex4-450x296.png" alt="21_dhex4" width="450" height="296" /></a>
<p><i>Obrázek 21: Hexa editor <strong>dhex</strong>: ruční úpravou konfiguračního souboru jsem dosáhl změny barvy pruhu s&nbsp;funkcemi tlačítek.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/22_dhex5.png"><img class="alignnone size-medium wp-image-5400" src="http://fedora.cz/wp-content/uploads/2015/07/22_dhex5-450x296.png" alt="22_dhex5" width="450" height="296" /></a>
<p><i>Obrázek 22: Hexa editor <strong>dhex</strong>: užitečná binární a hexa kalkulačka, která nabízí i bitové operace a posuny.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/23_dhex6.png"><img class="alignnone size-medium wp-image-5401" src="http://fedora.cz/wp-content/uploads/2015/07/23_dhex6-450x296.png" alt="23_dhex6" width="450" height="296" /></a>
<p><i>Obrázek 23: Hexa editor <strong>dhex</strong>: průběh vlastní editace binárního souboru.</i></p>



<p><a name="k09"></a></p>
<h2 id="k09">9. Hexa editor <strong>bvi</strong></h2>

<p>Druhým plnohodnotným hexa editorem, který si dnes popíšeme, je nástroj nazvaný <strong>bvi</strong>. Jméno této aplikace je odvozeno od dvojice slov &bdquo;binary&ldquo; a &bdquo;vi&ldquo;, což již naznačuje, že se jedná o nástroj, jehož ovládání bude do značné míry podobné ovládání textových editorů <strong>Vi</strong> a <strong>Vim</strong>. Skutečně je tomu tak, samozřejmě s&nbsp;tím rozdílem, že <strong>bvi</strong> používá stejný způsob zobrazení jako mnohé další hexa editory, což je ostatně patrné i při pohledu na screenshoty zobrazené pod tímto odstavcem. Dalším rozdílem mezi <strong>Vi</strong> a <strong>Bvi</strong> je změněné chování některých operací, což je ale pochopitelné, neboť binární soubory jsou zpracovávány jako jeden dlouhý blok bajtů a nikoli jako sekvence textových řádků. Zajímavé ovšem je, že <strong>bvi</strong> je možné volbou &bdquo;memmove&ldquo; přepnout do režimu, v&nbsp;němž je možné jednotlivé bajty přidávat či naopak umazávat (což je operace, která je v&nbsp;některých dalších hexa editorech nedostupná).</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/24_bvi1.png"><img class="alignnone size-medium wp-image-5402" src="http://fedora.cz/wp-content/uploads/2015/07/24_bvi1-450x296.png" alt="24_bvi1" width="450" height="296" /></a>
<p><i>Obrázek 24: Hexa editor <strong>bvi</strong>: důležitá sekce nápovědy, ve které se popisuje rozdíl mezi textovým editorem Vi a binárním editorem Bvi.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/25_bvi2.png"><img class="alignnone size-medium wp-image-5403" src="http://fedora.cz/wp-content/uploads/2015/07/25_bvi2-450x296.png" alt="25_bvi2" width="450" height="296" /></a>
<p><i>Obrázek 25: Hexa editor <strong>bvi</strong>: textové uživatelské rozhraní binárního editoru Bvi.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/26_bvi3.png"><img class="alignnone size-medium wp-image-5404" src="http://fedora.cz/wp-content/uploads/2015/07/26_bvi3-450x296.png" alt="26_bvi3" width="450" height="296" /></a>
<p><i>Obrázek 26: Hexa editor <strong>bvi</strong>: výpis všech parametrů editoru, které je možné kdykoli změnit.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/27_bvi4.png"><img class="alignnone size-medium wp-image-5405" src="http://fedora.cz/wp-content/uploads/2015/07/27_bvi4-450x296.png" alt="27_bvi4" width="450" height="296" /></a>
<p><i>Obrázek 27: Hexa editor <strong>bvi</strong>: vlastní editace binárního souboru.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/28_bvi5.png"><img class="alignnone size-medium wp-image-5406" src="http://fedora.cz/wp-content/uploads/2015/07/28_bvi5-450x296.png" alt="28_bvi5" width="450" height="296" /></a>
<p><i>Obrázek 28: Hexa editor <strong>bvi</strong>: režim přepisu znaků.</i></p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Textový editor <strong>Vim</strong> ve funkci hexa editoru</h2>

<p>Poslední pomůckou programátora, kterou si v&nbsp;dnešním článku stručně popíšeme, je způsob editace binárních souborů ve známém textovém editoru <i>Vim</i>. <i>Vim</i> sice ve skutečnosti není přímo určen pro editaci binárních dat, ovšem v&nbsp;kombinaci <a href="#k07">s&nbsp;výše popsaným</a> externím nástrojem <strong>xxd</strong> ho je možné využít jako poměrně vyspělý hexa editor, protože nástroj <strong>xxd</strong> pracuje jako filtr převádějící binární data na jejich hexadecimální, osmičkovou či binární podobu a dokáže provést i zpětný převod. Pokud se při zavolání <strong>xxd</strong> použije volba <strong>-g 1</strong>, bude na standardní výstup vytištěn transformovaný obsah souboru rozdělený na jednotlivé bajty. Následně je možné tento výstup zobrazit ve <i>Vimu</i> a při ukládání provést zpětný převod. Důležité je si uvědomit, že <strong>xxd</strong> při zpětném převodu bude ignorovat poslední sloupec (se zobrazením znaků), což může být pro mnoho aplikací významné omezení. Další omezení spočítá v&nbsp;tom, že převod binárního souboru na jeho &bdquo;textovou&ldquo; podobu je velmi neefektivní z&nbsp;paměťového hlediska. Jinými slovy to znamená, že ve <i>Vimu</i> je možné měnit řádově menší soubory, než ve skutečném (plnohodnotném) hexa editoru.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/07/29_vim1.png"><img class="alignnone size-medium wp-image-5407" src="http://fedora.cz/wp-content/uploads/2015/07/29_vim1-450x283.png" alt="29_vim1" width="450" height="283" /></a>
<p><i>Obrázek 29: Textový editor Vim při zobrazení binárního souboru po jeho filtraci přes externí nástroj <strong>xxd</strong>. Pokud je Vim správně nakonfigurován, dokáže při ukládání souboru provést automatickou zpětnou filtraci z&nbsp;hexa formátu do původního binárního tvaru.</i></p>

<p>Ruční volání filtru <strong>xxd</strong> s&nbsp;přesměrováním standardního výstupu a otevřením tohoto výstupu ve <i>Vimu</i> je však ve skutečnosti zbytečně složité a vzhledem k&nbsp;tomu, že si my uživatelé <i>Vimu</i> rádi věci ulehčíme (jinak by ostatně pro editaci textu postačoval <a href="http://notepad.org/">Notepad</a> :-), je možné využít automatické příkazy volané při načítání, popř.&nbsp;při ukládání souborů. Následující sekvence příkazů zapsaná do konfiguračního souboru <strong>.vimrc</strong> (uloženého v&nbsp;domácím adresáři) zajistí, že se při načítání souborů *.class (což je jen příklad) tyto soubory automaticky převedou do hexa podoby a při ukládání se opět transformují do původní binární podoby:</p>

<pre>
" vim -b : edit binary using xxd-format!
augroup Binary_Java_Class
    au!
    au BufReadPre   *.class let &amp;bin=1
    au BufReadPost  *.class if &amp;bin | %!xxd -g1
    au BufReadPost  *.class set ft=xxd | endif
    au BufWritePre  *.class if &amp;bin | %!xxd -g1 -r
    au BufWritePre  *.class endif
    au BufWritePost *.class if &amp;bin | %!xxd -g1
    au BufWritePost *.class set nomod | endif
augroup END
</pre>

<p>Převod přeložené javovské třídy (tj.&nbsp;binárního souboru) do podoby editovatelné <i>Vimem</i> vypadá takto:</p>

<pre>
0000000: ca fe ba be 00 00 00 32 00 0f 0a 00 03 00 0c 07  .......2........
0000010: 00 0d 07 00 0e 01 00 06 3c 69 6e 69 74 3e 01 00  ........&lt;init&gt;..
0000020: 03 28 29 56 01 00 04 43 6f 64 65 01 00 0f 4c 69  .()V...Code...Li
0000030: 6e 65 4e 75 6d 62 65 72 54 61 62 6c 65 01 00 04  neNumberTable...
0000040: 6d 61 69 6e 01 00 16 28 5b 4c 6a 61 76 61 2f 6c  main...([Ljava/l
0000050: 61 6e 67 2f 53 74 72 69 6e 67 3b 29 56 01 00 0a  ang/String;)V...
0000060: 53 6f 75 72 63 65 46 69 6c 65 01 00 09 54 65 73  SourceFile...Tes
0000070: 74 2e 6a 61 76 61 0c 00 04 00 05 01 00 04 54 65  t.java........Te
0000080: 73 74 01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f  st...java/lang/O
0000090: 62 6a 65 63 74 00 21 00 02 00 03 00 00 00 00 00  bject.!.........
00000a0: 02 00 01 00 04 00 05 00 01 00 06 00 00 00 1d 00  ................
00000b0: 01 00 01 00 00 00 05 2a b7 00 01 b1 00 00 00 01  .......*........
00000c0: 00 07 00 00 00 06 00 01 00 00 00 01 00 09 00 08  ................
00000d0: 00 09 00 01 00 06 00 00 00 19 00 00 00 01 00 00  ................
00000e0: 00 01 b1 00 00 00 01 00 07 00 00 00 06 00 01 00  ................
00000f0: 00 00 03 00 01 00 0a 00 00 00 02 00 0b           .............
</pre>

<p>Pomocná proměnná <strong>bin</strong> je zde použita proto, aby se převod náhodou neprovedl dvakrát za sebou.</p>

<p>Podobným způsobem lze zajistit načítání i dalších typů binárních souborů, například:</p>

<pre>
augroup Binary
  au!
  au BufReadPre   *.gif let &amp;bin=1
  au BufReadPost  *.gif if &amp;bin | %!xxd -g1
  au BufReadPost  *.gif set ft=xxd | endif
  au BufWritePre  *.gif if &amp;bin | %!xxd -g1 -r
  au BufWritePre  *.gif endif
  au BufWritePost *.gif if &amp;bin | %!xxd -g1
  au BufWritePost *.gif set nomod | endif
augroup END
endif
</pre>



<p><a name="k11"></a></p>
<h2 id="k11">11. Obsah druhé části článku</h2>

<p>Ve druhé části článku o hexa prohlížečích a hexa editorech se zaměříme mj.&nbsp;na ty nástroje dostupné pro Linux, které využívají plnohodnotné grafické uživatelské rozhraní. Uvidíme, že těchto nástrojů kupodivu existuje poměrně velké množství. Velmi jednoduchý na ovládání (ovšem funkčně omezený) je například prohlížeč a editor nazvaný <strong>ghex</strong>, více funkcí nabízí <strong>khex</strong> určený pro konkurenční desktopové prostředí, dále je možné vyzkoušet <strong>wxhexer</strong>. Taktéž si popíšeme nástroje se jménem <strong>okteta</strong> a <strong>beye</strong>. Nesmíme zapomenout ani na další typ aplikací &ndash; na nástroje použitelné pro zobrazení rozdílů mezi dvěma binárními soubory (v&nbsp;tomto případě nebývá běžný <strong>diff</strong> tím nejlepším řešením).</p>



<p><a name="k12"></a></p>
<h2 id="k12">12. Odkazy na Internetu</h2>

<ol>

<li>Hex Editors for Lin/unix<br />
<a href="http://blog.sourcepole.com/2006/09/07/hex-editors/">http://blog.sourcepole.com/2006/09/07/hex-editors/</a>
</li>

<li>dhex (home page)<br />
<a href="http://freecode.com/projects/dhex">http://freecode.com/projects/dhex</a>
</li>

<li>Hex editor (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/Hex_editor">https://en.wikipedia.org/wiki/Hex_editor</a>
</li>

<li>Comparison of hex editors (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/Comparison_of_hex_editors">https://en.wikipedia.org/wiki/Comparison_of_hex_editors</a>
</li>

<li>bvi Home Page<br />
<a href="http://bvi.sourceforge.net/">http://bvi.sourceforge.net/</a>
</li>

<li>bvi (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/Bvi">https://en.wikipedia.org/wiki/Bvi</a>
</li>

<li>xxd (man page)<br />
<a href="http://www.linux-tutorial.info/modules.php?name=ManPage&sec=1&manpage=xxd">http://www.linux-tutorial.info/modules.php?name=ManPage&sec=1&manpage=xxd</a>
</li>

<li>vim (man page)<br />
<a href="http://www.linux-tutorial.info/modules.php?name=ManPage&sec=1&manpage=vim">http://www.linux-tutorial.info/modules.php?name=ManPage&sec=1&manpage=vim</a>
</li>

</ol>



</body>
</html>

