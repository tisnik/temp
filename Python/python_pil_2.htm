<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Užitečné knihovny a moduly pro Python: kreslení a pokročilé manipulace s obrázky v knihovně Pillow</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Užitečné knihovny a moduly pro Python: kreslení a pokročilé manipulace s obrázky v knihovně Pillow</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>Ve druhém článku o knihovně Pillow určené programátorům, kteří potřebují manipulovat s&nbsp;rastrovými obrázky ve skriptech  nebo i rozsáhlejších aplikacích psaných v&nbsp;Pythonu, si ukážeme některé pokročilejší operace nabízené touto knihovnou. Nejprve si představíme modul nazvaný ImageEnhance určený pro manipulaci se základními charakteristikami rastrových obrázků. Dále si řekneme jak je možné získat základní statistické informace o obrázku, a to včetně histogramu. Druhá polovina článku bude věnována popisu vybraných kreslicích operací, způsobu specifikace barev kreslení apod.</p><!--more-->



<h2>Obsah</h2>

<p><a href="#k01">1. Užitečné knihovny a moduly pro Python: kreslení a pokročilé manipulace s&nbsp;obrázky v&nbsp;knihovně Pillow</a></p>
<p><a href="#k02">2. Modul <strong>ImageEnhance</strong> určený pro manipulace se základními charakteristikami rastrových obrázků</a></p>
<p><a href="#k03">3. Zaostření nebo rozostření obrázku</a></p>
<p><a href="#k04">4. Zvýšení a snížení kontrastu</a></p>
<p><a href="#k05">5. Zvýšení a snížení jasu</a></p>
<p><a href="#k06">6. Změna sytosti barev</a></p>
<p><a href="#k07">7. Získání základních statistik o rastrovém obrázku</a></p>
<p><a href="#k08">8. Výpočet histogramu</a></p>
<p><a href="#k09">9. Operace pro manipulaci s&nbsp;jednotlivými pixely v&nbsp;rastrovém obrázku</a></p>
<p><a href="#k10">10. Vykreslení RGB palety</a></p>
<p><a href="#k11">11. Vykreslení HSL palety</a></p>
<p><a href="#k12">12. Kreslicí operace využívající modul <strong>ImageDraw</strong></a></p>
<p><a href="#k13">13. Nakreslení mřížky do načteného obrázku</a></p>
<p><a href="#k14">14. Vykreslení různobarevných čtverců</a></p>
<p><a href="#k15">15. Použití polyčar (lomených čar) pro tvorbu složitějších obrazců</a></p>
<p><a href="#k16">16. Vykreslení obrazce složeného z&nbsp;kružnic</a></p>
<p><a href="#k17">17. Základy práce s&nbsp;textem: rasterizace a vykreslení textu do obrázku</a></p>
<p><a href="#k18">18. Obsah následující části seriálu</a></p>
<p><a href="#k19">19. Repositář s&nbsp;demonstračními příklady</a></p>
<p><a href="#k20">20. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Užitečné knihovny a moduly pro Python: kreslení a pokročilé manipulace s&nbsp;obrázky v&nbsp;knihovně Pillow</h2>

<p><a href="https://mojefedora.cz/uzitecne-knihovny-a-moduly-pro-python-knihovna-pillow-urcena-pro-manipulaci-s-rastrovymi-obrazky/">V&nbsp;předchozím článku</a> seriálu o užitečných modulech určených pro programovací jazyk Python jsme si ve stručnosti představili knihovnu <i>Pillow</i> určenou pro manipulaci s&nbsp;rastrovými obrázky přímo v&nbsp;Pythonu. Připomeňme si, že tato knihovna dokáže načítat a ukládat rastrové obrázky v&nbsp;mnoha formátech, samozřejmě včetně většiny nejpopulárnějších rastrových grafických formátů, mezi něž patří především formáty GIF, JPEG, PNG, TIFF (různé varianty) a například i WebP či BMP. Do určité míry jsou podporovány i formáty PSD a dokonce i PDF, což samozřejmě není čistý rastrový formát. Tato knihovna však dokáže provádět i další operace, z&nbsp;nichž některé si popíšeme v&nbsp;dnešním článku. Především se jedná o manipulaci se základními charakteristikami rastrových obrázků (zaostření, kontrast, ...) a taktéž o vykreslování do obrázků, buď na úrovni jednotlivých pixelu či s&nbsp;využitím vysokoúrovňových 2D operací.</p>

<a href="https://mojefedora.cz/wp-content/uploads/2018/08/01_Lenna-1.png"><img class="alignnone size-thumbnail wp-image-10443" src="https://mojefedora.cz/wp-content/uploads/2018/08/01_Lenna-1-254x254.png" alt="" width="254" height="254" /></a>
<p><i>Obrázek 1: Testovací obrázek Lenny použitý ve většině dnešních demonstračních příkladů.</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Modul <strong>ImageEnhance</strong> určený pro manipulace se základními charakteristikami rastrových obrázků</h2>

<p>První modul, s&nbsp;nímž se dnes seznámíme, se jmenuje <strong>ImageEnhance</strong>. Tento modul slouží pro manipulaci se základními charakteristikami rastrového obrázku. Jedná se především o zaostření popř.&nbsp;naopak o rozostření (rozmazání) obrázku, změnu kontrastu, změnu jasu a změnu barevného podání (resp.&nbsp;poněkud nepřesně řečeno barevného kontrastu). Všechny tyto operace jsou globální, tj.&nbsp;mají dopad na všechny pixely rastrového obrázku (na rozdíl od operací kreslení, které jsou omezeny na přesně vymezenou oblast). Modul <strong>ImageEnhance</strong> se používá zhruba následovně:</p>

<p>Nejprve obrázek, který potřebujeme modifikovat, samozřejmě načteme:</p>

<pre><code>
# načtení originálního obrázku Leny
test_image = Image.open(filename)
test_image.load()
</code></pre>

<p>Mezi nízkoúrovňové operace, které knihovna <i>Pillow</i> programátorům nabízí, patří samozřejmě operace umožňující manipulovat s&nbsp;jednotlivými pixely načteného rastrového obrázku.</p>

<pre><code>
</code></pre>

<p>Ve chvíli, kdy je objekt typu <strong>ImageEnhance</strong> zkonstruován, můžeme zavolat jeho metodu <strong>enhance()</strong>, které se předává kladné reálné číslo. To zhruba odpovídá otočení ovladače na starém analogovém televizoru &ndash; hodnoty pod 1,0 odpovídají snížení úrovně (zde úrovně zaostření), hodnoty větší než 1,0 naopak zvýšení úrovně. Většinou není stanovena horní mez, tu si však můžete vyzkoušet sami:</p>

<pre>
sharper_image = enhancer.enhance(5.0)
</pre>

<p>Výsledkem zavolání metody <strong>enhance()</strong> je nový rastrový obrázek, který si můžeme uložit, zobrazit ho, aplikovat na něj další operaci atd.:</p>

<pre>
# uložení upraveneného obrázku
sharper_image.save("enhancer_sharpness_sharper.png")

# zobrazení upraveného obrázku
sharper_image.show()
blurred_image.show()
</pre>

<p>Poznámka: z&nbsp;technologického hlediska jsou všechny operace v&nbsp;modulu <strong>ImageEnhance</strong> implementovány formou takzvaných parametrizovatelných <i>konvolučních filtrů</i>, s&nbsp;jejichž jednoduchými obdobami jsme se již setkali v&nbsp;předchozím článku.</p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Zaostření nebo rozostření obrázku</h2>

<p>V&nbsp;dnešním prvním demonstračním příkladu je ukázán způsob aplikace zaostření popř.&nbsp;rozostření s&nbsp;využitím filtru <strong>ImageEnhance.Sharpness</strong>. Výsledky dvou aplikací tohoto filtru jsou zobrazeny na následujících dvou obrázcích:</p>

<a href="https://mojefedora.cz/wp-content/uploads/2018/08/02_enhancer_sharpness_sharper.png"><img class="alignnone size-thumbnail wp-image-10444" src="https://mojefedora.cz/wp-content/uploads/2018/08/02_enhancer_sharpness_sharper-254x254.png" alt="" width="254" height="254" /></a>
<p><i>Obrázek 2: Výsledek operace zaostření (koeficient=5,0).</i></p>

<a href="https://mojefedora.cz/wp-content/uploads/2018/08/03_enhancer_sharpness_blurred.png"><img class="alignnone size-thumbnail wp-image-10445" src="https://mojefedora.cz/wp-content/uploads/2018/08/03_enhancer_sharpness_blurred-254x254.png" alt="" width="254" height="254" /></a>
<p><i>Obrázek 3: Výsledek operace rozostření (koeficient=0,5).</i></p>

<p></p>

<pre><code>
#!/usr/bin/env python3
# vim: set fileencoding=utf-8

from PIL import Image
from PIL import ImageEnhance

filename = "Lenna.png"

try:
    # načtení originálního obrázku Leny
    test_image = Image.open(filename)
    test_image.load()

    # inicializace "vylepšovače" obrázků
    enhancer = ImageEnhance.Sharpness(test_image)

    # vytvoření "vylepšených" i "zhoršených" obrázků
    sharper_image = enhancer.enhance(5.0)
    blurred_image = enhancer.enhance(0.5)

    # uložení upravených obrázků
    sharper_image.save("enhancer_sharpness_sharper.png")
    blurred_image.save("enhancer_sharpness_blurred.png")

    # zobrazení originálu i upravených obrázků
    test_image.show()
    sharper_image.show()
    blurred_image.show()

except Exception as e:
    print(e)
</code></pre>



<p><a name="k04"></a></p>
<h2 id="k04">4. </h2>

<p></p>

<pre><code>
</code></pre>



<p><a name="k05"></a></p>
<h2 id="k05">5. </h2>

<p></p>

<pre><code>
</code></pre>



<p><a name="k06"></a></p>
<h2 id="k06">6. </h2>

<p></p>

<pre><code>
</code></pre>



<p><a name="k07"></a></p>
<h2 id="k07">7. </h2>

<p></p>

<pre><code>
</code></pre>



<p><a name="k08"></a></p>
<h2 id="k08">8. </h2>

<p></p>

<pre><code>
</code></pre>



<p><a name="k09"></a></p>
<h2 id="k09">9. </h2>

<p></p>

<pre><code>
</code></pre>



<p><a name="k10"></a></p>
<h2 id="k10">10. </h2>

<p></p>



<p><a name="k11"></a></p>
<h2 id="k11">11. </h2>

<p></p>



<p><a name="k12"></a></p>
<h2 id="k12">12. </h2>

<p></p>



<p><a name="k13"></a></p>
<h2 id="k13">13. </h2>

<p></p>



<p><a name="k14"></a></p>
<h2 id="k14">14. </h2>

<p></p>



<p><a name="k15"></a></p>
<h2 id="k15">15. </h2>

<p></p>



<p><a name="k16"></a></p>
<h2 id="k16">16. </h2>

<p></p>



<p><a name="k17"></a></p>
<h2 id="k17">17. </h2>

<p></p>



<p><a name="k18"></a></p>
<h2 id="k18">18. Obsah následující části seriálu</h2>

<p></p>



<p><a name="k19"></a></p>
<h2 id="k19">19. Repositář s&nbsp;demonstračními příklady</h2>

<p>Zdrojové kódy všech dnes popsaných demonstračních příkladů určených pro Python 3 a knihovnu <i>Pillow</i> byly uloženy do Git repositáře dostupného na adrese <a href="https://github.com/tisnik/most-popular-python-libs">https://github.com/tisnik/most-popular-python-libs</a> (stále na GitHubu :-). V&nbsp;případě, že nebudete chtít klonovat celý repositář (ten je ovšem stále velmi malý, dnes má doslova několik kilobajtů), můžete namísto toho použít odkazy na jednotlivé příklady, které naleznete v&nbsp;následující tabulce:</p>

<table>
<tr><th> #</th><th>Demonstrační příklad</th><th>Popis</th><th>Cesta</th></tr>
<tr><td> 1</td><td>16_image_enhance_sharpness.py</td><td>zaostření a rozostření obrázku</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/16_image_enhance_sharpness.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/16_image_enhance_sharpness.py</a></td></tr>
<tr><td> 2</td><td>17_image_enhance_contrast.py</td><td>zvýšení a snížení kontrastu obrázku</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/17_image_enhance_contrast.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/17_image_enhance_contrast.py</a></td></tr>
<tr><td> 3</td><td>18_image_enhance_brightness.py</td><td>změna světlosti</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/18_image_enhance_brightness.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/18_image_enhance_brightness.py</a></td></tr>
<tr><td> 4</td><td>19_image_enhance_color.py</td><td>změna barevného podání</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/19_image_enhance_color.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/19_image_enhance_color.py</a></td></tr>
<tr><td> 5</td><td>20_image_statistic.py</td><td>čtení základních statistických informací u barevného obrázku</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/20_image_statistic.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/20_image_statistic.py</a></td></tr>
<tr><td> 6</td><td>21_bw_image_statistic.py</td><td>čtení základních statistických informací u černobílého obrázku</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/21_bw_image_statistic.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/21_bw_image_statistic.py</a></td></tr>
<tr><td> 7</td><td>22_histogram.py</td><td>získání histogramu obrázku</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/22_histogram.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/22_histogram.py</a></td></tr>
<tr><td> 8</td><td>23_rgb_palette.py</td><td>vykreslení RGB palety</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/23_rgb_palette.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/23_rgb_palette.py</a></td></tr>
<tr><td> 9</td><td>24_hsl_palette.py</td><td>vykreslení HSL palety</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/24_hsl_palette.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/24_hsl_palette.py</a></td></tr>
<tr><td>10</td><td>25_draw_grid.py</td><td>vykreslení mřížky do načteného obrázku</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/25_draw_grid.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/25_draw_grid.py</a></td></tr>
<tr><td>11</td><td>26_colors_rgb.py</td><td>použití definice RGB barev při kreslení</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/26_colors_rgb.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/26_colors_rgb.py</a></td></tr>
<tr><td>12</td><td>27_polyline.py</td><td>vykreslení obrazce tvořeného lomenou čarou</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/27_polyline.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/27_polyline.py</a></td></tr>
<tr><td>13</td><td>28_circles.py</td><td>vykreslení obrazce z&nbsp;několika kružnic</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/28_circles.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/28_circles.py</a></td></tr>
<tr><td>14</td><td>29_text.py</td><td>vykreslení jednoduchého textu</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pil/29_text.py">https://github.com/tisnik/most-popular-python-libs/blob/master/pil/29_text.py</a></td></tr>
</table>



<p><a name="k20"></a></p>
<h2 id="k20">20. Odkazy na Internetu</h2>

<ol>

<li>PIL: The friendly PIL fork (home page)<br />
<a href="https://python-pillow.org/">https://python-pillow.org/</a>
</li>

<li>Python Imaging Library (PIL), (home page)<br />
<a href="http://www.pythonware.com/products/pil/">http://www.pythonware.com/products/pil/</a>
</li>

<li>PIL 1.1.6 na PyPi<br />
<a href="https://pypi.org/project/PIL/">https://pypi.org/project/PIL/</a>
</li>

<li>Pillow 5.2.0 na PyPi<br />
<a href="https://pypi.org/project/Pillow/">https://pypi.org/project/Pillow/</a>
</li>

<li>Python Imaging Library na Wikipedii<br />
<a href="https://en.wikipedia.org/wiki/Python_Imaging_Library">https://en.wikipedia.org/wiki/Python_Imaging_Library</a>
</li>

<li>Pillow na GitHubu<br />
<a href="https://github.com/python-pillow/Pillow">https://github.com/python-pillow/Pillow</a>
</li>

<li>Pillow - dokumentace na readthedocs.io<br />
<a href="http://pillow.readthedocs.io/en/5.2.x/">http://pillow.readthedocs.io/en/5.2.x/</a>
</li>

<li>How to use Pillow, a fork of PIL<br />
<a href="https://www.pythonforbeginners.com/gui/how-to-use-pillow">https://www.pythonforbeginners.com/gui/how-to-use-pillow</a>
</li>

<li>Lenna (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/Lenna">https://en.wikipedia.org/wiki/Lenna</a>
</li>

<li>Seriál Grafický formát GIF<br />
<a href="https://www.root.cz/serialy/graficky-format-gif/">https://www.root.cz/serialy/graficky-format-gif/</a>
</li>

<li>PNG is Not GIF<br />
<a href="https://www.root.cz/clanky/png-is-not-gif/">https://www.root.cz/clanky/png-is-not-gif/</a>
</li>

<li>JPEG - král rastrových grafických formátů?<br />
<a href="https://www.root.cz/clanky/jpeg-kral-rastrovych-grafickych-formatu/">https://www.root.cz/clanky/jpeg-kral-rastrovych-grafickych-formatu/</a>
</li>

<li>Grafický formát BMP - používaný a přitom neoblíbený<br />
<a href="https://www.root.cz/clanky/graficky-format-bmp-pouzivany-a-pritom-neoblibeny/">https://www.root.cz/clanky/graficky-format-bmp-pouzivany-a-pritom-neoblibeny/</a>
</li>

<li>Grafický formát PCX - výlet do historie PC<br />
<a href="https://www.root.cz/clanky/graficky-format-pcx-vylet-do-historie-pc/">https://www.root.cz/clanky/graficky-format-pcx-vylet-do-historie-pc/</a>
</li>

<li>Grafické formáty ve znamení Unixu<br />
<a href="https://www.root.cz/clanky/graficke-formaty-ve-znameni-unixu/">https://www.root.cz/clanky/graficke-formaty-ve-znameni-unixu/</a>
</li>

<li>Grafický formát TGA - jednoduchý, oblíbený, používaný<br />
<a href="https://www.root.cz/clanky/graficky-format-tga-jednoduchy-oblibeny-pouzivany/">https://www.root.cz/clanky/graficky-format-tga-jednoduchy-oblibeny-pouzivany/</a>
</li>

<li>Konvoluce<br />
<a href="https://cs.wikipedia.org/wiki/Konvoluce">https://cs.wikipedia.org/wiki/Konvoluce</a>
</li>

<li>Počítačová grafika<br />
<a href="https://cs.wikipedia.org/wiki/Kategorie:Po%C4%8D%C3%ADta%C4%8Dov%C3%A1_grafika">https://cs.wikipedia.org/wiki/Kategorie:Po%C4%8D%C3%ADta%C4%8Dov%C3%A1_grafika</a>
</li>

<li>Pixel<br />
<a href="https://cs.wikipedia.org/wiki/Pixel">https://cs.wikipedia.org/wiki/Pixel</a>
</li>

<li>Rastrová grafika<br />
<a href="https://cs.wikipedia.org/wiki/Rastrov%C3%A1_grafika">https://cs.wikipedia.org/wiki/Rastrov%C3%A1_grafika</a>
</li>

<li>Pixel art aneb umění práce s body<br />
<a href="https://www.root.cz/clanky/pixel-art-aneb-umeni-prace-s-body/">https://www.root.cz/clanky/pixel-art-aneb-umeni-prace-s-body/</a>
</li>

<li>Jak se dělá pixel art?<br />
<a href="https://www.root.cz/clanky/jak-se-dela-pixel-art/">https://www.root.cz/clanky/jak-se-dela-pixel-art/</a>
</li>

<li>Nástroje pro pixel art<br />
<a href="https://www.root.cz/clanky/nastroje-pro-pixel-art/">https://www.root.cz/clanky/nastroje-pro-pixel-art/</a>
</li>

<li>RGB color model<br />
<a href="https://en.wikipedia.org/wiki/RGB_color_model">https://en.wikipedia.org/wiki/RGB_color_model</a>
</li>

<li>HSL and HSV<br />
<a href="https://en.wikipedia.org/wiki/HSL_and_HSV">https://en.wikipedia.org/wiki/HSL_and_HSV</a>
</li>

<li>Color picker<br />
<a href="https://en.wikipedia.org/wiki/Color_picker">https://en.wikipedia.org/wiki/Color_picker</a>
</li>

<li>HCL color space<br />
<a href="https://en.wikipedia.org/wiki/HCL_color_space">https://en.wikipedia.org/wiki/HCL_color_space</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2018</small></p>
</body>
</html>

<!--
2018-08-xx: 0 hod
2018-08-xx: 0 hod
2018-08-xx: 0 hod
2018-08-xx: 0 hod
2018-08-xx: 0 hod
publikace:  0 hod
-----------------
            0 hod
-->
