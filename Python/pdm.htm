<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>PDM: moderní správce balíčků a virtuálních prostředí Pythonu</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>PDM: moderní správce balíčků a virtuálních prostředí Pythonu</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p></p>



<h2>Obsah</h2>

<p><a href="#k01">*** 1. PDM: moderní správce balíčků a virtuálních prostředí Pythonu</a></p>
<p><a href="#k02">*** 2. Instalace PDM</a></p>
<p><a href="#k03">*** 3. První spuštění PDM</a></p>
<p><a href="#k04">*** 4. Vytvoření kostry projektu bez dalších závislostí</a></p>
<p><a href="#k05">*** 5. Struktura nově vytvořeného projektu, soubor <strong>pyproject.toml</strong></a></p>
<p><a href="#k06">*** 6. Přidání dalšího balíčku do projektu</a></p>
<p><a href="#k07">*** 7. Soubor <strong>pdm.lock</strong></a></p>
<p><a href="#k08">*** 8. Projekt s&nbsp;více závislostmi</a></p>
<p><a href="#k09">*** 9. Nová podoba souboru <strong>pdm.lock</strong></a></p>
<p><a href="#k10">*** 10. </a></p>
<p><a href="#k11">*** 11. </a></p>
<p><a href="#k12">*** 12. </a></p>
<p><a href="#k13">*** 13. </a></p>
<p><a href="#k14">*** 14. </a></p>
<p><a href="#k15">*** 15. </a></p>
<p><a href="#k16">*** 16. </a></p>
<p><a href="#k17">*** 17. </a></p>
<p><a href="#k18">*** 18. </a></p>
<p><a href="#k19">*** 19. Repositář s&nbsp;demonstračními příklady</a></p>
<p><a href="#k20">*** 20. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. PDM: moderní správce balíčků a virtuálních prostředí Pythonu</h2>


Pipenv
kombinuje pip a venv

Poetry
zalozeno na pyproject.toml, ovsem neodpovida PEP-621

Hatch
pep 621





<p><a name="k02"></a></p>
<h2 id="k02">2. Instalace PDM</h2>



<p><a name="k03"></a></p>
<h2 id="k03">3. První spuštění PDM</h2>

<pre>
$ <strong>pdm --version</strong>
&nbsp;
PDM, version 2.9.3
&nbsp;
Usage: pdm [-h] [-V] [-c CONFIG] [-v] [-I] [--pep582 [SHELL]] ...
&nbsp;
    ____  ____  __  ___
   / __ \/ __ \/  |/  /
  / /_/ / / / / /|_/ /
 / ____/ /_/ / /  / /
/_/   /_____/_/  /_/
&nbsp;
Options:
  -h, --help            Show this help message and exit.
  -V, --version         Show the version and exit
  -c CONFIG, --config CONFIG
                        Specify another config file path [env var:
                        PDM_CONFIG_FILE]
  -v, --verbose         Use `-v` for detailed output and `-vv` for more
                        detailed
  -I, --ignore-python   Ignore the Python path saved in .pdm-python. [env var:
                        PDM_IGNORE_SAVED_PYTHON]
  --pep582 [SHELL]      Print the command line to be eval'd by the shell
&nbsp;
Commands:
  add                   Add package(s) to pyproject.toml and install them
  build                 Build artifacts for distribution
  cache                 Control the caches of PDM
  completion            Generate completion scripts for the given shell
  config                Display the current configuration
  export                Export the locked packages set to other formats
  fix                   Fix the project problems according to the latest
                        version of PDM
  import                Import project metadata from other formats
  info                  Show the project information
  init                  Initialize a pyproject.toml for PDM
  install               Install dependencies from lock file
  list                  List packages installed in the current working set
  lock                  Resolve and lock dependencies
  publish               Build and publish the project to PyPI
  remove                Remove packages from pyproject.toml
  run                   Run commands or scripts with local packages loaded
  search                Search for PyPI packages
  self (plugin)         Manage the PDM program itself (previously known as
                        plugin)
  show                  Show the package information
  sync                  Synchronize the current working set with lock file
  update                Update package(s) in pyproject.toml
  use                   Use the given python version or path as base
                        interpreter
  venv                  Virtualenv management
</pre>



<p><a name="k04"></a></p>
<h2 id="k04">4. Vytvoření kostry projektu bez dalších závislostí</h2>

<pre>
$ <strong>pdm init</strong>
</pre>

<pre>
Creating a pyproject.toml for PDM...
Please enter the Python interpreter to use
0. /usr/bin/python (3.11)
1. /usr/bin/python3.11 (3.11)
2. /usr/bin/python3 (3.11)
Please select (0): 2
Would you like to create a virtualenv with /usr/bin/python3? [y/n] (y): y
Virtualenv is created successfully at /home/ptisnovs/project1/.venv
Is the project a library that is installable?
If yes, we will need to ask a few more questions to include the project name and
build backend [y/n] (n): n
License(SPDX name) (MIT):
Author name (): Pavel
Author email (): pavel@nowhere.com
Python requires('*' to allow any) (&gt;=3.11): &gt;=3.7
Project is initialized successfully
</pre>

<p><div class="rs-tip-major">Poznámka: <strong>pyenv</strong></div></p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Struktura nově vytvořeného projektu, soubor <strong>pyproject.toml</strong></h2>

<p></p>

<pre>
.
├── __pycache__
├── pyproject.toml
├── README.md
├── src
│   └── example_package
│       ├── __init__.py
│       └── __pycache__
└── tests
    ├── __init__.py
    └── __pycache__

7 directories, 4 files
</pre>

<pre>
[project]
name = ""
version = ""
description = ""
authors = [
    {name = "Pavel", email = "pavel@nowhere.com"},
]
dependencies = []
requires-python = "&gt;=3.7"
readme = "README.md"
license = {text = "MIT"}
</pre>

<p><div class="rs-tip-major">Poznámka: formát <i>TOML</i> (neboli <i>Tom's
Obvious, Minimal Language</i>) sice zdánlivě (alespoň na první pohled) vychází
ze souborů typu INI, ovšem ve skutečnosti se jedná o odlišný, v&nbsp;mnoha
ohledech vylepšený a především promyšlený formát, v&nbsp;němž byly odstraněny
prakticky všechny nevýhody INI a přitom byla zachována čitelnost a snadnost
úprav. I proto se za posledních několik let stal velmi populární. Ve formátu
TOML jsou kromě řetězců, celých čísel a seznamů podporovány i další datové typy
&ndash; pravdivostní typ, čísla s&nbsp;plovoucí řádovou čárkou a zejména pak,
což je v&nbsp;praxi velmi užitečné, typ &bdquo;datum+čas&ldquo; neboli časové
razítko.</div></p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Přidání dalšího balíčku do projektu</h2>

<pre>
$ pdm add sympy
</pre>

<pre>
Adding packages to default dependencies: sympy
🔒 Lock successful
Changes are written to pyproject.toml.
All packages are synced to date, nothing to do.
&nbsp;
🎉 All complete!
</pre>

<pre>
[project]
name = ""
version = ""
description = ""
authors = [
    {name = "Pavel", email = "pavel@nowhere.com"},
]
dependencies = [
    "sympy>=1.10.1",
]
requires-python = ">=3.7"
readme = "README.md"
license = {text = "MIT"}
</pre>

<pre>
pdm list
</pre>

<pre>
[ptisnovs@ptisnovs-thinkpadt14gen3 project2]$ pdm list
╭────────┬─────────┬──────────╮
│ name   │ version │ location │
├────────┼─────────┼──────────┤
│ mpmath │ 1.3.0   │          │
│ sympy  │ 1.10.1  │          │
╰────────┴─────────┴──────────╯
</pre>

$ pdm list --graph
sympy 1.10.1 [ required: >=1.10.1 ]
└── mpmath 1.3.0 [ required: >=0.19 ]



<p><a name="k07"></a></p>
<h2 id="k07">7. Soubor <strong>pdm.lock</strong></h2>

<p></p>

<pre>
# This file is @generated by PDM.
# It is not intended for manual editing.

[metadata]
groups = ["default"]
cross_platform = true
static_urls = false
lock_version = "4.3"
content_hash = "sha256:c19bb0a4a0a179b5e92d875ea3704d5564d319483f9497918302f97aa96a7d83"

[[package]]
name = "mpmath"
version = "1.3.0"
summary = "Python library for arbitrary-precision floating-point arithmetic"
files = [
    {file = "mpmath-1.3.0-py3-none-any.whl", hash = "sha256:a0b2b9fe80bbcd81a6647ff13108738cfb482d481d826cc0e02f5b35e5c88d2c"},
    {file = "mpmath-1.3.0.tar.gz", hash = "sha256:7a28eb2a9774d00c7bc92411c19a89209d5da7c4c9a9e227be8330a23a25b91f"},
]

[[package]]
name = "sympy"
version = "1.10.1"
requires_python = ">=3.7"
summary = "Computer algebra system (CAS) in Python"
dependencies = [
    "mpmath>=0.19",
]
files = [
    {file = "sympy-1.10.1-py3-none-any.whl", hash = "sha256:df75d738930f6fe9ebe7034e59d56698f29e85f443f743e51e47df0caccc2130"},
    {file = "sympy-1.10.1.tar.gz", hash = "sha256:5939eeffdf9e152172601463626c022a2c27e75cf6278de8d401d50c9d58787b"},
]
</pre>



<p><a name="k08"></a></p>
<h2 id="k08">8. Projekt s&nbsp;více závislostmi</h2>

<pre>
$ pdm add requests
</pre>

<pre>
Adding packages to default dependencies: requests
🔒 Lock successful
Changes are written to pyproject.toml.
Synchronizing working set with resolved packages: 5 to add, 0 to update, 0 to
remove

  ✔ Install idna 3.4 successful
  ✔ Install requests 2.31.0 successful
  ✔ Install certifi 2023.7.22 successful
  ✔ Install urllib3 2.0.6 successful
  ✔ Install charset-normalizer 3.3.0 successful

🎉 All complete!

[project]
name = ""
version = ""
description = ""
authors = [
    {name = "Pavel", email = "pavel@nowhere.com"},
]
dependencies = [
    "sympy>=1.10.1",
    "requests>=2.31.0",
]
requires-python = ">=3.7"
readme = "README.md"
license = {text = "MIT"}
</pre>



<p><a name="k09"></a></p>
<h2 id="k09">9. Nová podoba souboru <strong>pdm.lock</strong></h2>

<pre>
</pre>



<p><a name="k10"></a></p>
<h2 id="k10">10. </h2>


[ptisnovs@ptisnovs-thinkpadt14gen3 project3]$ pdm info
PDM version:
  2.9.3
Python Interpreter:
  /home/ptisnovs/project1/.venv/bin/python (3.11)
Project Root:
  /home/ptisnovs/project3
Local Packages:

[ptisnovs@ptisnovs-thinkpadt14gen3 project3]$ pdm list
╭────────────────────┬───────────┬──────────╮
│ name               │ version   │ location │
├────────────────────┼───────────┼──────────┤
│ charset-normalizer │ 3.3.0     │          │
│ mpmath             │ 1.3.0     │          │
│ sympy              │ 1.10.1    │          │
│ idna               │ 3.4       │          │
│ requests           │ 2.31.0    │          │
│ certifi            │ 2023.7.22 │          │
│ urllib3            │ 2.0.6     │          │
╰────────────────────┴───────────┴──────────╯

$ pdm list --graph

requests 2.31.0 [ required: >=2.31.0 ]
├── certifi 2023.7.22 [ required: >=2017.4.17 ]
├── charset-normalizer 3.3.0 [ required: <4,>=2 ]
├── idna 3.4 [ required: <4,>=2.5 ]
└── urllib3 2.0.6 [ required: <3,>=1.21.1 ]
sympy 1.10.1 [ required: >=1.10.1 ]
└── mpmath 1.3.0 [ required: >=0.19 ]

[ptisnovs@ptisnovs-thinkpadt14gen3 project1]$ pdm venv list
Virtualenvs created with this project:

*  in-project: /home/ptisnovs/x/project1/.venv
[ptisnovs@ptisnovs-thinkpadt14gen3 project1]$ pdm venv remove in-project
Virtualenvs created with this project:
Will remove: /home/ptisnovs/x/project1/.venv, continue? [y/n] (y): y
Removed successfully!



<p><a name="k11"></a></p>
<h2 id="k11">11. </h2>

delete __pypackages__
then pdm install


<p><a name="k12"></a></p>
<h2 id="k12">12. </h2>

<pre>
├── __pycache__
├── src
│   └── example_package
│       └── __pycache__
├── tests
│   └── __pycache__
└── .venv
    ├── bin
    ├── lib
    │   └── python3.11
    │       └── site-packages
    │           ├── mpmath
    │           ├── mpmath-1.3.0.dist-info
    │           ├── __pycache__
    │           ├── sympy
    │           └── sympy-1.10.1.dist-info
    ├── lib64
    │   └── python3.11
    │       └── site-packages
    └── share
        └── man
            └── man1
</pre>

<pre>
$ tree -d -L 4
.
├── __pycache__
├── __pypackages__
│   └── 3.11
│       ├── bin
│       ├── include
│       ├── lib
│       │   ├── mpmath
│       │   ├── mpmath-1.3.0.dist-info
│       │   ├── sympy
│       │   └── sympy-1.12.dist-info
│       └── share
│           └── man
├── src
│   └── example_package
│       └── __pycache__
└── tests
    └── __pycache__
</pre>

rm -rf __pypackages__

$ tree -a -d -L 4
.
├── __pycache__
├── src
│   └── example_package
│       └── __pycache__
└── tests
    └── __pycache__

$ pdm install -v
STATUS: Resolving packages from lockfile...
STATUS: Fetching hashes for resolved packages...
Synchronizing working set with resolved packages: 2 to add, 0 to update, 0 to remove

unearth.preparer: Using cached <Link https://files.pythonhosted.org/packages/43/e3/7d92a15f894aa0c9c4b49b8ee9ac9850d6e63b03c9c32c0367a13ae62209/mpmath-1.3.0-py3-none-any.whl (from https://pypi.org/simple/mpmath/)>
unearth.preparer: Using cached <Link https://files.pythonhosted.org/packages/d2/05/e6600db80270777c4a64238a98d442f0fd07cc8915be2a1c16da7f2b9e74/sympy-1.12-py3-none-any.whl (from https://pypi.org/simple/sympy/)>
  ✔ Install mpmath 1.3.0 successful
  ✔ Install sympy 1.12 successful

.
├── __pycache__
├── __pypackages__
│   └── 3.11
│       ├── bin
│       ├── include
│       ├── lib
│       │   ├── mpmath
│       │   ├── mpmath-1.3.0.dist-info
│       │   ├── sympy
│       │   └── sympy-1.12.dist-info
│       └── share
│           └── man
├── src
│   └── example_package
│       └── __pycache__
└── tests
    └── __pycache__



<p><a name="k13"></a></p>
<h2 id="k13">13. </h2>



<p><a name="k14"></a></p>
<h2 id="k14">14. </h2>



<p><a name="k15"></a></p>
<h2 id="k15">15. </h2>



<p><a name="k16"></a></p>
<h2 id="k16">16. </h2>


dev dependencies
pdm add -d pytest



<p><a name="k17"></a></p>
<h2 id="k17">17. </h2>



<p><a name="k18"></a></p>
<h2 id="k18">18. </h2>



<p><a name="k19"></a></p>
<h2 id="k19">19. Repositář s&nbsp;demonstračními příklady</h2>

<p>Všechny Pythonovské projekty, které jsme si vytvořili, naleznete na adrese
<a
href="https://github.com/tisnik/most-popular-python-libs">https://github.com/tisnik/most-popular-python-libs</a>.
Následují odkazy na jednotlivé příklady (pro jejich spuštění je nutné mít
nainstalovánu některou z&nbsp;podporovaných verzí Pythonu 3 a pochopitelně
taktéž PDM:</p>

<table>
<tr><th>#</th><th>Projekt</th><th>Stručný popis</th><th>Adresa</th></tr>
<tr><td>1</td><td>project1/</td><td>nově vytvořený projekt bez závislostí</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project1/">https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project1/</a></td></tr>
<tr><td>2</td><td>project2/</td><td>projekt s&nbsp;jednou explicitně zapsanou závislostí</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project2/">https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project2/</a></td></tr>
<tr><td>3</td><td>project3/</td><td>projekt s&nbsp;dvojicí explicitně zapsaných závislostí</td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project3/">https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project3/</a></td></tr>
<tr><td>4</td><td>project4/</td><td></td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project4/">https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project4/</a></td></tr>
<tr><td>5</td><td>project5/</td><td></td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project5/">https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project5/</a></td></tr>
<tr><td>6</td><td>project6/</td><td></td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project6/">https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project6/</a></td></tr>
<tr><td>7</td><td>project7/</td><td></td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project7/">https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project7/</a></td></tr>
<tr><td>8</td><td>project8/</td><td></td><td><a href="https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project8/">https://github.com/tisnik/most-popular-python-libs/blob/master/pdm/project8/</a></td></tr>
<table>



<p><a name="k20"></a></p>
<h2 id="k20">20. Odkazy na Internetu</h2>

<ol>

<li>Stránka projektu PDM<br />
<a href="https://pdm.fming.dev/latest/">https://pdm.fming.dev/latest/</a>
</li>

<li>PDF na GitHubu<br />
<a href="https://github.com/pdm-project/pdm">https://github.com/pdm-project/pdm</a>
</li>

<li>PEP 582 &ndash; Python local packages directory<br />
<a href="https://peps.python.org/pep-0582/">https://peps.python.org/pep-0582/</a>
</li>

<li>PDM na PyPi<br />
<a href="https://pypi.org/project/pdm/">https://pypi.org/project/pdm/</a>
</li>

<li>Which Python package manager should you use?<br />
<a href="https://towardsdatascience.com/which-python-package-manager-should-you-use-d0fd0789a250">https://towardsdatascience.com/which-python-package-manager-should-you-use-d0fd0789a250</a>
</li>

<li>How to Use PDM to Manage Python Dependencies without a Virtual Environment<br />
<a href="https://www.youtube.com/watch?v=qOIWNSTYfcc">https://www.youtube.com/watch?v=qOIWNSTYfcc</a>
</li>

<li>What are the best Python package managers?<br />
<a href="https://www.slant.co/topics/2666/~best-python-package-managers">https://www.slant.co/topics/2666/~best-python-package-managers</a>
</li>

<li>PEP 621 &ndash; Storing project metadata in pyproject.toml<br />
<a href="https://peps.python.org/pep-0621/">https://peps.python.org/pep-0621/</a>
</li>

<li>Pick a Python Lockfile and Improve Security<br />
<a href="https://blog.phylum.io/pick-a-python-lockfile-and-improve-security/">https://blog.phylum.io/pick-a-python-lockfile-and-improve-security/</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2023</small></p>
</body>
</html>

