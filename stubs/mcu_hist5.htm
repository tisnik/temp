<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Dokončení popisu čtyřbitových mikrořadičů: hi-end řada Epson S1C63</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Dokončení popisu čtyřbitových mikrořadičů: hi-end řada Epson S1C63</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>Popis čtyřbitových mikrořadičů zakončíme čipy Epson S1C63. Jedná se poměrně výkonné mikrořadiče, které jsou určeny do těch zařízení, v&nbsp;nichž se používají LCD s&nbsp;větším množstvím segmentů popř.&nbsp;maticové LCD. Oproti minule popsané řadě S1C60 došlo i k&nbsp;vylepšení instrukční sady.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Dokončení popisu čtyřbitových mikrořadičů: hi-end řada Epson S1C63</a></p>
<p><a href="#k02">2. Interní architektura jader S1C63</a></p>
<p><a href="#k03">3. Konfigurace čtyřbitových mikrořadičů s&nbsp;jádry S1C63</a></p>
<p><a href="#k04">4. Vstupní a výstupní piny, specializované vývody pro ovládání LCD</a></p>
<p><a href="#k05">5. Programová paměť (ROM)</a></p>
<p><a href="#k06">6. Datová paměť (RAM)</a></p>
<p><a href="#k07">7. Programátorský model jader S1C63</a></p>
<p><a href="#k08">8. Instrukční sada jader S1C63</a></p>
<p><a href="#k09">9. Podporované adresní režimy</a></p>
<p><a href="#k10">10. Aritmetické instrukce</a></p>
<p><a href="#k11">11. Logické instrukce</a></p>
<p><a href="#k12">12. Bitové rotace a logické posuny</a></p>
<p><a href="#k13">13. Operace nad jednotlivými bity</a></p>
<p><a href="#k14">14. Instrukce pro práci se zásobníkem</a></p>
<p><a href="#k15">15. Instrukce typu Load &amp; Store</p>
<p><a href="#k16">16. Podmíněné a nepodmíněné skoky</a></p>
<p><a href="#k17">17. Ostatní instrukce</a></p>
<p><a href="#k18">18. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Dokončení popisu čtyřbitových mikrořadičů: hi-end řada Epson S1C63</h2>

<p>Čtyřbitové mikrořadiče řady <i>Epson S1C60</i>, s&nbsp;nimiž jsme se
seznámili <a
href="https://www.root.cz/clanky/ctyrbitove-mikroradice-rady-epson-s1c60/">minule</a>,
jsou určeny pouze do těch nejjednodušších zařízení vybavených LCD
s&nbsp;několika jednotkami maximálně desítkami segmentů. Příkladem použití
těchto čipů mohou být hodiny, teploměry a termostaty. Ovšem ve chvíli, kdy je
nutné ovládat displeje s&nbsp;více segmenty popř.&nbsp;dokonce maticové
displeje, je nutné sáhnout po přece jen výkonnějších mikrořadičích. A právě
v&nbsp;této oblasti můžeme nalézt čipy <i>S1C63</i>, které sice částečně
vychází z&nbsp;řady <i>S1C60</i>, ovšem v&nbsp;mnoha ohledech došlo
k&nbsp;jejich vylepšení, která se týkají již zmíněných komplexnějších LCD,
vyšších taktovacích frekvencí, rozšířené instrukční sady a v&nbsp;neposlední
řadě také toho, že se unifikoval a zjednodušil systém adresování
s&nbsp;použitím dvojice šestnáctibitových index registrů.</p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Interní architektura jader S1C63</h2>

<p>Interní architektura mikrořadičů s&nbsp;jádry S1C63 je poměrně jednoduchá.
Ústředním prvkem je čtyřbitová aritmeticko-logická jednotka, která na vstupu
vybírá operandy z&nbsp;dvojice akumulátorů nazvaných <strong>A</strong> a
<strong>B</strong>, popř.&nbsp;z&nbsp;konstanty načtené z&nbsp;paměti ROM nebo
lze operand získat z&nbsp;datové paměti RAM. Výsledek provedené aritmetické
operace, logické operace či bitové rotace se ukládá zpět do vybraného
akumulátoru a navíc se ještě většinou nastavují příznakové bity
<strong>Carry</strong> a <strong>Zero</strong> uložené v&nbsp;registru
<strong>F</strong>. Kromě plnohodnotné aritmeticko-logické jednotky je
v&nbsp;mikrořadičovém jádru implementována i šestnáctibitová sčítačka použitá
při generování adres, zvyšování hodnoty programového čítače
<strong>PC</strong>, relativních skocích, autoinkrementaci/dekrementaci
indexových registrů <strong>X</strong> a <strong>Y</strong> apod. Čip je řízen
mikroinstrukcemi čtenými z&nbsp;instrukčního dekodéru, přičemž se každá
instrukce podle své složitosti provede v&nbsp;jednom, dvou či třech strojových
cyklech (jeden strojový cyklus přitom odpovídá dvěma taktům hodinového
signálu).</p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Konfigurace čtyřbitových mikrořadičů s&nbsp;jádry S1C63</h2>

<p>Čtyřbitová mikrořadičová jádra S1C63 jsou v&nbsp;současnosti použita
v&nbsp;několika typech mikrořadičů, které se od sebe odlišují zejména maximální
povolenou taktovací frekvencí (minimální frekvence je vždy 32,768 kHz, takže
lze použít běžné krystaly používané například v&nbsp;digitálkách), kapacitou
paměti programu (ROM), kapacitou datové paměti a taktéž typem paměti ROM.
K&nbsp;dispozici jsou totiž jak čipy určené pro aplikace (výrobky) citlivé na
cenu, kde je použita paměť ROM programovaná maskou při výrobě, tak i několik
čipů vybavených pamětí Flash. Základní parametry všech mikrořadičů založených
na jádrech S1C63 jsou vypsány v&nbsp;následující tabulce:</p>

<table>
<tr><th>Typ</th><th>Frekvence (max)</th><th>Frekvence (min)</th><th>ROM</th><th>Typ ROM</th><th>RAM</th></tr>
<tr><td>S1C63003</td><td>550 kHz</td><td>32768 Hz</td><td>4096&times;13 bitů</td><td>ROM</td><td>256&times;4 bity</td></tr>
<tr><td>S1C63004</td><td>1 MHz</td><td>32768 Hz</td><td>4096&times;13 bitů</td><td>ROM</td><td>512&times;4 bity</td></tr>
<tr><td>S1C63008</td><td>1-4 MHz</td><td>32768 Hz</td><td>8192&times;13 bitů</td><td>ROM</td><td>1024&times;4 bity</td></tr>
<tr><td>S1C63016</td><td>1-4 MHz</td><td>32768 Hz</td><td>16384&times;13 bitů</td><td>ROM</td><td>2048&times;4 bity</td></tr>
<tr><td>S1C6F016</td><td>4,2 MHz</td><td>32768 Hz</td><td>16384&times;13 bitů</td><td>Flash</td><td>2048&times;4 bity</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63158</td><td>4 MHz</td><td>32768 Hz</td><td>8192&times;13 bitů</td><td>ROM</td><td>512&times;4 bity</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63408</td><td>4 MHz</td><td>32768 Hz</td><td>8192&times;13 bitů</td><td>ROM</td><td>1024&times;4 bity</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63567</td><td>3,58 MHz</td><td>32768 Hz</td><td>16384&times;13 bitů</td><td>ROM</td><td>512&times;4 bity</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63654</td><td>4 MHz</td><td>32768 Hz</td><td>4096&times;13 bitů</td><td>ROM</td><td>512&times;4 bity</td></tr>
<tr><td>S1C63656</td><td>4 MHz</td><td>32768 Hz</td><td>6144&times;13 bitů</td><td>ROM</td><td>1024&times;4 bity</td></tr>
<tr><td>S1C63658</td><td>4 MHz</td><td>32768 Hz</td><td>8192&times;13 bitů</td><td>ROM</td><td>1024&times;4 bity</td></tr>
<tr><td>S1C63666</td><td>4 MHz</td><td>32768 Hz</td><td>16384&times;13 bitů</td><td>ROM</td><td>5120&times;4 bity</td></tr>
<tr><td>S1C63616</td><td>4 MHz</td><td>32768 Hz</td><td>16384&times;13 bitů</td><td>ROM</td><td>2048&times;4 bity</td></tr>
<tr><td>S1C63632</td><td>4 MHz</td><td>32768 Hz</td><td>31744&times;13 bitů</td><td>ROM</td><td>8192&times;4 bity</td></tr>
<tr><td>S1C6F632</td><td>4 MHz</td><td>32768 Hz</td><td>31744&times;13 bitů</td><td>Flash</td><td>8192&times;4 bity</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63709</td><td>4 MHz</td><td>32768 Hz</td><td>12288&times;13 bitů</td><td>ROM</td><td>2048&times;4 bity</td></tr>
</table>



<p><a name="k04"></a></p>
<h2 id="k04">4. Vstupní a výstupní piny, specializované vývody pro ovládání LCD</h2>

<p>Podobně, jako tomu bylo i u minule popsaných jader S1C60, jsou i mikrořadiče
s&nbsp;jádry S1C63 vybaveny relativně velkým množstvím vstupních, výstupních či
vstupně-výstupních pinů a navíc většina čipů obsahuje i piny, přes které je
možné ovládat LCD. Typické konfigurace jsou opět přehledně vypsány
v&nbsp;tabulce pod tímto odstavcem, kde se ve sloupci &bdquo;Vstupy&ldquo;
nachází počet čistě vstupních pinů, ve sloupci &bdquo;Výstupy&ldquo; počet
výstupních pinů, sloupec &bdquo;I/O&ldquo; obsahuje konfigurovatelné piny a
v&nbsp;posledním sloupci jsou informace o maximální možné složitosti LCD, který
se k&nbsp;čipům může připojit. Povšimněte si, že některé mikrořadiče dokážou
ovládat displeje se segmenty (ty mají velké množství vstupů pro zapnutí či
vypnutí segmentů a jen několik vstupů pro výběr skupin segmentů), zatímco další
mikrořadiče lze připojit k&nbsp;maticovým (rastrovým) LCD:</p>

<table>
<tr><th>Typ</th><th>Vstupy</th><th>Výstupy</th><th>I/O</th><th>Displej</th></tr>
<tr><td>S1C63003</td><td>0</td><td>0</td><td>16</td><td>22&times;5 segmentů</td></tr>
<tr><td>S1C63004</td><td>0</td><td>0</td><td>20</td><td>36&times;8 segmentů</td></tr>
<tr><td>S1C63008</td><td>0</td><td>0</td><td>24</td><td>50&times;8 segmentů</td></tr>
<tr><td>S1C63016</td><td>0</td><td>0</td><td>24</td><td>56&times;8 segmentů</td></tr>
<tr><td>S1C6F016</td><td>0</td><td>0</td><td>24</td><td>56&times;8 segmentů</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63158</td><td>9</td><td>12</td><td>20</td><td>&times;</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63408</td><td>4</td><td>4</td><td>4</td><td>60&times;17 segmentů</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63567</td><td>8</td><td>12</td><td>16</td><td>60&times;17 segmentů</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63654</td><td>8</td><td>4</td><td>8</td><td>32&times;6 segmentů</td></tr>
<tr><td>S1C63656</td><td>8</td><td>4</td><td>8</td><td>38&times;4 segmenty</td></tr>
<tr><td>S1C63658</td><td>8</td><td>8</td><td>8</td><td>56&times;8 segmentů</td></tr>
<tr><td>S1C63666</td><td>8</td><td>8</td><td>8</td><td>64&times;8 segmentů</td></tr>
<tr><td>S1C63616</td><td>0</td><td>0</td><td>16</td><td>56&times;16 pixelů</td></tr>
<tr><td>S1C63632</td><td>0</td><td>0</td><td>24</td><td>64&times;16 pixelů</td></tr>
<tr><td>S1C6F632</td><td>0</td><td>0</td><td>24</td><td>64&times;16 pixelů</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>S1C63709</td><td>13</td><td>0</td><td>18</td><td>64&times;8 segmentů</td></tr>
</table>



<p><a name="k05"></a></p>
<h2 id="k05">5. Programová paměť (ROM)</h2>

<p>Programová paměť typu ROM či Flash má poměrně neobvyklou strukturu, protože
šířka adresovatelných slov je třináct bitů a maximální teoretická adresovatelná
kapacita tohoto typu paměti je 64k&times;13 bitů. Ve skutečnosti jsme si však
již <a href="#k03">ve třetí</a> kapitole ukázali, že žádný čip nemá větší
kapacitu ROM/Flash než 31744&times;13 bitů, přičemž poněkud zvláštní hodnota
31744 odpovídá 2<sup>15</sup>-2<sup>10</sup>. Činnost ROM/Flash je zřejmá
&ndash; jsou v&nbsp;ní uloženy instrukce a popř.&nbsp;taktéž konstantní data
(převodní tabulky, překódování numerických hodnot na indexy segmentů, bitové
masky znaků pro maticové LCD apod.). Všechna instrukční slova mají konstantní
šířku 13 bitů, adresa zpracovávané instrukce je přitom uložena v&nbsp;jediném
registru <strong>PC</strong>. Kromě ROM/Flash, které jsou přímo součástí čipu
s&nbsp;mikrořadičem, lze k&nbsp;S1C63 připojit další EPROM (či EEROM) se
sériovým rozhraním. Tím lze částečně obejít nutnost programování masky ROM pro
každý typ zařízení zvlášť.</p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Datová paměť (RAM)</h2>

<p>Datové paměti (tedy klasické RAM) mají u všech dnes popisovaných čipů šířku
slov pouhé čtyři bity (tj.&nbsp;jedná se o <i>nibbly</i>). Ovšem počet slov je
již u některých variant mikrořadičů poměrně vysoký. Základní kapacita je
256&times;4 bity, maximální pak 8192&times;4 bity (čistě teoreticky se může
jednat o 65536&times;4 bity, ovšem část adresního rozsahu je obsazena
&bdquo;video&ldquo; pamětí určenou pro práci s&nbsp;LCD). Na rozdíl od řady
S1C60 není nutné u čipů S1C63 používat stránkování, protože oba index registry
byly rozšířeny na šestnáct bitů. Samozřejmě opět platí, že část RAM je obsazena
zásobníkem, na který je možné ukládat čtyřbitové, osmibitové i šestnáctibitové
hodnoty (viz též druhou část článku s&nbsp;popisem instrukčního souboru).</p>



<p><a name="k07"></a></p>
<h2 id="k07">7. Programátorský model jader S1C63</h2>

<p>Programátorský model mikrořadičů S1C63 je sice odvozen on programátorského
modelu již minule popsaných mikrořadičů S1C60, ovšem nalezneme zde určitá
zjednodušení způsobená tím, že se šířky některých registrů rozšířily (tím
odpadla nutnost používat stránkové registry). Nejdříve si tedy zopakujme, jak
vypadal programátorský model S1C60:</p>

<table>
<tr><th>Registr</th><th>Šířka</th><th>Rozdělen na</th><th>Celé jméno</th></tr>
<tr><td>PCS</td><td>8</td><td>&times;</td><td>Program counter step</td></tr>
<tr><td>PCP</td><td>4</td><td>&times;</td><td>Program counter page</td></tr>
<tr><td>NPP</td><td>4</td><td>&times;</td><td>New page pointer</td></tr>
<tr><td>SP</td><td>8</td><td>SPH+SPL</td><td>Stack pointer</td></tr>
<tr><td>IX</td><td>12</td><td>XP+XH+XL</td><td>Index register X</td></tr>
<tr><td>IY</td><td>12</td><td>YP+YH+YL</td><td>Index register Y</td></tr>
<tr><td>RP</td><td>4</td><td>&times;</td><td>Register pointer</td></tr>
<tr><td>A</td><td>4</td><td>&times;</td><td>General register A</td></tr>
<tr><td>B</td><td>4</td><td>&times;</td><td>General register B</td></tr>
</table>

<p>U čtyřbitových jader S1C63 naproti tomu nalezneme tyto registry:</p>

<table>
<tr><th>Registr</th><th>Šířka</th><th>Rozdělen na</th><th>Celé jméno</th></tr>
<tr><td>PC</td><td>16</td><td>&times;</td><td>Program counter</td></tr>
<tr><td>SP1</td><td>8</td><td>&nbsp;</td><td>Stack pointer, posunutý o dva bity doleva</td></tr>
<tr><td>SP2</td><td>8</td><td>&nbsp;</td><td>Stack pointer</td></tr>
<tr><td>X</td><td>16</td><td>XH+XL</td><td>Index register X</td></tr>
<tr><td>Y</td><td>16</td><td>YH+YL</td><td>Index register Y</td></tr>
<tr><td>A</td><td>4</td><td>&times;</td><td>General register A</td></tr>
<tr><td>B</td><td>4</td><td>&times;</td><td>General register B</td></tr>
<tr><td>EXT</td><td>8</td><td>&times;</td><td>Extension register</td></tr>
</table>

<p>Důležité je především rozšíření registru <strong>PC</strong> na celých
šestnáct bitů, čímž odpadla nutnost používat dvojici
<strong>PCS</strong>+<strong>NPP</strong>. Kvůli rozšíření možností adresování
byl přidán registr <strong>EXT</strong>, jehož činnost si popíšeme níže.
Rozšířeny byly taktéž index registry <strong>X</strong> a <strong>Y</strong>,
takže vlastně jedinými skutečně čtyřbitovými registry zůstaly oba akumulátory
<strong>A</strong> a <strong>B</strong>.</p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Instrukční sada jader S1C63</h2>

<p>V&nbsp;instrukční sadě dnes popisovaných čtyřbitových mikrořadičů najdeme
pouze 39 základních instrukcí, ovšem mnohé z&nbsp;těchto instrukcí existuje
v&nbsp;několika variantách, které se od sebe odlišují především použitým
adresovacím režimem. Připomeňme si, že každé instrukční slovo má šířku třinácti
bitů, což mj.&nbsp;znamená, že se kromě operačního kódu instrukce do tohoto
slova mohou uložit i konstanty, relativní adresy skoků atd. Ostatně podívejme
se na následující tabulku, v&nbsp;níž jsou některé možnosti konstant uložených
v&nbsp;instrukčních slovech shrnuty:</p>

<table>
<tr><th>Šířka konstanty</th><th>Rozsah</th><th>Význam</th></tr>
<tr><td>2 bity</td><td>0-3</td><td>index bitu v&nbsp;bitových operacích</td></tr>
<tr><td>4 bity</td><td>0-15</td><td>konstanta vystupující v&nbsp;ALU operacích atd.</td></tr>
<tr><td>6 bitů</td><td>0-63</td><td>index vektoru přerušení</td></tr>
<tr><td>8 bitů</td><td>-128..127</td><td>konstanta pro osmibitové registry, relativní adresa</td></tr>
<tr><td>4 bity</td><td>1-16</td><td>radix použitý u některých základních ALU instrukcí</td></tr>
</table>

<p>Seznam instrukcí:</p>

<table>
<tr><th>Skupina</th><th>Počet</th></tr>
<tr><td><a href="#k10">Aritmetické instrukce</a></td><td>7</td></tr>
<tr><td><a href="#k11">Logické instrukce</a></td><td>4</td></tr>
<tr><td><a href="#k12">Bitové rotace a logické posuny</a></td><td>4</td></tr>
<tr><td><a href="#k13">Operace nad jednotlivými bity</a></td><td>3</td></tr>
<tr><td><a href="#k14">Instrukce pro práci se zásobníkem</a></td><td>2</td></tr>
<tr><td><a href="#k15">Instrukce typu Load &amp; Store</a></td><td>3</td></tr>
<tr><td><a href="#k16">Podmíněné a nepodmíněné skoky</a></td><td>12</td></tr>
<tr><td><a href="#k17">Ostatní instrukce</a></td><td>4</td></tr>
<tr><td>Celkem:</td><td>39</td></tr>
</table>



<p><a name="k09"></a></p>
<h2 id="k09">9. Podporované adresní režimy</h2>

<p>Na instrukční sadě čipů S1C63 jsou nejzajímavější především adresní režimy,
které do značné míry používají &bdquo;plnohodnotné&ldquo; šestnáctibitové
registry <strong>PC</strong>, <strong>X</strong> a <strong>Y</strong> doplněné
o registr <strong>EXT</strong>. Registry <strong>X</strong> a
<strong>Y</strong> jsou použity pro uložení adresy, takže je například možné
provést instrukci:</p>

<pre>
LD [X], [Y]
</pre>

<p>pro přesun čtyřbitového operandu z&nbsp;adresy uložené v&nbsp;registru Y na
adresu uloženou v&nbsp;registru X. Taktéž je možné provést autoinkrementaci
registru po provedení operace, což nám umožňuje relativně snadno implementovat
blokové přenosy dat:</p>

<pre>
LD [X]+, [Y]+
</pre>

<p>U mnoha instrukcí se taktéž v&nbsp;instrukčním slovu používá šestibitová
adresa (konstanta) specifikující adresu operandu v&nbsp;rozsahu 0x0000 až
0x003F a 0xFFC0 až 0xFFFF, tedy na začátku či naopak na konci paměti:</p>

<pre>
INC [adresa]
</pre>

<p>Pokud je zapotřebí pracovat se šestnáctibitovými konstantami, používá se pro
tento účel registr <strong>EXT</strong> do něhož se načte horních osm bitů
konstanty. Ihned po nastavení tohoto registru se změní význam další instrukce,
protože příznak o modifikaci <strong>EXT</strong> je uložen v&nbsp;příznakovém
registru <strong>F</strong>. Například:</p>

<pre>
LDB EXT, 0x12
LDB XL,  0x34
</pre>

<p>odpovídá pseudoinstrukci:</p>

<pre>
LD X, 0x01234
</pre>

<p>Nebo (mnohem zajímavější varianta):</p>

<pre>
LDB EXT, 0xAB
ADD X,   0xCD
</pre>

<p>odpovídá pseudoinstrukci:</p>

<pre>
ADD X, 0xABCD
</pre>



<p><a name="k10"></a></p>
<h2 id="k10">10. Aritmetické instrukce</h2>

<p>Sada aritmetických a logických instrukcí obsahuje prakticky všechny
očekávatelné instrukce. U součtů a rozdílů mohou být zdrojovými operandy
registr/akumulátor <strong>A</strong>, <strong>B</strong>, buňka adresovaná
index registrem <strong>X</strong>, <strong>Y</strong> či čtyřbitová konstanta.
Cílové operandy jsou prakticky totožné, samozřejmě až na zmíněnou konstantu.
Instrukce <strong>CMP</strong> je shodná s&nbsp;instrukcí <strong>SUB</strong>,
ovšem cílový operand se nezmění, pouze se nastaví bitové příznaky. Instrukce
<strong>INC</strong> a <strong>DEC</strong> mohou pracovat s&nbsp;buňkou
paměti. U prvních šesti instrukcí je dokonce možné zvolit radix 1-16, což je
nejenom v&nbsp;oblasti čtyřbitových mikrořadičů nepochybně zajímavá
možnost:</p>

<table>
<tr><th>#</th><th>Instrukce</th><th>Stručný popis</th></tr>
<tr><td>1</td><td>ADD</td><td>součet + nastavení příznaků</td></tr>
<tr><td>2</td><td>ADC</td><td>součet s&nbsp;připočtením Carry + nastavení příznaků</td></tr>
<tr><td>3</td><td>SUB</td><td>rozdíl + nastavení příznaků</td></tr>
<tr><td>4</td><td>SBC</td><td>rozdíl s&nbsp;připočtením Carry + nastavení příznaků</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>5</td><td>INC</td><td>zvýšení buňky paměti o jedničku</td></tr>
<tr><td>6</td><td>DEC</td><td>snížení buňky paměti o jedničku</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>7</td><td>CMP</td><td>obdoba instrukce <strong>SUB</strong>, ovšem bez uložení výsledku rozdílu</td></tr>
</table>



<p><a name="k11"></a></p>
<h2 id="k11">11. Logické instrukce</h2>

<p>Logické instrukce mohou mít shodné typy operandů jako výše popsané
aritmetické instrukce <strong>ADD/ADC/SUB/SBB</strong>. Ovšem navíc všechny tři
zmíněné instrukce podporují provedení zvolené logické operace mezi obsahem
příznakového registru <strong>F</strong> a čtyřbitovou konstantou. To
mj.&nbsp;znamená, že je možné nastavit libovolnou kombinaci příznaků na
jedničku instrukcí <strong>OR</strong>, vynulovat libovolnou kombinaci příznaků
instrukcí <strong>AND</strong> či příznaky znegovat instrukcí
<strong>XOR</strong>, což je podle mého názoru elegantní řešení:</p>

<table>
<tr><th>#</th><th>Instrukce</th><th>Stručný popis</th></tr>
<tr><td>1</td><td>AND</td><td>logický součin prováděný bit po bitu</td></tr>
<tr><td>2</td><td>OR </td><td>logický součet prováděný bit po bitu</td></tr>
<tr><td>3</td><td>XOR</td><td>logická nonekvivalence prováděná bit po bitu</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>4</td><td>BIT</td><td>logické AND vybraného registru se čtyřbitovou konstantou a nastavení příznaků</td></tr>
</table>

<p>Poznámka: poslední instrukce nazvaná <strong>BIT</strong> je prakticky
totožná s&nbsp;instrukcí <strong>AND</strong>, ovšem výsledek se nikam
neukládá. Pouze se změní stav příznaku Zero na základě výsledku operace. U
jiných procesorů se tato instrukce většinou jmenuje <strong>TEST</strong> a u
minule popsaného procesoru se jmenovala <strong>FAN</strong>.</p>



<p><a name="k12"></a></p>
<h2 id="k12">12. Bitové rotace a logické posuny</h2>

<p>V&nbsp;instrukčním souboru existují dvě instrukce pro bitové rotace a dvě
instrukce pro logické posuny. Všechny čtyři instrukce vždy pracují i
s&nbsp;příznakem Carry. Rotovat je možné pracovní registr <strong>A</strong>,
<strong>B</strong>, popř.&nbsp;paměť adresovanou přes index registry
<strong>X</strong> či <strong>Y</strong> (s&nbsp;případnou autoinkrementací
adresy):</p>

<table>
<tr><th>#</th><th>Instrukce</th><th>Stručný popis</th></tr>
<tr><td>1</td><td>RR</td><td>bitová rotace doprava přes Carry</td></tr>
<tr><td>2</td><td>RL</td><td>bitová rotace doleva přes Carry</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>4</td><td>SRL</td><td>logický posun doprava; nejnižší bit se přesune do Carry</td></tr>
<tr><td>3</td><td>SLL</td><td>logický posun doleva; nejvyšší bit se přesune do Carry</td></tr>
</table>

<p>Poznámka: aritmetickou rotaci doleva je nutné implementovat programově
nastavením příznaku Carry před provedením <strong>SLL</strong>.</p>



<p><a name="k13"></a></p>
<h2 id="k13">13. Operace nad jednotlivými bity</h2>

<p>Tři nové instrukce slouží pro operace prováděné nad jednotlivými bity
získanými z&nbsp;paměťové buňky ležící na adresách 0x0000 až 0x003F
popř.&nbsp;na adresách 0xFFC0 až 0xFFFF, tedy na úplném začátku či naopak na
úplném konci adresovatelného rozsahu. Součástí instrukčního slova je jak
šestibitová adresa, tak i bitové pole obsahující index bitu, který se má
nastavit, vynulovat či otestovat:</p>

<table>
<tr><th>#</th><th>Instrukce</th><th>Stručný popis</th></tr>
<tr><td>2</td><td>CLR</td><td>vynulování bitu 0..3 na zvolené adrese + nastavení příznaku Zero</td></tr>
<tr><td>3</td><td>SET</td><td>nastavení bitu 0..3 na zvolené adrese + nastavení příznaku Zero</td></tr>
<tr><td>4</td><td>TST</td><td>otestování bitu 0..3 na zvolené adrese: nastavení příznaku Zero na hodnotu přečteného bitu</td></tr>
</table>



<p><a name="k14"></a></p>
<h2 id="k14">14. Instrukce pro práci se zásobníkem</h2>

<p>Dvojice instrukcí <strong>PUSH</strong> a <strong>POP</strong> slouží pro
uložení vybraného registru na zásobník popř.&nbsp;naopak pro obnovení obsahu
registru ze zásobníku. Pokud se na zásobník ukládají registry
<strong>A</strong> a <strong>B</strong> či příznakový registr
<strong>F</strong>, používá se jeden prvek zásobníku, u registrů
<strong>X</strong> a <strong>Y</strong> pak čtyři prvky (tyto registry jsou
šestnáctibitové):</p>

<table>
<tr><th>#</th><th>Instrukce</th><th>Stručný popis</th></tr>
<tr><td>1</td><td>PUSH</td><td>uložení vybraného registru na zásobník</td></tr>
<tr><td>2</td><td>POP</td><td>obnovení vybraného registru ze zásobníku</td></tr>
</table>



<p><a name="k15"></a></p>
<h2 id="k15">15. Instrukce typu Load &amp; Store</h2>

<p>Další skupina instrukcí slouží pro načtení či naopak uložení operandů do
operační paměti. Při adresování operandů se používají index registry
<strong>X</strong> a <strong>Y</strong> s&nbsp;případnou autoinkrementací
adresy. Samozřejmě je též možné načíst konstantu do vybraného registru
<strong>A</strong> či <strong>B</strong>, popř.&nbsp;provést převod dat mezi
pracovním registrem a registrem příznaků. Instrukce <strong>LDB</strong>
pracuje s&nbsp;operandy dvojnásobné šířky, tedy s&nbsp;jednotlivými bajty:</p>

<table>
<tr><th>#</th><th>Instrukce</th><th>Stručný popis</th></tr>
<tr><td>1</td><td>LD</td><td>načtení či uložení čtyřbitového operandu z/do registru</td></tr>
<tr><td>2</td><td>LDB</td><td>načtení celého bajtu (nikoli nibblu)</td></tr>
<tr><td>3</td><td>EX</td><td>prohození obsahu registru a buňky paměti</td></tr>
</table>

<p>Některé varianty &bdquo;čtyřbitové&ldquo; instrukce <strong>LD</strong>:</p>

<pre>
LD A, B
LD A, F
LD A, #konstanta
LD A, [X]
LD A, [X]+
</pre>

<p>Některé varianty &bdquo;osmibitové&ldquo; instrukce <strong>LD</strong>:</p>

<pre>
LDB XH,BA
LDB XL,BA
&nbsp;
LDB BA, YH
LDB BA, YL
LDB BA, #konstanta
LDB BA, [X]+
LDB BA, [Y]+
&nbsp;
LDB EXT, BA
LDB EXT, #konstanta
LDB SP1, BA
</pre>

<p>Všechny varianty &bdquo;čtyřbitové&ldquo; instrukce <strong>EX</strong>:</p>

<pre>
EX A, B
EX A, [X]
EX A, [X]+
EX A, [Y]
EX A, [Y]+
EX B, [X]
EX B, [X]+
EX B, [Y]
EX B, [Y]+
</pre>


<p><a name="k16"></a></p>
<h2 id="k16">16. Podmíněné a nepodmíněné skoky</h2>

<p>Instrukce provádějící skoky můžeme rozdělit do několika kategorií. Nalezneme
zde především nepodmíněný skok <strong>JR</strong>, nepodmíněný skok na adresu
uloženou v&nbsp;index registru <strong>Y</strong>, dále čtveřici podmíněných
skoků provedených či neprovedených na základě testu příznakových bitů
<strong>Carry</strong> a <strong>Zero</strong>, skoky do podprogramu a návraty
z&nbsp;podprogramů. Poslední instrukce provede návrat z&nbsp;podprogramu a
současně ještě uloží konstantu na adresu umístěnou v&nbsp;registru Y:</p>

<table>
<tr><th>#</th><th>Instrukce</th><th>Stručný popis</th></tr>
<tr><td>1</td><td>JR</td><td>nepodmíněný skok</td></tr>
<tr><td>2</td><td>JP</td><td>nepodmíněný skok na adresu uloženou v&nbsp;registru Y</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>3</td><td>JRC</td><td>podmíněný skok pokud Carry=1</td></tr>
<tr><td>4</td><td>JRNC</td><td>podmíněný skok pokud Carry=0</td></tr>
<tr><td>5</td><td>JRZ</td><td>podmíněný skok pokud Zero=1</td></tr>
<tr><td>6</td><td>JRNZ</td><td>podmíněný skok pokud Zero=0</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>7</td><td>CALZ</td><td>skok do podprogramu na nulté stránce</td></tr>
<tr><td>8</td><td>CALR</td><td>relativní skok do podprogramu</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>9</td><td>RET</td><td>návrat z&nbsp;podprogramu</td></tr>
<tr><td>10</td><td>RETS</td><td>dtto, ale navíc zvýšení PC a 1 (přeskočí se další instrukce ve volajícím kódu)</td></tr>
<tr><td>11</td><td>RETI</td><td>návrat z&nbsp;přerušovací subrutiny</td></tr>
<tr><td>12</td><td>RETD</td><td>návrat z&nbsp;podprogramu s&nbsp;výsledkem uloženým do paměti adresované X</td></tr>
</table>



<p><a name="k17"></a></p>
<h2 id="k17">17. Ostatní instrukce</h2>

<p>Zbývá nám popsat si čtyři instrukce, které nelze zařadit do žádné jiné
skupiny. Jedná se o instrukci <strong>INT</strong> určenou pro vyvolání SW
přerušení, klasickou instrukci <strong>NOP</strong> a dále o dvojici instrukcí
<strong>HALT</strong> a <strong>SLP</strong>, které dokážou přepnout režim
mikrořadiče do módu uspání či zastavení (potom mikrořadič reaguje pouze na
přerušení):</p>

<table>
<tr><th>#</th><th>Instrukce</th><th>Stručný popis</th></tr>
<tr><td>1</td><td>INT</td><td>uložení příznakového registru a návratové adresy na zásobník + vyvolání přerušení</td></tr>
<tr><td>2</td><td>NOP</td><td>pouze zvýšení hodnoty čítače instrukcí o 1</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>3</td><td>HALT</td><td>přechod celého čipu do režimu HALT</td></tr>
<tr><td>4</td><td>SLP</td><td>přechod celého čipu do režimu SLEEP</td></tr>
</table>



<p><a name="k18"></a></p>
<h2 id="k18">18. Odkazy na Internetu</h2>

<ol>

<li>4-bit architecture<br />
<a href="https://en.wikichip.org/wiki/4-bit_architecture">https://en.wikichip.org/wiki/4-bit_architecture</a>
</li>

<li>S1C60 - Epson<br />
<a href="https://en.wikichip.org/wiki/epson/s1c60">https://en.wikichip.org/wiki/epson/s1c60</a>
</li>

<li>S1C63 - Epson<br />
<a href="https://en.wikichip.org/wiki/epson/s1c63">https://en.wikichip.org/wiki/epson/s1c63</a>
</li>

<li>4-bit to 32-bit low power microcontrollers (Epson)<br />
<a href="http://global.epson.com/products_and_drivers/semicon/products/micro_controller/">http://global.epson.com/products_and_drivers/semicon/products/micro_controller/</a>
</li>

<li>4-bit microcontrollers (Epson)<br />
<a href="http://global.epson.com/products_and_drivers/semicon/products/micro_controller/4bit/">http://global.epson.com/products_and_drivers/semicon/products/micro_controller/4bit/</a>
</li>

<li>High Performance 4bit (Epson)<br />
<a href="http://global.epson.com/products_and_drivers/semicon/products/micro_controller/high4bit/">http://global.epson.com/products_and_drivers/semicon/products/micro_controller/high4bit/</a>
</li>

<li>S1C60 Family Products overview (PDF)<br />
<a href="http://global.epson.com/products_and_drivers/semicon/products/micro_controller/pdf/spec_mcu_4bit.pdf">http://global.epson.com/products_and_drivers/semicon/products/micro_controller/pdf/spec_mcu_4bit.pdf</a>
</li>

<li>Zero-power Microcontrollers for Low-power and High-temperature Applications<br />
<a href="http://en.wikichip.org/w/images/1/17/Atmel_MARC4_brochure.pdf">http://en.wikichip.org/w/images/1/17/Atmel_MARC4_brochure.pdf</a>
</li>

<li>MARC4 Micro-Controller (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/MARC4_Micro-Controller">https://en.wikipedia.org/wiki/MARC4_Micro-Controller</a>
</li>

<li>MARC4 - Atmel<br />
<a href="https://en.wikichip.org/wiki/atmel/marc4">https://en.wikichip.org/wiki/atmel/marc4</a>
</li>

<li>MARC 4bit Microcontrollers Programmer's Guide<br />
<a href="https://en.wikichip.org/w/images/4/44/MARC4_4-bit_Microcontrollers_Programmer%27s_Guide.pdf">https://en.wikichip.org/w/images/4/44/MARC4_4-bit_Microcontrollers_Programmer%27s_Guide.pdf</a>
</li>

<li>MARC4 User's Guide qFORTH Compiler<br />
<a href="https://en.wikichip.org/w/images/2/25/MARC4_User%27s_Guide_qFORTH_Compiler.pdf">https://en.wikichip.org/w/images/2/25/MARC4_User%27s_Guide_qFORTH_Compiler.pdf</a>
</li>

<li>Accumulator<br />
<a href="https://en.wikipedia.org/wiki/Accumulator_%28computing%29">https://en.wikipedia.org/wiki/Accumulator_%28computing%29</a>
</li>

<li>Index register<br />
<a href="https://en.wikipedia.org/wiki/Index_register">https://en.wikipedia.org/wiki/Index_register</a>
</li>

<li>Control/Status register<br />
<a href="https://en.wikipedia.org/wiki/Control/Status_Register">https://en.wikipedia.org/wiki/Control/Status_Register</a>
</li>

<li>Programovací jazyk Forth a zásobníkové procesory<br />
<a href="http://www.root.cz/clanky/programovaci-jazyk-forth-a-zasobnikove-procesory/">http://www.root.cz/clanky/programovaci-jazyk-forth-a-zasobnikove-procesory/</a>
</li>

<li>Seriál Programovací jazyk Forth<br />
<a href="http://www.root.cz/serialy/programovaci-jazyk-forth/">http://www.root.cz/serialy/programovaci-jazyk-forth/</a>
</li>

<li>Programovací jazyk Factor<br />
<a href="http://www.root.cz/clanky/programovaci-jazyk-factor/">http://www.root.cz/clanky/programovaci-jazyk-factor/</a>
</li>

<li>Grafický metaformát PostScript<br />
<a href="http://www.root.cz/clanky/graficky-metaformat-postscript/">http://www.root.cz/clanky/graficky-metaformat-postscript/</a>
</li>

<li>PMOS<br />
<a href="https://en.wikipedia.org/wiki/PMOS_logic">https://en.wikipedia.org/wiki/PMOS_logic</a>
</li>

<li>NMOS<br />
<a href="https://en.wikipedia.org/wiki/NMOS_logic">https://en.wikipedia.org/wiki/NMOS_logic</a>
</li>

<li>CMOS<br />
<a href="https://en.wikipedia.org/wiki/CMOS">https://en.wikipedia.org/wiki/CMOS</a>
</li>

<li>Vacuum Fluorescent Display<br />
<a href="https://en.wikipedia.org/wiki/Vacuum_fluorescent_display">https://en.wikipedia.org/wiki/Vacuum_fluorescent_display</a>
</li>

<li>Computer History Museum: TMS 1000 4-Bit microcontroller<br />
<a href="http://www.computerhistory.org/collections/catalog/102711697">http://www.computerhistory.org/collections/catalog/102711697</a>
</li>

<li>Texas Instruments TMS1000 microcontroller family<br />
<a href="http://www.cpu-world.com/CPUs/TMS1000/">http://www.cpu-world.com/CPUs/TMS1000/</a>
</li>

<li>Invention History of Microcontroller<br />
<a href="http://www.circuitstoday.com/microcontroller-invention-history">http://www.circuitstoday.com/microcontroller-invention-history</a>
</li>

<li>TMS1000 Series - TI<br />
<a href="https://en.wikichip.org/wiki/ti/tms1000">https://en.wikichip.org/wiki/ti/tms1000</a>
</li>

<li>TMX1795 - TI<br />
<a href="https://en.wikichip.org/wiki/ti/tmx1795">https://en.wikichip.org/wiki/ti/tmx1795</a>
</li>

<li>Milton Bradley Microvision (U.S.) (1979, LCD, 9 Volt (1 or 2), Model# 4952)<br />
<a href="http://www.handheldmuseum.com/MB/uVUS.htm">http://www.handheldmuseum.com/MB/uVUS.htm</a>
</li>

<li>8051 Microcontroller<br />
<a href="http://www.circuitstoday.com/8051-microcontroller">http://www.circuitstoday.com/8051-microcontroller</a>
</li>

<li>4-bit (computer architectures)<br />
<a href="https://en.wikipedia.org/wiki/4-bit">https://en.wikipedia.org/wiki/4-bit</a>
</li>

<li>TMS 1000 Data Manual<br />
<a href="http://blog.kevtris.org/blogfiles/TMS_1000_Data_Manual.pdf">http://blog.kevtris.org/blogfiles/TMS_1000_Data_Manual.pdf</a>
</li>

<li>Considerations for 4-bit processing<br />
<a href="http://www.embeddedinsights.com/channels/2010/12/10/considerations-for-4-bit-processing/">http://www.embeddedinsights.com/channels/2010/12/10/considerations-for-4-bit-processing/</a>
</li>

<li>Are you, or would you consider, using a 4-bit microcontroller?<br />
<a href="http://www.embeddedinsights.com/channels/2010/11/24/are-you-or-would-you-consider-using-a-4-bit-microcontroller/">http://www.embeddedinsights.com/channels/2010/11/24/are-you-or-would-you-consider-using-a-4-bit-microcontroller/</a>
</li>

<li>MARC4 Micro-Controller<br />
<a href="https://en.wikipedia.org/wiki/MARC4_Micro-Controller">https://en.wikipedia.org/wiki/MARC4_Micro-Controller</a>
</li>

<li>The Texas Instruments TMX 1795: the (almost) first, forgotten microprocessor <br />
<a href="http://www.righto.com/2015/05/the-texas-instruments-tmx-1795-first.html">http://www.righto.com/2015/05/the-texas-instruments-tmx-1795-first.html</a>
</li>

<li>O2 Homepage<br />
<a href="http://www.the-nextlevel.com/odyssey2/">http://www.the-nextlevel.com/odyssey2/</a>
</li>

<li>Magnavox Odyssey2 (1978), Philips Videopac G7000 / C52 (1979)<br />
<a href="http://www.mess.org/sysinfo:odyssey2">http://www.mess.org/sysinfo:odyssey2</a>
</li>

<li>The Video Game Critic's Odyssey 2 Reviews <br />
<a href="http://videogamecritic.net/odd.htm">http://videogamecritic.net/odd.htm</a>
</li>

<li>Computer Closet Collection: Magnavox Odyssey^2<br />
<a href="http://www.computercloset.org/MagnavoxOdyssey2.htm">http://www.computercloset.org/MagnavoxOdyssey2.htm</a>
</li>

<li>PHILIPS Videopac C52<br />
<a href="http://old-computers.com/museum/computer.asp?c=1060">http://old-computers.com/museum/computer.asp?c=1060</a>
</li>

<li>O2 Tech. Manual V.1.1 (PDF dokument)<br />
<a href="http://www.atarihq.com/danb/files/o2doc.pdf">http://www.atarihq.com/danb/files/o2doc.pdf</a>
</li>

<li>Magnavox Odyssey<sup>2</sup><br />
<a href="http://www.game-machines.com/consoles/odyssey2.php">http://www.game-machines.com/consoles/odyssey2.php</a>
</li>

<li>Magnavox Odyssey<sup>2</sup> (Wikipedia EN)<br />
<a href="http://en.wikipedia.org/wiki/Odyssey_2">http://en.wikipedia.org/wiki/Odyssey_2</a>
</li>

<li>Magnavox Odyssey<sup>2</sup> Games (Wikipedia EN)<br />
<a href="http://en.wikipedia.org/wiki/List_of_Videopac_games">http://en.wikipedia.org/wiki/List_of_Videopac_games</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2017</small></p>
</body>
</html>

