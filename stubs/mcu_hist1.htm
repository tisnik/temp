<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Vznik mikrořadičů: čtyřbitový čip TMS 1000</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Vznik mikrořadičů: čtyřbitový čip TMS 1000</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V posledních částech seriálu o architekturách počítačů jsme si popsali moderní mikrořadiče, které jsou vybaveny výkonnými šestnáctibitovými a 32bitovými jádry s hodinovou frekvencí dosahující stovek MHz. Ovšem na začátku mikrořadičové revoluce stál z dnešního pohledu primitivní čtyřbitový čip TMS 1000 s hodinovou frekvencí 400 kHz.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Vznik mikrořadičů: čtyřbitový čip TMS 1000</a></p>
<p><a href="#k02">2. Čtyřbitové architektury mikrořadičů &ndash; šlo jen o historickou raritu?</a></p>
<p><a href="#k03">3. Varianty čipu TMS 1000</a></p>
<p><a href="#k04">4. Základní charakteristiky TMS 1000</a></p>
<p><a href="#k05">5. Architektura čipu TMS 1000 (interní struktura)</a></p>
<p><a href="#k06">6. Vstupní a výstupní piny &ndash; způsob zapojení klávesnice a displeje</a></p>
<p><a href="#k07">7. Sada pracovních registrů</a></p>
<p><a href="#k08">8. Programový čítač a stránkový registr</a></p>
<p><a href="#k09">9. Programovatelný dekodér instrukcí</a></p>
<p><a href="#k10">10. Aritmeticko-logická jednotka</a></p>
<p><a href="#k11">11. Instrukční soubor mikrořadičů TMS 1000</a></p>
<p><a href="#k12">12. Použití čipů TMS 1000</a></p>
<p><a href="#k13">13. Kapesní herní konzole MicroVision</a></p>
<p><a href="#k14">14. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Vznik mikrořadičů: čtyřbitový čip TMS 1000</h2>

<p>Naprostá většina mikrořadičů, které se používají v&nbsp;současnosti,
obsahuje aritmeticko-logické jednotky i datové sběrnice s&nbsp;šířkou osm bitů,
šestnáct bitů či 32 bitů. Navíc můžeme sledovat postupný přechod na 32bitové
čipy, a to dokonce i v&nbsp;těch aplikacích, kde to není z&nbsp;hlediska
potřebného výpočetního výkonu nutné. Důvodem je snadnější programování a
samozřejmě i klesající cena za 32bitové čipy (ať již se jedná o architekturu
MIPS či o pravděpodobně populárnější ARM). Ovšem na samotném začátku historie
mikrořadičů, která se začala psát začátkem sedmdesátých let minulého století,
nenajdeme osmibitový čip, protože první mikrořadiče byly postaveny na bázi
čtyřbitových ALU. Jednalo se o čipy &micro;COM společnosti NEC a taktéž o TMS
1000 navržený ve firmě Texas Instruments. TMS 1000 je uváděn jako první
mikrořadič, ovšem zpočátku byl používán pouze pro potřeby TI, takže se na trhu
jako první objevil &micro;COM.</p>

<img src="https://i.iinfo.cz/images/208/tms1000-1.jpg" class="image-284542" alt="&#160;" width="418" height="726" />
<p><i>Obrázek 1: Typickým segmentem trhu pro TMS 1000 jsou kapesní kalkulačky,
ať již s&nbsp;displeji založenými na LED, LCD či VFD.</i></p>

<p>Tyto čipy se začaly používat v&nbsp;kapesních i stolních kalkulačkách,
pokladnách i v&nbsp;typických &bdquo;mikrořadičových aplikacích&ldquo;, mezi
něž patřilo ovládání mikrovlnných trub (kompaktní mikrovlnky se na západě
objevily již na přelomu 1969/1970), alarmy, kávové konvice atd. Ovšem &ndash; a
to pravděpodobně tvůrci čtyřbitových mikrořadičů nepředpokládali &ndash; se TMS
1000 společnosti TI začal používat i v&nbsp;elektronických hračkách (robotech),
elektronických hrách, jako zvukový generátor atd. Naproti tomu pro složitější
aplikace (ovládání křižovatek) se začal používat výkonnější čip Intel 8008 (ne
8080!), který ovšem ke své činnosti vyžadoval další podpůrné čipy, takže se
nejedná o mikrořadič.</p>

<img src="https://i.iinfo.cz/images/208/tms1000-2.jpg" class="image-284543" alt="&#160;" width="303" height="542" />
<p><i>Obrázek 2: Některé varianty čipu TMS 1000 byly navrženy takovým způsobem,
aby mohly ovládat displeje s&nbsp;technologií VFD. Tyto displeje jsou používány
na DVD přehrávačích, mikrovlnkách atd. Od LED je snadno rozeznáte podle mřížky,
která se při pohledu zblízka jasně viditelná.</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Čtyřbitové architektury mikrořadičů &ndash; šlo jen o historickou raritu?</h2>

<p><i>&bdquo;The sweet spot for 4-bit processor designs are single battery
applications that have a 10 year lifespan and where the device is active
perhaps 1% of that time and in standby the other 99%. An interesting
differentiator for 4-bit processors is that they can operate at 0.6V. This is a
substantial advantage over the lowest power 8-bit processors which are still
fighting over the 0.9 to 1.8V space.&ldquo;<br />Robert Cravotta</i></p>

<p>Čtyřbitové mikrořadiče mohou z&nbsp;dnešního pohledu vypadat jako zcela
překonaná archaická technologie, a nutno říci, že je to pro naprostou většinu
aplikací pravda. Ovšem v&nbsp;okamžiku, kdy je jediným úkolem mikrořadiče
snímat několik digitálních vstupů a zobrazovat výsledek na sedmisegmentovém
displeji, může být použití čtyřbitové ALU zcela dostačující, protože i na
osmibitových mikrořadičích se programátoři v&nbsp;takovém případě většinou
(zcela správně) uchylovali k&nbsp;použití BCD aritmetiky. Ostatně dodnes se
s&nbsp;BCD setkáme na některých čipech s&nbsp;hodinami reálného času, řadičích
displejů atd. Z&nbsp;tohoto důvodu většina osmibitových mikrořadičů BCD dodnes
podporuje (s&nbsp;výjimkou PICů), popř.&nbsp;aspoň obsahuje instrukci
<strong>SWAP</strong> pro prohození horních a spodních čtyř bitů v&nbsp;bajtu
(<i>nibbles</i>).</p>

<img src="https://i.iinfo.cz/images/208/tms1000-4.jpg" class="image-284545" alt="&#160;" width="236" height="261" />
<p><i>Obrázek 3: Jedna z&nbsp;typických nasazení čtyřbitových mikrořadičů
&ndash; elektronika pump pohonných hmot.</i></p>

<p>V&nbsp;následující tabulce jsou pro přehlednost vypsány základní parametry
prvních mikrořadičů (tučné písmo). Pro úplnost a doplnění kontextu jsem do
tabulky přidal i tři klasické mikroprocesory firmy Intel. Z&nbsp;tabulky je
patrné, jak se koncept mikrořadiče a mikroprocesoru paralelně rozvíjel ve více
společnostech:</p>

<table>
<tr><th>Rok</th><th>Výrobce</th><th>Označení čipu</th><th>Počet bitů</th><th>Frekvence</th><th>Technologie</th></tr>
<tr><td>1971</td><td>Intel</td><td>4004</td><td>4</td><td>740 kHz</td><td>PMOS</td></tr>
<tr><td>1971</td><td>TI   </td><td><strong>prototyp mikrořadiče TMS</strong></td><td>4</td><td>? kHz</td><td>PMOS</td></tr>
<tr><td>1972</td><td>Intel</td><td>8008</td><td>8</td><td>200 kHz - 800 kHz</td><td>PMOS</td></tr>
<tr><td>1973</td><td>NEC  </td><td><strong>&micro;COM</strong></td><td>4</td><td>1 MHz</td><td>NMOS</td></tr>
<tr><td>1974</td><td>Intel</td><td>8080</td><td>8</td><td>2 MHz</td><td></td></tr>
<tr><td>1974</td><td>TI   </td><td><strong>TMS 1000</strong></td><td>4</td><td>400 kHz</td><td>PMOS, později CMOS i NMOS</td></tr>
<tr><td>1976</td><td>Intel</td><td><strong>8048</strong></td><td>8</td><td>11 MHz</td><td>NMOS, později CMOS</td></tr>
<tr><td>1980</td><td>Intel</td><td><strong>8051</strong></td><td>8</td><td>12 MHz</td><td>NMOS, později CMOS</td></tr>
</table>

<img src="https://i.iinfo.cz/images/208/tms1000-4.jpg" class="image-284545" alt="&#160;" width="236" height="261" />
<p><i>Obrázek 4: Další kalkulačka s&nbsp;VFD, která je řízena variantou čipu
TMS 1000.</i></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Varianty čipu TMS 1000</h2>

<p><i>&bdquo;I speculate that there may be other 4-bit designs out there, but
the people using them do not want anyone else to know about them. Think about
it, would you want your competitor to know you were able to simplify the
problem set to fit on such a small device? Let them think you are using a
larger, more expensive (cost and energy) device and wonder how you are doing
it.&ldquo;<br />Robert Cravotta</i></p>

<p>Na základě architektury původního čipu TMS 1000 vzniklo poměrně velké
množství dalších variant, které se od sebe odlišovaly především kapacitou
paměti programu (ROM), kapacitou datové paměti (RAM), počtem vstupních a
výstupních pinů, použitou technologií (PMOS, NMOS, CMOS) a taktéž tím, jaký
displej bylo možné k&nbsp;mikrořadiči připojit (VFD displeje vyžadovaly vyšší
napětí atd.). V&nbsp;následující tabulce jsou základní varianty TMS 1000
vypsány:</p>

<table>
<tr><th>Čip</th><th>ROM</th><th>RAM</th><th>Technologie</th><th>Poznámka</th></tr>
<tr><td>TMS1000 </td><td>1KB </td><td>64x4 </td><td>PMOS</td><td>původní varianta mikrořadiče</td></tr>
<tr><td>TMS1000C</td><td>1KB </td><td>64x4 </td><td>CMOS</td><td>identické s TMS 1000, ale použita technologie CMOS</td></tr>
<tr><td>TMS1018 </td><td>-   </td><td>64x4 </td><td>PMOS</td><td></td></tr>
<tr><td>TMS1040 </td><td>1KB </td><td>64x4 </td><td>PMOS</td><td>řadič displeje VFD</td></tr>
<tr><td>TMS1070 </td><td>1KB </td><td>64x4 </td><td>PMOS</td><td>řadič displeje VFD</td></tr>
<tr><td>TMS0970 </td><td>1KB </td><td>64x4 </td><td>PMOS</td><td>jako předchozí, ale řadič pro LED</td></tr>
<tr><td>TMS1098 </td><td>-   </td><td>128x4</td><td>PMOS</td><td></td></tr>
<tr><td>TMS1099 </td><td>-   </td><td>64x4 </td><td>PMOS</td><td></td></tr>
<tr><td>TMS1099C</td><td>-   </td><td>64x4 </td><td>CMOS</td><td>identické s TMS 1099, ale použita technologie CMOS</td></tr>
<tr><td>TMS1100 </td><td>2KB </td><td>128x4</td><td>PMOS</td><td></td></tr>
<tr><td>TMS1117 </td><td>2KB </td><td>128x4</td><td>PMOS</td><td></td></tr>
<tr><td>TMS1200 </td><td>1KB </td><td>64x4 </td><td>PMOS</td><td></td></tr>
<tr><td>TMS1200C</td><td>1KB </td><td>64x4 </td><td>CMOS</td><td>identické s TMS 1200, ale použita technologie CMOS</td></tr>
<tr><td>TMS1270 </td><td>1KB </td><td>64x4 </td><td>PMOS</td><td></td></tr>
<tr><td>TMS1300 </td><td>2KB </td><td>128x8</td><td>PMOS</td><td></td></tr>
<tr><td>TMS1400 </td><td>4KB </td><td>128x4</td><td>PMOS</td><td></td></tr>
<tr><td>TMS1600 </td><td>4KB </td><td>128x4</td><td>PMOS</td><td></td></tr>
<tr><td>TMS1700 </td><td>512B</td><td>32x4 </td><td>PMOS</td><td></td></tr>
<tr><td>TMS2000 </td><td>1KB </td><td>64x4 </td><td>NMOS</td><td>NMOS varianta mikrořadiče TMS 1000</td></tr>
<tr><td>TMS2100 </td><td>2KB </td><td>128x4</td><td>NMOS</td><td>NMOS varianta mikrořadiče TMS 1100</td></tr>
<tr><td>TMS2200 </td><td>1KB </td><td>64x4 </td><td>NMOS</td><td>NMOS varianta mikrořadiče TMS 1200</td></tr>
<tr><td>TMS2300 </td><td>2KB </td><td>128x8</td><td>NMOS</td><td>NMOS varianta mikrořadiče TMS 1300</td></tr>
</table>

<p>Poznámka: velmi pravděpodobně existují i další varianty TMS 1000, které však
byly určeny jen pro konkrétního zákazníka, takže se pouze podle označení čipu
nedá přesně zjistit, o jaký mikrořadič se jedná. Například ve známé kalkulačce
TI-35 je použit čip TP0324-4N.</p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Základní charakteristiky TMS 1000</h2>

<p>Mikrořadič <i>TMS 1000</i> byl založen na čtyřbitové centrální procesorové
jednotce (CPU), což poměrně podstatným způsobem ovlivnilo jak jeho výpočetní
výkon, tak i aplikační oblasti, ve kterých bylo možné tento čip využít.
V&nbsp;průběhu dalších let se totiž ukázalo, že čtyřbitové mikrořadiče jsou pro
většinu aplikací málo vhodné, naproti tomu osmibitové mikrořadiče jsou stále
používané, i když dnes jsou již k&nbsp;dispozici i výkonnější šestnáctibitové a
32bitové mikrořadiče. <i>TMS 1000</i> obsahoval na jednom čipu čtyřbitovou
aritmeticko-logickou jednotku (ALU), několik pracovních i specializovaných
registrů, operační paměť o kapacitě 64 nebo 128 <i>nibblů</i> (<i>nibble</i> je
čtveřice bitů, podobně jako <i>bajt</i> je osmice bitů), paměť programu (ROM) o
maximální kapacitě 2048 bajtů (původní čip dokonce jen 1024 bajtů, TMS1700 měl
ovšem ještě menší ROM o velikosti 512 bajtů) a taktéž, což bylo dosti
novátorské řešení, i PLA (programovatelnou logiku), pomocí níž bylo možné
vytvořit (&bdquo;namikroprogramovat&ldquo;) až 31 uživatelských instrukcí,
které se přidaly k&nbsp;původní (neměnné) instrukční sadě obsahující pouhých 12
instrukcí. Ve verzi určené pro ovládání displejů měl TMS napájecí napětí 15V
(!) a spotřebu 68 mW.</p>

<p>Zvětšený snímek čipu si lze prohlédnout na stránce <a
href="http://smithsonianchips.si.edu/augarten/i38.htm">http://smithsonianchips.si.edu/augarten/i38.htm</a>.
Z&nbsp;tohoto snímku je patrný i rozdíl v&nbsp;hustotě bitů u RAM a ROM &ndash;
ROM sice zabírá nepatrně větší plochu čipu než RAM, ovšem má čtyřnásobnou
kapacitu. Mimochodem &ndash; i přesto, že EPROM byla vynalezena již v&nbsp;roce
1971, měla většina čipů TMS ROM programovatelnou maskou při výrobě (později
pravděpodobně i PROM). To však pro daný segment trhu příliš nevadilo, protože
zde rozhodovala celková výrobní cena a při velkém množství čipů bylo výhodnější
si objednat TMS s&nbsp;vlastní maskou (cena za jeden čip pak klesala ke dvěma
dolarům, což je neporovnatelně méně, než u výkonnějších mikrořadičů).</p>

<p>Poznámka: oproti předchozímu snímku je toto okomentované schéma
z&times;patentu TMS otočené: <a
href="http://www.seanriddle.com/patentdieshot.jpg">http://www.seanriddle.com/patentdieshot.jpg</a>.</p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Architektura čipu TMS 1000 (interní struktura)</h2>

<p>Zjednodušená interní struktura čipu TMS 1000 s&nbsp;kapacitou programové
paměti 1024 bajtů a kapacitou datové paměti 64&times;4 bitů je zobrazena na
pátém obrázku. Žluté trojúhelníky označují sady vstupních a výstupních pinů,
které jsou podrobněji popsány <a href="#k06">v&nbsp;navazující kapitole</a>.
Povšimněte si zde pouze jedné zajímavosti &ndash; čtyři vstupní piny
<strong>Kn</strong> jsou připojeny přímo do aritmeticko-logické jednotky.
K&nbsp;ALU je přímo připojen i čtyřbitový akumulátor, a to jak na vstup, tak i
na výstup. Pracovní registr <strong>Y</strong> je možné považovat za klasický
index registr, ale kvůli možnosti přístupu k&nbsp;64 či u některých čipů ke 128
nibblům bylo nutné tento registr doplnit o dva či tři bity, které jsou
představovány registrem <strong>X</strong>. Paměť RAM je propojena jak
s&nbsp;aritmeticko-logickou jednotkou, tak i s&nbsp;akumulátorem, což ostatně
bude patrné při pohledu <a href="#k11">na instrukční sadu</a>.</p>

<a href="https://www.root.cz/obrazek/284546/"><img src="https://i.iinfo.cz/images/208/tms1000-5-prev.png" class="image-284546" alt="&#160;" width="260" height="270" /></a>
<p><i>Obrázek 5: Zjednodušená interní struktura čipu TMS 1000 bez dekodéru
instrukcí a mikrořadiče (klikněte pro zvětšení).</i></p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Vstupní a výstupní piny &ndash; způsob zapojení klávesnice a displeje</h2>

<p>Podívejme se nejprve na zapojení vývodů čipu TMS 1000 ve verzi
s&nbsp;dvaceti osmi piny (existují totiž i varianty se 40 piny):</p>

<img src="https://i.iinfo.cz/images/208/tms1000-6.png" class="image-284547" alt="&#160;" width="236" height="266" />
<p><i>Obrázek 6: Zapojení vývodů čipu TMS 1000 ve verzi s&nbsp;dvaceti osmi piny.</i></p>

<p>Můžeme zde vidět především piny <strong>Vss</strong> a <strong>Vdd</strong>
pro připojení napájení, piny <strong>OSC1</strong> a <strong>OSC2</strong> pro
externí oscilátor a taktéž pin <strong>INIT</strong> umožňující vygenerování
signálu RESET v&nbsp;těch aplikacích, u nichž je náběh napájecího napětí pomalý
a/nebo napětí kolísá (čip si RESET generuje sám, ale pouze pokud se napájecí
napětí zvýší skokově). Všechny další piny již slouží pro připojení periferních
obvodů. Jedná se o piny <strong>K1</strong>, <strong>K2</strong>,
<strong>K3</strong> a <strong>K4</strong>, které typicky slouží pro přečtení
stavu kláves zapojených do matice 8&times;4 až 10&times;4 klávesy (tyto piny
jsou přesměrovány přímo do ALU). O výběr řádku na klávesnici se staraly
výstupní piny <strong>R0</strong> až <strong>R10</strong> (u některých čipů až
<strong>R12</strong>). Ovšem tyto piny současně sloužily pro výběr číslice na
displeji, což znamená, že podporovány byly displeje až s&nbsp;jedenácti (či
třinácti) místy. Konkrétní tvar číslice a desetinné tečky se přenášel po pinech
<strong>O0</strong> až <strong>O7</strong>.</p>

<p>Zapojení nejjednodušší kalkulačky s&nbsp;osmimístným displejem může vypadat
následovně (tato klávesnice trpí klasickým problémem &ndash; při stlačení tří
kláves se chybně detekuje i stisk klávesy tvořící čtvrtou stranu čtverce):</p>

<pre>
  Klávesnice      
      8x4
--+--+--+--+----------------------------.
--+--+--+--+-------------------------.  |
--+--+--+--+----------------------.  |  |
--+--+--+--+-------------------.  |  |  |
--+--+--+--+----------------.  |  |  |  |
--+--+--+--+-------------.  |  |  |  |  |
--+--+--+--+----------.  |  |  |  |  |  |
--+--+--+--+-------.  |  |  |  |  |  |  |
  |  |  |  |       |  |  |  |  |  |  |  |
  |  |  |  |       |  |  |  |  |  |  |  |
  |  |  |  |       |  |  |  |  |  |  |  |
  |  |  |  |       ^  ^  ^  ^  ^  ^  ^  ^
  v  v  v  v       |  |  |  |  |  |  |  |
 K1 K2 K3 K4      R7 R6 R5 R4 R3 R2 R1 R0   O7 O6 O5 O4 O3 O2 O1 O0
                   |  |  |  |  |  |  |  |    |  |  |  |  |  |  |  |
                   |  (výběr číslice)   |    (stav segmentů a tečky)
                   |  |  |  |  |  |  |  |    |  |  |  |  |  |  |  |
                 +------------------------+  |  |  |  |  |  |  |  |
                 | 0  0  0  0  0  0  0  0.|&lt;-*--*--*--*--*--*--*--*
                 +------------------------+
</pre>

<p>Funkce vstupů a výstupů:</p>

<ul>

<li>Na výstupy <strong>R0</strong> až <strong>R7</strong> se postupně přenáší
bitový vzorek 00000001, 00000010, 00000100, tj.&nbsp;vlastně výsledek
z&nbsp;posuvného registru. Frekvence změn je odvozena od možností displeje (jak
rychle se musí obnovovat).</li>

<li>Tím se automaticky vybírá řádek na klávesnici, stav všech čtyř kláves na
řádku se ihned může přečíst na pinech <strong>K1</strong> až
<strong>K4</strong> (poznámka: fyzický tvar klávesnice samozřejmě může být
odlišný od interní matice 8&times;4).</li>

<li>Současně se automaticky vybírá číslice na displeji, takže je možné číslici
obnovit zápisem osmi bitů na výstupy <strong>O0</strong> až
<strong>O7</strong>. Obnova musí probíhat tak rychle, aby uživatel neviděl
poblikávání displeje, což ovšem u čipu s&nbsp;hodinovou frekvencí 400 kHz není
problém.</li>

</ul>



<p><a name="k07"></a></p>
<h2 id="k07">7. Sada pracovních registrů</h2>

<p>Mikrořadič <i>TMS 1000</i> obsahoval několik registrů. Jednalo se především
o čtyřbitový akumulátor označovaný tradičně písmenem <strong>A</strong>, dále o
čtyřbitový pracovní registr <strong>Y</strong> a dvou či tříbitový registr
<strong>X</strong> (podobnost s&nbsp;osmibitovým mikroprocesorem <i>MOS
6502</i> je ovšem čistě náhodná, protože tyto dva registry mají poněkud odlišné
funkce :-). Registry <strong>X</strong> a <strong>Y</strong> bylo možné
v&nbsp;případě potřeby zkombinovat takovým způsobem, že se chovaly jako šesti
nebo sedmibitový index registr umožňující adresaci 64 nebo 128 nibblů operační
paměti RAM (ostatně z&nbsp;tohoto důvodu je <strong>X</strong> dvoubitový či
tříbitový podle toho, o jakou variantu čipu se jednalo). V&nbsp;mikrořadiči byl
taktéž přítomen stavový (příznakový) registr, který byl ovšem představován
pouze jediným bitem (ostatně i aritmetické operace byly do značné míry
zjednodušené, takže nevyžadovaly klasickou čtveřici
Carry+Overflow+Zero+Negative).</p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Programový čítač a stránkový registr</h2>

<p>Posledními registry, které byly viditelné programátorům, byly šestibitový
programový čítač (<strong>PC</strong>), čtyřbitový stránkový registr (<i>page
address register</i>), registr s&nbsp;návratovou adresou ze subrutiny a
jednobitový registr uchovávající aktuální banku v&nbsp;paměti ROM (horní nebo
spodní kilobajt u čipů se dvěma kilobajty ROM). Při načítání instrukcí se
adresa načítané instrukce složila ze všech tří zmíněných registrů: 1 bit bank
registr + 4 bity stránkový registr + 6 bitů <strong>PC</strong> = 11 bitů, což
přesně odpovídá 2048 adresám. Programová paměť tedy byla rozdělena na stránky
(<i>page</i>), z&nbsp;nichž každá měla kapacitu 64 instrukcí. Podmíněné skoky
probíhaly právě v&nbsp;tomto rozsahu.</p>

<p>Registr <strong>PC</strong> se sice nazýval programový čítač (toto jméno
bylo převzato ze starších procesorových jednotek), ovšem ve skutečnosti nebyl
inkrementován pomocí sčítačky, tak jako je tomu u naprosté většiny ostatních
mikroprocesorů a mikrořadičů, ale jeho obsah byl po načtení operačního kódu
instrukce změněn pomocí polynomického čítače (podobně jako například
v&nbsp;čipu <i>TIA</i> použitého u herní konzole <i>Atari 2600</i>), což
znamenalo, že instrukce nebyly ve skutečnosti v&nbsp;paměti ROM umístěny za
sebou. Ovšem vzhledem k&nbsp;tomu, že se jednalo o interní paměť nečitelnou
mimo vlastní čip a spustitelný program byl většinou generován assemblerem,
nepředstavovala tato vlastnost vlastně žádný větší problém (naopak &ndash;
polynomické čítače jsou implementačně jednodušší než sčítačka).</p>

<p>Schéma čtrnáctibitového posuvného registru se zpětnou vazbou. U TMS 1000 je
tento registr samozřejmě kratší; jen šestibitový:</p>

<pre>
                 &lt;=======================

+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+
| 14 | 13 | 12 | 11 | 10 |  9 |  8 |  7 |  6 |  5 |  4 |  3 |  2 |  1 |  0 |
+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+
   v    v        _____                                                   ^
   v    +-------| xor |--------------------------------------------------+
   +------------|_____|
</pre>



<p><a name="k09"></a></p>
<h2 id="k09">9. Programovatelný dekodér instrukcí</h2>

<p>Význam některých instrukcí je možné změnit modifikací <strong>PLA</strong>
(<i>Programmable Logic Array</i>) při výrobě masky čipu. Díky tomu se
instrukční soubor může měnit podle toho, jakou funkci má čip TMS 1000 provádět.
Cílem není zvýšit rychlost instrukcí (to není možné &ndash; počet mikrokroků
každé instrukce je konstantní), ale spíše ušetřit kapacitu ROM při implementaci
běžných funkcí. Do PLA je také možné nahrát kódovací tabulku pro
sedmisegmentový displej (převod BCD na sedm segmentů) apod., takže zápis
akumulátoru na piny On neproběhne přímo, ale přes tento dekodér.</p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Aritmeticko-logická jednotka</h2>

<p>Aritmeticko-logická jednotka je pouze čtyřbitová, takže pro její realizaci
byla použita relativně malá plocha čipu (a taktéž jsou výpočty nepatrně
rychlejší). Vstupy do aritmeticko-logické jednotky se označují
<strong>P</strong> a <strong>N</strong>. Jedná se vlastně o multiplexory, které
na základě použité instrukce vybírají operandy (libovolnou kombinaci):</p>

<table>
<tr><th>Vstup P</th><th>Vstup N</th></tr>
<tr><td>registr Y</td><td>akumulátor/negovaný akumulátor</td></tr>
<tr><td>konstanta</td><td>konstanta</td></tr>
<tr><td>vstupní piny Kn</td><td>vstupní piny Kn</td></tr>
<tr><td>nibble z&nbsp;RAM</td><td>nibble z&nbsp;RAM</td></tr>
</table>

<p>Výstup z&nbsp;aritmeticko-logické jednotky je možné přímo zapsat do
akumulátoru či do registru Y. Pokud je zapotřebí provést zápis do RAM či výstup
na piny On, používá se přenos dat z&nbsp;akumulátoru.</p>



<p><a name="k11"></a></p>
<h2 id="k11">11. Instrukční soubor mikrořadičů TMS 1000</h2>

<p>Základní (standardní) instrukční soubor dostupný bez modifikace PLA sestává
z&nbsp;pouhých 43 instrukcí, které jsou vypsány v&nbsp;tabulce. Většina
aritmetických instrukcí nastavuje příznakový bit podle toho, zda došlo
k&nbsp;přetečení, tj.&nbsp;výsledek je větší než 15. Instrukce testující bit
v&nbsp;paměti nastavují příznakový bit podle obsahu načteného bitu
z&nbsp;paměti atd.:</p>

<table>
<tr><th>Instrukce</th><th>Význam</th></tr>
<tr><td>TAY</td><td>přenos nibble z&nbsp;akumulátoru do registru Y</td></tr>
<tr><td>TYA</td><td>přenos nibble z&nbsp;registru Y do akumulátoru</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>TAM</td><td>uložení akumulátoru do RAM</td></tr>
<tr><td>TAMIY</td><td>dtto, ale zvýší se hodnota index registru Y</td></tr>
<tr><td>TAMZA</td><td>kombinace TAM+CLA</td></tr>
<tr><td>TMA</td><td>načtení nibble z&nbsp;RAM do akumulátoru</td></tr>
<tr><td>XMA</td><td>prohození obsahu akumulátoru a buňky RAM</td></tr>
<tr><td>TMY</td><td>přenos nibble z&nbsp;RAM do registru Y</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>CLA</td><td>vynulování akumulátoru</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>AMAAC</td><td>součet akumulátor + nibble z RAM</td></tr>
<tr><td>SAMAN</td><td>rozdíl nibble z RAM - akumulátor</td></tr>
<tr><td>IMAC</td><td>inkrementace nibble v&nbsp;RAM + přenos do akumulátoru</td></tr>
<tr><td>DMAN</td><td>dekrementace nibble v&nbsp;RAM + přenos do akumulátoru</td></tr>
<tr><td>IA</td><td>inkrementace akumulátoru</td></tr>
<tr><td>IYC</td><td>inkrementace registru Y</td></tr>
<tr><td>DAN</td><td>dekrementace akumulátoru</td></tr>
<tr><td>DYN</td><td>dekrementace registru Y</td></tr>
<tr><td>A6AAC</td><td>přičtení 6 k&nbsp;akumulátoru (pro BCD aritmetiku)</td></tr>
<tr><td>A8AAC</td><td>přičtení 8 k&nbsp;akumulátoru</td></tr>
<tr><td>A10AAC</td><td>přičtení 10 k&nbsp;akumulátoru</td></tr>
<tr><td>CPAIZ</td><td>negace akumulátoru + jeho inkrementace</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>ALEM</td><td>porovnání akumulátoru s&nbsp;buňkou paměti na relaci &le;</td></tr>
<tr><td>ALEC</td><td>porovnání akumulátoru s&nbsp;konstantou na relaci &le;</td></tr>
<tr><td>MNEZ</td><td>porovnání nibble z&nbsp;RAM s&nbsp;nulou (test na nulovost)</td></tr>
<tr><td>YNEA</td><td>porovnání registru Y a akumulátoru na relaci &ne;</td></tr>
<tr><td>YNEC</td><td>porovnání registru Y s&nbsp;konstantou na relaci &ne;</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>SBIT</td><td>nastavení bitu v&nbsp;RAM na 1</td></tr>
<tr><td>RBIT</td><td>vynulování bitu v&nbsp;RAM</td></tr>
<tr><td>TBIT1</td><td>test bitu v&nbsp;RAM na jedničku</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>TCY</td><td>načtení konstanty do registru Y</td></tr>
<tr><td>TCMIY</td><td>uložení konstanty do RAM + IYC</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>KNEZ</td><td>test vstupů Kn na nulu</td></tr>
<tr><td>TKA</td><td>uložení vstupů Kn do akumulátoru</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>SETR</td><td>nastavení výstupů Rn</td></tr>
<tr><td>RSTR</td><td>vynulování výstupů Rn</td></tr>
<tr><td>TDO</td><td>na výstupy On se přenese obsah akumulátoru + latche (záchytného registru)</td></tr>
<tr><td>CLO</td><td>vynulování latche</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>LDX</td><td>načtení konstanty do registru X (jen 2 či 3 bity)</td></tr>
<tr><td>COMX</td><td>negace registru X</td></tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>BR</td><td>podmíněný skok na základě příznakového bitu</td></tr>
<tr><td>CALL</td><td>volání subrutiny</td></tr>
<tr><td>RETN</td><td>návrat ze subrutiny</td></tr>
<tr><td>LDP</td><td>změna stránkového registru</td></tr>
</table>

<p>Poznámka: podobnost některých instrukcí s&nbsp;MOS 6502 je pravděpodobně
čistě náhodná.</p>



<p><a name="k12"></a></p>
<h2 id="k12">12. Použití čipů TMS 1000</h2>

<p>Čipy TMS 1000 nalezneme především v&nbsp;dobových kalkulačkách, jak těch
základních, tak i kalkulačkách umožňujících provádět statistické výpočty,
počítat goniometrické či logaritmické funkce apod. Příkladem mohou být
kalkulačky <a href="http://www.datamath.org/Sci/WEDGE/sr-16.htm">SR-16</a> (SR
znamená &bdquo;slide rule&ldquo;, tedy logaritmické pravítko :-) a <a
href="http://www.datamath.org/Sci/WEDGE/sr-16-ii.htm">SR-16II</a>, TI-35
(neplést s&nbsp;HP-35) a desítky dalších typů, včetně <a
href="http://www.datamath.org/Related/Canon/MD-8.htm">Canon Palmtronic
MD-8</a>, který jako první kapesní kalkulačka měla dva řádky čísel.</p>

<p>Mezi poněkud neobvyklé kalkulačky patří <a
href="http://www.datamath.org/Related/Kosmos/Kosmos2.htm">Kosmos2</a>
s&nbsp;výpočtem biorytmů a <a
href="http://www.datamath.org/Related/Kosmos/Astro.htm">Astro</a> pro (velmi
jednoduché) výpočty horoskopů. Ovšem s&nbsp;jedním malým háčkem &ndash; výpočty
platí jen do 31.12.1999.</p>

<p>Nesmíme zapomenout na elektronické hry a elektronické hračky, v&nbsp;nichž
byl TMS 1000 či některá jeho varianta použit:</p>

<ul>
<li><a href="http://www.robotroom.com/BigTrak.html">BigTrak</a> (programovatelný robot!)</li>
<li><a href="http://handheldmuseum.com/Tiger/Copycat.htm">Tiger</a></li>
<li><a href="https://boardgamegeek.com/boardgame/4122/electronic-battleship">Electronic battleship</a></li>
<li><a href="http://handheldmuseum.com/Entex/Soccer.htm">Soccer</a></li>
<li><a href="http://www.handheldmuseum.com/Entex/SpaceBattle.htm">Space Battle</a></li>
</ul>

<a href="https://www.root.cz/obrazek/284548/"><img src="https://i.iinfo.cz/images/208/tms1000-7-prev.jpg" class="image-284548" alt="&#160;" width="370" height="191" /></a></p>
<p><i>Obrázek 7: Před Facebookem a smartphony se zprávy po třídě posílaly <a
href="https://en.wikipedia.org/wiki/Calculator_spelling">kalkulačkami, třeba i
oblíbenou TI-35</a>.</i></p>



<p><a name="k13"></a></p>
<h2 id="k13">13. Kapesní herní konzole MicroVision</h2>

<p>Poněkud neobvyklé bylo použití čipu TMS 1000 v&nbsp;kapesní herní konzoli
MicroVision. Tato konzole se výrazně lišila od známých her s&nbsp;LED či LCD,
které se začaly rozšiřovat v&nbsp;polovině sedmdesátých let minulého století (u
nás poněkud později). Konzole s&nbsp;LED byly velmi primitivní (například
<i>Mattel's Auto Race</i> z&nbsp;konce roku 1976), ale s&nbsp;vývojem LCD došlo
k&nbsp;náhradě LED právě za displeje z&nbsp;tekutých krystalů, což kromě menší
spotřeby přineslo i možnost vykreslení herní scény s&nbsp;využitím prakticky
libovolných tvarů (v&nbsp;našich končinách bylo důležité, že se kapesní hry
s&nbsp;LCD začaly vyrábět i v&nbsp;SSSR, pravděpodobně nejznámější je hra
<i>Jen Počkej &ndash; IM-02</i>).</p>

<img src="http://i.iinfo.cz/images/671/8904.jpg" width="304" height="500" alt="&#160;" />
<p><i>Obrázek 8: Pohled na konzoli Mattel's Auto Race.</i></p>

<p>Taktéž se rozšiřovaly možnosti ovladačů, protože výrobci kapesních konzolí
začali jednoduchá tlačítka nahrazovat či spíše doplňovat o takzvaný <i>D-pad
(joypad)</i>, malé joysticky, dotykové displeje atd. atd. Bylo jen otázkou
času, kdy se objeví konzole univerzální s&nbsp;maticovým displejem.</p>

<img src="http://i.iinfo.cz/images/455/8914.jpg" width="450" height="338" alt="&#160;" />
<p><i>Obrázek 9: Příklad specializované herní konzole: slavná hra &bdquo;Jen
Počkej&ldquo; (IM-2).</i></p>

<p>První kapesní herní konzolí vybavenou displejem z&nbsp;tekutých krystalů,
jenž umožňoval zobrazit rastrový obraz, byla herní konzole nazvaná
<i>MicroVision</i>. Jedná se o velmi zajímavé a přitom po konstrukční stránce
dosti jednoduché zařízení, protože se vlastní konzole vlastně skládala pouze
z&nbsp;displeje, napájecí části a ovladače (několika tlačítek). Veškeré další
elektronické součástky, zejména mikroprocesor, paměť RAM i paměť ROM, nebyly
umístěny přímo na konzoli, ale musely být součástí cartridge se hrou. To je
velmi neobvyklé řešení, které alespoň teoreticky umožňovalo velkou variabilitu,
jenž byla dokonce využita, protože původní cartridge obsahovaly buď osmibitový
mikroprocesor <i>Intel 8021</i> (přesněji řečeno se jednalo o mikrořadič,
konkrétně o variantu čipu <i>8048</i>) dnes popisovaný <i>TMS 1000</i>.</p>

<img src="http://i.iinfo.cz/images/265/8917.png" width="249" height="469" alt="&#160;" />
<p><i>Obrázek 10: Hra pro simulátor konzole MicroVision: Bowling simulator.
Povšimněte si &bdquo;simulace&ldquo; barev s&nbsp;použitím barevné fólie, která
se nasadila před displej. Podobné řešení jsme již viděli v&nbsp;seriálu o
historii her u herní konzole Vectrex s&nbsp;monochromatickým vektorovým
displejem.</i></p>

<p>Nejdůležitější součástí herní konzole <i>MicroVision</i> je však bezesporu
její grafická část. Displej z&nbsp;tekutých krystalů byl sice rastrový, ovšem
jeho rozlišení pravděpodobně nikoho z&nbsp;dnešních čtenářů příliš nenadchne,
protože dosahovalo pouhých 16&times;16 pixelů (navíc bez možnosti použití více
stupňů šedi). Pixely tedy byly ve skutečnosti představovány poměrně velkými
čtverci, nicméně i přesto se jednalo o určitý krok vpřed, protože herní scéna
mohla být velmi variabilní (ono 2<sup>256</sup> možných kombinací není úplně
malé číslo :-). Toho samozřejmě využili i výrobci her, protože her určených pro
<i>MicroVision</i> vzniklo přibližně 15, což sice není nijak vysoké číslo, ale
musíme si uvědomit, že se jedná o konzoli z&nbsp;roku 1979. Jedním
z&nbsp;problémů, s&nbsp;nimiž se musí vyrovnat současní majitelé těchto
konzolí, je především malá životnost použitého displeje, který postupně tmavne,
což je ovšem i problém provázející některé první digitálky, které jsou taktéž
sběratelským artiklem.</p>

<img src="http://i.iinfo.cz/images/228/8918.png" width="250" height="477" alt="&#160;" />
<p><i>Obrázek 11: Hra pro simulátor konzole Microvision: Phaser Strike.</i></p>



<p><a name="k14"></a></p>
<h2 id="k14">14. Odkazy na Internetu</h2>

<ol>

<li>PMOS<br />
<a href="https://en.wikipedia.org/wiki/PMOS_logic">https://en.wikipedia.org/wiki/PMOS_logic</a>
</li>

<li>NMOS<br />
<a href="https://en.wikipedia.org/wiki/NMOS_logic">https://en.wikipedia.org/wiki/NMOS_logic</a>
</li>

<li>CMOS<br />
<a href="https://en.wikipedia.org/wiki/CMOS">https://en.wikipedia.org/wiki/CMOS</a>
</li>

<li>Vacuum Fluorescent Display<br />
<a href="https://en.wikipedia.org/wiki/Vacuum_fluorescent_display">https://en.wikipedia.org/wiki/Vacuum_fluorescent_display</a>
</li>

<li>Computer History Museum: TMS 1000 4-Bit microcontroller<br />
<a href="http://www.computerhistory.org/collections/catalog/102711697">http://www.computerhistory.org/collections/catalog/102711697</a>
</li>

<li>Texas Instruments TMS1000 microcontroller family<br />
<a href="http://www.cpu-world.com/CPUs/TMS1000/">http://www.cpu-world.com/CPUs/TMS1000/</a>
</li>

<li>Invention History of Microcontroller<br />
<a href="http://www.circuitstoday.com/microcontroller-invention-history">http://www.circuitstoday.com/microcontroller-invention-history</a>
</li>

<li>TMS1000 Series - TI<br />
<a href="https://en.wikichip.org/wiki/ti/tms1000">https://en.wikichip.org/wiki/ti/tms1000</a>
</li>

<li>TMX1795 - TI<br />
<a href="https://en.wikichip.org/wiki/ti/tmx1795">https://en.wikichip.org/wiki/ti/tmx1795</a>
</li>

<li>Milton Bradley Microvision (U.S.) (1979, LCD, 9 Volt (1 or 2), Model# 4952)<br />
<a href="http://www.handheldmuseum.com/MB/uVUS.htm">http://www.handheldmuseum.com/MB/uVUS.htm</a>
</li>

<li>8051 Microcontroller<br />
<a href="http://www.circuitstoday.com/8051-microcontroller">http://www.circuitstoday.com/8051-microcontroller</a>
</li>

<li>4-bit (computer architectures)<br />
<a href="https://en.wikipedia.org/wiki/4-bit">https://en.wikipedia.org/wiki/4-bit</a>
</li>

<li>TMS 1000 Data Manual<br />
<a href="http://blog.kevtris.org/blogfiles/TMS_1000_Data_Manual.pdf">http://blog.kevtris.org/blogfiles/TMS_1000_Data_Manual.pdf</a>
</li>

<li>Considerations for 4-bit processing<br />
<a href="http://www.embeddedinsights.com/channels/2010/12/10/considerations-for-4-bit-processing/">http://www.embeddedinsights.com/channels/2010/12/10/considerations-for-4-bit-processing/</a>
</li>

<li>Are you, or would you consider, using a 4-bit microcontroller?<br />
<a href="http://www.embeddedinsights.com/channels/2010/11/24/are-you-or-would-you-consider-using-a-4-bit-microcontroller/">http://www.embeddedinsights.com/channels/2010/11/24/are-you-or-would-you-consider-using-a-4-bit-microcontroller/</a>
</li>

<li>MARC4 Micro-Controller<br />
<a href="https://en.wikipedia.org/wiki/MARC4_Micro-Controller">https://en.wikipedia.org/wiki/MARC4_Micro-Controller</a>
</li>

<li>The Texas Instruments TMX 1795: the (almost) first, forgotten microprocessor <br />
<a href="http://www.righto.com/2015/05/the-texas-instruments-tmx-1795-first.html">http://www.righto.com/2015/05/the-texas-instruments-tmx-1795-first.html</a>
</li>

<li>O2 Homepage<br />
<a href="http://www.the-nextlevel.com/odyssey2/">http://www.the-nextlevel.com/odyssey2/</a>
</li>

<li>Magnavox Odyssey2 (1978), Philips Videopac G7000 / C52 (1979)<br />
<a href="http://www.mess.org/sysinfo:odyssey2">http://www.mess.org/sysinfo:odyssey2</a>
</li>

<li>The Video Game Critic's Odyssey 2 Reviews <br />
<a href="http://videogamecritic.net/odd.htm">http://videogamecritic.net/odd.htm</a>
</li>

<li>Computer Closet Collection: Magnavox Odyssey^2<br />
<a href="http://www.computercloset.org/MagnavoxOdyssey2.htm">http://www.computercloset.org/MagnavoxOdyssey2.htm</a>
</li>

<li>PHILIPS Videopac C52<br />
<a href="http://old-computers.com/museum/computer.asp?c=1060">http://old-computers.com/museum/computer.asp?c=1060</a>
</li>

<li>O2 Tech. Manual V.1.1 (PDF dokument)<br />
<a href="http://www.atarihq.com/danb/files/o2doc.pdf">http://www.atarihq.com/danb/files/o2doc.pdf</a>
</li>

<li>Magnavox Odyssey<sup>2</sup><br />
<a href="http://www.game-machines.com/consoles/odyssey2.php">http://www.game-machines.com/consoles/odyssey2.php</a>
</li>

<li>Magnavox Odyssey<sup>2</sup> (Wikipedia EN)<br />
<a href="http://en.wikipedia.org/wiki/Odyssey_2">http://en.wikipedia.org/wiki/Odyssey_2</a>
</li>

<li>Magnavox Odyssey<sup>2</sup> Games (Wikipedia EN)<br />
<a href="http://en.wikipedia.org/wiki/List_of_Videopac_games">http://en.wikipedia.org/wiki/List_of_Videopac_games</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2017</small></p>
</body>
</html>

