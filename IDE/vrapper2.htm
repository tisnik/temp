<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Vrapper aneb spojení možností Vimu a Eclipse (část 2: vyhledávání a nahrazování textu)</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Vrapper aneb spojení možností Vimu a Eclipse (část 2: vyhledávání a nahrazování textu)</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>Ve druhé části článku o projektu Vrapper, který do integrovaného vývojového prostředí Eclipse přináší poměrně pokročilou emulaci funkcí Vimu, se seznámíme s&nbsp;některými dalšími důležitými vlastnostmi Vrapperu. Jedná se především o příkazy pro vyhledávání a nahrazování textu (substitute). Teprve s&nbsp;těmito funkcemi je možné možnosti Eclipse a Vrapperu využít skutečně naplno.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Vrapper aneb spojení možností Vimu a Eclipse (část 2: vyhledávání a nahrazování textu)</a></p>
<p><a href="#k02">2. Příkazy pro vyhledávání textu</a></p>
<p><a href="#k03">3. Nalezení n-tého výskytu textu</a></p>
<p><a href="#k04">4. Posun kurzoru po nalezení textu (přesun na jiný řádek či sloupec)</a></p>
<p><a href="#k05">5. Význam konfiguračních voleb <strong>ignorecase</strong> a <strong>smartcase</strong></a></p>
<p><a href="#k06">6. Použití regulárních výrazů při vyhledávání</a></p>
<p><a href="#k07">7. Příkaz pro vyhledání s&nbsp;nahrazením (<strong>substitute</strong>)</a></p>
<p><a href="#k08">8. Specifikace rozsahu nahrazování</a></p>
<p><a href="#k09">9. Rozsah nahrazování zadaný pomocí vyhledávacích příkazů</a></p>
<p><a href="#k10">10. Význam některých přepínačů příkazu <strong>substitute</strong></a></p>
<p><a href="#k11">11. Obsah třetí části článku</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Vrapper aneb spojení možností Vimu a Eclipse (část 2: vyhledávání a nahrazování textu)</h2>

<p><a href="http://mojefedora.cz/vrapper-aneb-spojeni-moznosti-vimu-a-eclipse/">V&nbsp;úvodní části</a> článku o projektu <i>Vrapper</i>, který do integrovaného vývojového prostředí <a href="http://mojefedora.cz/eclipse-integrovane-vyvojove-prostredi-pro-javu-i-dalsi-programovaci-jazyky/">Eclipse</a> přidává emulaci chování populárního textového editoru Vim, jsme se seznámili s&nbsp;tím, jakým způsobem se Vrapper do Eclipse instaluje a jak se používá namísto výchozího programátorského editoru, jenž je standardní součástí Eclipse. Taktéž jsme si řekli, které vlastnosti Vimu jsou ve Vrapperu podporovány. Připomeňme si jen ve stručnosti, že je samozřejmě možné používat všechny základní režimy práce Vimu (normální, příkazový, vkládací, přepisovací, vizuální atd.), k&nbsp;dispozici jsou taktéž prakticky všechny editační příkazy a operátory (<i>yank</i>, <i>delete</i>, <i>change</i>, <i>shift</i>), příkaz pro vyhledávání a nahrazování textu, definovat je možné značky a používat lze i registry (přesněji řečeno alespoň většinu běžně používaných registrů).</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/06.png"><img class="alignnone size-medium wp-image-5961" src="http://mojefedora.cz/wp-content/uploads/2015/11/06-450x379.png" alt="06" width="450" height="379" /></a>
<p><i>Obrázek 1: Průběh instalace pluginu Vrapper. Do tohoto dialogu je nutné zadat adresu (URL), na níž se nachází balíček Vrapper. Tato adresa zní <strong>http://vrapper.sourceforge.net/update-site/stable</strong>. Po potvrzení se objeví krátká zpráva &bdquo;Pending&ldquo; a posléze by se měly vypsat všechny balíčky, které byly na uvedené adrese nalezeny.</i></p>

<p>Ve druhé a posléze i ve třetí části článku o přídavném modulu <i>Vrapper</i> si ukážeme některé pokročilejší možnosti, které tento plugin vývojářům i dalším uživatelům integrovaného vývojového prostředí Eclipse přináší. Nejdříve si podrobněji popíšeme dva základní příkazy pro práci s&nbsp;textem: jedná se o příkaz pro <a href="#k02">vyhledávání</a> (stručně zmíněný již minule) a taktéž o příkaz pro <a href="#k07">vyhledávání se současným nahrazováním</a> textu. Možnosti těchto dvou příkazů jsou velmi široké a to mj.&nbsp;i proto, že je možné použít regulární výrazy, o čemž se zmíníme <a href="#k06">v&nbsp;šesté kapitole</a> a u příkazu <strong>substitute</strong> i oblast v&nbsp;dokumentu, kde se má vyhledávání a nahrazování provést.</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/12.png"><img class="alignnone size-medium wp-image-5967" src="http://mojefedora.cz/wp-content/uploads/2015/11/12-450x289.png" alt="12" width="450" height="289" /></a>
<p><i>Obrázek 2: Pokud se v&nbsp;integrovaném vývojovém prostředí objevila tato ikona, podařilo se Vrapper korektně nainstalovat a následně inicializovat. Instalace je podrobněji popsána <a href="http://mojefedora.cz/vrapper-aneb-spojeni-moznosti-vimu-a-eclipse/">v&nbsp;první části</a> tohoto článku.</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Příkazy pro vyhledávání textu</h2>

<p>Se základními příkazy sloužícími k&nbsp;vyhledávání textu (například ve zdrojových kódech) jsme se již seznámili minule. Připomeňme si tedy, že pro vyhledávání ve zdrojovém kódu se používají příkazy <strong>/</strong> a <strong>?</strong>, přičemž první příkaz hledá směrem dolů (od aktuální pozice kurzoru směrem ke konci souboru), zatímco příkaz druhý naopak směrem k&nbsp;začátku zdrojového textu. Po zadání <strong>/</strong> či <strong>?</strong> editor očekává regulární výraz ukončený klávesou Enter. Po vyhledání prvního výskytu textu odpovídajícího regulárnímu výrazu lze použít příkaz <strong>n</strong> pro nalezení dalšího výskytu či <strong>N</strong> pro nalezení výskytu předchozího (povšimněte si zde logiky: klávesa Shift vždy mění směr vyhledávání, minimálně na anglické klávesnici). Alternativně lze hledat výskyt jediného znaku příkazy <strong>f</strong> (<i>find</i>) a <strong>t</strong> (<i>till</i>), pro které opět existuje i verze hledající směrem zpět: <strong>F</strong> a <strong>T</strong>. Třetí možnost představují příkazy <strong>*</strong> a <strong>#</strong> určené pro hledání dalšího/předchozího identifikátoru, přičemž identifikátor se nachází pod kurzorem (tyto příkazy jsou velmi užitečné a vyplatí se je naučit používat, zejména při práci s&nbsp;rozsáhlejšími zdrojovými kódy).</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/19.png"><img class="alignnone size-medium wp-image-5974" src="http://mojefedora.cz/wp-content/uploads/2015/11/19-450x271.png" alt="19" width="450" height="271" /></a>
<p><i>Obrázek 3: Zvýraznění vyhledaných částí textu je možné ovlivnit volbami <strong>hlsearch</strong> a <strong>incsearch</strong>. Na tomto screenshotu jsou použity (zapnuty) obě volby.</i></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Nalezení n-tého výskytu textu</h2>

<p>Nyní se podrobněji zaměřme především na příkazy <strong>/</strong> a <strong>?</strong> zmíněné již v&nbsp;předchozí kapitole. Tyto příkazy totiž umožňují, aby se k&nbsp;vyhledávanému textu popř.&nbsp;k&nbsp;regulárnímu výrazu přidaly i další nepovinné parametry ovlivňující vyhledávání. Před samotným příkazem se může &ndash; podobně jako je tomu u mnoha dalších příkazů &ndash; uvést nějaké číslo rozdílné od nuly (nula je totiž sama o sobě příkazem &ndash; skok na začátek řádku). Toto číslo má jednoduchý význam: při jeho použití se nevyhledá nejbližší text odpovídající zadanému regulárnímu výrazu, ale nalezne se až <i>n</i>-tý výskyt tohoto textu. Tato vlastnost se může použít například při tvorbě maker apod. Chování příkazu <strong>/</strong>, před nímž je zadáno nějaké kladné číslo, je ukázáno na následující trojici screenshotů:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/041.png"><img class="alignnone size-medium wp-image-6111" src="http://mojefedora.cz/wp-content/uploads/2015/11/041-450x274.png" alt="04" width="450" height="274" /></a>
<p><i>Obrázek 4: Kurzor je před použitím příkazu <strong>/</strong> umístěn na začátek zdrojového souboru.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/051.png"><img class="alignnone size-medium wp-image-6112" src="http://mojefedora.cz/wp-content/uploads/2015/11/051-450x274.png" alt="05" width="450" height="274" /></a>
<p><i>Obrázek 5: Po zadání příkazu <strong>/final[Enter]</strong> se kurzor přesune na místo označené červeným obdélníkem.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/061.png"><img class="alignnone size-medium wp-image-6113" src="http://mojefedora.cz/wp-content/uploads/2015/11/061-450x274.png" alt="06" width="450" height="274" /></a>
<p><i>Obrázek 6: Pokud se namísto příkazu <strong>/final[Enter]</strong> použije <strong>3/final[Enter]</strong>, přesune se kurzor až na třetí výskyt slova &bdquo;final&ldquo;.</i></p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Posun kurzoru po nalezení textu (přesun na jiný řádek či sloupec)</h2>

<p>Kromě přesunu kurzoru na první nalezený text popř.&nbsp;alternativně na <i>n</i>-tý nalezený text je možné specifikovat, kam přesně se má kurzor posunout relativně od nalezeného textu. Pokud se zadá vyhledávací příkaz ve stylu <strong>/text/číslo[Enter]</strong> či <strong>/text/+číslo[Enter]</strong>, nalezne se odpovídající text a ihned poté se kurzor přesune o zadaný počet řádků níže. Podobně pro příkaz <strong>/text/-číslo[Enter]</strong> dojde k&nbsp;posunu na řádky umístěné nad nalezeným textem. Taktéž je možné použít <strong>/text/s+číslo[Enter]</strong> či <strong>/text/e+číslo[Enter]</strong> pro relativní posun přímo na řádku, kde byl text nalezen. Znak &bdquo;s&ldquo; specifikuje začátek nalezeného textu (resp.&nbsp;relativní posun od začátku textu), zatímco znak &bdquo;e&ldquo; konec nalezeného textu. Opět se podívejme na ilustrační screenshoty:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/071.png"><img class="alignnone size-medium wp-image-6114" src="http://mojefedora.cz/wp-content/uploads/2015/11/071-450x274.png" alt="07" width="450" height="274" /></a>
<p><i>Obrázek 7: Před zadáním příkazu <strong>/final/10[Enter]</strong> se kurzor nachází na začátku zdrojového kódu.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/081.png"><img class="alignnone size-medium wp-image-6115" src="http://mojefedora.cz/wp-content/uploads/2015/11/081-450x274.png" alt="08" width="450" height="274" /></a>
<p><i>Obrázek 8: Po zadání příkazu <strong>/final/10[Enter]</strong> se kurzor přesune na desátý řádek pod první nalezené slovo &bdquo;final&ldquo; (aktuální řádek je zvýrazněn podsvícením).</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/091.png"><img class="alignnone size-medium wp-image-6116" src="http://mojefedora.cz/wp-content/uploads/2015/11/091-450x274.png" alt="09" width="450" height="274" /></a>
<p><i>Obrázek 9: Před zadáním příkazu <strong>/final/-1[Enter]</strong> se kurzor opět nachází na začátku zdrojového kódu (shodná pozice, jako na obrázku číslo 7).</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/101.png"><img class="alignnone size-medium wp-image-6117" src="http://mojefedora.cz/wp-content/uploads/2015/11/101-450x274.png" alt="10" width="450" height="274" /></a>
<p><i>Obrázek 10: Po zadání příkazu <strong>/final/-1[Enter]</strong> se kurzor přesune na řádek před prvním výskytem slova &bdquo;final&ldquo;.</i></p>

<p>U příkazu <strong>?text</strong> (hledání směrem k&nbsp;začátku souboru) je nutné dát pozor na to, že i druhý znak před číslem musí být otazník, tj.&nbsp;správná syntaxe je <strong>?text?číslo[Enter]</strong>. Situace při použití příkazu <strong>?</strong> vypadá takto:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/111.png"><img class="alignnone size-medium wp-image-6118" src="http://mojefedora.cz/wp-content/uploads/2015/11/111-450x274.png" alt="11" width="450" height="274" /></a>
<p><i>Obrázek 11: Před zadáním příkazu <strong>?public?2[Enter]</strong> se kurzor nachází na konci zdrojového kódu.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/121.png"><img class="alignnone size-medium wp-image-6119" src="http://mojefedora.cz/wp-content/uploads/2015/11/121-450x274.png" alt="12" width="450" height="274" /></a>
<p><i>Obrázek 12: Průběh zadávání příkazu <strong>?public?2[Enter]</strong>.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/131.png"><img class="alignnone size-medium wp-image-6120" src="http://mojefedora.cz/wp-content/uploads/2015/11/131-450x274.png" alt="13" width="450" height="274" /></a>
<p><i>Obrázek 13: Po zadání příkazu <strong>?public?2[Enter]</strong> se sice vysvítí slovo &bdquo;public&ldquo;, ale kurzor se posune o dva řádky níže.</i></p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Význam konfiguračních voleb <strong>ignorecase</strong> a <strong>smartcase</strong></h2>

<p>Při vyhledávání ve zdrojových kódech (či v&nbsp;jiných textových souborech) s&nbsp;využitím příkazů <strong>/</strong> a <strong>?</strong> lze specifikovat, zda se mají při vyhledávání rozlišovat malá a velká písmena, tj.&nbsp;zda se například při zadání příkazu <strong>/hello[Enter]</strong> nalezne i řetězec &bdquo;Hello&ldquo; či nikoli. K&nbsp;nastavení této vlastnosti slouží konfigurační volby <strong>ignorecase</strong> a <strong>smartcase</strong>. Tyto volby jsou nastavovány příkazem <strong>:set</strong> a vzhledem k&nbsp;tomu, že se jedná o přepínač (pravdivostní hodnotu), jsou k&nbsp;dispozici následující možnosti, které je možné zadat v&nbsp;příkazovém režimu, tj.&nbsp;po stisku dvojtečky:</p>

<pre>
:set ignorecase
:set noignorecase
:set smartcase
:set nosmartcase
</pre>

<p>Význam jednotlivých nastavení je následující:</p>

<table>
<tr><th>Volba</th><th>Stručný popis</th></tr>
<tr><td>ignorecase</td><td>při vyhledávání se bude ignorovat velikost písmen ve vyhledávaném textu</td></tr>
<tr><td>noignorecase</td><td>opak předchozí volby, velikost písmen se nebude ignorovat</td></tr>
<tr><td>smartcase</td><td>velikost písmen se bude ignorovat pouze ve chvíli, kdy má vyhledávaný text pouze malá písmena</td></tr>
<tr><td>nosmartcase</td><td>chování plně závisí na nastavení ignorecase/noignorecase</td></tr>
</table>

<p>V&nbsp;praxi tyto volby ovlivní vyhledávání způsobem, jenž je naznačen na následujících screenshotech:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/141.png"><img class="alignnone size-medium wp-image-6121" src="http://mojefedora.cz/wp-content/uploads/2015/11/141-450x274.png" alt="14" width="450" height="274" /></a>
<p><i>Obrázek 14: Vyhledání řetězce &bdquo;hello&ldquo;, nastavené volby <strong>noignorecase</strong> a <strong>nosmartcase</strong>.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/151.png"><img class="alignnone size-medium wp-image-6122" src="http://mojefedora.cz/wp-content/uploads/2015/11/151-450x274.png" alt="15" width="450" height="274" /></a>
<p><i>Obrázek 15: Vyhledání řetězce &bdquo;Hello&ldquo;, nastavené volby <strong>noignorecase</strong> a <strong>nosmartcase</strong>.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/161.png"><img class="alignnone size-medium wp-image-6123" src="http://mojefedora.cz/wp-content/uploads/2015/11/161-450x274.png" alt="16" width="450" height="274" /></a>
<p><i>Obrázek 16: Vyhledání řetězce &bdquo;Hello&ldquo;, nastavené volby <strong>ignorecase</strong> a <strong>nosmartcase</strong>.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/171.png"><img class="alignnone size-medium wp-image-6124" src="http://mojefedora.cz/wp-content/uploads/2015/11/171-450x274.png" alt="17" width="450" height="274" /></a>
<p><i>Obrázek 17: Vyhledání řetězce &bdquo;Hello&ldquo;, nastavené volby <strong>ignorecase</strong> a <strong>smartcase</strong>.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/181.png"><img class="alignnone size-medium wp-image-6125" src="http://mojefedora.cz/wp-content/uploads/2015/11/181-450x274.png" alt="18" width="450" height="274" /></a>
<p><i>Obrázek 18: Vyhledání řetězce &bdquo;hello&ldquo;, nastavené volby <strong>ignorecase</strong> a <strong>smartcase</strong></i>.</p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Použití regulárních výrazů při vyhledávání</h2>

<p>Vzhledem k&nbsp;tomu, že vyhledávaný vzorek může obsahovat regulární výraz, otevírají se zde uživatelům přídavného modulu <i>Vrapper</i> velmi široké možnosti. Díky použití regulárních výrazů je totiž možné specifikovat jak různé skupiny znaků (čísla, alfanumerické znaky atd.), tak i přesně stanovit, kolikrát se tyto znaky ve vyhledávaném textu mohou objevit.</p>

<p>V&nbsp;regulárních výrazech je možné při vyhledávání v&nbsp;textu použít několik skupin znaků se speciálním významem. Následující znaky reprezentují začátek a konec řádku nebo slova, takže je možné například jednoduše nalézt slovo nacházející se na začátku řádku apod.:</p>

<table>
<tr><th>Znak(y) v&nbsp;regexpu</th><th>Význam</th></tr>
<tr><td>^</td><td>začátek řádku</td></tr>
<tr><td>$</td><td>konec řádku</td></tr>
<tr><td>\&lt;</td><td>začátek slova</td></tr>
<tr><td>\&gt;</td><td>konec slova</td></tr>
</table>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/191.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/191-450x274.png" alt="19" width="450" height="274" class="alignnone size-medium wp-image-6134" /></a>
<p><i>Obrázek 19: Vyhledání slova začínajícího znakem &bdquo;p&ldquo;. Příkaz pro vyhledání tohoto slova (či slov) vypadá následovně: <strong>/\&lt;p</strong></i></p>

<p>Specifikovat je možné i různé speciální znaky, které se mohou ve zdrojových kódech či jiných textových souborech v&nbsp;některých případech vyskytovat (pravděpodobně nejčastěji se setkáte se znakem Tab):</p>

<table>
<tr><th>Znak(y) v&nbsp;regexpu</th><th>Význam</th></tr>
<tr><td>\e</td><td>Esc</td></tr>
<tr><td>\t</td><td>Tab</td></tr>
<tr><td>\r</td><td>CR</td></tr>
<tr><td>\b</td><td>Backspace</td></tr>
<tr><td>\n</td><td>Konec řádku</td></tr>
</table>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/201.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/201-450x274.png" alt="20" width="450" height="274" class="alignnone size-medium wp-image-6135" /></a>
<p><i>Obrázek 20: Vyhledání znaku &bdquo;=&ldquo;, který je uveden za koncem slova. Mezi koncem slova a znakem &bdquo;=&ldquo; se může nacházet libovolné množství takzvaných bílých znaků (mezer, Tabů). Příkaz pro vyhledání vypadá následovně: <strong>/\&gt;\s*=</strong></i></p>

<p>Namísto jediného znaku se může v&nbsp;regulárním výrazu použít i množina znaků definovaná buď výčtem nebo rozsahem. Podívejme se na několik příkladů:</p>

<table>
<tr><th>Znak(y) v&nbsp;regexpu</th><th>Význam</th></tr>
<tr><td>[rgb]</td><td>jeden za znaků &bdquo;r&ldquo;, &bdquo;g&ldquo; či &bdquo;b&ldquo;</td></tr>
<tr><td>[rgb01]</td><td>jeden za znaků &bdquo;r&ldquo;, &bdquo;g&ldquo;, &bdquo;b&ldquo;, &bdquo;0&ldquo; či &bdquo;1&ldquo;</td></tr>
<tr><td>[a-z]</td><td>jeden ze znaků malé abecedy</td></tr>
<tr><td>[a-zA-Z]</td><td>jeden ze znaků malé či velké abecedy</td></tr>
<tr><td>[0-9]</td><td>libovolná číslice</td></tr>
<tr><td>[^a-z]</td><td>negace, vše kromě znaku malé abecedy</td></tr>
<tr><td>[^0-9]</td><td>negace, vše kromě číslice</td></tr>
</table>

<p>V&nbsp;regulárních výrazech je možné použít i takzvané třídy znaků, zejména:</p>
 
<table>
<tr><th>Znak(y) v&nbsp;regexpu</th><th>Význam</th></tr>
<tr><td>. </td><td>libovolný znak v&nbsp;textu</td></tr>
<tr><td>\s</td><td>tzv. bílý znak (mezera, Tab)</td></tr>
<tr><td>\S</td><td>opak předchozího, tj.&nbsp;vše kromě bílých znaků</td></tr>
<tr><td>\d</td><td>decimální číslice</td></tr>
<tr><td>\D</td><td>opak předchozího (jakýkoli znak mimo číslice)</td></tr>
<tr><td>\w</td><td>znaky A-Z, a-z a podtržítko</td></tr>
<tr><td>\W</td><td>opak předchozího</td></tr>
</table>

<p>Poznámka: některé třídy znaků, které bylo možné použít v&nbsp;originálním textovém editoru Vimu, nejsou ve Vrapperu (alespoň prozatím, tj.&nbsp;v&nbsp;jeho aktuální verzi) podporovány.</p>

<p>U jednotlivých znaků či jejich skupin lze v&nbsp;případě potřeby specifikovat i počet opakování:</p>

<table>
<tr><th>Znak(y) v&nbsp;regexpu</th><th>Význam</th></tr>
<tr><td>*</td><td>nula nebo více opakování</td></tr>
<tr><td>+</td><td>jedno nebo více opakování</td></tr>
<tr><td>\{n,m}</td><td>od <i>n</i> do <i>m</i> opakování</td></tr>
<tr><td>\{n,}</td><td>od <i>n</i> opakování</td></tr>
</table>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/211.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/211-450x274.png" alt="21" width="450" height="274" class="alignnone size-medium wp-image-6136" /></a>
<p><i>Obrázek 21: Vyhledání všech slov s&nbsp;délkou od pěti do deseti znaků. Příkaz pro vyhledání vypadá následovně: <strong>/\w{5,10}</strong></i></p>



<p><a name="k07"></a></p>
<h2 id="k07">7. Příkaz pro vyhledání s&nbsp;nahrazením (<strong>substitute</strong>)</h2>

<p>Velmi užitečným příkazem, s&nbsp;nímž se můžeme setkat jak v&nbsp;textovém editoru <i>Vim</i>, tak i ve <i>Vrapperu</i>, je příkaz pojmenovaný <strong>substitute</strong>. Jak již název tohoto příkazu naznačuje, používá se ve chvíli, kdy je nutné ve zdrojovém kódu provést náhradu nějakého textového vzorku za jiný text. Ve skutečnosti jsou však možnosti příkazu <strong>substitute</strong> mnohem větší, než je tomu u klasických příkazů typu &bdquo;Najdi a nahraď&ldquo;, které mohou mnozí uživatelé znát z&nbsp;dalších typů textových editorů, a to zejména z&nbsp;toho důvodu, že v&nbsp;<strong>substitute</strong> lze použít regulární výrazy a navíc je možné ovlivnit, se kterou částí zdrojového kódu má příkaz <strong>substitute</strong> pracovat. Úplný tvar tohoto příkazu vypadá následovně:</p>

<pre>
:[rozsah]s/vyhledávaný_vzorek/nahrazující_text/[přepínače]
</pre>

<p>popř:</p>

<pre>
:[rozsah]substitute/vyhledávaný_vzorek/nahrazující_text/[přepínače]
</pre>

<p>Přičemž <i>[rozsah]</i> a <i>[přepínače]</i> nemusí být uvedeny, takže v&nbsp;nejjednodušším případě vypadá příkaz <strong>substitute</strong> takto (v&nbsp;této podobě se nalezne a nahradí text pouze na aktuálním řádku):</p>

<pre>
:s/vyhledávaný_vzorek/nahrazující_text
</pre>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/221.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/221-450x274.png" alt="22" width="450" height="274" class="alignnone size-medium wp-image-6137" /></a>
<p><i>Obrázek 22: Nahrazení slova &bdquo;private&ldquo; za slovo &bdquo;protected&ldquo;, ovšem pouze na aktuálním řádku.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/231.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/231-450x274.png" alt="23" width="450" height="274" class="alignnone size-medium wp-image-6138" /></a>
<p><i>Obrázek 23: Výsledek zavolání příkazu <strong>:s/private/protected/</strong></i></p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Specifikace rozsahu nahrazování</h2>

<p>V&nbsp;mnoha případech však nechceme nahrazovat pouze text, který se nachází na jednom řádku &ndash; potom je nutné specifikovat rozsah. Pokud se má nahrazení provést v&nbsp;celém zdrojovém kódu (velmi častý požadavek), může se použít znak % způsobem, jaký je naznačen na následující dvojici screenshotů:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/24.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/24-450x274.png" alt="24" width="450" height="274" class="alignnone size-medium wp-image-6139" /></a>
<p><i>Obrázek 24: Nahrazení všech slov &bdquo;static&ldquo; za &bdquo;xyzzy&ldquo;.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/25.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/25-450x274.png" alt="25" width="450" height="274" class="alignnone size-medium wp-image-6140" /></a>
<p><i>Obrázek 25: Výsledek použití příkazu <strong>:%s/static/xyzzy/g</strong> (g znamená globální nahrazení, viz též další kapitolu s&nbsp;podrobnějším popisem).</i></p>

<p>Taktéž je možné rozsah specifikovat pomocí dvou čísel odpovídajících číslům řádků. Opět se podívejme na dvojici screenshotů, kde je tato možnost použita:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/26.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/26-450x274.png" alt="26" width="450" height="274" class="alignnone size-medium wp-image-6141" /></a>
<p><i>Obrázek 26: Nahrazení všech slov &bdquo;import&ldquo; za &bdquo;static import&ldquo;, ovšem pouze na prvních třech řádcích.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/27.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/27-450x274.png" alt="27" width="450" height="274" class="alignnone size-medium wp-image-6142" /></a>
<p><i>Obrázek 27: Výsledek použití příkazu <strong>:1,3s/import/static import</strong></i></p>

<p>Alternativně je možné text vybrat do bloku (klávesa v či V pro vstup do vizuálního režimu), což automaticky povede k&nbsp;vložení znaků pro začátek a konec vizuálního označení v&nbsp;příkazu <strong>substitute</strong>. V&nbsp;praxi to znamená, že se nahrazování bude týkat pouze označeného textu:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/28.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/28-450x274.png" alt="28" width="450" height="274" class="alignnone size-medium wp-image-6143" /></a>
<p><i>Obrázek 28: Nahrazení všech slov &bdquo;private&ldquo; za &bdquo;protected&ldquo;, ovšem pouze v&nbsp;označeném bloku textu.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/29.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/29-450x274.png" alt="29" width="450" height="274" class="alignnone size-medium wp-image-6144" /></a>
<p><i>Obrázek 29: Výsledek použití příkazu <strong>:'&lt;,'&gt;s/private/protected/</strong> (začátek příkazu je doplněn automaticky, protože editor rozpozná režim vizuálního výběru textu).</i></p>

<p>Ve skutečnosti není zapotřebí používat v&nbsp;příkazu <strong>substitute</strong> pouze lomítka, ale je možné zvolit i jiný znak, například pomlčku:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/30.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/30-450x274.png" alt="30" width="450" height="274" class="alignnone size-medium wp-image-6145" /></a>
<p><i>Obrázek 30: Použití pomlčky namísto lomítka v&nbsp;příkazu <strong>substitute</strong>.</i></p>



<p><a name="k09"></a></p>
<h2 id="k09">9. Rozsah nahrazování zadaný pomocí vyhledávacích příkazů</h2>

<p>Poslední možností, jak v&nbsp;příkazu <strong>substitute</strong> určit tu část textu, v&nbsp;níž se má provádět nahrazování, spočívá ve využití vyhledávacích příkazů. V&nbsp;tomto případě má příkaz substitute tvar:</p>

<pre>
:/vzorek1/,/vzorek2/s/vyhledávaný_vzorek/nahrazující_text
:?vzorek1?,/vzorek2/s/vyhledávaný_vzorek/nahrazující_text
:?vzorek1?,?vzorek2?s/vyhledávaný_vzorek/nahrazující_text
</pre>

<p>Zápis <strong>/vzorek/</strong> znamená vyhledávání vzorku směrem vpřed (ke konci souboru), zatímco zápis <strong>?vzorek?</strong> vyhledávání od pozice kurzoru směrem k&nbsp;začátku souboru. Ukázka tohoto nejsložitějšího tvaru příkazu <strong>substitute</strong> je na screenshotu číslo 31:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/31.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/31-450x435.png" alt="31" width="450" height="435" class="alignnone size-medium wp-image-6148" /></a>
<p><i>Obrázek 31: Nahrazení slova &bdquo;separator&ldquo; za &bdquo;stringSeparator&ldquo;, ovšem jen v&nbsp;textu, který se nachází na řádcích se slovy &bdquo;function&ldquo; a &bdquo;return&ldquo;.</i></p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Význam některých přepínačů příkazu <strong>substitute</strong></h2>

<p>Poslední nepovinnou položkou příkazu <strong>substitute</strong> jsou příznaky, které se v&nbsp;případě potřeby mohou zadat za poslední rozdělovací znak. My jsme prozatím v&nbsp;naších demonstračních příkladech používali pro oddělení jednotlivých částí příkazu <strong>substitute</strong> lomítko, může se však jednat i o jiný znak, typicky o pomlčku. Příznaky ovlivňují způsob vyhledávání a taktéž to, zda se mají nahradit všechny výskyty vzorku na jednom řádku či zda se naopak má nahradit pouze první nalezený výskyt (což je výchozí chování příkazu <strong>substitute</strong>). Některé příznaky je možné kombinovat, u dalších to nedává smysl. Pokud se příznaky kombinují, zapisují se přímo za sebe bez jakýchkoli oddělovačů, například:</p>

<pre>
:%s/foo/bar/gc
:%s/foo/bar/gci
:%s/foo/bar/igc
:%s-foo-bar-Ig
:%s:foo:bar:gc
</pre>

<p>Význam jednotlivých příznaků příkazu <strong>substitute</strong> je uveden v&nbsp;následující tabulce:</p>

<table>
<tr><th>#</th><th>Příznak</th><th>Význam</th></tr>
<tr><td>1</td><td>g</td><td>nahradí se všechny výskyty vzorku na řádku (ve výchozím stavu se nahradí jen první výskyt)</td></tr>
<tr><td>2</td><td>c</td><td>před nahrazením se plugin zeptá, zda se náhrada má skutečně provést</td></tr>
<tr><td>3</td><td>i</td><td>ignorování velikosti písmen při vyhledávání</td></tr>
<tr><td>4</td><td>I</td><td>zákaz ignorování velikosti písmen při vyhledávání</td></tr>
<tr><td>5</td><td>&amp;</td><td>použijí se příznaky posledního příkazu <strong>substitute</strong></td></tr>
</table>

<p>Opět se podívejme na demonstrační příklady:</p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/32.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/32-450x274.png" alt="32" width="450" height="274" class="alignnone size-medium wp-image-6149" /></a>
<p><i>Obrázek 32: Po specifikaci příznaku <strong>c</strong> se bude plugin před každým nahrazováním ptát, zda se má nahrazení provést (y), neprovést (n), provést všechna další nahrazení (a) nebo se má ukončit (q).</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/33.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/33-450x274.png" alt="33" width="450" height="274" class="alignnone size-medium wp-image-6150" /></a>
<p><i>Obrázek 33: Globální nahrazení části slova &bdquo;image&ldquo; za &bdquo;picture&ldquo; s&nbsp;ignorováním velikosti písmen.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/34.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/34-450x274.png" alt="34" width="450" height="274" class="alignnone size-medium wp-image-6151" /></a>
<p><i>Obrázek 34: K&nbsp;nahrazení skutečně došlo, a to i v&nbsp;případě slova BufferedImage.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/35.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/35-450x274.png" alt="35" width="450" height="274" class="alignnone size-medium wp-image-6152" /></a>
<p><i>Obrázek 35: Globální nahrazení části slova &bdquo;image&ldquo; za &bdquo;picture&ldquo; bez ignorování velikosti písmen.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/36.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/36-450x274.png" alt="36" width="450" height="274" class="alignnone size-medium wp-image-6153" /></a>
<p><i>Obrázek 36: Došlo k&nbsp;nahrazení pouze slov &bdquo;image&ldquo;, nikoli &bdquo;Image&ldquo;.</i></p>

<a href="http://mojefedora.cz/wp-content/uploads/2015/11/37.png"><img src="http://mojefedora.cz/wp-content/uploads/2015/11/37-450x274.png" alt="37" width="450" height="274" class="alignnone size-medium wp-image-6154" /></a>
<p><i>Obrázek 37: Příznak &amp; znamená &bdquo;použij parametry posledního příkazu <strong>substitute</strong>&ldquo;.</i></p>



<p><a name="k11"></a></p>
<h2 id="k11">11. Obsah třetí části článku</h2>

<p>Ve třetí části článku o modulu <i>Vrapper</i> se zaměříme na popis mapování kláves příkazem <strong>:map</strong> a jeho variantami, Tento velmi užitečný příkaz je do značné míry totožný s&nbsp;funkcionalitou nabízenou samotným Vimem. Samostatnou kapitolu si zcela jistě zaslouží vysvětlení problematiky záznamu a následného použití maker, protože právě spojení makrosystému s&nbsp;možností použití Vimovských operátorů může vývojářům (či dalším uživatelům integrovaného vývojového prostředí Eclipse a pluginu <i>Vrapper</i>) ušetřit mnoho práce, a to nejenom při samotné editaci zdrojových kódů, ale například i při úpravě různých datových souborů, přípravě šablon HTML stránek apod.</p>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2015</small></p>
</body>
</html>

