<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Programovací jazyky a knihovny určené pro výuku základů počítačové grafiky (4)</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Programovací jazyky a knihovny určené pro výuku základů počítačové grafiky (4)</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>Ve čtvrtém článku věnovaném programovacím jazykům a taktéž knihovnám, které mohou být vhodné pro výuku programování i základů počítačové grafiky, se opět budeme zabývat popisem možností knihovny LÖVE, o níž jsme se stručně zmínili minule i předminule. Na demonstračních příkladech si ukážeme použití 2D grafiky, tvorbu animací i práci se sprity.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Programovací jazyky a knihovny určené pro výuku základů počítačové grafiky (4)</a></p>
<p><a href="#k02">2. Šestý demonstrační příklad: kreslení s&nbsp;využitím funkcí z&nbsp;modulu love.graphics</a></p>
<p><a href="#k03">3. Nastavení parametrů vykreslování</a></p>
<p><a href="#k04">4. Sedmý demonstrační příklad: kreslení s&nbsp;využitím funkcí z&nbsp;modulu love.graphics, směšování barev</a></p>
<p><a href="#k05">5. Rastrové obrázky a sprity aneb základní objekty při tvorbě 2D her</a></p>
<p><a href="#k06">6. Osmý demonstrační příklad: základy práce se sprity</a></p>
<p><a href="#k07">7. Tvorba animací s&nbsp;využitím callback funkce nazvané <strong>love.update()</strong></a></p>
<p><a href="#k08">8. Devátý demonstrační příklad: pohyb spritů na obrazovce (skákající míčky)</a></p>
<p><a href="#k09">9. Otáčení spritů okolo jejich lokální souřadnice [0,0]</a></p>
<p><a href="#k10">10. Desátý demonstrační příklad: otáčení spritů při vykreslování</a></p>
<p><a href="#k11">11. Další parametry funkce <strong>love.draw()</strong></a></p>
<p><a href="#k12">12. Jedenáctý demonstrační příklad: korektní rotace spritů</a></p>
<p><a href="#k13">13. Repositář se zdrojovými kódy dnešních demonstračních příkladů</a></p>
<p><a href="#k14">14. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Programovací jazyky a knihovny určené pro výuku základů počítačové grafiky (4)</h2>

<p><a href="http://fedora.cz/programovaci-jazyky-a-knihovny-urcene-pro-vyuku-zakladu-pocitacove-grafiky-3/">V&nbsp;předchozí části</a> seriálu o <a href="http://fedora.cz/stitek/programovaci-jazyk/">programovacích jazycích</a> a taktéž knihovnách, které mohou být vhodné pro <a href="http://fedora.cz/stitek/vyuka/">výuku programování</a> i základů počítačové grafiky, jsme se seznámili s&nbsp;některými možnostmi nabízenými knihovnou <i>LÖVE</i>. Víme již, že tato knihovna je určena především pro jednoduchou a rychlou tvorbu her s&nbsp;2D grafikou, hudbou a zvuky, přičemž pro zápis algoritmů se používá snadno naučitelný programovací jazyk <i>Lua</i>. Samozřejmě je možné <i>LÖVE</i> použít i pro tvorbu jiných typů aplikací, například různých dem, simulací s&nbsp;grafickým výstupem atd. (pro složitější aplikace však chybí funkce pro tvorbu plnohodnotného grafického uživatelského rozhraní). Minule jsme si na pěti demonstračních příkladech ukázali některé základní grafické (vykreslovací) funkce a taktéž způsob obsluhy klávesnice a myši. Dnes se zaměříme na popis dalších možností nabízených především subsystémem pro práci s&nbsp;grafikou, tj.&nbsp;na funkce, které lze nalézt v&nbsp;modulu <strong>love.graphics</strong>.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/08/03.png"><img class="alignnone size-medium wp-image-5535" src="http://fedora.cz/wp-content/uploads/2015/08/03-450x352.png" alt="03" width="450" height="352" /></a>
<p><i>Obrázek 1: Ukázka hry naprogramované s&nbsp;využitím knihovny LÖVE.</i></p>

<p>V&nbsp;následující tabulce jsou pro přehlednost uvedeny ty funkce knihovny <i>LÖVE</i>, které budou popsány v&nbsp;dalších kapitolách:</p>

<table>
<tr><th> #</th><th>Funkce</th><th>Kapitola</th></tr>
<tr><td> 1</td><td>love.graphics.setMode()</td><td><a href="#k02">2</a></td></tr>
<tr><td> 2</td><td>love.window.setMode()  </td><td><a href="#k02">2</a></td></tr>
<tr><td> 3</td><td>love.graphics.newFont()</td><td><a href="#k02">2</a></td></tr>
<tr><td> 4</td><td>love.graphics.setFont()</td><td><a href="#k02">2</a></td></tr>
<tr><td> 5</td><td>love.graphics.print()  </td><td><a href="#k02">2</a></td></tr>
<tr><td> 6</td><td>love.graphics.line()   </td><td><a href="#k02">2</a></td></tr>
<tr><td> 7</td><td>love.graphics.setColor()</td><td><a href="#k03">3</a></td></tr>
<tr><td> 8</td><td>love.graphics.setColorMask()</td><td><a href="#k03">3</a></td></tr>
<tr><td> 9</td><td>love.graphics.setColorMode()</td><td><a href="#k03">3</a></td></tr>
<tr><td>10</td><td>love.graphics.setBlendMode()</td><td><a href="#k03">3</a></td></tr>
<tr><td>11</td><td>love.graphics.setLineWidth()</td><td><a href="#k03">3</a></td></tr>
<tr><td>12</td><td>love.graphics.setLineStyle()</td><td><a href="#k03">3</a></td></tr>
<tr><td>13</td><td>love.graphics.setLineStipple()</td><td><a href="#k03">3</a></td></tr>
<tr><td>14</td><td>love.graphics.setPointSize </td><td><a href="#k03">3</a></td></tr>
<tr><td>15</td><td>love.graphics.setPointStyle</td><td><a href="#k03">3</a></td></tr>
<tr><td>16</td><td>love.graphics.newImage</td><td><a href="#k05">5</a></td></tr>
<tr><td>17</td><td>love.graphics.draw</td><td><a href="#k05">5</a></td></tr>
</table>

<a href="http://fedora.cz/wp-content/uploads/2015/08/04.png"><img class="alignnone size-medium wp-image-5536" src="http://fedora.cz/wp-content/uploads/2015/08/04-450x333.png" alt="04" width="450" height="333" /></a>
<p><i>Obrázek 2: Prohlížeč demonstračních příkladů.</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Šestý demonstrační příklad: kreslení s&nbsp;využitím funkcí z&nbsp;modulu love.graphics</h2>

<p>Minule jsme si ukázali, jakým způsobem je možné vykreslit základní grafický obrazec (obdélník) i způsob načtení a následného zobrazení rastrových obrázků. V&nbsp;dalším demonstračním příkladu, který je v&nbsp;pořadí už šestým příkladem, je použito hned několik nových funkcí. První funkce slouží pro nastavení grafického režimu a popř.&nbsp;i pro nastavení velikosti hlavního okna aplikace; tato funkce se tedy může používat v&nbsp;handleru <strong>love.load()</strong> (ten je zavolán při inicializaci aplikace).</p>

<p>Funkce pro nastavení grafického režimu ve skutečnosti existuje ve dvou variantách v&nbsp;závislosti na tom, která verze knihovny <i>LÖVE</i> je použita. Ve verzi 0.8 se používá funkce nazvaná <strong>love.graphics.setMode()</strong>, ve verzi 0.9 pak funkce nazvaná <strong>love.window.setMode()</strong>. I parametry obou zmíněných funkcí se odlišují, nicméně v&nbsp;obou případech se do prvních dvou parametrů zadává velikost hlavního okna aplikace. U funkce <strong>love.graphics.setMode()</strong> se dále zadává trojice hodnot: zda se má využít celoobrazovkový režim (<i>fullscreen</i>), zda se má při vykreslování čekat na vertikální zatemnění (<i>v-sync</i>) a zda se má použít buffer pro antialiasing. U funkce <strong>love.window.setMode()</strong> jsou tyto parametry předány v&nbsp;tabulce předané jako třetí parametr (v&nbsp;demonstračním příkladu je tato tabulka prázdná).</p>

<p>Další trojice funkcí, které jsou v&nbsp;tomto demonstračním příkladu použity, slouží pro práci s&nbsp;textem. Jedná se o funkci <strong>love.graphics.newFont()</strong> určenou pro načtení fontu (my zde používáme výchozí font nabízený knihovnou <i>LÖVE</i>). Funkce <strong>love.graphics.setFont()</strong> umožňuje vybrat si aktuálně používaný font v&nbsp;případě, že jich je načteno větší množství. A konečně funkce <strong>love.graphics.print()</strong> vytiskne zadaný řetězec na určené souřadnice na obrazovce. Poslední novou funkcí, která je v&nbsp;příkladu použita, je funkce nazvaná <strong>love.graphics.line()</strong>. Ta ve své nejjednodušší podobě slouží pro vykreslení úsečky z&nbsp;bodu [x1, y1] do bodu [x2, y2] aktuálně nastavenou barvou.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/03.png"><img class="alignnone size-full wp-image-5578" src="http://fedora.cz/wp-content/uploads/2015/09/03.png" alt="03" width="450" height="450" /></a>
<p><i>Obrázek 3: Screenshot v&nbsp;pořadí šestého demonstračního příkladu.</i></p>

<p>Všechny zmíněné funkce naleznete ve zdrojovém kódu šestého demonstračního příkladu:</p>

<pre>
<i>-- </i>
<i>--  Knihovna LÖVE</i>
<i>-- </i>
<i>--  Šestý demonstrační příklad</i>
<i>-- </i>
<i>--  Kreslení s využitím funkcí z knihovny love.graphics</i>
<i>-- </i>
&nbsp;
&nbsp;
&nbsp;
<i>--  rozměry okna</i>
width = 450
height = 450
&nbsp;
<i>--  poloměr vykreslovaného obrazce</i>
radius = 200
&nbsp;
&nbsp;
&nbsp;
<i>-- </i>
<i>--  Funkce volaná při inicializaci aplikace.</i>
<i>-- </i>
<strong>function</strong> love.load()
    <i>-- načtení standardního fontu a nastavení grafického režimu</i>
    <strong>local</strong> font = love.graphics.newFont(love.default_font, 20)
    love.window.setMode(width, height, {})
    love.graphics.setFont(font)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>-- </i>
<i>--  Tato funkce je volána automaticky při překreslení obsahu</i>
<i>--  okna či obrazovky.</i>
<i>-- </i>
<strong>function</strong> love.draw()
    <strong>local</strong> max = 120
    <i>-- vykreslení obrazce složeného ze sady rovnostranných trojúhelníků</i>
    <strong>for</strong> i=1, max, 3 <strong>do</strong>
        <i>-- natočení trojúhelníku</i>
        <strong>local</strong> colorAngle = math.rad(i*360/max)
        <i>-- výpočet a nastavení barvy</i>
        love.graphics.setColor(128+127*math.cos(colorAngle), 255, 128+128*math.sin(colorAngle))
        <strong>for</strong> j=0, 2 <strong>do</strong>
            <strong>local</strong> angle1 = math.rad(i + j * 120)
            <strong>local</strong> angle2 = angle1 + math.rad(120)
            <strong>local</strong> x1 = width/2 + radius*math.cos(angle1)
            <strong>local</strong> y1 = width/2 + radius*math.sin(angle1)
            <strong>local</strong> x2 = width/2 + radius*math.cos(angle2)
            <strong>local</strong> y2 = width/2 + radius*math.sin(angle2)
            love.graphics.line(x1, y1, x2, y2)
        <strong>end</strong>
    <strong>end</strong>
    love.graphics.setColor(255, 200, 255, 255)
    love.graphics.print("Press escape to exit.", 30, 433)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>-- </i>
<i>--  Callback funkce zavolaná při stisku klávesy.</i>
<i>-- </i>
<strong>function</strong> love.keypressed(k)
    <strong>if</strong> k == 'escape' <strong>then</strong>
        love.event.quit()
    <strong>end</strong>
<strong>end</strong>
&nbsp;
<i>-- </i>
<i>--  finito</i>
<i>-- </i>
</pre>

<p>Pokud používáte knihovnu <i>LÖVE</i> verze 0.9, je nutné změnit funkci <strong>love.load()</strong> následujícím způsobem:</p>

<pre>
<i>--</i>
<i>-- Funkce volaná při inicializaci aplikace.</i>
<i>--</i>
<strong>function</strong> love.load()
    <i>-- načtení standardního fontu a nastavení grafického režimu</i>
    local font = love.graphics.newFont(love.default_font, 20)
    love.window.setMode(width, height, {})
    love.graphics.setFont(font)
<strong>end</strong>
</pre>

<a href="http://fedora.cz/wp-content/uploads/2015/09/04.png"><img class="alignnone size-medium wp-image-5579" src="http://fedora.cz/wp-content/uploads/2015/09/04.png" alt="04" width="450" height="450" /></a>
<p><i>Obrázek 4: Chybové hlášení vypsané v&nbsp;případě, že se použije nekompatibilní verze knihovny LÖVE.</i></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Nastavení parametrů vykreslování</h2>

<p>Knihovna <strong>love.graphics</strong> obsahuje několik funkcí určených pro vykreslování základních geometrických obrazců, především bodů (<strong>love.graphics.point</strong>), úseček (<strong>love.graphics.line</strong>), trojúhelníků (<strong>love.graphics.triangle()</strong>, obdélníků (<strong>love.graphics.rectangle</strong>) a kružnic (<strong>love.graphics.circle</strong>). Tyto obrazce jsou vykresleny nastavenou barvou, tloušťkou čáry, stylem čáry (plná, čárkovaná atd.) a se zapnutým či vypnutým antialiasingem. Povolení antialiasingu funkcí <strong>love.graphics.setLineStyle(Linestyle.rough/smooth)</strong> poměrně výrazným způsobem zlepšuje kvalitu výsledného obrázku, především u šikmých linek, kde kvůli vlastnostem rastrového displeje dochází k&nbsp;tvorbě &bdquo;schodů&ldquo; &ndash; <strong>jagged lines</strong>, ovšem toto vizuální vylepšení jde na úkor rychlosti vykreslování. U jednodušších her, ve kterých se používá omezený počet objektů (řádově stovky), si však s&nbsp;tímto typem antialiasingu soudobé grafické akcelerátory bez větších problémů poradí, protože vykreslování je prováděno (přes knihovnu OpenGL i ovladač grafické karty) samotným GPU umístěným na akcelerátoru. Seznam nejdůležitějších funkcí ovlivňujících způsob vykreslování, je uveden v&nbsp;tabulce níže:</p>

<table>
<tr><th>#</th><th>Název funkce</th><th>Význam</th></tr>
<tr><td>1</td><td>love.graphics.setColor()</td><td>nastavení barvy vykreslovaných objektů</td></tr>
<tr><td>2</td><td>love.graphics.setColorMask()</td><td>povoluje či zakazuje jednotlivé barvové kanály (přidáno ve verzi 0.9)</td></tr>
<tr><td>3</td><td>love.graphics.setColorMode()</td><td>určení, zda se má při vykreslování provádět modulace (násobení) barvy s&nbsp;pozadím (odstraněno ve verzi 0.9!)</td></tr>
<tr><td>4</td><td>love.graphics.setBlendMode()</td><td>povolení či zákaz míchání barev s&nbsp;pozadím při vykreslování</td></tr>
<tr><td>5</td><td>love.graphics.setLineWidth()</td><td>šířka čáry při vykreslování</td></tr>
<tr><td>6</td><td>love.graphics.setLineStyle()</td><td>povolení či zákaz antialiasingu při vykreslování úseček</td></tr>
<tr><td>7</td><td>love.graphics.setLineStipple()</td><td>nastavení typu čáry podle zadaného bitového vzorku (odstraněno ve verzi 0.9!)</td></tr>
<tr><td>8</td><td>love.graphics.setPointSize </td><td>velikost vykreslovaných bodů</td></tr>
<tr><td>9</td><td>love.graphics.setPointStyle</td><td>styl vykreslovaných bodů (bez či s&nbsp;antialisingem)</td></tr>
</table>



<p><a name="k04"></a></p>
<h2 id="k04">4. Sedmý demonstrační příklad: kreslení s&nbsp;využitím funkcí z&nbsp;modulu love.graphics, směšování barev</h2>

<p>V&nbsp;sedmém demonstračním příkladu, jehož zdrojový kód je vypsán pod tímto odstavcem, je ukázáno použití funkce <i>love.graphics.setBlendMode()</i> i význam čtvrtého (nepovinného) parametru funkce <i>love.graphics.setColor()</i>, nazývaného <i>alfa (alpha)</i>. Tento parametr určuje průhlednost nastavené barvy a tím i celkový vizuální vzhled objektu. Po spuštění demonstračního příkladu je možné pomocí klávesy <strong>B</strong> přepínat režim míchání barev mezi <i>"alpha"</i> a <i>"additive"</i>. V&nbsp;závislosti na vybraném režimu je buď nastavená barva pouze vynásobena hodnotou <i>alfa</i> (předaná hodnota je nejprve vydělena 255, aby se nacházela v&nbsp;rozsahu 0.0 až 1.0), ovšem ve druhém případě je proveden součet barvy pozadí (tj.&nbsp;i dříve nakreslených objektů) s&nbsp;barvou vykreslovaného objektu, takže v&nbsp;místech, kde se objekty překrývají, dochází ke zvýšení intenzity barev, což ostatně můžeme vidět dvojici screenshotů:</p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/05.png"><img class="alignnone size-medium wp-image-5580" src="http://fedora.cz/wp-content/uploads/2015/09/05.png" alt="05" width="450" height="450" /></a>
<p><i>Obrázek 5: Screenshot sedmého demonstračního příkladu.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/06.png"><img class="alignnone size-medium wp-image-5581" src="http://fedora.cz/wp-content/uploads/2015/09/06.png" alt="06" width="450" height="450" /></a>
<p><i>Obrázek 6: Screenshot sedmého demonstračního příkladu (změna režimu směšování barev).</i></p>

<pre>
<i>-- </i>
<i>--  Knihovna LÖVE</i>
<i>-- </i>
<i>--  Sedmý demonstrační příklad</i>
<i>-- </i>
<i>--  Kreslení s využitím funkcí z knihovny love.graphics, nastavení režimu</i>
<i>--  směšování barev</i>
<i>-- </i>
&nbsp;
&nbsp;
<i>--  rozměry okna</i>
width = 450
height = 450
&nbsp;
<i>--  poloměr vykreslovaného obrazce</i>
radius = 200
&nbsp;
<i>--  režim směšování barev</i>
blending = "alpha"
<i>--  konstanta pro směšování</i>
blend_factor = 80
&nbsp;
&nbsp;
&nbsp;
<i>-- </i>
<i>--  Funkce volaná při inicializaci aplikace.</i>
<i>-- </i>
<strong>function</strong> love.load()
    <i>-- načtení standardního fontu a nastavení grafického režimu</i>
    local font = love.graphics.newFont(love.default_font, 20)
    love.graphics.setMode(width, height, false, false, 0)
    love.graphics.setFont(font)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>-- </i>
<i>--  Tato funkce je volána automaticky při překreslení obsahu</i>
<i>--  okna či obrazovky.</i>
<i>-- </i>
<strong>function</strong> love.draw()
    <i>-- nastavení režimu směšování barev</i>
    love.graphics.setBlendMode(blending)
    love.graphics.setColor(255, 255, 255, blend_factor)
    <i>-- vykreslení obrazce</i>
    <strong>for</strong> i=1, 90 <strong>do</strong>
        <strong>for</strong> j=0, 3 <strong>do</strong>
            local angle1 = math.rad(i + j * 90)
            local angle2 = angle1 + 90
            local x1 = width/2 + radius*math.cos(angle1*2)
            local y1 = width/2 + radius*math.sin(angle1*3)
            local x2 = width/2 + radius*math.cos(angle2*3)
            local y2 = width/2 + radius*math.sin(angle2*2)
            love.graphics.line(x1, y1, x2, y2)
        <strong>end</strong>
    <strong>end</strong>
    love.graphics.setColor(255, 200, 255, 255)
    love.graphics.print("Press escape to exit.", 30, 433)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>-- </i>
<i>--  Callback funkce zavolaná při stisku klávesy.</i>
<i>-- </i>
<strong>function</strong> love.keypressed(k)
    <strong>if</strong> k == 'escape' <strong>then</strong>
        love.event.quit()
    <strong>elseif</strong> k == 'b' <strong>then</strong>
        setBlending()
    <strong>end</strong>
<strong>end</strong>
&nbsp;
<i>--  povolení či zákaz směšování barev po stisku klávesy "b"</i>
<strong>function</strong> setBlending()
    <strong>if</strong> blending == "alpha" <strong>then</strong>
        blending = "additive"
    <strong>else</strong>
        blending = "alpha"
    <strong>end</strong>
<strong>end</strong>
&nbsp;
&nbsp;
<i>-- </i>
<i>--  finito</i>
<i>-- </i>
</pre>

<p>Podobně jako u předchozího příkladu platí, že pokud používáte knihovnu <i>LÖVE</i> verze 0.9, je nutné změnit funkci <strong>love.load()</strong> následujícím způsobem:</p>

<pre>
<i>--</i>
<i>-- Funkce volaná při inicializaci aplikace.</i>
<i>--</i>
<strong>function</strong> love.load()
    <i>-- načtení standardního fontu a nastavení grafického režimu</i>
    local font = love.graphics.newFont(love.default_font, 20)
    love.window.setMode(width, height, {})
    love.graphics.setFont(font)
<strong>end</strong>
</pre>



<p><a name="k05"></a></p>
<h2 id="k05">5. Rastrové obrázky a sprity aneb základní objekty při tvorbě 2D her</h2>

<p>Základní grafickou entitou používanou při tvorbě naprosté většiny klasických her s&nbsp;2D grafikou, jsou rastrové obrázky, jejichž některé pixely jsou buď zcela průhledné či poloprůhledné. Díky měnitelné průhlednosti (definované až na úroveň jednotlivých pixelů) je možné takové rastrové obrázky použít pro zobrazení pohybujících se objektů či naopak statických prvků jednotlivých scén, které mohou překrývat pozadí. V&nbsp;dobách osmibitových domácích mikropočítačů a herních konzolí se takové bitmapy (s&nbsp;malým rozlišením a omezeným množstvím barev) označovaly jménem <i>sprite</i> a o jejich vykreslování se mnohdy staraly specializované čipy. Dnes je vlastně situace obdobná, protože bitmapy jsou (i s&nbsp;případnou průhledností) vykreslovány s&nbsp;využitím grafických akcelerátorů a jejich GPU. V&nbsp;následujících demonstračních příkladech si ukážeme použití moderní obdoby spritů s&nbsp;využitím funkcí nabízených knihovnou <i>LÖVE</i>.</p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/07.png"><img class="alignnone size-medium wp-image-5582" src="http://fedora.cz/wp-content/uploads/2015/09/07.png" alt="07" width="336" height="240" /></a>
<p><i>Obrázek 7: Historická hra pro osmibitové mikropočítače (Draconus), v&nbsp;níž se pro zobrazení postavy ovládané hráčem používaly hardwarově vykreslované sprity, tj.&nbsp;bitmapy o malém rozlišení a omezeném počtu barev, o jejichž vykreslení se staral specializovaný čip.</i></p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Osmý demonstrační příklad: základy práce se sprity</h2>

<p>V&nbsp;tomto demonstračním příkladu si připomeneme, jakým způsobem se rastrový obrázek dá načíst z&nbsp;externího souboru a jaká funkce posléze slouží k&nbsp;jeho zobrazení. Načtení obrázku je realizováno funkcí <strong>love.graphics.newImage()</strong>, která dokáže pracovat s&nbsp;prakticky všemi základními grafickými formáty, samozřejmě včetně dnes pravděpodobně nejpoužívanějších formátů PNG a JPEG. Při použití formátu PNG je plně podporována průhlednost jednotlivých pixelů, a to jak průhlednost reprezentovaná jedním bitem (pixel je buď plně průhledný či naopak zcela neprůhledný), tak i plnohodnotný alfa kanál. Podrobnosti o možnostech formátu PNG jsou popsány v&nbsp;článcích <a href="http://www.root.cz/clanky/png-is-not-gif/">PNG is not GIF</a> a <a href="http://www.root.cz/clanky/png-bity-byty-chunky/">PNG - bity, byty, chunky</a>, nás však dnes bude zajímat především fakt, že právě PNG lze použít pro tvorbu plnohodnotných spritů. Obrázky s&nbsp;průhledností jsou totiž v&nbsp;osmém demonstračním příkladu použity pro vytvoření následující 2D scény:</p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/08.png"><img class="alignnone size-medium wp-image-5583" src="http://fedora.cz/wp-content/uploads/2015/09/08.png" alt="08" width="450" height="450" /></a>
<p><i>Obrázek 8: Screenshot osmého demonstračního příkladu.</i></p>

<p>Následuje výpis zdrojového kódu osmého demonstračního příkladu:</p>

<pre>
<i>--</i>
<i>-- Knihovna LÖVE</i>
<i>--</i>
<i>-- Osmý demonstrační příklad</i>
<i>--</i>
<i>-- Práce se sprity.</i>
<i>--</i>
&nbsp;
&nbsp;
<i>-- rozměry okna</i>
width = 450
height = 450
&nbsp;
&nbsp;
&nbsp;
<strong>local</strong> sprite1 = nil
<strong>local</strong> sprite2 = nil
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Funkce volaná při inicializaci aplikace.</i>
<i>--</i>
<strong>function</strong> love.load()
    <i>-- načtení standardního fontu a nastavení grafického režimu</i>
    <strong>local</strong> font = love.graphics.newFont(love.default_font, 40)
    <i>-- načtení spritů</i>
    sprite1 = love.graphics.newImage("sprite1.png")
    sprite2 = love.graphics.newImage("sprite2.png")
    love.graphics.setMode(width, height, false, false, 0)
    love.graphics.setFont(font)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Tato funkce je volána automaticky při překreslení obsahu</i>
<i>-- okna či obrazovky.</i>
<i>--</i>
<strong>function</strong> love.draw()
    <i>-- velikost okna</i>
    <strong>local</strong> windowWidth = love.graphics.getWidth()
    <strong>local</strong> windowHeight = love.graphics.getHeight()
&nbsp;
    <i>-- vykreslení mřížky</i>
    <strong>for</strong> y=0, windowHeight - sprite2:getHeight(), sprite2:getHeight()+5 <strong>do</strong>
        <strong>for</strong> x=0, windowWidth - sprite2:getWidth(), sprite2:getWidth()+5 <strong>do</strong>
            love.graphics.draw(sprite2, x, y)
        <strong>end</strong>
    <strong>end</strong>
&nbsp;
    <i>-- vykreslení prvního spritu přes ostatní sprity</i>
    love.graphics.draw(sprite1, 30, 30)
    love.graphics.print("Press escape to exit.", 30, 433)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Callback funkce zavolaná při stisku klávesy.</i>
<i>--</i>
<strong>function</strong> love.keypressed(k)
    <strong>if</strong> k == 'escape' <strong>then</strong>
        love.event.quit()
    <strong>end</strong>
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- finito</i>
<i>--</i>
</pre>



<p><a name="k07"></a></p>
<h2 id="k07">7. Tvorba animací s&nbsp;využitím callback funkce nazvané <strong>love.update()</strong></h2>

<p>Všechny předchozí příklady pouze zobrazovaly statickou 2D scénu, což vlastně ani není příliš zajímavé. Užitečnější je tvorba animací, ať již animací běžících zcela automaticky (různá grafická dema atd.), tak i dynamických scén, které může svou činností ovlivňovat uživatel (počítačové hry). V&nbsp;obou případech je nutné, aby existovala nějaká periodicky volaná funkce, v&nbsp;jejímž těle se mění stav programu a tím pádem i například pozice spritů na obrazovce. V&nbsp;knihovně <i>LÖVE</i> se tato funkce jmenuje <strong>love.update()</strong>. Tuto funkci automaticky volá engine knihovny <i>LÖVE</i> a uživatel může sám zjistit, kolik času uběhlo od předchozího volání této funkce přečtením jejího parametru <i>dt</i> (tento čas je udaný v&nbsp;sekundách, ovšem jedná se o číslo s&nbsp;plovoucí řádovou čárkou, takže časový úsek je možné měřit s&nbsp;větší přesností). Jedna z&nbsp;možností, jak zajistit změnu stavu programu v&nbsp;pravidelných intervalech (zde konkrétně v&nbsp;intervalu jedné třicetiny sekundy) spočívá v&nbsp;použití funkce <strong>love.timer.sleep()</strong>, která pozastaví provádění celého programu po nastavený časový okamžik. Nepříliš přesné, ovšem pro nás dostačující, řešení může vypadat následovně:</p>

<pre>
<i>--</i>
<i>-- Funkce volaná cca 30x za sekundu</i>
<i>--</i>
<strong>function</strong> love.update(dt)
    <i>-- změna stavu aplikace</i>
    <i>-- změna stavu aplikace</i>
    <i>-- změna stavu aplikace</i>
    <strong>local</strong> delay = 1/30
    <strong>if</strong> dt &lt; delay <strong>then</strong>
        love.timer.sleep(delay - dt)
    <strong>end</strong>
<strong>end</strong>
</pre>



<p><a name="k08"></a></p>
<h2 id="k08">8. Devátý demonstrační příklad: pohyb spritů na obrazovce (skákající míčky)</h2>

<p>Funkce <strong>love.update()</strong>, která byla zmíněná v&nbsp;předchozí kapitole, je použita v&nbsp;devátém demonstračním příkladu pro animaci třech skákajících míčků představovaných ve vykreslované scéně sprity. Stav celého programu je uložen v&nbsp;proměnných <strong>sprite1</strong>, <strong>sprite2</strong> a <strong>sprite3</strong>, což jsou asociativní pole obsahující jak vlastní sprite (obrázek s&nbsp;poloprůhlednými i průhlednými pixely), tak i jeho aktuální pozici na obrazovce a vektor pohybu (proměnné <i>dx</i>, <i>dy</i>, zjednodušeně tento vektor můžeme považovat za rychlost). Vertikální složka vektoru pohybu se v&nbsp;čase postupně mění, čímž je simulován vliv gravitace. Odrážení míčků od stěn je jednoduché &ndash; pouze se změní znaménko horizontální či vertikální složky vektoru pohybu. Animaci a současně i celý program je možné zastavit klávesou <i>Esc</i>. Animace vytvořená tímto demonstračním programem vypadá následovně:</p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/anim1_.gif"><img class="alignnone size-full wp-image-5594" src="http://fedora.cz/wp-content/uploads/2015/09/anim1_.gif" alt="anim1_" width="450" height="450" /></a>

<p>Zdrojový kód devátého demonstračního příkladu:</p>

<pre>
<i>--</i>
<i>-- Knihovna LÖVE</i>
<i>--</i>
<i>-- Devátý demonstrační příklad</i>
<i>--</i>
<i>-- Práce se sprity: zobrazení, posun.</i>
<i>-- (skákající míčky)</i>
<i>--</i>
&nbsp;
&nbsp;
<i>-- rozměry okna</i>
width = 450
height = 450
&nbsp;
&nbsp;
&nbsp;
<i>-- objekty představující sprity zobrazené v okně</i>
<strong>local</strong> sprite1 = {x=100, y=100, dx=4, dy=0}
<strong>local</strong> sprite2 = {x=200, y=10,  dx=3, dy=0}
<strong>local</strong> sprite3 = {x=300, y=100, dx=2, dy=0}
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Funkce volaná při inicializaci aplikace.</i>
<i>--</i>
<strong>function</strong> love.load()
    <i>-- načtení standardního fontu a nastavení grafického režimu</i>
    <strong>local</strong> font = love.graphics.newFont(love.default_font, 40)
    <i>-- načtení spritů</i>
    sprite1.image = love.graphics.newImage("sprite2.png")
    sprite2.image = love.graphics.newImage("sprite1.png")
    sprite3.image = love.graphics.newImage("sprite2.png")
    love.graphics.setMode(width, height, false, false, 0)
    <i>-- nastavení fontu</i>
    love.graphics.setFont(font)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Vykreslení spritu s jeho posunem.</i>
<i>--</i>
<strong>function</strong> drawSprite(sprite)
    <i>-- vykreslení spritu s posunem</i>
    love.graphics.draw(sprite.image, sprite.x, sprite.y)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Tato funkce je volána automaticky při překreslení obsahu</i>
<i>-- okna či obrazovky.</i>
<i>--</i>
<strong>function</strong> love.draw()
    <i>-- vykreslení prvního spritu přes ostatní sprity</i>
    drawSprite(sprite1)
    <i>-- vykreslení druhého spritu přes ostatní sprity</i>
    drawSprite(sprite2)
    <i>-- vykreslení třetího spritu přes ostatní sprity</i>
    drawSprite(sprite3)
&nbsp;
    love.graphics.print("Press escape to exit.", 30, 433)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Změna pozice spritů v okně</i>
<i>--</i>
<strong>function</strong> updateSpritePosition(sprite)
    <i>-- velikost okna</i>
    <strong>local</strong> windowWidth = love.graphics.getWidth()
    <strong>local</strong> windowHeight = love.graphics.getHeight()
&nbsp;
    sprite.x = sprite.x + sprite.dx
    sprite.y = sprite.y + sprite.dy
&nbsp;
    <strong>if</strong> sprite.x &lt; 1 or sprite.x &gt; windowWidth - sprite.image:getWidth() - 2 <strong>then</strong>
        sprite.dx = -sprite.dx
    <strong>end</strong>
    <strong>if</strong> sprite.y &lt; 1 or sprite.y &gt; windowHeight - sprite.image:getHeight() - 2 <strong>then</strong>
        sprite.dy = -sprite.dy
    <strong>end</strong>
    sprite.dy = sprite.dy + 0.1
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Funkce volaná cca 30x za sekundu</i>
<i>--</i>
<strong>function</strong> love.update(dt)
    updateSpritePosition(sprite1)
    updateSpritePosition(sprite2)
    updateSpritePosition(sprite3)
    <strong>local</strong> delay = 1/30
    <strong>if</strong> dt &lt; delay <strong>then</strong>
        love.timer.sleep(delay - dt)
    <strong>end</strong>
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Callback funkce zavolaná při stisku klávesy.</i>
<i>--</i>
<strong>function</strong> love.keypressed(k)
    <strong>if</strong> k == 'escape' <strong>then</strong>
        love.event.quit()
    <strong>end</strong>
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- finito</i>
<i>--</i>
</pre>

<a href="http://fedora.cz/wp-content/uploads/2015/09/09.png"><img class="alignnone size-medium wp-image-5584" src="http://fedora.cz/wp-content/uploads/2015/09/09.png" alt="09" width="450" height="450" /></a>
<p><i>Obrázek 9: Screenshot devátého demonstračního příkladu.</i></p>



<p><a name="k09"></a></p>
<h2 id="k09">9. Otáčení spritů okolo jejich lokální souřadnice [0,0]</h2>

<p>Funkce <strong>love.graphics.draw()</strong> používaná mj.&nbsp;i pro vykreslení obrázků do 2D scény, ve skutečnosti akceptuje více parametrů, než jen proměnnou obsahující obrázek a x-ovou i y-ovou pozici obrázku na obrazovce. Čtvrtým parametrem této funkce je možné specifikovat otočení obrázku, což se samozřejmě může v&nbsp;mnoha případech hodit (představit si můžeme například vesmírnou střílečku typu Asteroids či závodní hru, kde jsou autíčka viděna svrchu). Při rotaci obrázků v&nbsp;průběhu jejich vykreslování je však zapotřebí dbát na dvě vlastnosti funkce <strong>love.graphics.draw()</strong>. Rotace je udávána v&nbsp;radiánech, takže pokud se ve hře úhel reprezentuje ve stupních, je nutné zajistit převod této hodnoty, například vynásobením konstantou 180/&pi;. Druhá vlastnost může přinášet jisté komplikace &ndash; otáčení obrázku je totiž provedeno okolo jeho počátku, tj.&nbsp;okolo souřadnic [0,0] a nikoli okolo středu obrázku. Výsledek tedy nemusí ve všech případech odpovídat představám vývojáře, o čemž se přesvědčíme hned v&nbsp;dalším demonstračním příkladu.</p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Desátý demonstrační příklad: otáčení spritů při vykreslování</h2>

<p>V&nbsp;desátém demonstračním příkladu je ukázáno použití funkce <strong>love.graphics.draw()</strong> pro vykreslení otočených obrázků. Opět se jedná o animaci, přičemž se ve funkci <strong>love.update()</strong> mění pouze proměnná <strong>sprite.r</strong> představující úhel otočení daného spritu reprezentovaný v&nbsp;radiánech. O vykreslení spritů se stará uživatelská funkce pojmenovaná <strong>drawSprite()</strong>, jejíž zdrojový kód vypadá následovně:</p>

<pre>
<i>--</i>
<i>-- Vykreslení spritu s jeho otočením.</i>
<i>--</i>
<strong>function</strong> drawSprite(sprite)
    <i>-- vykreslení spritu s rotací</i>
    love.graphics.draw(sprite.image, sprite.x, sprite.y, sprite.r)
<strong>end</strong>
</pre>

<p>Vzhledem k&nbsp;tomu, že sprity jsou otáčeny okolo jejich lokální souřadnice [0,0], nebude pravděpodobně výsledná animace odpovídat představám vývojáře, o čemž se ostatně můžeme snadno přesvědčit:</p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/anim2_.gif"><img class="alignnone size-medium wp-image-5595" src="http://fedora.cz/wp-content/uploads/2015/09/anim2_.gif" alt="anim2_" width="450" height="450" /></a>

<p>Zdrojový kód desátého demonstračního příkladu:</p>

<pre>
<i>--</i>
<i>-- Knihovna LÖVE</i>
<i>--</i>
<i>-- Desátý demonstrační příklad</i>
<i>--</i>
<i>-- Práce se sprity: zobrazení, otočení.</i>
<i>--</i>
&nbsp;
&nbsp;
<i>-- rozměry okna</i>
width = 450
height = 450
&nbsp;
&nbsp;
&nbsp;
<i>-- objekty představující sprity zobrazené v okně</i>
<strong>local</strong> sprite1 = {x=100, y=100, r=0, dr=-0.17}
<strong>local</strong> sprite2 = {x=185, y=80, r=0, dr=0.1}
<strong>local</strong> sprite3 = {x=300, y=100, r=0, dr=0.05}
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Funkce volaná při inicializaci aplikace.</i>
<i>--</i>
<strong>function</strong> love.load()
    <i>-- načtení standardního fontu a nastavení grafického režimu</i>
    <strong>local</strong> font = love.graphics.newFont(love.default_font, 40)
    <i>-- načtení spritů</i>
    sprite1.image = love.graphics.newImage("sprite2.png")
    sprite2.image = love.graphics.newImage("sprite1.png")
    sprite3.image = love.graphics.newImage("sprite2.png")
    love.graphics.setMode(width, height, false, false, 0)
    <i>-- nastavení fontu</i>
    love.graphics.setFont(font)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Vykreslení spritu s jeho otočením.</i>
<i>--</i>
<strong>function</strong> drawSprite(sprite)
    <i>-- vykreslení spritu s rotací</i>
    love.graphics.draw(sprite.image, sprite.x, sprite.y, sprite.r)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Tato funkce je volána automaticky při překreslení obsahu</i>
<i>-- okna či obrazovky.</i>
<i>--</i>
<strong>function</strong> love.draw()
    <i>-- vykreslení prvního spritu přes ostatní sprity</i>
    drawSprite(sprite1)
    <i>-- vykreslení druhého spritu přes ostatní sprity</i>
    drawSprite(sprite2)
    <i>-- vykreslení třetího spritu přes ostatní sprity</i>
    drawSprite(sprite3)
&nbsp;
    love.graphics.print("Press escape to exit.", 30, 433)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Změna rotace spritů v okně</i>
<i>--</i>
<strong>function</strong> updateSpriteAngle(sprite)
    sprite.r = sprite.r + sprite.dr
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Funkce volaná cca 30x za sekundu</i>
<i>--</i>
<strong>function</strong> love.update(dt)
    updateSpriteAngle(sprite1)
    updateSpriteAngle(sprite2)
    updateSpriteAngle(sprite3)
    <strong>local</strong> delay = 1/30
    <strong>if</strong> dt &gt; delay <strong>then</strong>
        love.timer.sleep(delay - dt)
    <strong>end</strong>
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Callback funkce zavolaná při stisku klávesy.</i>
<i>--</i>
<strong>function</strong> love.keypressed(k)
    <strong>if</strong> k == 'escape' <strong>then</strong>
        love.event.quit()
    <strong>end</strong>
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- finito</i>
<i>--</i>
</pre>

<a href="http://fedora.cz/wp-content/uploads/2015/09/10.png"><img class="alignnone size-medium wp-image-5585" src="http://fedora.cz/wp-content/uploads/2015/09/10.png" alt="10" width="450" height="450" /></a>
<p><i>Obrázek 10: Screenshot desátého demonstračního příkladu: začátek animace.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/11.png"><img class="alignnone size-medium wp-image-5586" src="http://fedora.cz/wp-content/uploads/2015/09/11.png" alt="11" width="450" height="450" /></a>
<p><i>Obrázek 11: Screenshot desátého demonstračního příkladu: průběh animace.</i></p>



<p><a name="k11"></a></p>
<h2 id="k11">11. Další parametry funkce <strong>love.draw()</strong></h2>

<p>Problém s&nbsp;rotací obrázků, se kterým jsme se setkali v&nbsp;předchozím demonstračním příkladu, je možné řešit dvěma způsoby: změnou souřadného systému (to si popíšeme příště) popř.&nbsp;použitím dalších parametrů funkce <strong>love.graphics.draw</strong>. Tato funkce totiž ve skutečnosti akceptuje až deset parametrů s&nbsp;následujícím významem:</p>

<table>
<tr><th> #</th><th>Parametr</th><th>Význam</th></tr>
<tr><td> 1</td><td>drawable</td><td>obrázek či jiný objekt, který se má vykreslit</td></tr>
<tr><td> 2</td><td>x</td><td>horizontální souřadnice obrázku na obrazovce</td></tr>
<tr><td> 3</td><td>y</td><td>vertikální souřadnice obrázku na obrazovce</td></tr>
<tr><td> 4</td><td>r</td><td>otočení obrázku (radiány)</td></tr>
<tr><td> 5</td><td>sx</td><td>horizontální měřítko obrázku (1=beze změny velikosti)</td></tr>
<tr><td> 6</td><td>sy</td><td>vertikální měřítko obrázku (1=beze změny velikosti)</td></tr>
<tr><td> 7</td><td>ox</td><td>horizontální offset (ten se používá při otáčení)</td></tr>
<tr><td> 8</td><td>oy</td><td>vertikální offset</td></tr>
<tr><td> 9</td><td>kx</td><td>horizontální zešikmení</td></tr>
<tr><td>10</td><td>ky</td><td>vertikální zešikmení</td></tr>
</table>

<p>Pro rotaci obrázku okolo jakéhokoli bodu tedy postačuje vhodným způsobem specifikovat horizontální a vertikální offset. Konkrétně pro rotaci okolo středu obrázku:</p>

<pre>
<i>--</i>
<i>-- Vykreslení spritu s jeho otočením.</i>
<i>--</i>
<strong>function</strong> drawSprite(sprite)
    <i>-- vykreslení spritu</i>
    love.graphics.draw(sprite.image,
                       sprite.x, sprite.y, <i>-- souřadnice na obrazovce (umístění spritu)</i>
                       sprite.r,           <i>-- rotace</i>
                       1.0, 1.0,           <i>-- zvětšení/změna měřítka</i>
                       sprite.image:getWidth()/2, sprite.image:getHeight()/2) <i>-- posun pozice středu otáčení</i>
<strong>end</strong>
</pre>



<p><a name="k12"></a></p>
<h2 id="k12">12. Jedenáctý demonstrační příklad: korektní rotace spritů</h2>

<p>Upravená funkce <strong>drawSprite()</strong> zmíněná v&nbsp;předchozí kapitole, která otáčí každý obrázek/sprite okolo jeho středu, je součástí jedenáctého a současně i posledního demonstračního příkladu. Po jeho spuštění se zobrazí tato animace:</p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/anim3_.gif"><img class="alignnone size-medium wp-image-5596" src="http://fedora.cz/wp-content/uploads/2015/09/anim3_.gif" alt="anim3_" width="450" height="450" /></a>

<p>Zdrojový kód jedenáctého demonstračního příkladu:</p>

<pre>
<i>--</i>
<i>-- Knihovna LÖVE</i>
<i>--</i>
<i>-- Jedenáctý demonstrační příklad</i>
<i>--</i>
<i>-- Práce se sprity: zobrazení, otočení (korektní rotace).</i>
<i>--</i>
&nbsp;
&nbsp;
<i>-- rozměry okna</i>
width = 450
height = 450
&nbsp;
&nbsp;
&nbsp;
<i>-- objekty představující sprity zobrazené v okně</i>
<strong>local</strong> sprite1 = {x=100, y=100, r=0, dr=-0.17}
<strong>local</strong> sprite2 = {x=185, y=80,  r=0, dr=0.1}
<strong>local</strong> sprite3 = {x=300, y=100, r=0, dr=0.05}
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Funkce volaná při inicializaci aplikace.</i>
<i>--</i>
<strong>function</strong> love.load()
    <i>-- načtení standardního fontu a nastavení grafického režimu</i>
    <strong>local</strong> font = love.graphics.newFont(love.default_font, 40)
    <i>-- načtení spritů</i>
    sprite1.image = love.graphics.newImage("sprite2.png")
    sprite2.image = love.graphics.newImage("sprite1.png")
    sprite3.image = love.graphics.newImage("sprite2.png")
    love.graphics.setMode(width, height, false, false, 0)
    <i>-- nastavení fontu</i>
    love.graphics.setFont(font)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Vykreslení spritu s jeho otočením.</i>
<i>--</i>
<strong>function</strong> drawSprite(sprite)
    <i>-- vykreslení spritu</i>
    love.graphics.draw(sprite.image,
                       sprite.x, sprite.y, <i>-- souřadnice na obrazovce (umístění spritu)</i>
                       sprite.r,           <i>-- rotace</i>
                       1.0, 1.0,           <i>-- zvětšení</i>
                       sprite.image:getWidth()/2, sprite.image:getHeight()/2) <i>-- posun pozice středu otáčení</i>
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Tato funkce je volána automaticky při překreslení obsahu</i>
<i>-- okna či obrazovky.</i>
<i>--</i>
<strong>function</strong> love.draw()
    <i>-- vykreslení prvního spritu přes ostatní sprity</i>
    drawSprite(sprite1)
    <i>-- vykreslení druhého spritu přes ostatní sprity</i>
    drawSprite(sprite2)
    <i>-- vykreslení třetího spritu přes ostatní sprity</i>
    drawSprite(sprite3)
&nbsp;
    love.graphics.print("Press escape to exit.", 30, 433)
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Změna rotace spritů v okně</i>
<i>--</i>
<strong>function</strong> updateSpriteAngle(sprite)
    sprite.r = sprite.r + sprite.dr
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Funkce volaná cca 30x za sekundu</i>
<i>--</i>
<strong>function</strong> love.update(dt)
    updateSpriteAngle(sprite1)
    updateSpriteAngle(sprite2)
    updateSpriteAngle(sprite3)
    <strong>local</strong> delay = 1/30
    <strong>if</strong> dt &gt; delay <strong>then</strong>
        love.timer.sleep(delay - dt)
    <strong>end</strong>
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- Callback funkce zavolaná při stisku klávesy.</i>
<i>--</i>
<strong>function</strong> love.keypressed(k)
    <strong>if</strong> k == 'escape' <strong>then</strong>
        love.event.quit()
    <strong>end</strong>
<strong>end</strong>
&nbsp;
&nbsp;
&nbsp;
<i>--</i>
<i>-- finito</i>
<i>--</i>
</pre>

<a href="http://fedora.cz/wp-content/uploads/2015/09/12.png"><img class="alignnone size-medium wp-image-5587" src="http://fedora.cz/wp-content/uploads/2015/09/12.png" alt="12" width="450" height="450" /></a>
<p><i>Obrázek 12: Screenshot jedenáctého demonstračního příkladu: začátek animace.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/13.png"><img class="alignnone size-medium wp-image-5588" src="http://fedora.cz/wp-content/uploads/2015/09/13.png" alt="13" width="450" height="450" /></a>
<p><i>Obrázek 13: Screenshot jedenáctého demonstračního příkladu: průběh animace.</i></p>

<a href="http://fedora.cz/wp-content/uploads/2015/09/14.png"><img class="alignnone size-full wp-image-5589" src="http://fedora.cz/wp-content/uploads/2015/09/14.png" alt="14" width="450" height="450" /></a>
<p><i>Obrázek 14: Screenshot jedenáctého demonstračního příkladu: průběh animace.</i></p>



<p><a name="k13"></a></p>
<h2 id="k13">13. Repositář se zdrojovými kódy dnešních demonstračních příkladů</h2>

<p>Všech šest demonstračních příkladů, s&nbsp;nimiž jsme se v&nbsp;dnešním článku seznámili, bylo uloženo do Git repositáře na GitHubu (<a href="https://github.com/tisnik/presentations">https://github.com/tisnik/presentations</a>):</p>

<table>
<tr><th>#</th><th>Příklad</th><th>Zdrojový kód</th></tr>
<tr><td>1</td><td>example06 pro v0.8</td><td><a href="https://github.com/tisnik/presentations/tree/master/love/example06">https://github.com/tisnik/presentations/tree/master/love/example06</a></td></tr>
<tr><td>2</td><td>example06 pro v0.9</td><td><a href="https://github.com/tisnik/presentations/tree/master/love/example06_v09">https://github.com/tisnik/presentations/tree/master/love/example06_v09</a></td></tr>
<tr><td>3</td><td>example07 pro v0.8</td><td><a href="https://github.com/tisnik/presentations/tree/master/love/example07">https://github.com/tisnik/presentations/tree/master/love/example07</a></td></tr>
<tr><td>4</td><td>example07 pro v0.9</td><td><a href="https://github.com/tisnik/presentations/tree/master/love/example07_v09">https://github.com/tisnik/presentations/tree/master/love/example07_v09</a></td></tr>
<tr><td>5</td><td>example08</td><td><a href="https://github.com/tisnik/presentations/tree/master/love/example08">https://github.com/tisnik/presentations/tree/master/love/example08</a></td></tr>
<tr><td>6</td><td>example09</td><td><a href="https://github.com/tisnik/presentations/tree/master/love/example09">https://github.com/tisnik/presentations/tree/master/love/example09</a></td></tr>
<tr><td>7</td><td>example10</td><td><a href="https://github.com/tisnik/presentations/tree/master/love/example10">https://github.com/tisnik/presentations/tree/master/love/example10</a></td></tr>
<tr><td>8</td><td>example11</td><td><a href="https://github.com/tisnik/presentations/tree/master/love/example11">https://github.com/tisnik/presentations/tree/master/love/example11</a></td></tr>
</table>



<p><a name="k14"></a></p>
<h2 id="k14">14. Odkazy na Internetu</h2>

<ol>

<li>Domovská stránka systému LÖVE<br />
<a href="http://love2d.org/">http://love2d.org/</a>
</li>

<li>Dokumentace k&nbsp;systému LÖVE<br />
<a href="http://love2d.org/wiki/love">http://love2d.org/wiki/love</a>
</li>

<li>Domovská stránka programovacího jazyka Lua<br />
<a href="http://www.lua.org/ ">http://www.lua.org/ </a>
</li>

<li>Seriál o programovacím jazyku Lua (root.cz):<br />
<a href="http://www.root.cz/serialy/programovaci-jazyk-lua/">http://www.root.cz/serialy/programovaci-jazyk-lua/</a>
</li>

<li>Domovská stránka systému LÖVE<br />
<a href="http://love2d.org/">http://love2d.org/</a>
</li>

<li>Domovská stránka programovacího jazyka Lua<br />
<a href="http://www.lua.org/ ">http://www.lua.org/ </a>
</li>

<li>Web o Lieru, Gusanos, GeneRally, Atari atd.<br />
<a href="http://karelik.wz.cz/">http://karelik.wz.cz/</a>
</li>

<li>Web o Lieru, Gusanos<br />
<a href="http://karelik.wz.cz/gusanos.php">http://karelik.wz.cz/gusanos.php</a>
</li>

<li>GUSANOS<br />
<a href="http://gusanos.sourceforge.net/">http://gusanos.sourceforge.net/</a>
</li>

<li>GUSANOS Download<br />
<a href="http://sourceforge.net/projects/gusanos/">http://sourceforge.net/projects/gusanos/</a>
</li>

<li>Lua<br />
<a href="http://www.linuxexpres.cz/praxe/lua">http://www.linuxexpres.cz/praxe/lua</a>
</li>

<li>Lua<br />
<a href="http://cs.wikipedia.org/wiki/Lua">http://cs.wikipedia.org/wiki/Lua</a>
</li>

<li>Lua (programming language)<br />
<a href="http://en.wikipedia.org/wiki/Lua_(programming_language)">http://en.wikipedia.org/wiki/Lua_(programming_language)</a>
</li>

<li>The Lua Programming Language<br />
<a href="http://www.tiobe.com/index.php/paperinfo/tpci/Lua.html">http://www.tiobe.com/index.php/paperinfo/tpci/Lua.html</a>
</li>

<li>Lua Programming Gems<br />
<a href="http://www.lua.org/gems/">http://www.lua.org/gems/</a>
</li>

<li>LuaForge<br />
<a href="http://luaforge.net/">http://luaforge.net/</a>
</li>

<li>Forge project tree<br />
<a href="http://luaforge.net/softwaremap/trove_list.php">http://luaforge.net/softwaremap/trove_list.php</a>
</li>

<li>SdlBasic home page<br />
<a href="http://www.sdlbasic.altervista.org/main/">http://www.sdlbasic.altervista.org/main/</a>
</li>

<li>SdlBasic examples<br />
<a href="http://nitrofurano.linuxkafe.com/sdlbasic/">http://nitrofurano.linuxkafe.com/sdlbasic/</a>
</li>

<li>SdlBasic na Wikipedii<br />
<a href="http://en.wikipedia.org/wiki/SdlBasic">http://en.wikipedia.org/wiki/SdlBasic</a>
</li>

<li>Simple DirectMedia Layer<br />
<a href="http://en.wikipedia.org/wiki/Simple_DirectMedia_Layer">http://en.wikipedia.org/wiki/Simple_DirectMedia_Layer</a>
</li>

<li>SDLBASIC &ndash; The high-level interpreter for all?<br />
<a href="http://openbytes.wordpress.com/2008/11/08/sdlbasic-the-high-level-interpreter-for-all/">http://openbytes.wordpress.com/2008/11/08/sdlbasic-the-high-level-interpreter-for-all/</a>
</li>

<li>FreeBasic home page<br />
<a href="http://www.freebasic.net/">http://www.freebasic.net/</a>
</li>

<li>FreeBASIC (Wikipedia EN)<br />
<a href="https://en.wikipedia.org/wiki/FreeBASIC">https://en.wikipedia.org/wiki/FreeBASIC</a>
</li>

<li>FreeBASIC Wiki<br />
<a href="http://www.freebasic.net/wiki/wikka.php?wakka=FBWiki">http://www.freebasic.net/wiki/wikka.php?wakka=FBWiki</a>
</li>

<li>FreeBASIC Manual<br />
<a href="http://www.freebasic.net/wiki/wikka.php?wakka=DocToc">http://www.freebasic.net/wiki/wikka.php?wakka=DocToc</a>
</li>

<li>FreeBASIC (Wikipedia CZ)<br />
<a href="http://cs.wikipedia.org/wiki/FreeBASIC">http://cs.wikipedia.org/wiki/FreeBASIC</a>
</li>

<li>The Griffon Legend<br />
<a href="http://syn9.thingie.net/?table=griffonlegend">http://syn9.thingie.net/?table=griffonlegend</a>
</li>

<li>Seriál Letní škola programovacího jazyka Logo<br />
<a href="http://www.root.cz/serialy/letni-skola-programovaciho-jazyka-logo/">http://www.root.cz/serialy/letni-skola-programovaciho-jazyka-logo/</a>
</li>

<li>Scratch: oficiální stránka projektu<br />
<a href="http://scratch.mit.edu/">http://scratch.mit.edu/</a>
</li>

<li>Scratch: galerie projektů vytvořených ve Scratchi<br />
<a href="http://scratch.mit.edu/galleries/browse/newest">http://scratch.mit.edu/galleries/browse/newest</a>
</li>

<li>Scratch: nápověda<br />
<a href="file:///usr/share/scratch/Help/en/index.html">file:///usr/share/scratch/Help/en/index.html</a>
</li>

<li>Scratch: obrazovky nápovědy<br />
<a href="file:///usr/share/scratch/Help/en/allscreens.html">file:///usr/share/scratch/Help/en/allscreens.html</a>
</li>

<li>Scratch (Wikipedie CZ)<br />
<a href="http://cs.wikipedia.org/wiki/Scratch">http://cs.wikipedia.org/wiki/Scratch</a>
</li>

<li>Scratch (programming language)<br />
<a href="http://en.wikipedia.org/wiki/Scratch_(programming_language)">http://en.wikipedia.org/wiki/Scratch_(programming_language)</a>
</li>

<li>Scratch Modification<br />
<a href="http://wiki.scratch.mit.edu/wiki/Scratch_Modification">http://wiki.scratch.mit.edu/wiki/Scratch_Modification</a>
</li>

<li>Scratch Lowers Resistance to Programming<br />
<a href="http://www.wired.com/gadgetlab/2009/03/scratch-lowers/">http://www.wired.com/gadgetlab/2009/03/scratch-lowers/</a>
</li>

<li>Snap!<br />
<a href="http://snap.berkeley.edu/">http://snap.berkeley.edu/</a>
</li>

<li>Prostředí Snap!<br />
<a href="http://snap.berkeley.edu/snapsource/snap.html">http://snap.berkeley.edu/snapsource/snap.html</a>
</li>

<li>Alternatives to Scratch<br />
<a href="http://wiki.scratch.mit.edu/wiki/Alternatives_to_Scratch">http://wiki.scratch.mit.edu/wiki/Alternatives_to_Scratch</a>
</li>

<li>Basic-256 home page<br />
<a href="http://www.basic256.org/index_en">http://www.basic256.org/index_en</a>
</li>

<li>Basic-256 Language Documentation<br />
<a href="http://doc.basic256.org/doku.php">http://doc.basic256.org/doku.php</a>
</li>

<li>Basic-256 Art Gallery<br />
<a href="http://www.basic256.org/artgallery">http://www.basic256.org/artgallery</a>
</li>

<li>Basic-256 Tutorial<br />
<a href="http://www.basic256.org/tutorials">http://www.basic256.org/tutorials</a>
</li>

<li>Why BASIC?<br />
<a href="http://www.basic256.org/whybasic">http://www.basic256.org/whybasic</a>
</li>

<li>A book to teach ANYBODY how to program a computer (using BASIC)<br />
<a href="http://www.basicbook.org/">http://www.basicbook.org/</a>
</li>

<li>BASIC Computer Games (published 1978) - Hammurabi<br />
<a href="http://atariarchives.org/basicgames/showpage.php?page=78">http://atariarchives.org/basicgames/showpage.php?page=78</a>
</li>

<li>Hamurabi - zdrojový kód v BASICu<br />
<a href="http://www.dunnington.u-net.com/public/basicgames/HMRABI">http://www.dunnington.u-net.com/public/basicgames/HMRABI</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2015</small></p>
</body>
</html>

