<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Programovací jazyky a knihovny určené pro výuku základů počítačové grafiky: detekce kolize spritů</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Programovací jazyky a knihovny určené pro výuku základů počítačové grafiky: detekce kolize spritů</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V dnešní části seriálu o programovacích jazycích i o knihovnách a frameworcích vhodných pro <a href="http://mojefedora.cz/stitek/vyuka/">výuku programování</a> popř.&nbsp;pro výuku základů počítačové <a href="http://mojefedora.cz/stitek/grafika/">grafiky</a>, si ukážeme, jakým způsobem se v knihovně Pygame může detekovat kolize dvou či více spritů. To je velmi důležitá operace, s&nbsp;níž se setkáme v&nbsp;prakticky každé 2D hře.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Programovací jazyky a knihovny určené pro výuku základů počítačové grafiky: detekce kolize spritů</a></p>
<p><a href="#k02">2. Použití funkce <strong>pygame.sprite.spritecollide</strong> pro detekci kolize spritů</a></p>
<p><a href="#k03">3. Zdrojový kód demonstračního příkladu <strong>pygame20</strong>: základní detekce kolize spritů</a></p>
<p><a href="#k04">4. Vylepšení předchozího kódu: detekce hráče se sebou samým je ignorována</a></p>
<p><a href="#k05">5. Zdrojový kód demonstračního příkladu <strong>pygame21</strong></a></p>
<p><a href="#k06">6. Zvýraznění spritu, s&nbsp;nímž došlo ke kolizi</a></p>
<p><a href="#k07">7. Zdrojový kód demonstračního příkladu <strong>pygame22</strong>: vysvícení spritů</a></p>
<p><a href="#k08">8. Kolize se sprity, které nemají čtvercový či obdélníkový tvar</a></p>
<p><a href="#k09">9. Zdrojový kód demonstračního příkladu <strong>pygame23</strong>: špatně vypočtená kolize kruhových spritů</a></p>
<p><a href="#k10">10. Zdrojový kód demonstračního příkladu <strong>pygame24</strong>: použití korektní detekce kolize</a></p>
<p><a href="#k11">11. Obsah následující části seriálu</a></p>
<p><a href="#k12">12. Repositář se zdrojovými kódy všech dnešních demonstračních příkladů</a></p>
<p><a href="#k13">13. Funkce použité v&nbsp;dnešních demonstračních příkladech</a></p>
<p><a href="#k14">14. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Programovací jazyky a knihovny určené pro výuku základů počítačové grafiky: detekce kolize spritů</h2>

<p><a href="http://mojefedora.cz/programovaci-jazyky-a-knihovny-urcene-pro-vyuku-zakladu-pocitacove-grafiky-sprity-v-knihovne-pygame/">V&nbsp;předchozí části</a> seriálu o systémech, knihovnách a jazycích vhodných pro výuku programování počítačové grafiky, jsme se seznámili s&nbsp;tím, jakým způsobem lze v&nbsp;knihovně <i>Pygame</i> pracovat s&nbsp;takzvanými <i>sprity</i>, tj.&nbsp;s&nbsp;rastrovými obrázky, s&nbsp;nimiž je možné pohybovat po celé dvourozměrné scéně. Sprity samozřejmě mohou úplně či částečně překreslit pozadí vytvářené scény, mohou se v&nbsp;případě potřeby navzájem překrývat, při překrytí lze aplikovat již dříve popsanou průhlednost apod.</p>

<img class="alignnone size-medium wp-image-6428" src="http://mojefedora.cz/wp-content/uploads/2016/01/01-450x338.png" alt="01" width="450" height="338" />
<p><i>Obrázek 1: Sprity použité ve známé herní sérii Sonic the Hedgehog.</i></p>

<p>Ovšem zbývá nám vyřešit ještě jeden relativně závažný problém úzce související se sprity &ndash; v&nbsp;mnoha aplikacích (především v&nbsp;počítačových hrách) je nutné nějakým způsobem zareagovat ve chvíli, kdy dojde ke kolizi či k&nbsp;překryvu dvou spritů. Představme si například hru Pac-Man, která musí adekvátně reagovat při srážce hlavního hrdiny s&nbsp;duchem, zareagovat na sežrání bodu (což je taktéž srážka spritu/spritů) apod. I tyto případy, které byly v&nbsp;minulosti řešeny už na úrovni příslušného hardware (video čipu), jsou samozřejmě v&nbsp;knihovně <i>Pygame</i> relativně jednoduše vyřešitelné, což ostatně uvidíme v&nbsp;navazujících kapitolách.</p>

<img class="alignnone size-medium wp-image-6429" src="http://mojefedora.cz/wp-content/uploads/2016/01/02-450x295.png" alt="02" width="450" height="295" />
<p><i>Obrázek 2: Starší varianta hry Pac-Man, zde pro osmibitovou herní konzoli Atari 2600.</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Použití funkce <strong>pygame.sprite.spritecollide</strong> pro detekci kolize spritů</h2>

<p>Připomeňme si, že každý sprite je v&nbsp;knihovně <i>Pygame</i> charakterizován svým rastrovým obrázkem, dále pak rozměry (šířka&times;výška) a taktéž pozicí v&nbsp;dvourozměrné scéně. Obě poslední hodnoty, tj.&nbsp;jak rozměry, tak i pozice spritu ve scéně, jsou uloženy v&nbsp;jediné datové struktuře typu <strong>rect</strong>. Test, zda došlo ke kolizi dvou spritů, lze tedy v&nbsp;nejjednodušším případě realizovat testem na protnutí dvou obdélníků charakterizovaných již zmíněnou strukturou <strong>rect</strong>. Aby nebylo nutné kód pro detekci kolizí spritů psát neustále znovu, lze využít funkci <a href="http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.spritecollide">pygame.sprite.spritecollide()</a>. Tato funkce akceptuje tři nebo čtyři parametry (čtvrtý parametr je totiž nepovinný):</p>

<ol>

<li><strong>sprite</strong> &ndash; sprite, pro nějž se zjišťuje potenciální kolize s&nbsp;ostatními sprity.</li>

<li><strong>group</strong> &ndash; skupina spritů, s&nbsp;nimiž může první sprite kolidovat (kolize mezi jednotlivými sprity ve skupině se však nezjišťuje).</li>

<li><strong>dokill</strong> &ndash; pokud je tento parametr nastavený na pravdivostní hodnotu <strong>True</strong>, je kolidující sprite ze skupiny odstraněn. V&nbsp;opačném případě nedojde k&nbsp;žádné změně v&nbsp;předané skupině.</li>

<li><strong>collided</strong> &ndash; v&nbsp;případě, že je tento parametr specifikován, musí se jednat o funkci, které se předají dva sprity a funkce vrátí hodnotu <strong>True</strong>, pokud dojde k&nbsp;jejich kolizi.</li>

</ol>

<p>Funkce <strong>pygame.sprite.spritecollide()</strong> vrátí seznam obsahující ty sprity ze skupiny <strong>group</strong>, které kolidují s&nbsp;prvním spritem předaným v&nbsp;parametru <strong>sprite</strong>. Sprity samozřejmě nejsou do tohoto seznamu kopírovány, ale je použita jen reference na ně (což nám umožňuje provádět operace nad původními objekty).</p>

<img class="alignnone size-medium wp-image-6430" src="http://mojefedora.cz/wp-content/uploads/2016/01/03.png" alt="03" width="322" height="264" />
<p><i>Obrázek 3: Povšimněte si počitadla kolizí zobrazeného v&nbsp;titulku okna tohoto demonstračního příkladu (jednička zde znamená, že hráč koliduje sám se sebou, což je jeden z&nbsp;nedostatků dále popsaného příkladu).</i></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Zdrojový kód demonstračního příkladu <strong>pygame20</strong>: základní detekce kolize spritů</h2>

<p>V&nbsp;dnešním prvním demonstračním příkladu (v&nbsp;celkovém pořadí se však jedná už o příklad dvacátý) je ukázáno použití výše zmíněné funkce <strong>pygame.sprite.spritecollide()</strong>. Celý program je založen na kódu, s&nbsp;nímž jsme se již seznámili minule, ovšem došlo k&nbsp;přidání několika nepohyblivých spritů a taktéž funkce <strong>check_collisions()</strong>. V&nbsp;této periodicky volané funkci se zjistí, zda došlo ke kolizi hráče (resp.&nbsp;přesněji řečeno spritu reprezentujícího hráče) s&nbsp;některým dalším spritem. Následně se do titulkového pruhu okna vypíše celkový počet kolizí, který se velmi snadno vypočítá z&nbsp;délky seznamu, který funkce <strong>pygame.sprite.spritecollide()</strong> vrátí. Počet kolizí bude o jedničku vyšší, a to z&nbsp;toho důvodu, že samotný hráč je taktéž přidán do skupiny <i>sprite_group</i> (a každý sprite samozřejmě koliduje sám se sebou). Podívejme se nyní na výpis celého zdrojového kódu tohoto demonstračního příkladu:</p>

<pre>
#!/usr/bin/python
# vim: set fileencoding=utf-8

# Demonstrační příklady využívající knihovnu Pygame

# Příklad číslo 20: použití spritů, pohyblivý sprite


import pygame, sys, os, math

# Nutno importovat kvůli konstantám QUIT atd.
from pygame.locals import *

# Velikost okna aplikace
WIDTH = 320
HEIGHT = 240



# Třída představující sprite zobrazený jako jednobarevný čtverec.
class BlockySprite(pygame.sprite.Sprite):
    # Konstruktor
    def __init__(self, color, size, x, y):
        # Nejprve je nutné zavolat konstruktor předka,
        # tj. konstruktor třídy pygame.sprite.Sprite:
        pygame.sprite.Sprite.__init__(self)

        # Vytvoření obrázku představujícího vizuální obraz spritu:
        self.image = pygame.Surface([size,size])
        self.image.fill(color)

        # Vytvoření obalového obdélníku
        # (velikost se získá z rozměru obrázku)
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

        # Počáteční rychlost spritu
        self.speed_x = 0
        self.speed_y = 0



# Inicializace knihovny Pygame
pygame.init()

clock = pygame.time.Clock()

# Vytvoření okna pro vykreslování
display = pygame.display.set_mode([WIDTH, HEIGHT])

# Nastavení titulku okna
pygame.display.set_caption('Pygame test #20')

# Konstanty s n-ticemi představujícími základní barvy
BLACK   = (  0,   0,   0)
RED     = (255,   0,   0)
GRAY    = (128, 128, 128)

# Objekt sdružující všechny sprity
all_sprites = pygame.sprite.Group()

# Vytvoření několika typů spritů
#                     barva  x   y velikost
wall1  = BlockySprite(GRAY, 50, 10, 10)
wall2  = BlockySprite(GRAY, 15, 100, 100)
wall3  = BlockySprite(GRAY, 15, 100, 150)
wall4  = BlockySprite(GRAY, 15, 200, 100)
wall5  = BlockySprite(GRAY, 15, 200, 150)
player = BlockySprite(RED,  25, WIDTH/2-12, HEIGHT/2-12)

# Přidání několika dalších spritů do seznamu
# (jen jeden sprite - ten poslední - bude ve skutečnosti pohyblivý)
all_sprites.add(wall1)
all_sprites.add(wall2)
all_sprites.add(wall3)
all_sprites.add(wall4)
all_sprites.add(wall5)
all_sprites.add(player)



# Posun všech spritů ve skupině na základě jejich rychlosti
def move_sprites(sprite_group, playground_width, playground_height):
    for sprite in sprite_group:
        # Posun spritu
        sprite.rect.x = sprite.rect.x + sprite.speed_x
        sprite.rect.y = sprite.rect.y + sprite.speed_y
        # Kontrola, zda sprite nenarazil do okrajů okna
        if sprite.rect.x &lt;/gc 0:
            sprite.rect.x = 0
            sprite.speed_x = 0
        if sprite.rect.x + sprite.rect.width &gt;/gc playground_width:
            sprite.rect.x = playground_width - sprite.rect.width
            sprite.speed_x = 0
        if sprite.rect.y &lt;/gc 0:
            sprite.rect.y = 0
            sprite.speed_y = 0
        if sprite.rect.y + sprite.rect.height &gt;/gc playground_height:
            sprite.rect.y = playground_height - sprite.rect.height
            sprite.speed_y = 0



# Vykreslení celé scény na obrazovku
def draw_scene(display, background_color, sprite_group):
    # Vyplnění plochy okna černou barvou
    display.fill(background_color)
    # Vykreslení celé skupiny spritů do bufferu
    sprite_group.draw(display)
    # Obnovení obsahu obrazovky (překlopení zadního a předního bufferu)
    pygame.display.update()



# Zjistí kolize spritu se "stěnami" (nepohyblivými sprity)
def check_collisions(player, sprite_group):
    # Vytvoření seznamu spritů, které kolidují s hráčem
    hit_list = pygame.sprite.spritecollide(player, sprite_group, False)
    collisions = len(hit_list)
    # Přenastavení titulku okna
    pygame.display.set_caption('Pygame test #20: collisions ' + str(collisions))



# Hlavní herní smyčka
while True:
    # Načtení a zpracování všech událostí z fronty
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
        if event.type == KEYDOWN:
            if event.key == K_ESCAPE:
                pygame.quit()
                sys.exit()
            # Stiskem kurzorových kláves je možné měnit směr pohybu spritu
            elif event.key == pygame.K_LEFT:
                player.speed_x = -3
            elif event.key == pygame.K_RIGHT:
                player.speed_x = +3
            elif event.key == pygame.K_UP:
                player.speed_y = -3
            elif event.key == pygame.K_DOWN:
                player.speed_y = +3
        if event.type == KEYUP:
            # Puštění kurzorových kláves vede k zastavení pohybu spritu
            if event.key == pygame.K_LEFT:
                player.speed_x = 0
            elif event.key == pygame.K_RIGHT:
                player.speed_x = 0
            elif event.key == pygame.K_UP:
                player.speed_y = 0
            elif event.key == pygame.K_DOWN:
                player.speed_y = 0

    move_sprites(all_sprites, display.get_width(), display.get_height())
    check_collisions(player, all_sprites)
    draw_scene(display, BLACK, all_sprites)
    clock.tick(20)

# finito
</pre>

<img class="alignnone size-medium wp-image-6431" src="http://mojefedora.cz/wp-content/uploads/2016/01/04.png" alt="04" width="322" height="264" />
<p><i>Obrázek 4: Kolize hráče s&nbsp;jiným (nepohyblivým) spritem. Počitadlo zde dosáhlo hodnoty 2.</i></p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Vylepšení předchozího kódu: detekce hráče se sebou samým je ignorována</h2>

<p>Předchozí příklad trpěl jednou nectností při výpočtu kolizí, která by v&nbsp;praxi komplikovala způsob dalšího použití seznamu spritů, jež kolidují s&nbsp;hráčem. Vzhledem k&nbsp;tomu, že sprite představující samotného hráče je součástí seznamu všech spritů, je vždy detekována minimálně jedna kolize, a to konkrétně kolize hráče se sebou samým. Aby se tomuto nedostatku předešlo, je možné vytvořit dva seznamy spritů, přičemž první seznam bude obsahovat všechny sprity a druhý seznam všechny sprity kromě samotného hráče. První seznam bude používán pro vykreslování, druhý pak pouze pro detekci kolizí. Podívejme se nyní, jak tuto změnu realizovat.</p>

<p>Nejprve vytvoříme všechny sprity. Ve skutečnosti ani nepotřebujeme reference na sprity ukládat do samostatných proměnných, je to však přehlednější:</p>

<pre>
# Vytvoření několika typů spritů
#                     barva  x   y velikost
wall1  = BlockySprite(GRAY, 50, 10, 10)
wall2  = BlockySprite(GRAY, 15, 100, 100)
wall3  = BlockySprite(GRAY, 15, 100, 150)
wall4  = BlockySprite(GRAY, 15, 200, 100)
wall5  = BlockySprite(GRAY, 15, 200, 150)
player = BlockySprite(RED,  25, WIDTH/2-12, HEIGHT/2-12)
</pre>

<p>Dále vytvoříme seznam všech spritů, tj.&nbsp;jak nepohyblivých spritů, tak i samotného hráče:</p>

<pre>
# Objekt sdružující všechny sprity
all_sprites = pygame.sprite.Group()

# Přidání několika dalších spritů do seznamu
# (jen jeden sprite - ten poslední - bude ve skutečnosti pohyblivý)
all_sprites.add(wall1)
all_sprites.add(wall2)
all_sprites.add(wall3)
all_sprites.add(wall4)
all_sprites.add(wall5)
all_sprites.add(player)
</pre>

<p>Dále vytvoříme seznam všech spritů, ovšem bez hráče:</p>

<pre>
# Objekt sdružující všechny sprity kromě hráče
all_sprites_but_player = pygame.sprite.Group()

# Seznam všech nepohyblivých spritů
all_sprites_but_player.add(wall1)
all_sprites_but_player.add(wall2)
all_sprites_but_player.add(wall3)
all_sprites_but_player.add(wall4)
all_sprites_but_player.add(wall5)
</pre>

<p>Kolize se budou testovat mezi hráčem (<strong>player</strong>) a druhým seznamem (<strong>all_sprites_but_player</strong>):</p>

<pre>
check_collisions(player, all_sprites_but_player)
</pre>

<img class="alignnone size-medium wp-image-6432" src="http://mojefedora.cz/wp-content/uploads/2016/01/05.png" alt="05" width="322" height="264" />
<p><i>Obrázek 5: Úprava programového kódu: prozatím nedošlo ke kolizi hráče s&nbsp;jiným (nepohyblivým) spritem, počitadlo tedy správně ukazuje hodnotu 0.</i></p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Zdrojový kód demonstračního příkladu <strong>pygame21</strong></h2>

<p>Úprava předchozího programového kódu způsobem naznačeným <a href="#k04">v&nbsp;předchozí kapitole</a> vedla ke vzniku nového příkladu, jehož úplný zdrojový kód je vypsán pod tímto odstavcem. Povšimněte si zejména způsobu manipulace s&nbsp;datovými strukturami uloženými v&nbsp;proměnných <strong>all_sprites</strong> a <strong>all_sprites_but_player</strong>:</p>

<pre>
#!/usr/bin/python
# vim: set fileencoding=utf-8

# Demonstrační příklady využívající knihovnu Pygame

# Příklad číslo 21: použití spritů, pohyblivý sprite


import pygame, sys, os, math

# Nutno importovat kvůli konstantám QUIT atd.
from pygame.locals import *

# Velikost okna aplikace
WIDTH = 320
HEIGHT = 240



# Třída představující sprite zobrazený jako jednobarevný čtverec.
class BlockySprite(pygame.sprite.Sprite):
    # Konstruktor
    def __init__(self, color, size, x, y):
        # Nejprve je nutné zavolat konstruktor předka,
        # tj. konstruktor třídy pygame.sprite.Sprite:
        pygame.sprite.Sprite.__init__(self)

        # Vytvoření obrázku představujícího vizuální obraz spritu:
        self.image = pygame.Surface([size,size])
        self.image.fill(color)

        # Vytvoření obalového obdélníku
        # (velikost se získá z rozměru obrázku)
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

        # Počáteční rychlost spritu
        self.speed_x = 0
        self.speed_y = 0



# Inicializace knihovny Pygame
pygame.init()

clock = pygame.time.Clock()

# Vytvoření okna pro vykreslování
display = pygame.display.set_mode([WIDTH, HEIGHT])

# Nastavení titulku okna
pygame.display.set_caption('Pygame test #21')

# Konstanty s n-ticemi představujícími základní barvy
BLACK   = (  0,   0,   0)
RED     = (255,   0,   0)
GRAY    = (128, 128, 128)

# Objekt sdružující všechny sprity
all_sprites = pygame.sprite.Group()
# Objekt sdružující všechny sprity kromě hráče
all_sprites_but_player = pygame.sprite.Group()

# Vytvoření několika typů spritů
#                     barva  x   y velikost
wall1  = BlockySprite(GRAY, 50, 10, 10)
wall2  = BlockySprite(GRAY, 15, 100, 100)
wall3  = BlockySprite(GRAY, 15, 100, 150)
wall4  = BlockySprite(GRAY, 15, 200, 100)
wall5  = BlockySprite(GRAY, 15, 200, 150)
player = BlockySprite(RED,  25, WIDTH/2-12, HEIGHT/2-12)

# Přidání několika dalších spritů do seznamu
# (jen jeden sprite - ten poslední - bude ve skutečnosti pohyblivý)
all_sprites.add(wall1)
all_sprites.add(wall2)
all_sprites.add(wall3)
all_sprites.add(wall4)
all_sprites.add(wall5)
all_sprites.add(player)

# Seznam všech nepohyblivých spritů
all_sprites_but_player.add(wall1)
all_sprites_but_player.add(wall2)
all_sprites_but_player.add(wall3)
all_sprites_but_player.add(wall4)
all_sprites_but_player.add(wall5)



# Posun všech spritů ve skupině na základě jejich rychlosti
def move_sprites(sprite_group, playground_width, playground_height):
    for sprite in sprite_group:
        # Posun spritu
        sprite.rect.x = sprite.rect.x + sprite.speed_x
        sprite.rect.y = sprite.rect.y + sprite.speed_y
        # Kontrola, zda sprite nenarazil do okrajů okna
        if sprite.rect.x &lt;/gc 0:
            sprite.rect.x = 0
            sprite.speed_x = 0
        if sprite.rect.x + sprite.rect.width &gt;/gc playground_width:
            sprite.rect.x = playground_width - sprite.rect.width
            sprite.speed_x = 0
        if sprite.rect.y &lt;/gc 0:
            sprite.rect.y = 0
            sprite.speed_y = 0
        if sprite.rect.y + sprite.rect.height &gt;/gc playground_height:
            sprite.rect.y = playground_height - sprite.rect.height
            sprite.speed_y = 0



# Vykreslení celé scény na obrazovku
def draw_scene(display, background_color, sprite_group):
    # Vyplnění plochy okna černou barvou
    display.fill(background_color)
    # Vykreslení celé skupiny spritů do bufferu
    sprite_group.draw(display)
    # Obnovení obsahu obrazovky (překlopení zadního a předního bufferu)
    pygame.display.update()



# Zjistí kolize spritu se "stěnami" (nepohyblivými sprity)
def check_collisions(player, sprite_group):
    # Vytvoření seznamu spritů, které kolidují s hráčem
    hit_list = pygame.sprite.spritecollide(player, sprite_group, False)
    collisions = len(hit_list)
    # Přenastavení titulku okna
    pygame.display.set_caption('Pygame test #21: collisions ' + str(collisions))



# Hlavní herní smyčka
while True:
    # Načtení a zpracování všech událostí z fronty
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
        if event.type == KEYDOWN:
            if event.key == K_ESCAPE:
                pygame.quit()
                sys.exit()
            # Stiskem kurzorových kláves je možné měnit směr pohybu spritu
            elif event.key == pygame.K_LEFT:
                player.speed_x = -3
            elif event.key == pygame.K_RIGHT:
                player.speed_x = +3
            elif event.key == pygame.K_UP:
                player.speed_y = -3
            elif event.key == pygame.K_DOWN:
                player.speed_y = +3
        if event.type == KEYUP:
            # Puštění kurzorových kláves vede k zastavení pohybu spritu
            if event.key == pygame.K_LEFT:
                player.speed_x = 0
            elif event.key == pygame.K_RIGHT:
                player.speed_x = 0
            elif event.key == pygame.K_UP:
                player.speed_y = 0
            elif event.key == pygame.K_DOWN:
                player.speed_y = 0

    move_sprites(all_sprites, display.get_width(), display.get_height())
    check_collisions(player, all_sprites_but_player)
    draw_scene(display, BLACK, all_sprites)
    clock.tick(20)

# finito
</pre>

<img class="alignnone size-medium wp-image-6433" src="http://mojefedora.cz/wp-content/uploads/2016/01/06-1.png" alt="06" width="322" height="264" />
<p><i>Obrázek 6: Kolize hráče s&nbsp;jiným (nepohyblivým) spritem, počitadlo správně ukazuje hodnotu 1.</i></p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Zvýraznění spritu, s&nbsp;nímž došlo ke kolizi</h2>

<p>Výše uvedený příklad nyní upravíme takovým způsobem, aby se sprite, s&nbsp;níž hráč koliduje, vybarvil, a tím pádem i ve vykreslované 2D scéně zvýraznil. Výchozí barva spritů bude nastavena na světle šedou, barva spritu, do něhož narazí hráč, pak na barvu žlutou. Úprava programového kódu je ve skutečnosti velmi jednoduchá. Nejprve je nutné doplnit třídu <strong>BlockySprite</strong> o dvě nové metody pojmenované <strong>yellowColor()</strong> a <strong>grayColor()</strong>. Tyto metody po svém zavolání jednoduše vybarví celou plochu spritu zadanou barvou. Nejedná se sice o nejrychlejší řešení, ale prozatím je dostatečně rychlé i pro spuštění příkladu na (relativně) pomalém Raspberry Pi:</p>

<pre>
# Třída představující sprite zobrazený jako jednobarevný čtverec.
class BlockySprite(pygame.sprite.Sprite):
    ...
    ...
    ...

    # Nastavení barvy spritu, který kolidoval s hráčem
    def yellowColor(self):
        self.image.fill(YELLOW)

    # Nastavení barvy spritu, který nekolidoval s hráčem
    def grayColor(self):
        self.image.fill(GRAY)
</pre>

<p>O změnu barvy těch spritů, které kolidují s&nbsp;hráčem, se postará uživatelská funkce nazvaná <strong>change_colors()</strong>. Této funkci se předá seznam všech spritů a taktéž seznam spritů, s&nbsp;nimiž došlo ke kolizi. Na základě obsahu těchto dvou seznamů se každý sprite vybarví šedou nebo žlutou barvou:</p>

<pre>
# Změna barvy spritu na základě kolize s hráčem
def change_colors(sprite_group, hit_list):
    # Projít všemi sprity ze skupiny, kterou detekovala kolizní funkce
    for sprite in sprite_group:
        if sprite in hit_list:
            sprite.yellowColor()
        else:
            sprite.grayColor()
</pre>

<img class="alignnone size-medium wp-image-6434" src="http://mojefedora.cz/wp-content/uploads/2016/01/07-1.png" alt="07" width="322" height="264" />
<p><i>Obrázek 7: Prozatím nenastala kolize hráče s&nbsp;jiným (nepohyblivým) spritem.</i></p>

<img class="alignnone size-medium wp-image-6435" src="http://mojefedora.cz/wp-content/uploads/2016/01/08-1.png" alt="08" width="322" height="264" />
<p><i>Obrázek 8: Kolize hráče s&nbsp;jiným (nepohyblivým) spritem.</i></p>

<img class="alignnone size-medium wp-image-6436" src="http://mojefedora.cz/wp-content/uploads/2016/01/09-1.png" alt="09" width="322" height="264" />
<p><i>Obrázek 9: Kolize hráče s&nbsp;více (konkrétně se dvěma) sprity.</i></p>



<p><a name="k07"></a></p>
<h2 id="k07">7. Zdrojový kód demonstračního příkladu <strong>pygame22</strong>: vysvícení spritů</h2>

<p>Princip popsaný <a href="#k06">v&nbsp;šesté kapitole</a> nyní budeme aplikovat v&nbsp;uceleném programovém kódu, který je kompletně vypsán pod tímto odstavcem:</p>

<pre>
#!/usr/bin/python
# vim: set fileencoding=utf-8

# Demonstrační příklady využívající knihovnu Pygame

# Příklad číslo 22: použití spritů, pohyblivý sprite


import pygame, sys, os, math

# Nutno importovat kvůli konstantám QUIT atd.
from pygame.locals import *

# Velikost okna aplikace
WIDTH = 320
HEIGHT = 240



# Třída představující sprite zobrazený jako jednobarevný čtverec.
class BlockySprite(pygame.sprite.Sprite):
    # Konstruktor
    def __init__(self, color, size, x, y):
        # Nejprve je nutné zavolat konstruktor předka,
        # tj. konstruktor třídy pygame.sprite.Sprite:
        pygame.sprite.Sprite.__init__(self)

        # Vytvoření obrázku představujícího vizuální obraz spritu:
        self.image = pygame.Surface([size,size])
        self.image.fill(color)

        # Vytvoření obalového obdélníku
        # (velikost se získá z rozměru obrázku)
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

        # Počáteční rychlost spritu
        self.speed_x = 0
        self.speed_y = 0

    # Nastavení barvy spritu, který kolidoval s hráčem
    def yellowColor(self):
        self.image.fill(YELLOW)

    # Nastavení barvy spritu, který nekolidoval s hráčem
    def grayColor(self):
        self.image.fill(GRAY)



# Inicializace knihovny Pygame
pygame.init()

clock = pygame.time.Clock()

# Vytvoření okna pro vykreslování
display = pygame.display.set_mode([WIDTH, HEIGHT])

# Nastavení titulku okna
pygame.display.set_caption('Pygame test #22')

# Konstanty s n-ticemi představujícími základní barvy
BLACK   = (  0,   0,   0)
RED     = (255,   0,   0)
GRAY    = (128, 128, 128)
YELLOW  = (255, 255,   0)

# Objekt sdružující všechny sprity
all_sprites = pygame.sprite.Group()
# Objekt sdružující všechny sprity kromě hráče
all_sprites_but_player = pygame.sprite.Group()

# Vytvoření několika typů spritů
#                     barva  x   y velikost
wall1  = BlockySprite(GRAY, 50, 10, 10)
wall2  = BlockySprite(GRAY, 15, 100, 100)
wall3  = BlockySprite(GRAY, 15, 100, 150)
wall4  = BlockySprite(GRAY, 15, 200, 100)
wall5  = BlockySprite(GRAY, 15, 200, 150)
wall6  = BlockySprite(GRAY, 15, 150, 100)
wall7  = BlockySprite(GRAY, 15, 150, 150)
player = BlockySprite(RED,  40, WIDTH/2-20, HEIGHT/2-20)

# Přidání několika dalších spritů do seznamu
# (jen jeden sprite - ten poslední - bude ve skutečnosti pohyblivý)
all_sprites.add(wall1)
all_sprites.add(wall2)
all_sprites.add(wall3)
all_sprites.add(wall4)
all_sprites.add(wall5)
all_sprites.add(wall6)
all_sprites.add(wall7)
all_sprites.add(player)

# Seznam všech nepohyblivých spritů
all_sprites_but_player.add(wall1)
all_sprites_but_player.add(wall2)
all_sprites_but_player.add(wall3)
all_sprites_but_player.add(wall4)
all_sprites_but_player.add(wall5)
all_sprites_but_player.add(wall6)
all_sprites_but_player.add(wall7)



# Posun všech spritů ve skupině na základě jejich rychlosti
def move_sprites(sprite_group, playground_width, playground_height):
    for sprite in sprite_group:
        # Posun spritu
        sprite.rect.x = sprite.rect.x + sprite.speed_x
        sprite.rect.y = sprite.rect.y + sprite.speed_y
        # Kontrola, zda sprite nenarazil do okrajů okna
        if sprite.rect.x &lt;/gc 0:
            sprite.rect.x = 0
            sprite.speed_x = 0
        if sprite.rect.x + sprite.rect.width &gt;/gc playground_width:
            sprite.rect.x = playground_width - sprite.rect.width
            sprite.speed_x = 0
        if sprite.rect.y &lt;/gc 0:
            sprite.rect.y = 0
            sprite.speed_y = 0
        if sprite.rect.y + sprite.rect.height &gt;/gc playground_height:
            sprite.rect.y = playground_height - sprite.rect.height
            sprite.speed_y = 0



# Vykreslení celé scény na obrazovku
def draw_scene(display, background_color, sprite_group):
    # Vyplnění plochy okna černou barvou
    display.fill(background_color)
    # Vykreslení celé skupiny spritů do bufferu
    sprite_group.draw(display)
    # Obnovení obsahu obrazovky (překlopení zadního a předního bufferu)
    pygame.display.update()



# Změna barvy spritu na základě kolize s hráčem
def change_colors(sprite_group, hit_list):
    # Projít všemi sprity ze skupiny, kterou detekovala kolizní funkce
    for sprite in sprite_group:
        if sprite in hit_list:
            sprite.yellowColor()
        else:
            sprite.grayColor()



# Zjistí kolize spritu se "stěnami" (nepohyblivými sprity)
def check_collisions(player, sprite_group):
    # Vytvoření seznamu spritů, které kolidují s hráčem
    hit_list = pygame.sprite.spritecollide(player, sprite_group, False)
    # Změna barev kolidujících spritů
    change_colors(sprite_group, hit_list)
    collisions = len(hit_list)
    # Přenastavení titulku okna
    pygame.display.set_caption('Pygame test #22: collisions ' + str(collisions))



# Hlavní herní smyčka
while True:
    # Načtení a zpracování všech událostí z fronty
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
        if event.type == KEYDOWN:
            if event.key == K_ESCAPE:
                pygame.quit()
                sys.exit()
            # Stiskem kurzorových kláves je možné měnit směr pohybu spritu
            elif event.key == pygame.K_LEFT:
                player.speed_x = -3
            elif event.key == pygame.K_RIGHT:
                player.speed_x = +3
            elif event.key == pygame.K_UP:
                player.speed_y = -3
            elif event.key == pygame.K_DOWN:
                player.speed_y = +3
        if event.type == KEYUP:
            # Puštění kurzorových kláves vede k zastavení pohybu spritu
            if event.key == pygame.K_LEFT:
                player.speed_x = 0
            elif event.key == pygame.K_RIGHT:
                player.speed_x = 0
            elif event.key == pygame.K_UP:
                player.speed_y = 0
            elif event.key == pygame.K_DOWN:
                player.speed_y = 0

    move_sprites(all_sprites, display.get_width(), display.get_height())
    check_collisions(player, all_sprites_but_player)
    draw_scene(display, BLACK, all_sprites)
    clock.tick(20)

# finito
</pre>

<img class="alignnone size-medium wp-image-6437" src="http://mojefedora.cz/wp-content/uploads/2016/01/10-1.png" alt="10" width="322" height="264" />
<p><i>Obrázek 10: Kolize hráče s&nbsp;více (konkrétně se čtyřmi) sprity.</i></p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Kolize se sprity, které nemají čtvercový či obdélníkový tvar</h2>

<p>Tvary všech spritů, které jsme doposud ve všech demonstračních příkladech používali, byly čtvercové či obdélníkové, což znamená, že vizuální tvar spritu na obrazovce přesně odpovídal rozměrům spritů uložených v&nbsp;datové struktuře <strong>rect</strong>. V&nbsp;naprosté většině případů je však nutné v&nbsp;reálných aplikacích pracovat se sprity odlišných tvarů. V&nbsp;knihovně <i>Pygame</i> pro tyto případy existují dva další postupy, jak zjistit kolizi spritů jiných tvarů, než je čtverec nebo obdélník.</p>

<img class="alignnone size-medium wp-image-6438" src="http://mojefedora.cz/wp-content/uploads/2016/01/11-1.png" alt="11" width="24" height="24" />
<p><i>Obrázek 11: Kruhový sprite použitý v&nbsp;dalších příkladech.</i></p>

<p>Pokud se jedná o kruhové sprity, lze použít funkci <strong>pygame.sprite.collide_circle()</strong>, které se předají dva sprity a výsledkem je pravdivostní hodnota nastavená v&nbsp;závislosti na tom, zda se dvě kružnice, kterou oba sprity představují, překrývají či nikoli. Jak již víme z&nbsp;předchozího textu, je možné takovou callback funkci použít v&nbsp;<strong>pygame.sprite.spritecollide()</strong> (předává se ve čtvrtém parametru). Druhá užitečná funkce se jmenuje <strong>pygame.sprite.collide_mask()</strong> a použije se tehdy, pokud je zapotřebí vypočítat kolizi s&nbsp;přesností jednoho pixelu. Tato funkce je však nejpomalejší, proto je vhodné ji používat opravdu pouze ve chvíli, kdy je to kvůli tvarům spritů nezbytně nutné.</p>

<img class="alignnone size-medium wp-image-6439" src="http://mojefedora.cz/wp-content/uploads/2016/01/12-1.png" alt="12" width="64" height="64" />
<p><i>Obrázek 12: Druhý kruhový sprite použitý v&nbsp;dalších příkladech.</i></p>

<img class="alignnone size-medium wp-image-6440" src="http://mojefedora.cz/wp-content/uploads/2016/01/13.png" alt="13" width="64" height="64" />
<p><i>Obrázek 13: Barevně upravené druhý kruhový sprite, který je taktéž použitý v&nbsp;dalších příkladech.</i></p>



<p><a name="k09"></a></p>
<h2 id="k09">9. Zdrojový kód demonstračního příkladu <strong>pygame23</strong>: špatně vypočtená kolize kruhových spritů</h2>

<p>Podívejme se nejprve na příklad, v&nbsp;němž se sice používají kruhové sprity, ale výpočet kolize je prováděn &bdquo;starým&ldquo; způsobem, tj.&nbsp;pouze na základě detekce překryvu obdélníků. Tento příklad se liší od předchozích příkladů v&nbsp;tom ohledu, že se obrázek spritu načte z&nbsp;externího souboru, zatímco dříve jsme sprity jednoduše vyplnili nějakou barvou. Kvůli tomu, že budeme potřebovat zvýraznit náraz hráče do dalších spritů, načteme pro každý sprite dva obrázky, které se budou pouze prohazovat, podobně jako jsme u předchozích příkladů sprity přebarvovali.</p>

<p>Načtení obrázků v&nbsp;konstruktoru třídy <strong>CircularSprite</strong>:</p>

<pre>
        # Načtení obrázků, jeden pro normální sprite,
        # druhý pro sprite, který koliduje s hráčem
        self.normal_image = pygame.image.load("images/" + normal_image_name + ".png")
        self.collision_image = pygame.image.load("images/" + collision_image_name + ".png")

        # Vytvoření obrázku představujícího vizuální obraz spritu:
        self.image = self.normal_image
</pre>

<p>Změna obrázků po detekci kolize je zajištěna dvojicí funkcí:</p>

<pre>
    # Nastavení obrázku u spritu, který kolidoval s hráčem
    def setCollisionImage(self):
        self.image = self.collision_image

    # Nastavení obrázku u spritu, který nekolidoval s hráčem
    def setNormalImage(self):
        self.image = self.normal_image
</pre>

<p>Vlastní reakce na detekci kolize:</p>

<pre>
# Změna obrázku spritu na základě kolize s hráčem
def change_sprite_image(sprite_group, hit_list):
    # Projít všemi sprity ze skupiny, kterou detekovala kolizní funkce
    for sprite in sprite_group:
        if sprite in hit_list:
            sprite.setCollisionImage()
        else:
            sprite.setNormalImage()



# Zjistí kolize spritu se "stěnami" (nepohyblivými sprity)
def check_collisions(player, sprite_group):
    # Vytvoření seznamu spritů, které kolidují s hráčem
    hit_list = pygame.sprite.spritecollide(player, sprite_group, False)
    # Změna obrázků kolidujících spritů
    change_sprite_image(sprite_group, hit_list)
    collisions = len(hit_list)
    # Přenastavení titulku okna
    pygame.display.set_caption('Pygame test #23: collisions ' + str(collisions))
</pre>

<img class="alignnone size-medium wp-image-6441" src="http://mojefedora.cz/wp-content/uploads/2016/01/14.png" alt="14" width="322" height="264" />
<p><i>Obrázek 14: Uživatel může pohybovat spritem s&nbsp;obrázkem zeměkoule. Zde prozatím nedošlo k&nbsp;žádné kolizi s&nbsp;ostatními sprity.</i></p>

<p>Podívejme se nyní na úplný výpis zdrojového kódu tohoto příkladu:</p>

<pre>
#!/usr/bin/python
# vim: set fileencoding=utf-8

# Demonstrační příklady využívající knihovnu Pygame

# Příklad číslo 23: použití spritů, pohyblivý sprite,
#                   kolize, různé tvary kolidujících spritů


import pygame, sys, os, math

# Nutno importovat kvůli konstantám QUIT atd.
from pygame.locals import *

# Velikost okna aplikace
WIDTH = 320
HEIGHT = 240



# Třída představující sprite zobrazený jako jednobarevný čtverec.
class CircularSprite(pygame.sprite.Sprite):
    # Konstruktor
    def __init__(self, x, y, normal_image_name, collision_image_name):
        # Nejprve je nutné zavolat konstruktor předka,
        # tj. konstruktor třídy pygame.sprite.Sprite:
        pygame.sprite.Sprite.__init__(self)

        # Načtení obrázků, jeden pro normální sprite,
        # druhý pro sprite, který koliduje s hráčem
        self.normal_image = pygame.image.load("images/" + normal_image_name + ".png")
        self.collision_image = pygame.image.load("images/" + collision_image_name + ".png")

        # Vytvoření obrázku představujícího vizuální obraz spritu:
        self.image = self.normal_image
        #self.image.fill(color) - toto nyní nepoužijeme, pozůstatek z BlockySprite

        # Vytvoření obalového obdélníku
        # (velikost se získá z rozměru obrázku)
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

        # Počáteční rychlost spritu
        self.speed_x = 0
        self.speed_y = 0

    # Nastavení obrázku u spritu, který kolidoval s hráčem
    def setCollisionImage(self):
        self.image = self.collision_image

    # Nastavení obrázku u spritu, který nekolidoval s hráčem
    def setNormalImage(self):
        self.image = self.normal_image



# Inicializace knihovny Pygame
pygame.init()

clock = pygame.time.Clock()

# Vytvoření okna pro vykreslování
display = pygame.display.set_mode([WIDTH, HEIGHT])

# Nastavení titulku okna
pygame.display.set_caption('Pygame test #23')

# Konstanty s n-ticemi představujícími základní barvy
BLACK   = (  0,   0,   0)

# Objekt sdružující všechny sprity
all_sprites = pygame.sprite.Group()
# Objekt sdružující všechny sprity kromě hráče
all_sprites_but_player = pygame.sprite.Group()

# Vytvoření několika typů spritů
#                         x    y   první obr. druhý obr.
wall1  = CircularSprite( 20,  40, "sprite3", "sprite2")
wall2  = CircularSprite( 20, 140, "sprite3", "sprite2")
wall3  = CircularSprite(220,  40, "sprite3", "sprite2")
wall4  = CircularSprite(220, 140, "sprite3", "sprite2")
wall5  = CircularSprite(120,  40, "sprite3", "sprite2")
wall6  = CircularSprite(120, 140, "sprite3", "sprite2")
player = CircularSprite(WIDTH/2-20, HEIGHT/2-20, "sprite1", "sprite1")

# Přidání několika dalších spritů do seznamu
# (jen jeden sprite - ten poslední - bude ve skutečnosti pohyblivý)
all_sprites.add(wall1)
all_sprites.add(wall2)
all_sprites.add(wall3)
all_sprites.add(wall4)
all_sprites.add(wall5)
all_sprites.add(wall6)
all_sprites.add(player)

# Seznam všech nepohyblivých spritů
all_sprites_but_player.add(wall1)
all_sprites_but_player.add(wall2)
all_sprites_but_player.add(wall3)
all_sprites_but_player.add(wall4)
all_sprites_but_player.add(wall5)
all_sprites_but_player.add(wall6)



# Posun všech spritů ve skupině na základě jejich rychlosti
def move_sprites(sprite_group, playground_width, playground_height):
    for sprite in sprite_group:
        # Posun spritu
        sprite.rect.x = sprite.rect.x + sprite.speed_x
        sprite.rect.y = sprite.rect.y + sprite.speed_y
        # Kontrola, zda sprite nenarazil do okrajů okna
        if sprite.rect.x &lt;/gc 0:
            sprite.rect.x = 0
            sprite.speed_x = 0
        if sprite.rect.x + sprite.rect.width &gt;/gc playground_width:
            sprite.rect.x = playground_width - sprite.rect.width
            sprite.speed_x = 0
        if sprite.rect.y &lt;/gc 0:
            sprite.rect.y = 0
            sprite.speed_y = 0
        if sprite.rect.y + sprite.rect.height &gt;/gc playground_height:
            sprite.rect.y = playground_height - sprite.rect.height
            sprite.speed_y = 0



# Vykreslení celé scény na obrazovku
def draw_scene(display, background_color, sprite_group):
    # Vyplnění plochy okna černou barvou
    display.fill(background_color)
    # Vykreslení celé skupiny spritů do bufferu
    sprite_group.draw(display)
    # Obnovení obsahu obrazovky (překlopení zadního a předního bufferu)
    pygame.display.update()



# Změna obrázku spritu na základě kolize s hráčem
def change_sprite_image(sprite_group, hit_list):
    # Projít všemi sprity ze skupiny, kterou detekovala kolizní funkce
    for sprite in sprite_group:
        if sprite in hit_list:
            sprite.setCollisionImage()
        else:
            sprite.setNormalImage()



# Zjistí kolize spritu se "stěnami" (nepohyblivými sprity)
def check_collisions(player, sprite_group):
    # Vytvoření seznamu spritů, které kolidují s hráčem
    hit_list = pygame.sprite.spritecollide(player, sprite_group, False)
    # Změna obrázků kolidujících spritů
    change_sprite_image(sprite_group, hit_list)
    collisions = len(hit_list)
    # Přenastavení titulku okna
    pygame.display.set_caption('Pygame test #23: collisions ' + str(collisions))



# Hlavní herní smyčka
while True:
    # Načtení a zpracování všech událostí z fronty
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
        if event.type == KEYDOWN:
            if event.key == K_ESCAPE:
                pygame.quit()
                sys.exit()
            # Stiskem kurzorových kláves je možné měnit směr pohybu spritu
            elif event.key == pygame.K_LEFT:
                player.speed_x = -3
            elif event.key == pygame.K_RIGHT:
                player.speed_x = +3
            elif event.key == pygame.K_UP:
                player.speed_y = -3
            elif event.key == pygame.K_DOWN:
                player.speed_y = +3
        if event.type == KEYUP:
            # Puštění kurzorových kláves vede k zastavení pohybu spritu
            if event.key == pygame.K_LEFT:
                player.speed_x = 0
            elif event.key == pygame.K_RIGHT:
                player.speed_x = 0
            elif event.key == pygame.K_UP:
                player.speed_y = 0
            elif event.key == pygame.K_DOWN:
                player.speed_y = 0

    move_sprites(all_sprites, display.get_width(), display.get_height())
    check_collisions(player, all_sprites_but_player)
    draw_scene(display, BLACK, all_sprites)
    clock.tick(20)

# finito
</pre>

<img class="alignnone size-medium wp-image-6442" src="http://mojefedora.cz/wp-content/uploads/2016/01/15.png" alt="15" width="322" height="264" />
<p><i>Obrázek 15: Zde můžeme vidět problém: detekce kolize v&nbsp;případě, kdy se sice protnou obalové obdélníky spritů, ale nikoli jejich vybarvené pixely.</i></p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Zdrojový kód demonstračního příkladu <strong>pygame24</strong>: použití korektní detekce kolize</h2>

<p>V&nbsp;dnešním posledním příkladu se již detekce kolize kruhových spritů provádí korektně. Je tomu tak z&nbsp;toho důvodu, že se u každého spritu pamatuje i jejich poloměr:</p>

<pre>
# Třída představující sprite zobrazený jako jednobarevný čtverec.
class CircularSprite(pygame.sprite.Sprite):
    # Konstruktor
    def __init__(self, x, y, radius, normal_image_name, collision_image_name):
        ...
        ...
        ...
        # U kulatých spritů se nastavuje i poloměr
        self.radius = radius
</pre>

<p>A dále se při detekci kolizí volá již výše zmíněná callback funkce <strong>pygame.sprite.collide_circle()</strong>:</p>

<pre>
# Zjistí kolize spritu se "stěnami" (nepohyblivými sprity)
def check_collisions(player, sprite_group):
    # Vytvoření seznamu spritů, které kolidují s hráčem
    hit_list = pygame.sprite.spritecollide(player, sprite_group, False, pygame.sprite.collide_circle)
    # Změna obrázků kolidujících spritů
    change_sprite_image(sprite_group, hit_list)
    collisions = len(hit_list)
    # Přenastavení titulku okna
    pygame.display.set_caption('Pygame test #24: collisions ' + str(collisions))
</pre>

<p>Opět se podívejme na výpis celého zdrojového kódu, z&nbsp;něhož budou všechny změny zřejmé:</p>

<pre>
#!/usr/bin/python
# vim: set fileencoding=utf-8

# Demonstrační příklady využívající knihovnu Pygame

# Příklad číslo 24: použití spritů, pohyblivý sprite,
#                   kolize, různé tvary kolidujících spritů
#                   kolize se korektně počítá pro kruhové sprity


import pygame, sys, os, math

# Nutno importovat kvůli konstantám QUIT atd.
from pygame.locals import *

# Velikost okna aplikace
WIDTH = 320
HEIGHT = 240



# Třída představující sprite zobrazený jako jednobarevný čtverec.
class CircularSprite(pygame.sprite.Sprite):
    # Konstruktor
    def __init__(self, x, y, radius, normal_image_name, collision_image_name):
        # Nejprve je nutné zavolat konstruktor předka,
        # tj. konstruktor třídy pygame.sprite.Sprite:
        pygame.sprite.Sprite.__init__(self)

        # Načtení obrázků, jeden pro normální sprite,
        # druhý pro sprite, který koliduje s hráčem
        self.normal_image = pygame.image.load("images/" + normal_image_name + ".png")
        self.collision_image = pygame.image.load("images/" + collision_image_name + ".png")

        # Vytvoření obrázku představujícího vizuální obraz spritu:
        self.image = self.normal_image
        #self.image.fill(color) - toto nyní nepoužijeme, pozůstatek z BlockySprite

        # Vytvoření obalového obdélníku
        # (velikost se získá z rozměru obrázku)
        self.rect = self.image.get_rect()
        self.rect.x = x
        self.rect.y = y

        # U kulatých spritů se nastavuje i poloměr
        self.radius = radius

        # Počáteční rychlost spritu
        self.speed_x = 0
        self.speed_y = 0

    # Nastavení obrázku u spritu, který kolidoval s hráčem
    def setCollisionImage(self):
        self.image = self.collision_image

    # Nastavení obrázku u spritu, který nekolidoval s hráčem
    def setNormalImage(self):
        self.image = self.normal_image



# Inicializace knihovny Pygame
pygame.init()

clock = pygame.time.Clock()

# Vytvoření okna pro vykreslování
display = pygame.display.set_mode([WIDTH, HEIGHT])

# Nastavení titulku okna
pygame.display.set_caption('Pygame test #24')

# Konstanty s n-ticemi představujícími základní barvy
BLACK   = (  0,   0,   0)

# Objekt sdružující všechny sprity
all_sprites = pygame.sprite.Group()
# Objekt sdružující všechny sprity kromě hráče
all_sprites_but_player = pygame.sprite.Group()

# Vytvoření několika typů spritů
#                         x    y   r  první obr. druhý obr.
wall1  = CircularSprite( 20,  40, 31, "sprite3", "sprite2")
wall2  = CircularSprite( 20, 140, 31, "sprite3", "sprite2")
wall3  = CircularSprite(220,  40, 31, "sprite3", "sprite2")
wall4  = CircularSprite(220, 140, 31, "sprite3", "sprite2")
wall5  = CircularSprite(120,  40, 31, "sprite3", "sprite2")
wall6  = CircularSprite(120, 140, 31, "sprite3", "sprite2")
player = CircularSprite(WIDTH/2-20, HEIGHT/2-20, 22, "sprite1", "sprite1")

# Přidání několika dalších spritů do seznamu
# (jen jeden sprite - ten poslední - bude ve skutečnosti pohyblivý)
all_sprites.add(wall1)
all_sprites.add(wall2)
all_sprites.add(wall3)
all_sprites.add(wall4)
all_sprites.add(wall5)
all_sprites.add(wall6)
all_sprites.add(player)

# Seznam všech nepohyblivých spritů
all_sprites_but_player.add(wall1)
all_sprites_but_player.add(wall2)
all_sprites_but_player.add(wall3)
all_sprites_but_player.add(wall4)
all_sprites_but_player.add(wall5)
all_sprites_but_player.add(wall6)



# Posun všech spritů ve skupině na základě jejich rychlosti
def move_sprites(sprite_group, playground_width, playground_height):
    for sprite in sprite_group:
        # Posun spritu
        sprite.rect.x = sprite.rect.x + sprite.speed_x
        sprite.rect.y = sprite.rect.y + sprite.speed_y
        # Kontrola, zda sprite nenarazil do okrajů okna
        if sprite.rect.x &lt;/gc 0:
            sprite.rect.x = 0
            sprite.speed_x = 0
        if sprite.rect.x + sprite.rect.width &gt;/gc playground_width:
            sprite.rect.x = playground_width - sprite.rect.width
            sprite.speed_x = 0
        if sprite.rect.y &lt;/gc 0:
            sprite.rect.y = 0
            sprite.speed_y = 0
        if sprite.rect.y + sprite.rect.height &gt;/gc playground_height:
            sprite.rect.y = playground_height - sprite.rect.height
            sprite.speed_y = 0



# Vykreslení celé scény na obrazovku
def draw_scene(display, background_color, sprite_group):
    # Vyplnění plochy okna černou barvou
    display.fill(background_color)
    # Vykreslení celé skupiny spritů do bufferu
    sprite_group.draw(display)
    # Obnovení obsahu obrazovky (překlopení zadního a předního bufferu)
    pygame.display.update()



# Změna obrázku spritu na základě kolize s hráčem
def change_sprite_image(sprite_group, hit_list):
    # Projít všemi sprity ze skupiny, kterou detekovala kolizní funkce
    for sprite in sprite_group:
        if sprite in hit_list:
            sprite.setCollisionImage()
        else:
            sprite.setNormalImage()



# Zjistí kolize spritu se "stěnami" (nepohyblivými sprity)
def check_collisions(player, sprite_group):
    # Vytvoření seznamu spritů, které kolidují s hráčem
    hit_list = pygame.sprite.spritecollide(player, sprite_group, False, pygame.sprite.collide_circle)
    # Změna obrázků kolidujících spritů
    change_sprite_image(sprite_group, hit_list)
    collisions = len(hit_list)
    # Přenastavení titulku okna
    pygame.display.set_caption('Pygame test #24: collisions ' + str(collisions))



# Hlavní herní smyčka
while True:
    # Načtení a zpracování všech událostí z fronty
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
        if event.type == KEYDOWN:
            if event.key == K_ESCAPE:
                pygame.quit()
                sys.exit()
            # Stiskem kurzorových kláves je možné měnit směr pohybu spritu
            elif event.key == pygame.K_LEFT:
                player.speed_x = -3
            elif event.key == pygame.K_RIGHT:
                player.speed_x = +3
            elif event.key == pygame.K_UP:
                player.speed_y = -3
            elif event.key == pygame.K_DOWN:
                player.speed_y = +3
        if event.type == KEYUP:
            # Puštění kurzorových kláves vede k zastavení pohybu spritu
            if event.key == pygame.K_LEFT:
                player.speed_x = 0
            elif event.key == pygame.K_RIGHT:
                player.speed_x = 0
            elif event.key == pygame.K_UP:
                player.speed_y = 0
            elif event.key == pygame.K_DOWN:
                player.speed_y = 0

    move_sprites(all_sprites, display.get_width(), display.get_height())
    check_collisions(player, all_sprites_but_player)
    draw_scene(display, BLACK, all_sprites)
    clock.tick(20)

# finito
</pre>

<img class="alignnone size-medium wp-image-6443" src="http://mojefedora.cz/wp-content/uploads/2016/01/16.png" alt="16" width="322" height="264" />
<p><i>Obrázek 16: Poslední demonstrační příklad ihned po svém spuštění.</i></p>



<p><a name="k11"></a></p>
<h2 id="k11">11. Obsah následující části seriálu</h2>

<p>V&nbsp;následující části seriálu o programovacích jazycích i o knihovnách a frameworcích vhodných pro <a href="http://mojefedora.cz/stitek/vyuka/">výuku programování</a> popř.&nbsp;pro výuku základů počítačové <a href="http://mojefedora.cz/stitek/grafika/">grafiky</a>, se budeme zabývat možnostmi, které programátorům nabízí modul nazvaný <strong>pygame.transform</strong>. Jak již název tohoto modulu naznačuje, je možné s&nbsp;jeho využitím aplikovat afinní transformace na všechny objekty typu <strong>Surface</strong>, čehož je možné využít v&nbsp;mnoha (mnohdy velmi zajímavých) grafických efektech a dosáhnout tak i &bdquo;3D&ldquo; vzhledu hry či grafického dema.</p>

<img class="alignnone size-medium wp-image-6444" src="http://mojefedora.cz/wp-content/uploads/2016/01/17.png" alt="17" width="322" height="264" />
<p><i>Obrázek 17: Poslední demonstrační příklad: obalové obdélníky spritů se sice překrývají, ale kolize nebyla detekována.</i></p>



<p><a name="k12"></a></p>
<h2 id="k12">12. Repositář se zdrojovými kódy všech dnešních demonstračních příkladů</h2>

<p>Všechny demonstrační příklady, s&nbsp;nimiž jsme se v&nbsp;dnešním článku seznámili, byly, podobně jako ve všech předchozích částech tohoto seriálu, uloženy do Git repositáře umístěného na GitHubu (<a href="https://github.com/tisnik/presentations">https://github.com/tisnik/presentations</a>). Poslední verze zdrojových kódů naleznete pod těmito odkazy:</p>

<table>
<tr><th>#</th><th>Příklad</th><th>Zdrojový kód</th></tr>
<tr><td>1</td><td>pygame20.py</td><td><a href="https://github.com/tisnik/presentations/blob/master/pygame/pygame20.py">https://github.com/tisnik/presentations/blob/master/pygame/pygame20.py</a></td></tr>
<tr><td>2</td><td>pygame21.py</td><td><a href="https://github.com/tisnik/presentations/blob/master/pygame/pygame21.py">https://github.com/tisnik/presentations/blob/master/pygame/pygame21.py</a></td></tr>
<tr><td>3</td><td>pygame22.py</td><td><a href="https://github.com/tisnik/presentations/blob/master/pygame/pygame22.py">https://github.com/tisnik/presentations/blob/master/pygame/pygame22.py</a></td></tr>
<tr><td>4</td><td>pygame23.py</td><td><a href="https://github.com/tisnik/presentations/blob/master/pygame/pygame23.py">https://github.com/tisnik/presentations/blob/master/pygame/pygame23.py</a></td></tr>
<tr><td>5</td><td>pygame24.py</td><td><a href="https://github.com/tisnik/presentations/blob/master/pygame/pygame24.py">https://github.com/tisnik/presentations/blob/master/pygame/pygame24.py</a></td></tr>
</table>

<img class="alignnone size-medium wp-image-6445" src="http://mojefedora.cz/wp-content/uploads/2016/01/18.png" alt="18" width="322" height="264" />
<p><i>Obrázek 18: Poslední demonstrační příklad: až nyní došlo ke kolizi.</i></p>



<p><a name="k13"></a></p>
<h2 id="k13">13. Funkce použité v&nbsp;dnešních demonstračních příkladech</h2>

<p>Opět si pro úplnost vypišme funkce a metody nabízené knihovnou Pygame, které jsme použili v&nbsp;dnešních demonstračních příkladech:</p>

<ol>

<li>pygame.init()<br />
<a href="http://www.pygame.org/docs/ref/pygame.html#pygame.init">http://www.pygame.org/docs/ref/pygame.html#pygame.init</a>
</li>

<li>pygame.quit()<br />
<a href="http://www.pygame.org/docs/ref/pygame.html#pygame.quit">http://www.pygame.org/docs/ref/pygame.html#pygame.quit</a>
</li>

<li>pygame.display.set_mode()<br />
<a href="http://www.pygame.org/docs/ref/display.html#pygame.display.set_mode">http://www.pygame.org/docs/ref/display.html#pygame.display.set_mode</a>
</li>

<li>pygame.display.set_caption()<br />
<a href="http://www.pygame.org/docs/ref/display.html#pygame.display.set_caption">http://www.pygame.org/docs/ref/display.html#pygame.display.set_caption</a>
</li>

<li>pygame.display.quit()<br />
<a href="http://www.pygame.org/docs/ref/display.html#pygame.display.quit">http://www.pygame.org/docs/ref/display.html#pygame.display.quit</a>
</li>

<li>pygame.display.update()<br />
<a href="http://www.pygame.org/docs/ref/display.html#pygame.display.update">http://www.pygame.org/docs/ref/display.html#pygame.display.update</a>
</li>

<li>pygame.event.get()<br />
<a href="http://www.pygame.org/docs/ref/event.html#pygame.event.get">http://www.pygame.org/docs/ref/event.html#pygame.event.get</a>
</li>

<li>pygame.time.Clock()</strong>
<a href="http://www.pygame.org/docs/ref/time.html#pygame.time.Clock">http://www.pygame.org/docs/ref/time.html#pygame.time.Clock</a>
</li>

<li>pygame.time.Clock.tick()<br />
<a href="http://www.pygame.org/docs/ref/time.html#pygame.time.Clock.tick">http://www.pygame.org/docs/ref/time.html#pygame.time.Clock.tick</a>
</li>

<li>pygame.Surface()<br />
<a href="http://www.pygame.org/docs/ref/surface.html">http://www.pygame.org/docs/ref/surface.html</a>
</li>

<li>pygame.Surface.fill()<br />
<a href="http://www.pygame.org/docs/ref/surface.html#pygame.Surface.fill">http://www.pygame.org/docs/ref/surface.html#pygame.Surface.fill</a>
</li>

<li>pygame.image.load()<br />
<a href="http://www.pygame.org/docs/ref/image.html#pygame.image.load">http://www.pygame.org/docs/ref/image.html#pygame.image.load</a>
</li>

<li>pygame.Sprite.__init__()<br />
<a href="http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Sprite">http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Sprite</a>
</li>

<li>pygame.sprite.Group()<br />
<a href="http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group">http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group</a>
</li>

<li>pygame.sprite.Group.add()<br />
<a href="http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group.add">http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group.add</a>
</li>

<li>pygame.sprite.Group.draw()<br />
<a href="http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group.draw">http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Group.draw</a>
</li>

<li>pygame.sprite.spritecollide()<br />
<a href="http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.spritecollide">http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.spritecollide</a>
</li>

<li>pygame.sprite.collide_circle()<br />
<a href="http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.collide_circle">http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.collide_circle</a>
</li>

</ol>

<img class="alignnone size-medium wp-image-6446" src="http://mojefedora.cz/wp-content/uploads/2016/01/19.png" alt="19" width="322" height="264" />
<p><i>Obrázek 19: Sprity se mohou překrývat v&nbsp;jiném pořadí.</i></p>



<p><a name="k14"></a></p>
<h2 id="k14">14. Odkazy na Internetu</h2>

<ol>

<li>Program Arcade Games With Python And Pygame<br />
<a href="http://programarcadegames.com/index.php?lang=en#">http://programarcadegames.com/index.php?lang=en#</a>
</li>

<li>Program Arcade Games With Python And Pygame: Chapter 13: Introduction to Sprites:<br />
<a href="http://programarcadegames.com/index.php?chapter=introduction_to_sprites#">http://programarcadegames.com/index.php?chapter=introduction_to_sprites#</a>
</li>

<li>Pygame.org<br />
<a href="http://pygame.org/hifi.html">http://pygame.org/hifi.html</a>
</li>

<li>Pygame - instalační soubory pro různé operační systémy<br />
<a href="http://pygame.org/download.shtml">http://pygame.org/download.shtml</a>
</li>

<li>Pygame: documentation<br />
<a href="http://www.pygame.org/docs/">http://www.pygame.org/docs/</a>
</li>

<li>Pygame Wiki: Getting Started<br />
<a href="http://www.pygame.org/wiki/GettingStarted">http://www.pygame.org/wiki/GettingStarted</a>
</li>

<li>Pygame Tutorials: Tutorials Basic<br />
<a href="http://pygametutorials.wikidot.com/tutorials-basic">http://pygametutorials.wikidot.com/tutorials-basic</a>
</li>

<li>Pygame: Font class<br />
<a href="http://www.pygame.org/docs/ref/font.html">http://www.pygame.org/docs/ref/font.html</a>
</li>

<li>Python.org (dokumentace k&nbsp;jazyku, odkazy na instalační soubory atd.)<br />
<a href="https://www.python.org/">https://www.python.org/</a>
</li>

<li>How to Draw with Pygame on Your Raspberry Pi<br />
<a href="http://www.dummies.com/how-to/content/how-to-draw-with-pygame-on-your-raspberry-pi.html">http://www.dummies.com/how-to/content/how-to-draw-with-pygame-on-your-raspberry-pi.html</a>
</li>

<li>Bresenham's line algorithm<br />
<a href="https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm">https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm</a>
</li>

<li>Xiaolin Wu's line algorithm<br />
<a href="https://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm">https://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm</a>
</li>

<li>Pyglet<br />
<a href="https://pypi.python.org/pypi/pyglet/1.2.4">https://pypi.python.org/pypi/pyglet/1.2.4</a>
</li>

<li>Pyglet documentation<br />
<a href="http://pythonhosted.org/pyglet/">http://pythonhosted.org/pyglet/</a>
</li>

<li>PyOpenGL<br />
<a href="https://pypi.python.org/pypi/PyOpenGL/">https://pypi.python.org/pypi/PyOpenGL/</a>
</li>

<li>Computer font (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/Computer_font">https://en.wikipedia.org/wiki/Computer_font</a>
</li>

<li>TrueType (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/TrueType">https://en.wikipedia.org/wiki/TrueType</a>
</li>

<li>SDL and Fonts<br />
<a href="http://www.gamedev.net/page/resources/_/technical/game-programming/sdl--fonts-r1953">http://www.gamedev.net/page/resources/_/technical/game-programming/sdl--fonts-r1953</a>
</li>

<li>SDL_ttf Documentation<br />
<a href="http://www.libsdl.org/projects/SDL_ttf/docs/">http://www.libsdl.org/projects/SDL_ttf/docs/</a>
</li>

<li>SDL_ttf 2.0 (není prozatím součástí SDLJava)<br />
<a href="http://www.libsdl.org/projects/SDL_ttf/">http://www.libsdl.org/projects/SDL_ttf/</a>
</li>

<li>SDL_ttf doc<br />
<a href="http://www.libsdl.org/projects/SDL_ttf/docs/SDL_ttf_frame.html">http://www.libsdl.org/projects/SDL_ttf/docs/SDL_ttf_frame.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_Surface<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlsurface.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlsurface.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_PixelFormat<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlpixelformat.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlpixelformat.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_LockSurface<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdllocksurface.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdllocksurface.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_UnlockSurface<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlunlocksurface.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlunlocksurface.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_LoadBMP<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlloadbmp.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlloadbmp.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_SaveBMP<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlsavebmp.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlsavebmp.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_BlitSurface<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlblitsurface.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlblitsurface.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_VideoInfo<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlvideoinfo.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlvideoinfo.html</a>
</li>

<li>SDL 1.2 Documentation: SDL_GetVideoInfo<br />
<a href="http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlgetvideoinfo.html">http://www.libsdl.org/release/SDL-1.2.15/docs/html/sdlgetvideoinfo.html</a>
</li>

<li>Graphical user interface (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/Graphical_user_interface">http://en.wikipedia.org/wiki/Graphical_user_interface</a>
</li>

<li>The Real History of the GUI<br />
<a href="http://articles.sitepoint.com/article/real-history-gui">http://articles.sitepoint.com/article/real-history-gui</a>
</li>

<li>Computer-History: Xerox Alto<br />
<a href="http://www.mr-gadget.de/apple/2004-01-15/computer-history-xerox-alto">http://www.mr-gadget.de/apple/2004-01-15/computer-history-xerox-alto</a>
</li>

<li>bitsavers.org<br />
<a href="http://www.bitsavers.org/">http://www.bitsavers.org/</a>
</li>

<li>Dokumenty k&nbsp;počítači Xerox Alto na bitsavers.org<br />
<a href="http://www.bitsavers.org/pdf/xerox/alto/">http://www.bitsavers.org/pdf/xerox/alto/</a>
</li>

<li>The ALTO Computer<br />
<a href="http://www.maniacworld.com/alto-computer-video.html">http://www.maniacworld.com/alto-computer-video.html</a>
</li>

<li>Xerox Alto Operating System and Alto Applications<br />
<a href="http://www.digibarn.com/collections/software/alto/index.html">http://www.digibarn.com/collections/software/alto/index.html</a>
</li>

<li>Xerox Alto (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/Xerox_Alto">http://en.wikipedia.org/wiki/Xerox_Alto</a>
</li>

<li>BitBLT routines (1975)<br />
<a href="http://www.bitsavers.org/pdf/xerox/alto/BitBLT_Nov1975.pdf">http://www.bitsavers.org/pdf/xerox/alto/BitBLT_Nov1975.pdf</a>
</li>

<li>BitBlt in Squeak<br />
<a href="http://wiki.squeak.org/squeak/189">http://wiki.squeak.org/squeak/189</a>
</li>

<li>Bitmaps, Device Contexts and BitBlt<br />
<a href="http://www.winprog.org/tutorial/bitmaps.html">http://www.winprog.org/tutorial/bitmaps.html</a>
</li>

<li>BitBlt Game Programming Tutorial<br />
<a href="http://www.freevbcode.com/ShowCode.asp?ID=3677">http://www.freevbcode.com/ShowCode.asp?ID=3677</a>
</li>

<li>Bit blit (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/BitBLT">http://en.wikipedia.org/wiki/BitBLT</a>
</li>

<li>The Xerox Alto<br />
<a href="http://toastytech.com/guis/alto3.html">http://toastytech.com/guis/alto3.html</a>
</li>

<li>History of the graphical user interface<br />
<a href="http://en.wikipedia.org/wiki/History_of_the_graphical_user_interface">http://en.wikipedia.org/wiki/History_of_the_graphical_user_interface</a>
</li>

<li>Domovská stránka systému LÖVE<br />
<a href="http://love2d.org/">http://love2d.org/</a>
</li>

<li>Dokumentace k&nbsp;systému LÖVE<br />
<a href="http://love2d.org/wiki/love">http://love2d.org/wiki/love</a>
</li>

<li>Domovská stránka programovacího jazyka Lua<br />
<a href="http://www.lua.org/ ">http://www.lua.org/ </a>
</li>

<li>Seriál o programovacím jazyku Lua (root.cz):<br />
<a href="http://www.root.cz/serialy/programovaci-jazyk-lua/">http://www.root.cz/serialy/programovaci-jazyk-lua/</a>
</li>

<li>Web o Lieru, Gusanos, GeneRally, Atari atd.<br />
<a href="http://karelik.wz.cz/">http://karelik.wz.cz/</a>
</li>

<li>Web o Lieru, Gusanos<br />
<a href="http://karelik.wz.cz/gusanos.php">http://karelik.wz.cz/gusanos.php</a>
</li>

<li>GUSANOS<br />
<a href="http://gusanos.sourceforge.net/">http://gusanos.sourceforge.net/</a>
</li>

<li>GUSANOS Download<br />
<a href="http://sourceforge.net/projects/gusanos/">http://sourceforge.net/projects/gusanos/</a>
</li>

<li>Lua<br />
<a href="http://www.linuxexpres.cz/praxe/lua">http://www.linuxexpres.cz/praxe/lua</a>
</li>

<li>Lua<br />
<a href="http://cs.wikipedia.org/wiki/Lua">http://cs.wikipedia.org/wiki/Lua</a>
</li>

<li>Lua (programming language)<br />
<a href="http://en.wikipedia.org/wiki/Lua_(programming_language)">http://en.wikipedia.org/wiki/Lua_(programming_language)</a>
</li>

<li>The Lua Programming Language<br />
<a href="http://www.tiobe.com/index.php/paperinfo/tpci/Lua.html">http://www.tiobe.com/index.php/paperinfo/tpci/Lua.html</a>
</li>

<li>Lua Programming Gems<br />
<a href="http://www.lua.org/gems/">http://www.lua.org/gems/</a>
</li>

<li>LuaForge<br />
<a href="http://luaforge.net/">http://luaforge.net/</a>
</li>

<li>Forge project tree<br />
<a href="http://luaforge.net/softwaremap/trove_list.php">http://luaforge.net/softwaremap/trove_list.php</a>
</li>

<li>SdlBasic home page<br />
<a href="http://www.sdlbasic.altervista.org/main/">http://www.sdlbasic.altervista.org/main/</a>
</li>

<li>SdlBasic examples<br />
<a href="http://nitrofurano.linuxkafe.com/sdlbasic/">http://nitrofurano.linuxkafe.com/sdlbasic/</a>
</li>

<li>SdlBasic na Wikipedii<br />
<a href="http://en.wikipedia.org/wiki/SdlBasic">http://en.wikipedia.org/wiki/SdlBasic</a>
</li>

<li>Simple DirectMedia Layer<br />
<a href="http://en.wikipedia.org/wiki/Simple_DirectMedia_Layer">http://en.wikipedia.org/wiki/Simple_DirectMedia_Layer</a>
</li>

<li>SDLBASIC &ndash; The high-level interpreter for all?<br />
<a href="http://openbytes.wordpress.com/2008/11/08/sdlbasic-the-high-level-interpreter-for-all/">http://openbytes.wordpress.com/2008/11/08/sdlbasic-the-high-level-interpreter-for-all/</a>
</li>

<li>FreeBasic home page<br />
<a href="http://www.freebasic.net/">http://www.freebasic.net/</a>
</li>

<li>FreeBASIC (Wikipedia EN)<br />
<a href="https://en.wikipedia.org/wiki/FreeBASIC">https://en.wikipedia.org/wiki/FreeBASIC</a>
</li>

<li>FreeBASIC Wiki<br />
<a href="http://www.freebasic.net/wiki/wikka.php?wakka=FBWiki">http://www.freebasic.net/wiki/wikka.php?wakka=FBWiki</a>
</li>

<li>FreeBASIC Manual<br />
<a href="http://www.freebasic.net/wiki/wikka.php?wakka=DocToc">http://www.freebasic.net/wiki/wikka.php?wakka=DocToc</a>
</li>

<li>FreeBASIC (Wikipedia CZ)<br />
<a href="http://cs.wikipedia.org/wiki/FreeBASIC">http://cs.wikipedia.org/wiki/FreeBASIC</a>
</li>

<li>The Griffon Legend<br />
<a href="http://syn9.thingie.net/?table=griffonlegend">http://syn9.thingie.net/?table=griffonlegend</a>
</li>

<li>Seriál Letní škola programovacího jazyka Logo<br />
<a href="http://www.root.cz/serialy/letni-skola-programovaciho-jazyka-logo/">http://www.root.cz/serialy/letni-skola-programovaciho-jazyka-logo/</a>
</li>

<li>Scratch: oficiální stránka projektu<br />
<a href="http://scratch.mit.edu/">http://scratch.mit.edu/</a>
</li>

<li>Scratch: galerie projektů vytvořených ve Scratchi<br />
<a href="http://scratch.mit.edu/galleries/browse/newest">http://scratch.mit.edu/galleries/browse/newest</a>
</li>

<li>Scratch: nápověda<br />
<a href="file:///usr/share/scratch/Help/en/index.html">file:///usr/share/scratch/Help/en/index.html</a>
</li>

<li>Scratch: obrazovky nápovědy<br />
<a href="file:///usr/share/scratch/Help/en/allscreens.html">file:///usr/share/scratch/Help/en/allscreens.html</a>
</li>

<li>Scratch (Wikipedie CZ)<br />
<a href="http://cs.wikipedia.org/wiki/Scratch">http://cs.wikipedia.org/wiki/Scratch</a>
</li>

<li>Scratch (programming language)<br />
<a href="http://en.wikipedia.org/wiki/Scratch_(programming_language)">http://en.wikipedia.org/wiki/Scratch_(programming_language)</a>
</li>

<li>Scratch Modification<br />
<a href="http://wiki.scratch.mit.edu/wiki/Scratch_Modification">http://wiki.scratch.mit.edu/wiki/Scratch_Modification</a>
</li>

<li>Scratch Lowers Resistance to Programming<br />
<a href="http://www.wired.com/gadgetlab/2009/03/scratch-lowers/">http://www.wired.com/gadgetlab/2009/03/scratch-lowers/</a>
</li>

<li>Snap!<br />
<a href="http://snap.berkeley.edu/">http://snap.berkeley.edu/</a>
</li>

<li>Prostředí Snap!<br />
<a href="http://snap.berkeley.edu/snapsource/snap.html">http://snap.berkeley.edu/snapsource/snap.html</a>
</li>

<li>Alternatives to Scratch<br />
<a href="http://wiki.scratch.mit.edu/wiki/Alternatives_to_Scratch">http://wiki.scratch.mit.edu/wiki/Alternatives_to_Scratch</a>
</li>

<li>Basic-256 home page<br />
<a href="http://www.basic256.org/index_en">http://www.basic256.org/index_en</a>
</li>

<li>Basic-256 Language Documentation<br />
<a href="http://doc.basic256.org/doku.php">http://doc.basic256.org/doku.php</a>
</li>

<li>Basic-256 Art Gallery<br />
<a href="http://www.basic256.org/artgallery">http://www.basic256.org/artgallery</a>
</li>

<li>Basic-256 Tutorial<br />
<a href="http://www.basic256.org/tutorials">http://www.basic256.org/tutorials</a>
</li>

<li>Why BASIC?<br />
<a href="http://www.basic256.org/whybasic">http://www.basic256.org/whybasic</a>
</li>

<li>A book to teach ANYBODY how to program a computer (using BASIC)<br />
<a href="http://www.basicbook.org/">http://www.basicbook.org/</a>
</li>

<li>BASIC Computer Games (published 1978) - Hammurabi<br />
<a href="http://atariarchives.org/basicgames/showpage.php?page=78">http://atariarchives.org/basicgames/showpage.php?page=78</a>
</li>

<li>Hamurabi - zdrojový kód v BASICu<br />
<a href="http://www.dunnington.u-net.com/public/basicgames/HMRABI">http://www.dunnington.u-net.com/public/basicgames/HMRABI</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2016</small></p>
</body>
</html>

