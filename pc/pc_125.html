<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Mikroøadièe a jejich aplikace v&nbsp;jednoduchých mikropoèítaèích (4)</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Mikroøadièe a jejich aplikace v&nbsp;jednoduchých mikropoèítaèích (4)</h1>

<h1>Úvodník</h1>

<p>V&nbsp;dne¹ní èásti seriálu o architekturách poèítaèù dokonèíme popis osmibitového mikroøadièe Intel 8051 neboli MCS-51. Popí¹eme si vývojové kity, které lze pøi programování a ladìní tìchto mikroøadièù pou¾ít, jednoduché mikropoèítaèe zalo¾ené na MCS-51 i to, jakým zpùsobem je u tìchto mikropoèítaèù øe¹eno zobrazování informací na (textových) displejích z&nbsp;tekutých krystalù (LCD).</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Vývojové kity s&nbsp;mikroøadièem MCS-51</a></p>
<p><a href="#k02">2. Prapøedek vývojových kitù pro MCS-51 &ndash; Intel SDK-51</a></p>
<p><a href="#k03">3. Displej vývojového kitu SDK-51, konfigurace jeho pamìtí a práce s&nbsp;breakpointy</a></p>
<p><a href="#k04">4. Jednoduché mikropoèítaèe zalo¾ené na MCS-51</a></p>
<p><a href="#k05">5. Pøíklad amatérsky zkonstruovaného mikropoèítaèe s&nbsp;MCS-51</a></p>
<p><a href="#k06">6. Ovládání textových LCD mikroøadièem</a></p>
<p><a href="#k07">7. Øadiè textových displejù HD44780</a></p>
<p><a href="#k08">8. Obsah následující èásti seriálu</a></p>
<p><a href="#k09">9. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2>1. Vývojové kity s&nbsp;mikroøadièem MCS-51</h2>

<p>V&nbsp;dne¹ní èásti seriálu o architekturách poèítaèù si popí¹eme, jakým
zpùsobem byly konstruovány vývojové kity a takté¾ více èi ménì sofistikované
mikropoèítaèe, které byly zalo¾ené na osmibitovém mikroøadièi <i>Intel 8051</i>
nebo na nìkteré jeho variantì (napøíklad èipu <i>Intel 8031</i>). Kromì
standardních zpùsobù pou¾ití tohoto mikroøadièe si øekneme napøíklad i to,
jakým zpùsobem se nìkteøí konstruktéøi mikropoèítaèù sna¾ili o programové
generování obrazového signálu s&nbsp;vyu¾itím <i>MCS-51</i> (pøesnìji øeèeno
nìkteré jeho modernìj¹í a tím pádem i rychlej¹í varianty). Zaènìme nejdøíve u
vývojových kitù, tj.&nbsp;více èi ménì slo¾itých hardwarových nástrojù
s&nbsp;mikroøadièem <i>8051</i>, které umo¾òují pøímé spou¹tìní a ladìní
programù na tomto mikroøadièi, vìt¹inou i s&nbsp;mo¾ností zobrazení stavu
bì¾ících programu pomocí LED, alfanumerických displejù èi dokonce displejù
zobrazujících rastrová data. Vývojových kitù pro platformu <i>8051</i> ji¾ dnes
existuje nepøeberné mno¾ství, od tìch velmi jednoduchých, které se pøíli¹
neli¹í od prostých programátorù EPROM, EEPROM èi Flash pamìtí umístìných na
mikroøadièích, a¾ po vývojové kity vybavené plnohodnotnou klávesnicí,
nìkolikaøádkovým displejem a velkou sadou rùzných periferních zaøízení. Tyto
kity se ji¾ v&nbsp;nìkterých pøípadech podobají plnohodnotným
mikropoèítaèùm.</p>

<a href="http://i.iinfo.cz/images/484/pc125-1.jpg"><img src="http://i.iinfo.cz/images/484/pc125-1-prev.jpg" width="352" height="270" alt=" " /></a>
<p><i>Obrázek 1: Jeden z&nbsp;dostupných vývojových kitù s&nbsp;mikroøadièem
8051, který je vybavený klávesnicí, dvouøádkovým displejem, sériovým portem
kompatibilním s&nbsp;RS-232C, programátorem pamìtí EPROM i EEPROM a samozøejmì
i monitorem, tj.&nbsp;základním programovým vybavením, pomocí nìho¾ mù¾e
u¾ivatel s&nbsp;vývojovým kitem pracovat.</i></p>

<p>Velmi oblíbené jsou mezi programátory vývojové kity, které pro komunikaci
s&nbsp;u¾ivatelem vyu¾ívají bì¾ný osobní poèítaè (PC), který je s&nbsp;kitem
propojen vìt¹inou pomocí sériového portu (nìkdy té¾ pøes <i>USB</i>). Jedním
z&nbsp;tìchto typù kitù je i tuzemský kit <strong>RD2</strong> (pozor &ndash;
nejedná se o Red Dragon 2 :-) vybavený moderní rychlou variantou mikroøadièe
<i>8051</i> s&nbsp;pamìtí Flash, indikaèními LED, tlaèítkem RESET, konektorem
typu DB-9 pro pøipojení kitu k&nbsp;osobnímu poèítaèi s&nbsp;vyu¾itím sériového
portu, desetipinovým konektorem pro pøipojení displeje z&nbsp;tekutých krystalù
(LCD), dvacetipinovým konektorem, na nìj¾ jsou vyvedeny dva volné porty
mikroøadièe a koneènì 40pinovým konektorem, na který jsou bez dal¹ích úprav
vyvedeny v¹echny vstupní èi výstupní signály <i>8051</i>. Jednou
z&nbsp;pøedností takto pojatého vývojového kitu je jeho jednoduchá a tím pádem
i pomìrnì levná konstrukce. Na druhé stranì spektra stojí vývojové kity
pracující samostatnì, tj.&nbsp;bez nutnosti pou¾ívat osobní poèítaè. Dnes ji¾
klasického zástupce tohoto typu si pøedstavíme v&nbsp;následujících dvou
kapitolách.</p>

<a href="http://i.iinfo.cz/images/484/pc125-2.jpg"><img src="http://i.iinfo.cz/images/484/pc125-2-prev.jpg" width="370" height="202" alt=" " /></a>
<p><i>Obrázek 2: Tuzemský vývojový kit RD2.</i></p>



<p><a name="k02"></a></p>
<h2>2. Prapøedek vývojových kitù pro MCS-51 &ndash; Intel SDK-51</h2>

<p>Prvním vývojovým kitem, který se zejména v&nbsp;minulosti pou¾íval pro
tvorbu programù urèených pro osmibitové mikroøadièe øady <i>MCS-51</i>, byl kit
vyrábìný pøímo firmou <i>Intel</i> pod názvem <i>Intel SDK-51</i>. Mimochodem:
firma <i>Intel</i> svým zákazníkùm nabízela i dal¹í podobnì nazvané vývojové
kity urèené pro mnohé typy svých osmibitových i ¹estnáctibitových mikroøadièù a
mikroprocesorù; napøíklad je jedná o kity <i>Intel SDK-80</i>
s&nbsp;mikroprocesorem <i>8080</i>, <i>Intel SDK-85</i> s&nbsp;procesorem
<i>8085</i>, <i>Intel SDK-86</i> pou¾itelný s&nbsp;procesory <i>8086</i> i
<i>8088</i> (právì tento slavný procesor zahájil vznik platformy PC) atd.
Vývojový kit <i>Intel SDK-51</i> zaèal být zákazníkùm nabízen ji¾ v&nbsp;roce
1982, tj.&nbsp;cca dva roky po zahájení výroby vlastního mikroøadièe
<i>MCS-51</i>. Jednalo se o velmi dobøe vybavený vývojový nástroj (èemu¾ ov¹em
odpovídala i jeho pomìrnì vysoká cena &ndash; 1200 dolarù), který byl navíc
znaènì flexibilní, proto¾e umo¾òoval nìkteré své moduly pøekonfigurovat,
popø.&nbsp;pøímo odpojit, co¾ bylo dùle¾ité ve chvíli, kdy programátor
potøeboval nìjaký pin mikroøadièe <i>MCS-51</i> vyu¾ít pro svoje úèely,
napøíklad pro pøipojení vlastního periferního zaøízení.</p>

<img src="http://i.iinfo.cz/images/484/pc125-3.jpg" width="400" height="300" alt=" " />
<p><i>Obrázek 3: Vývojový kit Intel SDK-51.</i></p>

<p>Pojïme si nyní øíci základní technické parametry tohoto vývojového kitu.
Jeho nejdùle¾itìj¹í souèástkou byl samozøejmì samotný mikroøadiè, zde se
konkrétnì jednalo o variantu <i>Intel 8031</i>, tj.&nbsp;o mikroøadiè se 128
bajty interní pamìti údajù (RAM), který v¹ak nebyl vybaven ¾ádnou interní
pamìtí programu (ROM). Hodinová frekvence 12 MHz byla øízena bì¾ným krystalovým
oscilátorem. Vývojový kit <i>SDK-51</i> dále obsahoval plnohodnotnou
alfanumerickou klávesnici (podobnou klávesnici <i>ZX-80</i>), která se
rozlo¾ením kláves pøíli¹ neli¹ila od klávesnic osmibitových mikropoèítaèù (a
vlastnì ani od IBM PC XT, mimochodem klávesa <strong>Control</strong> byla
umístìna nad levou klávesou <strong>Shift</strong>, co¾ je mnohem pøirozenìj¹í
a praktiètìj¹í umístìní ne¾ pod touto klávesou). Jedním z&nbsp;viditelných
rozdílù byla absence kurzorových kláves (které stejnì nemìly valný význam) a
navíc pøítomnost dvanácti funkèních kláves. Zajímavostí byla zdvojená klávesa
<i>RESET</i>. Stlaèení (tøeba i neúmyslné) pouze jedné klávesy <i>RESET</i>
nemìlo ¾ádný efekt, pouze obì klávesy stlaèené souèasnì inicializovaly kit do
pùvodního stavu (mo¾ná ¾e právì zde le¾í prvopoèátky známého
&bdquo;trojhmatu&ldquo;?).</p>

<a href="http://i.iinfo.cz/images/484/pc125-4.jpg"><img src="http://i.iinfo.cz/images/484/pc125-4-prev.jpg" width="361" height="270" alt=" " /></a>
<p><i>Obrázek 4: Dal¹í varianta vývojového kitu Intel SDK-51.</i></p>



<p><a name="k03"></a></p>
<h2>3. Displej vývojového kitu SDK-51, konfigurace pamìtí a práce s&nbsp;breakpointy</h2>

<p>Zajímavým a z&nbsp;dne¹ního pohledu mo¾ná ponìkud neobvyklým zpùsobem byl
øe¹en displej, který dokázal zobrazit jeden textový øádek s&nbsp;maximálnì 24
znaky. Jednotlivé znaky byly zobrazovány pomocí segmentù slo¾ených z&nbsp;LED.
Jedná se o jednu z&nbsp;roz¹íøených variant klasického sedmisegmentového
displeje, který ov¹em nedoká¾e (èitelnì) zobrazit v¹echny potøebné znaky.
Z&nbsp;tohoto dùvodu se pùvodních sedm segmentù roz¹íøilo na segmentù ¹estnáct,
viz následující ilustraèní obrázek.</p>

<img src="http://i.iinfo.cz/images/484/pc125-5.jpg" width="200" height="125" alt=" " />
<p><i>Obrázek 5: Mo¾nosti zobrazení znakù na ¹estnáctisegmentovém
displeji.</i></p>

<p>Podle podobnosti s&nbsp;køí¾em na vlajce Spojeného království (spojené
rùznobarevné køí¾e Anglie, Skotska a Irska) se tomuto typu displeje také
pøezdívá <i>Union Jack</i>. Z&nbsp;2<sup>16</sup> kombinací, které je mo¾né na
tomto typu displeje zobrazit, bylo ve vývojovém kitu <i>SDK-51</i> pou¾ito
pouze 63 kombinací pøedstavujících znaky velké abecedy, èíslice a nìkteré
speciální znaky (zavináè pou¾ívaný v&nbsp;assembleru <i>8051</i> atd.). O tom,
jakým zpùsobem se jednotlivé znaky zobrazovaly, si mù¾ete udìlat pøedstavu po
shlédnutí následujících obrázkù:</p>

<img src="http://i.iinfo.cz/images/484/pc125-6.jpg" width="442" height="450" alt=" " />
<p><i>Obrázek 6: Znaková sada pou¾itá vývojovým kitem SDK-51.</i></p>

<img src="http://i.iinfo.cz/images/484/pc125-7.jpg" width="437" height="410" alt=" " />
<p><i>Obrázek 7: Speciální znaky ve znakové sadì vývojového kitu
SDK-51.</i></p>

<p>K&nbsp;mikroøadièi <i>Intel 8031</i> byla pøipojena externí pamì» RAM o
kapacitì jeden kilobajt (pou¾itá ov¹em pro programy, nikoli pro data), která
byla sestavená z&nbsp;dvojice pamì»ových modulù <i>2114</i>, co¾ je naprosto
stejná konfigurace, jakou se py¹nil napøíklad i èeskoslovenský mikropoèítaè
<i>PMI-80</i>. Kromì této pamìti byla k&nbsp;mikroøadièi pøipojena i externí
pamì» ROM mající kapacitu 8 kB.  V&nbsp;ROM byl ulo¾en monitor mapovaný na
adresový rozsah 0xe000 a¾ 0xffff umo¾òující zadávání programù, jejich
modifikaci, ladìní, nastavení breakpointù, výpis obsahu pamìti èi registrù
speciálních funkcí, zmìnu konfigurace sériového portu atd. Mo¾nosti monitoru
byly pomìrnì velké (pøipomínají spí¹e program <strong>DEBUG</strong>
z&nbsp;MS-DOSu) a zpùsob komunikace s&nbsp;ním se pøíli¹ neli¹il od
&bdquo;konverzaèního re¾imu&ldquo; pou¾ívaného napøíklad u plnohodnotných
mikropoèítaèù. Kromì pamìtí zmínìných vý¹e bylo mo¾né do vývojového kitu
nainstalovat dal¹ích 8 kB pamìti ROM pro nemìnitelné u¾ivatelské programy a a¾
15 kB pamìti RAM, v&nbsp;závislosti na tom, jak rozsáhlou aplikaci programátor
vyvíjel.</p>

<img src="http://i.iinfo.cz/images/484/pc125-8.jpg" width="292" height="540" alt=" " />
<p><i>Obrázek 8: Nìkteré pøíkazy monitoru vývojového kitu SDK-51.</i></p>

<p>Vývojový kit <i>Intel SDK-51</i> takté¾ obsahoval ètyøi kilobity (ne
kilobajty!) pamìti RAM s&nbsp;organizací 4096&times;1, která v¹ak nebyla pøímo
dostupná pro zápis dat ani jako pamì», v&nbsp;ní¾ mohly být ulo¾eny programy.
Tato RAM toti¾ slou¾ila pro nastavení breakpointù, co¾ je velmi u¾iteèná
pomùcka pøi ladìní programù. Systém breakpointù byl øe¹en na hardwarové úrovni
a to pomìrnì jednodu¹e &ndash; jakmile se na externí adresové sbìrnici objevila
taková adresa, pro ní¾ byl v&nbsp;&bdquo;breakpointové&ldquo; RAM nastaven
pøíslu¹ný bit, byl mikroøadiè zastaven a u¾ivatel mìl mo¾nost si prohlédnout
obsah interní i externí pamìti RAM, stav speciálních funkèních registrù atd.
Pozornìj¹ímu ètenáøi pravdìpodobnì neuniklo, ¾e 4096 bitù (tj.&nbsp;4096
pøíznakù, zda je èi není na dané adrese nastaven breakpoint) postaèuje pokrýt
pouze adresový rozsah ètyø kilobajtù pamìti programu (programátor musel pomocí
jumperù nastavit, o které ètyøi kilobajty se jedná), ov¹em do vývojového kitu
bylo mo¾né nainstalovat je¹tì jeden pamì»ový modul o kapacitì ètyø kilobitù,
tak¾e se breakpointy mohly nastavit pro jakoukoli adresu pamìti, v&nbsp;ní¾
byly umístìny u¾ivatelské programy.</p>

<a href="http://i.iinfo.cz/images/484/pc125-9.jpg"><img src="http://i.iinfo.cz/images/484/pc125-9-prev.jpg" width="370" height="256" alt=" " /></a>
<p><i>Obrázek 9: Blokové schéma vývojového kitu SDK-51.</i></p>



<p><a name="k04"></a></p>
<h2>4. Jednoduché mikropoèítaèe zalo¾ené na MCS-51</h2>

<p>Kromì vývojových kitù urèených pøedev¹ím pro vývoj programù, které se mìly
pozdìji vyu¾ívat v&nbsp;rùzných specializovaných elektronických zaøízeních,
vzniklo i mnoho rùzných mikropoèítaèù (zkonstruovaných vìt¹inou amatéry),
v&nbsp;nich¾ byl namísto univerzálního mikroprocesoru vyu¾it právì mikroøadiè
<i>MCS-51</i> jako jejich ústøední øídicí prvek. Volba tohoto typu mikroøadièe
pro amatérsky konstruované mikropoèítaèe je pomìrnì logická, kdy¾ si uvìdomíme,
¾e tyto èipy bylo mo¾né pou¾ívat bez nutnosti pøidávání vìt¹ího mno¾ství
podpùrných obvodù. V&nbsp;tom nejjednodu¹¹ím pøípadì postaèovalo
k&nbsp;mikroøadièi <i>MCS-51</i> pouze pøipojit napájení a krystalový
oscilátor, proto¾e <i>MCS-51</i> obsahoval jak pamì» RAM i ROM/EPROM/EEPROM (i
kdy¾ s&nbsp;pomìrnì malou kapacitou), tak i ètveøici osmibitových paralelních
portù, sériový port s&nbsp;konfigurovatelnou rychlostí pøenosu i ètyømi re¾imy
èinnosti, dvojici èi trojici èítaèù, dva vstupy pro pøipojení externích
pøeru¹ovacích signálù atd.</p>

<img src="http://i.iinfo.cz/images/293/pc124-9.jpg" width="320" height="240" alt=" " />
<p><i>Obrázek 10: Amatérský mikropoèítaè postavený na základì mikroøadièe 8051,
jeho¾ funkce bude popsaná v&nbsp;následující kapitole.</i></p>

<p>Na druhou stranu napøíklad osmibitový mikroprocesor <i>Intel 8080</i>
vy¾adoval minimálnì pìt dal¹ích èipù pro alespoò minimalistickou konstrukci
mikropoèítaèe &ndash; jedná se o pomocné èipy <i>8224</i> a <i>8228</i>, pamì»
ROM, pamì» RAM a alespoò jeden èip <i>8255</i> umo¾òující pøipojení klávesnice.
Osmibitové mikroprocesory <i>MOS 6502</i> èi <i>Zilog Z80</i> takté¾ vy¾adovaly
alespoò pøipojení RAM a ROM na datovou a adresovou sbìrnici a pro pøipojení
dal¹ích zaøízení obdobu èipù <i>8255</i> a <i>8251</i>. Nìkteré
z&nbsp;mikropoèítaèù zalo¾ených na mikroøadièi <i>MCS-51</i> skuteènì vyu¾ívaly
pouze interní pamì» údajù (RAM) i pamì» programu (ROM) bez dal¹ích pøídavných
pamìtí.</p>

<img src="http://i.iinfo.cz/images/293/pc124-10.jpg" width="320" height="240" alt=" " />
<p><i>Obrázek 11: Drátové propojky pou¾ité u mikropoèítaèe popsaného
v&nbsp;následující kapitole. Podle slov autora tohoto poèítaèe jsou drátové
propojky lep¹í ne¾ jiná technologie v&nbsp;tom ohledu, ¾e se zapojení snáze
upravuje ne¾ v&nbsp;pøípadì pou¾ití plo¹ného spoje nebo nepájivého kontaktního
pole.</i></p>

<p>Ov¹em pøedev¹ím kapacita pamìti údajù je pro universální mikropoèítaèe
nedostateèná, proto zaèaly vznikat (pøedev¹ím po sní¾ení cen pamì»ových èipù)
takové mikropoèítaèe s&nbsp;<i>MCS-51</i>, jejich¾ architektura se pøíli¹
neli¹ila od mikropoèítaèù vybavených jiným typem mikroprocesoru. Samozøejmì ¾e
dal¹í výhody <i>MCS-51</i>, napøíklad pøítomnost sériového portu, èítaèù, dvou
pøeru¹ovacích vstupù nebo jednoho èi dvou volných paralelních portù, nezùstaly
u tìchto mikropoèítaèù nevyu¾ity.</p>

<a href="http://i.iinfo.cz/images/542/pc122-15.png"><img src="http://i.iinfo.cz/images/542/pc122-15-prev.png" width="323" height="270" alt=" " /></a>
<p><i>Obrázek 12: Standardní zpùsob pøipojení externí pamìti programu a externí
pamìti údajù k&nbsp;mikroøadièi Intel 8051. Pov¹imnìte si pøedev¹ím pou¾ití
záchytného registru pro spodních osm bitù adresy a takté¾ toho, ¾e ètení
z&nbsp;externí pamìti programu se uskuteèòovalo pomocí signálu PSEN a
ètení/zápis do externí pamìti dat pomocí signálu RD a WR (v¹echny uvedené
signály jsou negované).</i></p>



<p><a name="k05"></a></p>
<h2>5. Pøíklad amatérsky zkonstruovaného mikropoèítaèe s&nbsp;MCS-51</h2>

<p>Pojïme si nyní jednu z&nbsp;mnoha variant mikropoèítaèù zalo¾ených na
mikroøadièi <i>MCS-51</i> pøedstavit. Na následujícím obrázku je vyobrazeno
schéma tohoto mikropoèítaèe s&nbsp;mikroøadièem <i>Intel 8031</i>
(tj.&nbsp;variantou <i>MCS-51</i> bez interní pamìti ROM a se 128 bajty pamìti
údajù) taktovaným na 12 MHz popø.&nbsp;na 11,059 MHz, k&nbsp;nìmu¾ je pøipojeno
vìt¹í mno¾ství podpùrných èipù. Pøedev¹ím se jedná a dva pamì»ové moduly RAM
(jeden s&nbsp;kapacitou 8 kB a druhý s&nbsp;kapacitou 32 kB), pamì»ový modul
ROM s&nbsp;kapacitou 16 kB, obvod MAX232 pou¾itý jako konvertor mezi sériovým
portem <i>MCS-51</i> a standardem RS-232C (odli¹né napì»ové úrovnì) a volitelnì
té¾ øadiè textového displeje s&nbsp;tekutých krystalù (LCD) a dokonce i øadiè
pevných diskù popø.&nbsp;dal¹ích zaøízení pøipojovaných na rozhraní IDE.
Vzhledem k&nbsp;tomu, ¾e pøipojení LCD a IDE vy¾aduje vìt¹í mno¾ství pinù ne¾
nabízí ètyøi porty mikroøadièe <i>Intel 8031</i>, je v&nbsp;zapojení pou¾it
obvod <i>8255</i>, který pracuje nejenom jako dal¹í tøi osmibitové
vstupnì/výstupní brány, ale i jako záchytný registr (latch).</p>

<a href="http://i.iinfo.cz/images/484/pc125-10.png"><img src="http://i.iinfo.cz/images/484/pc125-10-prev.png" width="370" height="223" alt=" " /></a>
<p><i>Obrázek 13: Schéma mikropoèítaèe s&nbsp;mikroøadièem Intel 8031
v&nbsp;základní sestavì, tj.&nbsp;bez øadièe LCD a rozhraní IDE.</i></p>

<p>Na schématu mikropoèítaèe je zajímavých hned nìkolik vìcí. První z&nbsp;nich
pøedstavuje pamì»ový subsystém. Vzhledem k&nbsp;tomu, ¾e mikroøadiè
<i>MCS-51</i> je zalo¾ený na Harvardské architektuøe, má plnì oddìlenou pamì»
programu od pamìti dat, a to i v&nbsp;pøípadì, ¾e jsou tyto pamìti pøipojeny
k&nbsp;mikroøadièi jako externí pamì»ové moduly. I kdy¾ se pro obì pamìti
pou¾ívá spoleèná adresová a datová sbìrnice, øídicí signály jsou odli¹né
&ndash; ètení z&nbsp;pamìti programu je øízeno negovaným signálem
<strong>PSEN</strong> a ètení èi zápis do pamìti dat dvojicí (opìt negovaných)
signálù <strong>RD</strong> a <strong>WR</strong>. U univerzálních
mikropoèítaèù je v¹ak mnohdy výhodnìj¹í pou¾ití procesoru s&nbsp;von
Neumannovou architekturou, která je v&nbsp;pøípadì popisovaného mikropoèítaèe
simulována tím, ¾e jsou oba &bdquo;ètecí&ldquo; signály <strong>RD</strong> a
<strong>PSEN</strong> logicky spojeny, tak¾e se tentý¾ pamì»ový èip mù¾e
pou¾ívat jak pro ulo¾ení programù, tak i pro data. Jednou z&nbsp;nevýhod tohoto
øe¹ení je zmen¹ení adresového rozsahu ze 128 kB (64 kB RAM + 64 kB ROM) na 64
kB, co¾ ov¹em pro popisovaný mikropoèítaè není nikterak omezující.</p>

<a href="http://i.iinfo.cz/images/484/pc125-11.png"><img src="http://i.iinfo.cz/images/484/pc125-11-prev.png" width="370" height="223" alt=" " /></a>
<p><i>Obrázek 14: Druhá (variantní) èást mikropoèítaèe s&nbsp;øadièem LCD a
rozhraním IDE.</i></p>

<p>O tom, jaký pamì»ový èip èi jaké periferní zaøízení bude v&nbsp;danou chvíli
adresováno, je rozhodnuto na základì nejvy¹¹ích tøí bitù adresy A13 a¾ A15,
tedy celkem osmi mo¾ných kombinací (viz èást schématu s&nbsp;èipem 74138).
Obsazení ètyø osmibitových portù mikroøadièe <i>Intel 8031</i> je v&nbsp;tomto
mikropoèítaèi následující: port èíslo 0 slou¾í jako spodních osm bitù
multiplexované adresové a datové sbìrnice øízené signálem <strong>ALE</strong>
(address latch enable), port èíslo 1 je urèen pro øízení LCD displeje a IDE
rozhraní (pokud jsou tyto dva moduly pou¾ity, je na tento port pøipojen obvod
<i>Intel 8255</i>), port èíslo 2 slou¾í jako horních osm bitù adresové sbìrnice
a koneènì v¹echny piny portu èíslo 3 jsou vyu¾ity ke svým alternativním
funkcím, tj.&nbsp;jako sériový port (<strong>RXD</strong>,
<strong>TXD</strong>), øízení externích pamìtí (<strong>RD</strong>,
<strong>WR</strong>), vstupy pøeru¹ení (<strong>INT0</strong> &ndash; pou¾ito u
rozhraní IDE, <strong>INT1</strong>) a vstupy obou èítaèù/èasovaèù
(<strong>T0</strong>, <strong>T1</strong>).</p>

<img src="http://i.iinfo.cz/images/484/pc125-12.jpg" width="290" height="196" alt=" " />
<p><i>Obrázek 15: K&nbsp;popisovanému mikropoèítaèi lze pøipojit i displej
z&nbsp;tekutých krystalù s&nbsp;vlastním øadièem. Zde je na displeji zobrazen
výpis èásti programu napsaného v&nbsp;BASICu, jeho¾ interpret i pøekladaè je
pro MCS-51 dostupný.</i></p>



<p><a name="k06"></a></p>
<h2>6. Ovládání textových LCD mikroøadièem</h2>

<p>Zatímco u vìt¹iny jednodu¹¹ích vývojových kitù (pøedev¹ím jejich star¹ích
variant) se kromì nìkolika LED nevyskytovala ¾ádná dal¹í periferní zaøízení,
která by u¾ivatelùm signalizovala stav mikroøadièe popø.&nbsp;stav bì¾ícího
programu, v&nbsp;pøípadì výstavby celého mikropoèítaèe zalo¾eného na
mikroøadièi <i>MCS-51</i> je situace znaènì odli¹ná, proto¾e u prakticky
ka¾dého mikropoèítaèe se dnes za standard pova¾uje alespoò mo¾nost zobrazení
nìkolika øádkù textu a vìt¹inou je preferovaný i grafický výstup. Pomìrnì velké
mno¾ství podomácku konstruovaných mikropoèítaèù zalo¾ených na mikroøadièi
<i>MCS-51</i> obsahuje monochromatický displej vyrobený z&nbsp;tekutých
krystalù (LCD) nabízejících mo¾nost zobrazení jednoho èi více øádkù textu.
Pøipojení tìchto typù displejù k&nbsp;mikroøadièi je velmi jednoduché, proto¾e
pro ovládání LCD se vyrábí specializované øadièe s&nbsp;vlastní RAM, které jsou
vìt¹inou znaènì univerzální, co se týèe mno¾ství podporovaných typù displejù
&ndash; typicky jsou podporovány displeje s&nbsp;jedním a¾ ètyømi øádky textu,
pøièem¾ poèet znakù na øádku mù¾e dosahovat hodnot 8, 16, 20, 24, 32 nebo
40.</p>

<img src="http://i.iinfo.cz/images/484/pc125-13.png" width="300" height="141" alt=" " />
<p><i>Obrázek 16: LCD zobrazující dva øádky textu po 16 znacích, jeho¾ øadiè se
k&nbsp;MCS-51 pøipojuje pøes sériové rozhraní.</i></p>

<p>Nìkteré modely øadièù LCD jsou vybaveny standardním sériovým rozhraním
podporujícím (vìt¹inou) asynchronní pøenos dat, tj.&nbsp;jednotlivých znakù,
které se mají zobrazit, i nìkterých øídicích kódù, kterými se ovládá napøíklad
pohyb kurzoru, smazání displeje, inverzní výpis znakù atd. Pøi asynchronním
pøenosu se vìt¹inou pou¾ívá formát 8N1 a pøenosová rychlost 2400 Bd
popø.&nbsp;9600 Bd (vìt¹inou je v¹ak mo¾né nastavit i jiné hodnoty). Ov¹em
existuje i øada øadièù LCD s&nbsp;rozhraním paralelním a to buï ètyøbitovým
nebo osmibitovým (popø.&nbsp;lze mezi obìma ¹íøkami paralelního rozhraní
volit). Jedním z&nbsp;velmi známých a èasto pou¾ívaných øadièù textových LCD je
èip <strong>HD44780</strong> struènì pøedstavený v&nbsp;následující
kapitole.</p>

<img src="http://i.iinfo.cz/images/484/pc125-14.png" width="340" height="100" alt=" " />
<p><i>Obrázek 17: Textový LCD se dvìma øádky textu po 20 znacích na
øádku.</i></p>



<p><a name="k07"></a></p>
<h2>7. Øadiè textových displejù HD44780</h2>

<p>Øadiè textových displejù prodávaný pod oznaèením <strong>HD44780</strong> je
navr¾en takovým zpùsobem, aby komunikace s&nbsp;ním byla co nejsnaz¹í a
souèasnì nevy¾adovala ulo¾ení zobrazovaných øetìzcù v&nbsp;pamìti mikroøadièe,
co¾ by mohl být pro èipy s&nbsp;pouhými 128 bajty RAM pomìrnì slo¾itì øe¹itelný
problém. Z&nbsp;tohoto dùvodu øadiè obsahuje i &bdquo;obrazovou&ldquo; pamì»
RAM s&nbsp;kapacitou pro ulo¾ení 80 znakù, co¾ odpovídá dvouøádkovému displeji
se 40 znaky na øádek nebo ètyøøádkovému displeji s&nbsp;20 znaky na øádek. Pro
dal¹í èasto pou¾ívanou kombinaci 4&times;40 znakù sice ji¾ kapacita 80 znakù
nedostaèuje, ov¹em je mo¾né dva øadièe <strong>HD44780</strong> spojit do
souèasnì pracující dvojice.</p>

<img src="http://i.iinfo.cz/images/484/pc125-15.png" width="200" height="130" alt=" " />
<p><i>Obrázek 18: Ètyøøádkový textový LCD.</i></p>

<p>Tento øadiè LCD takté¾ obsahuje pamì» ROM, v&nbsp;ní¾ je ulo¾eno celkem 208
znakù definovaných v&nbsp;rastru 5&times;8 pixelù a 32 znakù v&nbsp;rastru
5&times;10 pixelù (vìt¹inou bývá devátý mikroøádek prázdný a desátý mikroøádek
je vyu¾itý pro zobrazení kurzoru). Navíc je mo¾né v&nbsp;pøípadì potøeby tvar
osmi znakù definovat u¾ivatelsky, èeho¾ se vyu¾ívá napøíklad pro zobrazení
národních znakù s&nbsp;akcenty nebo pro zobrazení zjednodu¹eného loga
popø.&nbsp;rùzných ikon. Vzhledem k&nbsp;tomu, ¾e tvary tìchto osmi znakù jsou
ulo¾eny v&nbsp;RAM øadièe (po vypnutí napájení se jejich tvary ztratí), lze je
kdykoli zmìnit a vytvoøit tak velmi jednoduchou formu animace, popø.&nbsp;se
pøepínat mezi nìkolika národními znaky. Kromì bì¾nìj¹í varianty øadièe LCD
<strong>HD44780</strong> se znaky latinky a azbuky (cyrilice) existuje i verze
øadièe mající v&nbsp;ROM vypáleny zjednodu¹ené znaky japonské abecedy. Vzhledem
k&nbsp;tomu, ¾e tento øadiè podporuje osmibitový i ètyøbitový pøenos dat, mù¾e
být k&nbsp;<i>MCS-51</i> propojen buï osmibitovou nebo ètyøbitovou sbìrnicí
vytvoøenou napøíklad pomocí portu èíslo 0. Navíc je nutné k&nbsp;øadièi
pøipojit minimálnì i signál pro povolení zápisu <strong>WR</strong> a jeden
vodiè slou¾ící pro pøepínání mezi zápisem do øídicího registru
<strong>IR</strong> a datového registru <strong>DR</strong>.</p>

<a href="http://i.iinfo.cz/images/484/pc125-16.jpg"><img src="http://i.iinfo.cz/images/484/pc125-16-prev.jpg" width="359" height="270" alt=" " /></a>
<p><i>Obrázek 19: Grafický LCD s&nbsp;rozli¹ením 128&times;64 pixelù; zpùsoby
ovládání tìchto displejù si popí¹eme pøí¹tì.</i></p>



<p><a name="k08"></a></p>
<h2>8. Pøímé generování video signálu</h2>

<p>V&nbsp;následující èásti seriálu o architekturách poèítaèù si popí¹eme
nìkteré zpùsoby ovládání displejù z&nbsp;tekutých krystalù (LCD) umo¾òujících
práci s&nbsp;rastrovou grafikou, i kdy¾ vìt¹inou pouze monochromatickou.
Zatímco &bdquo;textové&ldquo; LCD je mo¾né pomocí mikroøadièù ovládat celkem
snadno, u nìkterých øadièù grafických displejù je ji¾ zapotøebí vyvinout vìt¹í
úsilí. Pravì z&nbsp;tohoto dùvodu vzniklo nìkolik programových knihoven
(nejenom) pro mikroøadièe <i>MCS-51</i>, které práci s&nbsp;grafickými LCD
zjednodu¹uje. Takté¾ se budeme zabývat nìkolika projekty, jejich¾ cílem bylo
generování obrazu pøímo na televizní obrazovce nebo na obrazovce monitoru. Pro
tyto úèely je nutné pou¾ít nìkterou modernìj¹í variantu mikroøadièe
<i>MCS-51</i>, který má dostateèný výkon na to, aby dokázal v&nbsp;reálném èase
generovat v¹echny potøebné signály, které se pøed posláním do televizoru
posléze slouèí do signálu jediného (v&nbsp;pøípadì pou¾ití anténního vstupu
navíc následuje modulace signálu). Tento princip generování obrazu bez pou¾ití
framebufferu a specializovaných èipù (které v&nbsp;podstatì serializují data
z&nbsp;framebufferu a pøidávají k&nbsp;nim synchronizaci) se vyu¾ívá jak u
zmínìného <i>MCS-51</i>, tak i u dal¹ích mikroøadièù, napøíklad rychlých
variant èipù <i>AVR</i>.</p>

<img src="http://i.iinfo.cz/images/484/pc125-17.jpg" width="311" height="237" alt=" " />
<p><i>Obrázek 20: Dal¹í grafický LCD s&nbsp;rozli¹ením 128&times;64 pixelù,
který je navíc vybavený ovladaèem se sériovým rozhraním.</i></p>

<p>Pøí¹tì se takté¾ zaèneme zabývat dal¹ím &ndash; a to velmi roz¹íøeným
&ndash; typem osmibitových mikroøadièù. Jedná se o mikroøadièe øady <i>PIC</i>,
které jsou vývojáøùm nabízeny v&nbsp;takøka nepøeberném mno¾ství variant
li¹ících se jak kapacitou pamìtí, tak i výkonem, poètem pinù, dostupnými moduly
a samozøejmì i cenou. Vysvìtlíme si rozdíl v&nbsp;instrukèních sadách
jednotlivých øad osmibitových mikroøadièù <i>PIC</i> (zpùsobený pøedev¹ím
rozdílnou maximální kapacitou pamìti údajù), funkèní moduly, které na tìchto
mikroøadièích mohou být pøítomny i zpùsob pou¾ití tìchto èipù v&nbsp;rùzných
zapojeních, samozøejmì opìt s&nbsp;dùrazem na jejich aplikaci
v&nbsp;mikropoèítaèích.</p>

<a href="http://i.iinfo.cz/images/484/pc125-18.jpg"><img src="http://i.iinfo.cz/images/484/pc125-18-prev.jpg" width="370" height="184" alt=" " /></a>
<p><i>Obrázek 21: Pøipojení grafického LCD k&nbsp;mikroøadièi MCS-51.</i></p>



<p><a name="k09"></a></p>
<h2>9. Obsah následující èásti seriálu</h2>

<ol>

<li>Graphic LCD interfacing with AT89C51<br />
<a href="http://www.8051projects.info/tags.asp?tag=graphic+lcd+interfacing+with+at89c51">http://www.8051projects.info/tags.asp?tag=graphic+lcd+interfacing+with+at89c51</a>
</li>

<li>Interfacing LCD made easy<br />
<a href="http://www.8051projects.info/blogs.asp?view=plink&amp;id=188">http://www.8051projects.info/blogs.asp?view=plink&amp;id=188</a>
</li>

<li>RD2 Kit &ndash; HW Description<br />
<a href="http://hw-server.com/constrc/rd2kit.html">http://hw-server.com/constrc/rd2kit.html</a>
</li>

<li>Programujte v C &ndash; RD2 Kit<br />
<a href="http://hw.cz/Produkty/ART130-Programujte-v-C---RD2-Kit.html">http://hw.cz/Produkty/ART130-Programujte-v-C---RD2-Kit.html</a>
</li>

<li>LCD Interfacing and Microcontroller<br />
<a href="http://lcdinterfacing.blogspot.com/2009/11/ks0108b-graphic-lcd-interfacing.html">http://lcdinterfacing.blogspot.com/2009/11/ks0108b-graphic-lcd-interfacing.html</a>
</li>

<li>Serial Graphic LCD 128x64<br />
<a href="http://www.sparkfun.com/commerce/product_info.php?products_id=9351">http://www.sparkfun.com/commerce/product_info.php?products_id=9351</a>
</li>

<li>Crystalfontz Liquid Crystal Displays<br />
<a href="http://www.crystalfontz.com/products/index-ser.html">http://www.crystalfontz.com/products/index-ser.html</a>
</li>

<li>Pøipojení inteligentního displeje k 8051<br />
<a href="http://www.dhservis.cz/lcd.htm">http://www.dhservis.cz/lcd.htm</a>
</li>

<li>Ovládání znakových LCD s øadièem HD44780<br />
<a href="http://elektronika.kvalitne.cz/ATMEL/necoteorie/LCDmatice.html">http://elektronika.kvalitne.cz/ATMEL/necoteorie/LCDmatice.html</a>
</li>

<li>SOH protokol - text a grafika<br />
<a href="http://www.acscontrol.com/Index_LcdTerminal.asp?Page=/Pages/Products/Lcd/128x64%20LCD_Display_Terminal_SOH_Protocol.htm">http://www.acscontrol.com/Index_LcdTerminal.asp?Page=/Pages/Products/Lcd/128x64%20LCD_Display_Terminal_SOH_Protocol.htm</a>
</li>

<li>Serial EEPROM (93C46 / 93CS46) Routines<br />
<a href="http://www.pjrc.com/tech/8051/serial-eeprom.html">http://www.pjrc.com/tech/8051/serial-eeprom.html</a>
</li>

<li>93CS46 (serial EEPROM) data sheet<br />
<a href="http://www.pjrc.com/tech/8051/93CS46.pdf">http://www.pjrc.com/tech/8051/93CS46.pdf</a>
</li>

<li>Microcontroller<br />
<a href="http://en.wikipedia.org/wiki/Microcontroller">http://en.wikipedia.org/wiki/Microcontroller</a>
</li>

<li>Great Microprocessors of the Past and Present (V 13.4.0)<br />
<a href="http://jbayko.sasktelwebsite.net/cpu.html">http://jbayko.sasktelwebsite.net/cpu.html</a>
</li>

<li>Intel 8048 Microcontroller Oral History Panel<br />
<a href="http://www.computerhistory.org/collections/accession/102658328">http://www.computerhistory.org/collections/accession/102658328</a>
</li>

<li>IMSAI(R) History: The 8048 Control Computer<br />
<a href="http://www.imsai.net/history/imsai_history/imsai_8048_control_computer.htm">http://www.imsai.net/history/imsai_history/imsai_8048_control_computer.htm</a>
</li>

<li>8048<br />
<a href="http://coprolite.com/8048.html">http://coprolite.com/8048.html</a>
</li>

<li>IMSAI 8048<br />
<a href="http://www.old-computers.com/museum/computer.asp?st=1&c=564">http://www.old-computers.com/museum/computer.asp?st=1&c=564</a>
</li>

<li>Intel 8048<br />
<a href="http://en.wikipedia.org/wiki/8048">http://en.wikipedia.org/wiki/8048</a>
</li>

<li>Tesla Eltos Mikropoèítaèová stavebnice Petr<br />
<a href="http://sites.google.com/site/computerresearchltd/Home/stare-stroje/tesla-eltos-mikropocitacova-stavebnice-petr">http://sites.google.com/site/computerresearchltd/Home/stare-stroje/tesla-eltos-mikropocitacova-stavebnice-petr</a>
</li>

<li>Mikropoèítaèová stavebnice Petr<br />
<a href="http://dex.bloguje.cz/770366-mikropocitacova-stavebnice-petr.php">http://dex.bloguje.cz/770366-mikropocitacova-stavebnice-petr.php</a>
</li>

<li>Kosmos CP1<br />
<a href="http://de.wikipedia.org/wiki/Kosmos_CP1">http://de.wikipedia.org/wiki/Kosmos_CP1</a>
</li>

<li>KOSMOS: CP1 / Computer Praxis<br />
<a href="http://www.old-computers.com/museum/computer.asp?st=1&c=494">http://www.old-computers.com/museum/computer.asp?st=1&c=494</a>
</li>

<li>Great CPU: Part VIII: Intel 8051, Descendant of the 8048 (around 1977?)<br />
<a href="http://jbayko.sasktelwebsite.net/cpu1.html#Sec1Part8">http://jbayko.sasktelwebsite.net/cpu1.html#Sec1Part8</a>
</li>

<li>Intel 8051 &ndash; Wikipedie EN<br />
<a href="http://en.wikipedia.org/wiki/8051">http://en.wikipedia.org/wiki/8051</a>
</li>

<li>Intel 8051 &ndash; Wikipedie CZ<br />
<a href="http://cs.wikipedia.org/wiki/Intel_8051">http://cs.wikipedia.org/wiki/Intel_8051</a>
</li>

<li>Popis mikroprocesoru 8051<br />
<a href="http://www.dhservis.cz/popis8051.htm">http://www.dhservis.cz/popis8051.htm</a>
</li>

<li>Jak se nauèit programovat (nejen jednoèipy)<br />
<a href="http://www.dhservis.cz/dalsi_1/obsah_popis.htm">http://www.dhservis.cz/dalsi_1/obsah_popis.htm</a>
</li>

<li>89C1051 series datasheets<br />
<a href="http://www.chipdocs.com/datasheets/datasheet-pdf/Atmel-Corporation/89C1051.html">http://www.chipdocs.com/datasheets/datasheet-pdf/Atmel-Corporation/89C1051.html</a>
</li>

<li>8051 microcontroller FAQ<br />
<a href="http://www.faqs.org/faqs/microcontroller-faq/8051/">http://www.faqs.org/faqs/microcontroller-faq/8051/</a>
</li>

<li>ABOUT THE 8051<br />
<a href="http://www.esacademy.com/assets/faqs/8051/2.htm">http://www.esacademy.com/assets/faqs/8051/2.htm</a>
</li>

<li>Mikroprocesor 8051<br />
<a href="http://8051.godlike.cz/">http://8051.godlike.cz/</a>
</li>

<li>Intel SDK<br />
<a href="http://en.wikipedia.org/wiki/Intel_SDK">http://en.wikipedia.org/wiki/Intel_SDK</a>
</li>

<li>Old Computer Museum: SDK-51 (MCS-51)<br />
<a href="http://oldcomputermuseum.com/intel_sdk51.html">http://oldcomputermuseum.com/intel_sdk51.html</a>
</li>

<li>Embedded Systems Development Nexus<br />
<a href="http://hypercontinuum.tripod.com/">http://hypercontinuum.tripod.com/</a>
</li>

<li>80x51 Microcontrollers webring<br />
<a href="http://nav.webring.org/cgi-bin/webring?ring=80x51;home">http://nav.webring.org/cgi-bin/webring?ring=80x51;home</a>
</li>

<li>Intel 8051 Java Simulator/Debugger<br />
<a href="http://www.viara.eu/en/j51/">http://www.viara.eu/en/j51/</a>
</li>

<li>Intel 8051 Java Simulator/Debugger - download page<br />
<a href="http://www.viara.eu/en/j51/#DOWNLOAD">http://www.viara.eu/en/j51/#DOWNLOAD</a>
</li>

<li>Silicon Labs Pipelined 8051 Microcontrollers<br />
<a href="http://www.silabs.com/products/mcu/Pages/8051-microcontroller.aspx">http://www.silabs.com/products/mcu/Pages/8051-microcontroller.aspx</a>
</li>

<li>My home-built 8051 Computer<br />
<a href="http://roger.trideja.com/8051/8051.html">http://roger.trideja.com/8051/8051.html</a>
</li>

<li>8390 Ethernet Tutorial<br />
<a href="http://www.8052.com/tcpip/">http://www.8052.com/tcpip/</a>
</li>

<li>Zylogic Semiconductor Corporation<br />
<a href="http://www.zylogic.com.cn/english/tools03.htm">http://www.zylogic.com.cn/english/tools03.htm</a>
</li>

<li>8051 Television Video<br />
<a href="http://www.8052.com/users/phillipmgallo/">http://www.8052.com/users/phillipmgallo/</a>
</li>

<li>128x64 Graphical LCD<br />
<a href="http://www.pjrc.com/tech/8051/board5/lcd_128x64.html">http://www.pjrc.com/tech/8051/board5/lcd_128x64.html</a>
</li>

<li>8051 FAQs<br />
<a href="http://www.8052.com/faqs">http://www.8052.com/faqs</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Ti¹novský</a> &nbsp; 2010</small></p>
</body>
</html>

