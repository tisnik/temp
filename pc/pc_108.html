<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Èeskoslovenské osmibitové poèítaèe 6 &ndash; Didaktik Gama, Didaktik M a Didaktik Kompakt</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Èeskoslovenské osmibitové poèítaèe 6 &ndash; Didaktik Gama, Didaktik M a Didaktik Kompakt</h1>

<h3>Pavel Ti¹novský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V dne¹ní èásti seriálu o architekturách poèítaèù dokonèíme popis domácích osmibitových èeskoslovenských poèítaèù Didaktik Gama, Didaktik M a Didaktik Kompakt. Popí¹eme si pøedev¹ím strukturu obrazové pamìti tìchto poèítaèù, která vychází z pùvodního ZX Spectra i zpùsob naèítání obrázkù (napøíklad z magnetofonu).</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Struktura obrazové pamìti poèítaèe Didaktik Gama i jeho následovníkù</a></p>
<p><a href="#k02">2. Èást obrazové pamìti s&nbsp;ulo¾enou bitmapou</a></p>
<p><a href="#k03">3. Atributová pamì», její pøednosti a omezení</a></p>
<p><a href="#k04">4. Naèítání obrázkù z&nbsp;externích zaøízení</a></p>
<p><a href="#k05">5. Osmibitový poèítaè Didaktik M</a></p>
<p><a href="#k06">6. Didaktik Kompakt</a></p>
<p><a href="#k07">7. Obsah následující èásti seriálu</a></p>
<p><a href="#k08">8. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2>1. Struktura obrazové pamìti poèítaèe Didaktik Gama i jeho následovníkù</h2>

<p>V&nbsp;pøedchozí èásti tohoto seriálu jsme si mj.&nbsp;øekli, jakým zpùsobem
je uspoøádaná pamì» oblíbeného domácího osmibitového mikropoèítaèe <i>Didaktik
Gama</i>. Pøipomeòme si, ¾e na rozdíl od pùvodního <i>ZX Spectra 16K</i> nebo
<i>ZX Spectra 48K</i> byla velikost nainstalované operaèní pamìti u
<i>Didaktiku Gama</i> rovna celým 80 kilobajtùm. Operaèní pamì» byla rozdìlena
na tøi bloky. První blok o kapacitì 16 kB, který se z&nbsp;pohledu
mikroprocesoru <i>Z80</i> mapoval na adresy 16384 a¾ 32767, obsahoval pøedev¹ím
grafickou pamì» popsanou v&nbsp;dal¹ím textu, vyrovnávací pamì» tiskárny,
systémové promìnné a volný blok pro BASICové nebo strojové programy (viz té¾
tabulka umístìná pod tímto odstavcem). Dal¹í dva pamì»ové bloky mìly shodnou
kapacitu 32 kB a byly støídavì mapovány na adresy 32768 a¾ 65535. Pøepínání
mezi obìma bloky se provádìlo pøes nultý bit brány C obvodu 8255, napøíklad
instrukcemi <strong>OUT 127,0</strong> a <strong>OUT 127,1</strong> (byly v¹ak
mo¾né i dal¹í zpùsoby, napøíklad zápis bajtu pøímo na bránu C).</p>

<img src="http://i.iinfo.cz/images/530/pc108-1.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 1: Sabre Wulf &ndash; jedna z&nbsp;úspì¹ných her firmy Ultimate
Play the Game vyu¾ívající v¹ech vlastností grafického re¾imu poèítaèù ZX
Spectrum a tím pádem i Didaktikù).</i></p>

<table>
<tr><th>Adresa od</th><th>Adresa do</th><th>Délka</th><th>Význam</th></tr>
<tr><td>0    </td><td>16383</td><td>16384</td><td>pamì» ROM s&nbsp;BASICem a základním systémem</td></tr>
<tr><td>16384</td><td>22527</td><td>6144</td><td>bitmapa o rozli¹ení 256&times;192 pixelù</td></tr>
<tr><td>22528</td><td>23295</td><td>768</td><td>barvové atributy obrazu</td></tr>
<tr><td>23296</td><td>23551</td><td>256</td><td>vyrovnávací pamì» tiskárny</td></tr>
<tr><td>23552</td><td>23754</td><td>203</td><td>systémové promìnné</td></tr>
<tr><td>23755</td><td> -?- </td><td></td><td>volná RAM pro BASIC i strojové programy</td></tr>
<tr><td>65368</td><td>65535</td><td>168</td><td>oblast s&nbsp;ulo¾ením bitmap u¾ivatelských znakù (mìnitelná velikost)</td></tr>
</table>

<img src="http://i.iinfo.cz/images/530/pc108-2.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 2: Dal¹í úspì¹ná a známá hra firmy Ultimate Play the Game, která
je nazvaná Knight Lore, je zalo¾ena na isometrickém promítání zvaném také 2,5D
grafika. Engine pro isometrické promítání firma Ultimate pou¾ila i ve svých
dal¹ích hrách; jeho funkce byly pozdìji s&nbsp;vìt¹ím èi men¹ím úspìchem
napodobeny i dal¹ími programátory.</i></p>

<p>V&nbsp;dal¹ím textu se budeme zabývat pouze prvním ¹estnáctikilobajtovým
blokem operaèní pamìti umístìným na adresách 16384 a¾ 32767, do nìho¾ mìl
pøístup jak mikroprocesor <i>Z80</i>, tak i èip <i>ULA</i>. Z&nbsp;hlediska
programátora byla tato èást operaèní pamìti &bdquo;pomalej¹í&ldquo; ne¾ zbylých
32 kB, co¾ mj.&nbsp;znamenalo, ¾e se do této oblasti neumis»ovaly programové
rutiny nároèné na pøesné èasování, napøíklad podprogramy pro pøehrávání zvukù
èi práci s&nbsp;magnetofonem. Èip <i>ULA</i> si toti¾ postupnì naèítal hodnoty
jednotlivých pixelù i pøíslu¹né barvové atributy tìchto pixelù pøi generování
video signálu, tak¾e v&nbsp;nìkterých okam¾icích (pøi soubì¾ném pøístupu obou
èipù do tohoto pamì»ového bloku) byl mikroprocesor pozastavován, aby nebyl
pøeru¹en tok dat z&nbsp;pamìti na televizor (co¾ by zpùsobilo vizuální chyby),
tak¾e programátor nemohl vyu¾ívat pøesné èasování zalo¾ené na znalosti délky
trvání jednotlivých strojových instrukcí.</p>

<img src="http://i.iinfo.cz/images/530/pc108-3.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 3: Hra Elita patøila jak po technické stránce, tak i po stránce
herní mezi ¹pièkové tituly. Na poèítaèích PC vzniklo i její pokraèování nazvané
Frontier.</i></p>



<p><a name="k02"></a></p>
<h2>2. Èást obrazové pamìti s&nbsp;ulo¾enou bitmapou</h2>

<p>Pøi pohledu do tabulky uvedené v&nbsp;první kapitole je patrné, ¾e obrazová
pamì» le¾í na úplném poèátku operaèní pamìti, konkrétnì se jedná o rozsah adres
16384 a¾ 23295 (v&nbsp;prvních ¹estnácti kilobajtech je pamì» ROM). Celá
obrazová pamì» je rozdìlena na dvì èásti &ndash; bitmapový obrázek
 s&nbsp;rozli¹ením 256&times;192 pixelù o velikosti 256&times;192/8=6144 bajtù a
maticí <i>atributù</i> s&nbsp;32&times;24=768 bajty. Ka¾dému pixelu je
v&nbsp;bitmapì pøiøazen jediný bit rozli¹ující, zda se jedná o pixel
s&nbsp;barvou pozadí (<i>background</i>) èi popøedí (v&nbsp;názvosloví sira
Sinclaira se jedná o takzvaný inkoust &ndash; <i>ink</i>). To znamená, ¾e
v&nbsp;jednom bajtu jsou ulo¾eny informace o osmi pixelech le¾ících na jednom
obrazovém øádku, podobnì jako je tomu napøíklad u poèítaèù <i>PMD-85</i>,
poèítaèù <i>Atari</i> pøi zapnutí grafického re¾imu èíslo 8 atd. Pixely na
ka¾dém obrazovém øádku, tvoøící blok o délce 32 bajtù (32&times;8=256), jsou
ulo¾eny lineárnì za sebou, ov¹em jednotlivé obrazové øádky jsou v&nbsp;operaèní
pamìti umístìny napøeskáèku.</p>

<img src="http://i.iinfo.cz/images/530/pc108-4.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 4: V&nbsp;úvodní obrazovce hry Exolon se autor úzkostlivì vyhýbal
tomu, aby na ní docházelo k&nbsp;pøekryvu rùznobarevných objektù, co¾ by mohlo
zpùsobit vznik vizuálních chyb kvùli uspoøádání atributové pamìti (viz dal¹í
text).</i></p>

<p>©estnáctibitovou adresu posílanou na adresovou sbìrnici spoleènou jak pro
mikroprocesor <i>Z80</i>, tak i pro èip <i>ULA</i>, je mo¾né v&nbsp;pøípadì
práce s&nbsp;obrazovou pamìtí rozdìlit na více èástí tak, jak je naznaèeno
v&nbsp;následující tabulce. Ka¾dý znak adresy odpovídá jednomu bitu
¹estnáctibitové adresy. Prefixové bity <strong>010</strong> znaèí oblast pamìti
le¾ící mezi adresami <strong>010</strong>0000000000000 a¾
<strong>010</strong>1111111111111 v&nbsp;dvojkové soustavì, co¾ odpovídá
rozsahu, 16384 a¾ 24575 v&nbsp;soustavì desítkové, tj.&nbsp;prvním osmi
kilobajtùm operaèní pamìti:</p>

<pre>
010 BB SSS RRR CCCCC
</pre>

<table>
<tr><th>Bity adresy</th><th>Význam</th></tr>
<tr><td>010  </td><td>nejvy¹¹í tøi bity adresy mají konstantní hodnotu 010</td></tr>
<tr><td>BB   </td><td>èíslo bloku 0, 1, 2 (v&nbsp;posledním bloku èíslo 3 je atributová pamì» popsaná v&nbsp;následující kapitole)</td></tr>
<tr><td>SSS  </td><td>èíslo øádky v&nbsp;jednom znaku, který je vysoký osm obrazových øádkù</td></tr>
<tr><td>RRR  </td><td>pozice textového øádku v&nbsp;bloku, tj.&nbsp;pozice obrazového øádku &times; 8. Ka¾dý blok je vysoký 64 obrazových øádkù, co¾ odpovídá osmi øádkùm textovým</td></tr>
<tr><td>CCCCC</td><td>index sloupce bajtu v&nbsp;rozmezí 0..31, kde je ulo¾ena osmice sousedních pixelù</td></tr>
</table>

<img src="http://i.iinfo.cz/images/530/pc108-5.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 5: Úvodní obrazovka známé multiplatformní hry Starquake, která
mìla neuvìøitelných 512 místností a pøitom ji bylo mo¾né hrát i na ZX Spectru
s&nbsp;48 kilobajty operaèní pamìti.</i></p>

<p>Bitmapa o rozli¹ení 256&times;192 pixelù je v&nbsp;obrazové pamìti rozdìlena
na tøetiny (bloky), pøièem¾ ka¾dá tøetina je vybrána pomocí bitù adresy
oznaèené v&nbsp;tabulce znaky <strong>BB</strong>). Ka¾dá tøetina má rozli¹ení
256&times;64 pixelù (tj.&nbsp;osm textových øádkù na vý¹ku) a obsazuje
256&times;64/8=2048 bajtù operaèní pamìti. Obrazové øádky v&nbsp;ka¾dém bloku
jsou ulo¾eny prokládanì, jak to ostatnì naznaèilo schéma v&nbsp;tabulce.
Konkrétnì se jedná o bity oznaèené znaky <strong>SSS</strong> a
<strong>RRR</strong>, které jsou oproti pøirozenému poøadí prohozeny &ndash;
pokud by mìly být v¹echny øádky v&nbsp;bloku ulo¾eny za sebou, musela by adresa
vypadat takto: 010 BB RRR SSS CCCCC. Poøadí ulo¾ených øádkù v&nbsp;obrazové
pamìti i jim odpovídající adresa je následující (<strong>BB</strong> je opìt
èíslo bloku a <strong>CCCCC</strong> pìtice nejni¾¹ích bitù, pomocí nich¾ je
adresují jednotlivé osmice pixelù na ka¾dém obrazovém øádku):</p>

<table>
<tr><th>Èíslo øádku v bloku</th><th>Adresa zapsaná binárnì</th></tr>
<tr><td> 0</td><td>010 BB 000 000 CCCCC</td></tr>
<tr><td> 8</td><td>010 BB 000 001 CCCCC</td></tr>
<tr><td>16</td><td>010 BB 000 010 CCCCC</td></tr>
<tr><td>24</td><td>010 BB 000 011 CCCCC</td></tr>
<tr><td>32</td><td>010 BB 000 100 CCCCC</td></tr>
<tr><td>40</td><td>010 BB 000 101 CCCCC</td></tr>
<tr><td>48</td><td>010 BB 000 110 CCCCC</td></tr>
<tr><td>56</td><td>010 BB 000 111 CCCCC</td></tr>
<tr><td> 1</td><td>010 BB 001 000 CCCCC</td></tr>
<tr><td> 9</td><td>010 BB 001 001 CCCCC</td></tr>
<tr><td>17</td><td>010 BB 001 010 CCCCC</td></tr>
<tr><td>25</td><td>010 BB 001 011 CCCCC</td></tr>
<tr><td>33</td><td>010 BB 001 100 CCCCC</td></tr>
<tr><td>41</td><td>010 BB 001 101 CCCCC</td></tr>
<tr><td>49</td><td>010 BB 001 110 CCCCC</td></tr>
<tr><td>57</td><td>010 BB 001 111 CCCCC</td></tr>
<tr><td> 2</td><td>010 BB 010 000 CCCCC</td></tr>
<tr><td>10</td><td>010 BB 010 001 CCCCC</td></tr>
<tr><td>18</td><td>010 BB 010 010 CCCCC</td></tr>
<tr><td>26</td><td>010 BB 010 011 CCCCC</td></tr>
<tr><td>34</td><td>010 BB 010 100 CCCCC</td></tr>
<tr><td>42</td><td>010 BB 010 101 CCCCC</td></tr>
<tr><td>50</td><td>010 BB 010 110 CCCCC</td></tr>
<tr><td>58</td><td>010 BB 010 111 CCCCC</td></tr>
<tr><td> 3</td><td>010 BB 011 000 CCCCC</td></tr>
<tr><td>11</td><td>010 BB 011 001 CCCCC</td></tr>
<tr><td>19</td><td>010 BB 011 010 CCCCC</td></tr>
<tr><td>27</td><td>010 BB 011 011 CCCCC</td></tr>
<tr><td>35</td><td>010 BB 011 100 CCCCC</td></tr>
<tr><td>43</td><td>010 BB 011 101 CCCCC</td></tr>
<tr><td>51</td><td>010 BB 011 110 CCCCC</td></tr>
<tr><td>59</td><td>010 BB 011 111 CCCCC</td></tr>
<tr><td> 4</td><td>010 BB 100 000 CCCCC</td></tr>
<tr><td>12</td><td>010 BB 100 001 CCCCC</td></tr>
<tr><td>20</td><td>010 BB 100 010 CCCCC</td></tr>
<tr><td>28</td><td>010 BB 100 011 CCCCC</td></tr>
<tr><td>36</td><td>010 BB 100 100 CCCCC</td></tr>
<tr><td>44</td><td>010 BB 100 101 CCCCC</td></tr>
<tr><td>52</td><td>010 BB 100 110 CCCCC</td></tr>
<tr><td>60</td><td>010 BB 100 111 CCCCC</td></tr>
<tr><td> 5</td><td>010 BB 101 000 CCCCC</td></tr>
<tr><td>13</td><td>010 BB 101 001 CCCCC</td></tr>
<tr><td>21</td><td>010 BB 101 010 CCCCC</td></tr>
<tr><td>29</td><td>010 BB 101 011 CCCCC</td></tr>
<tr><td>37</td><td>010 BB 101 100 CCCCC</td></tr>
<tr><td>45</td><td>010 BB 101 101 CCCCC</td></tr>
<tr><td>53</td><td>010 BB 101 110 CCCCC</td></tr>
<tr><td>61</td><td>010 BB 101 111 CCCCC</td></tr>
<tr><td> 6</td><td>010 BB 110 000 CCCCC</td></tr>
<tr><td>14</td><td>010 BB 110 001 CCCCC</td></tr>
<tr><td>22</td><td>010 BB 110 010 CCCCC</td></tr>
<tr><td>30</td><td>010 BB 110 011 CCCCC</td></tr>
<tr><td>38</td><td>010 BB 110 100 CCCCC</td></tr>
<tr><td>46</td><td>010 BB 110 101 CCCCC</td></tr>
<tr><td>54</td><td>010 BB 110 110 CCCCC</td></tr>
<tr><td>62</td><td>010 BB 110 111 CCCCC</td></tr>
<tr><td> 7</td><td>010 BB 111 000 CCCCC</td></tr>
<tr><td>15</td><td>010 BB 111 001 CCCCC</td></tr>
<tr><td>23</td><td>010 BB 111 010 CCCCC</td></tr>
<tr><td>31</td><td>010 BB 111 011 CCCCC</td></tr>
<tr><td>39</td><td>010 BB 111 100 CCCCC</td></tr>
<tr><td>47</td><td>010 BB 111 101 CCCCC</td></tr>
<tr><td>55</td><td>010 BB 111 110 CCCCC</td></tr>
<tr><td>63</td><td>010 BB 111 111 CCCCC</td></tr>
</table>

<img src="http://i.iinfo.cz/images/530/pc108-6.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 6: Prostøedí hry Starquake.</i></p>



<p><a name="k03"></a></p>
<h2>3. Atributová pamì», její pøednosti a omezení</h2>

<p>K&nbsp;bitmapovému obrázku popsanému v&nbsp;pøedchozí kapitole byla navíc
pøiøazena takzvaná <i>atributová pamì»</i> o velikosti 32&times;24=768 bajtù,
v&nbsp;ní¾ byla pro ka¾dý blok o velikosti 8&times;8 pixelù zaznamenána barva
popøedí (<i>ink</i>), barva pozadí (<i>background</i>), intenzita barvy pixelu
a pøíznak blikání (pravidelného prohazování barvy popøedí a pozadí). Poèítaèe
Didaktik mìly pevnì nastavenou barvovou paletu s&nbsp;osmi základními barvami,
pøièem¾ sedm barev (kromì barvy èerné) mohlo být zobrazeno s&nbsp;nízkou èi
vysokou intenzitou. Celkem tedy bylo mo¾né na obrazovce pou¾ít patnáct
barevných odstínù, ov¹em s&nbsp;tím omezením, ¾e se v&nbsp;bloku 8&times;8
pixelù mohly vyskytovat maximálnì dvì barvy &ndash; viz napøíklad <a
href="http://gfxzone.planet-d.net/articles/zx_spectrum_graphics-explanation_symbol_places.png">tento
ilustraèní obrázek</a>.</p>

<img src="http://i.iinfo.cz/images/530/pc108-7.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 7: Prostøedí známé hry R-type, v&nbsp;nìm¾ mù¾eme vidìt rozdìlení
obrazovky na dvoubarevné bloky 8&times;8 pixelù. Pøi kolizích støel èi rakety
s&nbsp;okolními pøedmìty docházelo ke vzniku barevných chyb, ostatnì jako
v&nbsp;mnoha dal¹ích hrách.</i></p>

<p>Tato architektura obrazové pamìti má jednu pomìrnì zásadní výhodu &ndash;
pro ulo¾ení celého obrázku bylo zapotøebí pouze 6144+768=6912 bajtù. Nevýhodou
byl vznik ne¾ádoucích jevù v&nbsp;pøípadì, ¾e do¹lo ke kolizi více objektù
s&nbsp;rùznými barvami v&nbsp;jednom bloku 8&times;8 pixelù &ndash; tyto kolize
se sice daly na statických obrázcích eliminovat, ov¹em ve hrách
s&nbsp;pohybujícími se hráèi i dal¹ími pøedmìty ke kolizím a tím pádem i
k&nbsp;vizuálním chybám, docházelo. Pomìrnì brzy po zaèátku prodeje ZX Spectra
(a o nìkolik let pozdìji Didaktiku) programátoøi vymysleli nìkteré triky,
kterými mohli èásteènì obejít omezení daná pevnou barvovou paletou a pamìtí
atributù. Pravdìpodobnì prvním trikem bylo pou¾ití <i>ditheringu</i>. V¹echny
screenshoty, které jsou v&nbsp;tomto èlánku zobrazeny pochází z&nbsp;emulátorù
a snímky jsou tak ostré &ndash; je viditelný ka¾dý pixel a i èernobílá
¹achovnice s&nbsp;velikostí políèek 1&times;1 pixel by byla rozeznatelná
(samozøejmì jen v&nbsp;pøípadech, pokud má laskavý ètenáø dobøe seøízený
monitor èi nastavené nativní rozli¹ení LCD). Ve skuteènosti pøi zobrazení
bitmapy na televizní obrazovce docházelo k&nbsp;rozmazávání obrázku, pøedev¹ím
v&nbsp;horizontálním smìru, èeho¾ se dalo vyu¾ít právì s&nbsp;pomocí
ditheringu.</p>

<img src="http://i.iinfo.cz/images/530/pc108-8.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 8: Úvodní obrazovka hry R-type, v&nbsp;ní¾ grafici dokázali
obejít (èi spí¹e vyu¾ít) vlastnosti atributové pamìti tak, aby nedocházelo
k&nbsp;viditelným chybám a navíc pou¾ili dithering pro zdánlivé zvý¹ení poètu
barevných odstínù v&nbsp;obrázku. Ve skuteènosti obsahuje tento obrázek pouze
deset barev.</i></p>

<p>Dal¹ím trikem byla zmìna atributové pamìti v&nbsp;prùbìhu zobrazování
jednotlivých obrazových øádkù. V&nbsp;pøedchozí kapitole jsme si øekli, ¾e ULA
v¾dy naèítala obsah atributové pamìti pro celý obrazový øádek, tudí¾ bylo mo¾né
s&nbsp;vyu¾itím pøesného èasování hodnotu atributù mìnit pro ka¾dý øádek zvlá¹»
a vlastnì tak zvý¹it rozli¹ení atributové pamìti z&nbsp;pùvodních 32&times;24
blokù na 32&times;192 blokù. Ov¹em rychlost mikroprocesoru <i>Z80</i> nebyla
tak vysoká, aby bylo mo¾né pøepsat v¹ech 32 bajtù v&nbsp;prùbìhu jednoho øádku
(pøesnìji øeèeno pøi návratu elektronového paprsku na dal¹í obrazový øádek),
proto se v&nbsp;praxi mìnila v¾dy jen zhruba polovina atributù &ndash; tento
re¾im se nìkdy oznaèuje 8&times;2.</p>

<img src="http://i.iinfo.cz/images/530/pc108-9.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 9: Vyu¾ití ditheringu v&nbsp;obrázku, který ve skuteènosti
obsahuje pouze devìt barev.</i></p>



<p><a name="k04"></a></p>
<h2>4. Naèítání obrázkù z&nbsp;externích zaøízení</h2>

<p>Organizaci obrazové pamìti popsané v&nbsp;pøedchozích tøech kapitolách bylo
mo¾né pøímo (na vlastní oèi :-) pozorovat napøíklad pøi naèítání úvodních
obrázkù her èi dal¹ích aplikací z&nbsp;magnetofonu nebo nìkterého dal¹ího
pomalej¹ího periferního zaøízení. U mnoha her se pøed vlastním strojovým kódem
hry naèítal z&nbsp;magnetofonu obsah obrazové pamìti. Jedná se, jak ji¾ ostatnì
víme, o souvislý blok pamìti o délce 6912 bajtù (6144 bajtù pro bitmapu a 768
bajtù atributové pamìti). V&nbsp;nejtypiètìj¹ím pøípadì se mù¾eme setkat
s&nbsp;tím, ¾e je celá hra èi jiná aplikace na magnetofonové pásce ulo¾ena
v&nbsp;¹esti za sebou jdoucích blocích. Prvním blokem je devatenáctibajtová
hlavièka obsahující pøedev¹ím jméno programu a typ následujícího bloku, ve
druhém bloku krátký zavádìcí Basicový program (mnohdy rùzným zpùsobem upravený
tak, aby ne¹el vylistovat, obsahoval neviditelné znaky, nultý øádek atd.),
následuje opìt hlavièka (tentokrát obrázku) následovaná blokem dat
s&nbsp;obsahem obrazové pamìti a poslední dva bloky obsahují hlavièku
(strojového kódu) a koneènì vlastní kód hry èi aplikace.</p>

<img src="http://i.iinfo.cz/images/530/pc108-10.gif" width="320" height="256" alt="pc108" />
<p><i>Obrázek 10: Naèítání úvodního obrázku ke høe Cookie. Nejedná se o zcela
pøesnou animaci nahrávání obrázku &ndash; ve skuteènosti je nahrávání na
reálném Didaktiku èi ZX Spectru plynulej¹í (pruhy na pozadí se mìní 50&times;
za sekundu) a souèasnì ponìkud pomalej¹í. Ov¹em základní uspoøádání obrazové
pamìti je z&nbsp;této animace patrné &ndash; nejdøíve se nahrává první tøetina
bitmapy (ka¾dý osmý øádek, potom ka¾dý osmý øádek+1 atd.), poté zbylé dvì
tøetiny bitmapy a nakonec se naplní obsah atributové pamìti &ndash; teprve
v&nbsp;této chvíli se obrázek vybarví :-)</i></p>

<p>Bloky nesoucí hlavièku, mají shodnou délku devatenácti bajtù i stejnou
strukturu, která je vypsána v&nbsp;následující tabulce (pøed ka¾dým blokem je
je¹tì ulo¾ena dvojice bajtù s&nbsp;délkou celého bloku):</p>

<table>
<tr><th>Offset</th><th>Délka</th><th>Popis</th></tr>
<tr><td> 0</td><td> 1</td><td>pøíznak bloku &ndash; 00=hlavièka, FF=datový blok</td></tr>
<tr><td> 1</td><td> 1</td><td>typ bloku (0, 1, 2, 3)</td></tr>
<tr><td> 2</td><td>10</td><td>jméno souboru doplnìné zprava mezerami</td></tr>
<tr><td>12</td><td> 2</td><td>délka následujícího datového bloku</td></tr>
<tr><td>14</td><td> 2</td><td>parametr 1 (má význam jen pro nìkteré typy blokù, ne pro obrázek)</td></tr>
<tr><td>16</td><td> 2</td><td>parametr 2 (-//-)</td></tr>
<tr><td>17</td><td> 1</td><td>kontrolní souèet (ne skuteèný CRC, jen XOR v¹ech bajtù)</td></tr>
</table>

<p>Samotný blok nesoucí data (jedná se i o blok s&nbsp;obrázkem) je ji¾ mnohem
jednodu¹¹í, tak¾e blok s&nbsp;obrázkem má délku 6914 bajtù s&nbsp;následující
strukturou:</p>

<table>
<tr><th>Offset</th><th>Délka</th><th>Popis</th></tr>
<tr><td> 0  </td><td>   1</td><td>pøíznak bloku &ndash; FF=datový blok</td></tr>
<tr><td> 1  </td><td>6144</td><td>bitmapa</td></tr>
<tr><td>6145</td><td> 768</td><td>barvové atributy</td></tr>
<tr><td>6913</td><td>   1</td><td>kontrolní souèet (XOR v¹ech pøedchozích bajtù)</td></tr>
</table>

<img src="http://i.iinfo.cz/images/530/pc108-11.gif" width="320" height="256" alt="pc108" />
<p><i>Obrázek 11: Nahrávání úvodního obrázku ke známé høe JetPac.</i></p>

<p>Poznámka: kvùli nedostatku lep¹ích pomùcek vznikly jednotlivé snímky
seøazené do animací zobrazených na obrázcích 10 a 11 pomocí následujícího
jednoduchého skriptu vyu¾ívajícího <i>Image Magick</i>:</p>

<pre>
xspect -name xyzzy cookie.tzx

for a in {10..99}
do
    sleep 0.5s
    echo "ukladam snimek $a"
    import -window xyzzy $a.png
done
</pre>

<img src="http://i.iinfo.cz/images/530/pc108-12.gif" width="256" height="192" alt="pc108" />
<p><i>Obrázek 12: Pouze sedmibarevný statický obrázek vyu¾ívající
dithering.</i></p>



<p><a name="k05"></a></p>
<h2>5. Osmibitový poèítaè Didaktik M</h2>

<p>Po osmibitovém domácím a ¹kolním mikropoèítaèi <i>Didaktik Gama</i> se zaèal
ve firmì Didaktik Skalica vyrábìt jeho následovník nazvaný <i>Didaktik M</i>,
jen¾ byl nabízený ve dvou modelech &ndash; modelu 90 a modelu 91. Prodejní cena
<i>Didaktiku M</i> se pohybovala okolo tøí tisíc tehdej¹ích korun, tak¾e tento
poèítaè byl dostupný pomìrnì ¹iroké vrstvì lidí, na rozdíl od tehdy se
roz¹iøujících ¹estnáctibitových èi tøicetidvoubitových poèítaèù. Opìt se
jednalo o mikropoèítaè do znaèné míry kompatibilní se <i>ZX Spectrem</i>.
Oproti pùvodnímu <i>Didaktiku Gama</i> (a vlastnì i <i>ZX Spectru</i> &ndash;
gumákovi) byla vylep¹ena klávesnice (k&nbsp;pùvodním ètyøiceti klávesám byly
pøidány ètyøi kurzorové klávesy, na klávesnici se nacházel i RESET rozumnì
odsunutý od ostatních kláves, na rozdíl od ji¾ popsaného poèítaèe
<i>IQ-151</i>) a zmìnil se i jeho celkový design, napøíklad odpadl chladiè.
Takté¾ do¹lo k&nbsp;rozdìlení pùvodnì jediného konektoru DIN na dvojici
konektorù &ndash; jeden byl urèen pro pøipojení napájení, druhý pro
magnetofon.</p>

<a href="http://i.iinfo.cz/images/530/pc108-13.jpg"><img src="http://i.iinfo.cz/images/530/pc108-13-prev.jpg" width="370" height="172" alt="pc108" /></a>
<p><i>Obrázek 13: Klávesnice poèítaèe Didaktik M.</i></p>

<p>Namísto paralelního portu obsluhovaného v&nbsp;<i>Didaktiku Gama</i> obvodem
8255 je u <i>Didaktiku M</i> vyvedena dvojice portù pro pøipojení joystickù
(Sinclair a Kempston). Kapacita operaèní pamìti se sní¾ila z&nbsp;80 kB (viz
<i>Didaktik Gama</i>) na pùvodních 48 kB (pøesnìji øeèeno byl pou¾it jediný
pamì»ový èip s&nbsp;kapacitou 64 kB, ov¹em skuteènì vyu¾ito bylo pouze 48 kB),
tak¾e se poèítaè internì zjednodu¹il a takté¾ jeho cena mohla být ni¾¹í, ne¾
v&nbsp;pøípadì osazení operaèní pamìtí s&nbsp;vìt¹í kapacitou. Poèítaè v¹ak mìl
jinou rychlost ne¾ pùvodní ZX Spectrum (hodinová frekvence mikroprocesoru se
zvý¹ila na 4 MHz) a navíc se kvùli mírnì odli¹né architektuøe li¹ilo i èasování
pamìti &ndash; nebyl zde rozdíl mezi pøístupem do dolních 16 kB a horních 32
kB, co¾ u nìkterých her zpùsobovalo potí¾e a musely být upravovány. Takté¾ byl
namísto pùvodního <i>ULA</i> firmy Ferranti pou¾it èip T32B&#1043;1 sovìtské
výroby generující obraz s&nbsp;pomìrem stran 1:1 namísto obvyklých 4:3 (ov¹em
to bylo mo¾né do jisté míry korigovat nastavením televizoru). Schéma zapojení
<i>Didaktiku M</i> lze nalézt napøíklad zde: <a
href="http://bruxy.regnet.cz/8bit/didaktik_m/m_schema.png">http://bruxy.regnet.cz/8bit/didaktik_m/m_schema.png</a>.</p>

<a href="http://i.iinfo.cz/images/530/pc108-14.jpg"><img src="http://i.iinfo.cz/images/530/pc108-14-prev.jpg" width="370" height="121" alt="pc108" /></a>
<p><i>Obrázek 14: Zadní èást poèítaèe Didaktik M s&nbsp;vyvedenou sbìrnicí,
konektory pro pøipojení joystickù (oproti ZX Spectru novinka), magnetofonu,
napájecího zdroje i výstupem na televizor.</i></p>



<p><a name="k06"></a></p>
<h2>6. Didaktik Kompakt</h2>

<p>Poslední v&nbsp;øadì osmibitových poèítaèù Didaktik stojí <i>Didaktik
Kompakt</i>, který se vyrábìl v&nbsp;letech 1991 a¾ 1994, tedy ji¾ v&nbsp;dobì
kralování poèítaèù Atari ST, Amiga a samozøejmì i IBM PC (a kompatibilních
klonù). Tento poèítaè se do znaèné míry podobal svým pøedchùdcùm, souèasnì v¹ak
obsahoval nìkolik novinek. Pøímo v&nbsp;poèítaèi byla zabudována 3,5 palcová
disketová jednotka pou¾ívající diskety naformátované na 840 kB, zvuk mohl
být kromì klasického jednobitového beeperu generován i pøidaným zvukovým èipem
<i>AY-3-8920</i> (stejnì jako na pozdìj¹ích modelech ZX Spectra, napøíklad ZX
Spectra +128K) a dokonce se v&nbsp;nìm objevuje i konektor (<a
href="http://osmi.tarbik.com/cssr/obrazky/didaktik_kompakt3.jpg">SCART</a>),
kterým je mo¾né poèítaè pøipojit k&nbsp;televizoru namísto videa. Obraz je tím
pádem mnohem kvalitnìj¹í, ne¾ pøi bì¾nì provádìné VF modulaci v&nbsp;poèítaèi a
následné demodulaci v&nbsp;televizoru (samostatnì vyvedený videosignál ostatnì
mìly i osmibitové poèítaèe Atari o dekádu døíve).</p>

<a href="http://i.iinfo.cz/images/530/pc108-15.jpg"><img src="http://i.iinfo.cz/images/530/pc108-15-prev.jpg" width="370" height="162" alt="pc108" /></a>
<p><i>Obrázek 15: Osazená deska plo¹ného spoje poèítaèe Didaktik Kompakt;
v&nbsp;pravé èásti je vidìt disketová jednotka.</i></p>

<p>Zajímavá funkce byla pøiøazena ke kombinaci kláves Caps Shift + levá ¹ipka +
pravá ¹ipka. Jednalo se o trojhmat, kterým bylo mo¾né ulo¾it stav operaèní
pamìti i registrù procesoru na disketu, tak¾e se vlastnì jedná o dnes tak
populární hibernaci :). Otisk operaèní pamìti lze samozøejmì nahrát
z&nbsp;diskety zpìt a spustit ho ze stejného místa, odkud byl zastaven. Vyu¾ití
je zøejmé &ndash; &bdquo;úpravy programù&ldquo;, podpora pro ladìní aplikací
atd. (poznámka &ndash; stejnou funkci nabízely i externí disketové jednotky
<i>D40</i> a <i>D80</i>, které si popí¹eme pøí¹tì). Tento poèítaè mìl pouze
jeden záva¾nìj¹í nedostatek bránící jeho vìt¹ímu roz¹íøení &ndash; byl na trh
dodán pøíli¹ pozdì (odhadem cca o tøi a¾ ètyøi roky) a proti konkurenci
¹estnáctibitových poèítaèù nemìl prakticky ¾ádnou ¹anci na výraznìj¹í úspìch,
co¾ je tro¹ku ¹koda, nebo» se jednalo o pìknì navr¾ený poèítaè u nìj¾ disketová
jednotka roz¹iøovala mo¾nosti jeho pou¾ití (CP/M atd.).</p>

<img src="http://i.iinfo.cz/images/530/pc108-16.jpg" width="400" height="300" alt="pc108" />
<p><i>Obrázek 16: Pro porovnání z&nbsp;pøedchozím snímkem: èást plo¹ného spoje
poèítaèe Didaktik M.</i></p>



<p><a name="k07"></a></p>
<h2>7. Obsah následující èásti seriálu</h2>

<p>V&nbsp;následující èásti seriálu o architekturách poèítaèù si na chvíli
odpoèineme od popisu parametrù i architektury èeskoslovenských osmibitových
poèítaèù. Namísto toho se budeme zabývat periferními zaøízeními, která byla
v&nbsp;ÈSSR pro osmibitové poèítaèe vyrábìna. Tìchto zaøízení existovalo
pomìrnì velké mno¾ství &ndash; od joystickù a rùzných programátorù pamìtí pøes
magnetofony, jehlièkové tiskárny èi perové plottery a¾ po rùzné typy
disketových jednotek. Pøí¹tì se zamìøíme pøedev¹ím na popis rùzných druhù
tiskáren a plotterù, napøíklad na slavnou jednojehlièkovou tiskárnu
<i>BT-100</i> pøezdívanou &bdquo;spla¹ený høebík&ldquo; (a nìkdy i ponìkud ménì
slu¹nými výrazy), plottery firmy <i>Aritma</i> atd. Takté¾ si popí¹eme
disketové jednotky urèené pøedev¹ím pro poèítaèe <i>Didaktik</i>, které se
v&nbsp;dobách pøed nástupem osobních poèítaèù (PC) tì¹ily v&nbsp;tuzemsku
pomìrnì velké popularitì a nezapomeneme ani na zvukový modul <i>Melodik</i>
zalo¾ený na èipech kompatibilních se známým a ve svìtì v&nbsp;mnoha oblastech
pou¾ívaným èipem <i>AY-3-8910</i> (resp. <i>AY-3-8912</i>).</p>

<img src="http://i.iinfo.cz/images/530/pc108-17.jpg" width="270" height="123" alt="pc108" />
<p><i>Obrázek 17: Slavný zvukový èip AY-3-8910.</i></p>



<p><a name="k08"></a></p>
<h2>8. Odkazy na Internetu</h2>

<ol>

<li>World of Spectrum<br />
<a href="http://www.worldofspectrum.org/">http://www.worldofspectrum.org/</a>
</li>

<li>ZX Spectrum &ndash; dokumentace<br />
<a href="http://www.worldofspectrum.org/documentation.html">http://www.worldofspectrum.org/documentation.html</a>
</li>

<li>The World of Spectrum FAQ<br />
<a href="http://www.worldofspectrum.org/WoSFAQ.html">http://www.worldofspectrum.org/WoSFAQ.html</a>
</li>

<li>BruXy.REGNET.CZ<br />
<a href="http://bruxy.regnet.cz/web/8bit">http://bruxy.regnet.cz/web/8bit</a>
</li>

<li>Didaktik M Poèítaè za ménì ne¾ 3000 korun<br />
<a href="http://bruxy.regnet.cz/web/8bit/CZ/didaktik-m,-pocitac-za-mene-nez-3000-korun/">http://bruxy.regnet.cz/web/8bit/CZ/didaktik-m,-pocitac-za-mene-nez-3000-korun/</a>
</li>

<li>Didaktik Kompakt<br />
<a href="http://osmi.tarbik.com/cssr/didaktik_kompakt.html">http://osmi.tarbik.com/cssr/didaktik_kompakt.html</a>
</li>

<li>Emulátor ZX Spectra napsaný v Javì<br />
<a href="http://www.zzspectrum.org/">http://www.zzspectrum.org/</a>
</li>

<li>DOOM game on ZX Spectrum<br />
<a href="http://www.youtube.com/watch?v=3v7cFGneuaw&amp;feature=related">http://www.youtube.com/watch?v=3v7cFGneuaw&amp;feature=related</a>
</li>

<li>A Short History of Computer Graphics<br />
<a href="http://cs.fit.edu/~wds/classes/graphics/History/history/history.html">http://cs.fit.edu/~wds/classes/graphics/History/history/history.html</a>
</li>

<li>ZX Spectrum Graphics Modes<br />
<a href="http://gfxzone.planet-d.net/articles/zx_spectrum_graphics-article_01.html">http://gfxzone.planet-d.net/articles/zx_spectrum_graphics-article_01.html</a></li>

<li>Museum of vintage computer graphics<br />
<a href="http://www.zxscreens.i12.com/zxscreens">http://www.zxscreens.i12.com/zxscreens</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Ti¹novský</a> &nbsp; 2010</small></p>
</body>
</html>

