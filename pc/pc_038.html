<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Roz¹íøené re¾imy paralelního portu a norma IEEE 1284</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Roz¹íøené re¾imy paralelního portu a norma IEEE 1284</h1>

<h3>Pavel Ti¹novský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V dne¹ní èásti seriálu o architekturách poèítaèù dokonèíme popis práce s paralelním portem. Øekneme si, jakým zpùsobem je mo¾né paralelní port pou¾ít pro obousmìrný pøenos dat (data lze pøená¹et buï po ètyøech bitech nebo dokonce po celých bajtech) i jakou technologií jsou øe¹ené paralelní porty ECP a EPP.</p>



<h1>Obsah</h1>
<p>
<a href="#k01">1. Roz¹íøené re¾imy paralelního portu a norma IEEE 1284</a><br />
<a href="#k02">2. Re¾imy èinnosti podle normy IEEE 1284</a><br />
<a href="#k03">3. Kompatibilní re¾im &ndash; SPP</a><br />
<a href="#k04">4. Jednosmìrný a obousmìrný pøenos dat po ètyøech bitech (nibble mode)</a><br />
<a href="#k05">5. Jednosmìrný a obousmìrný pøenos dat po osmi bitech (byte mode)</a><br />
<a href="#k06">6. Vysokorychlostní re¾im EPP</a><br />
<a href="#k07">7. Vysokorychlostní re¾im ECP</a><br />
<a href="#k08">8. Odkazy na Internetu</a><br />
<a href="#k09">9. Obsah dal¹í èásti seriálu</a><br />
</p>



<p><a name="k01"></a></p>
<h1>1. Roz¹íøené re¾imy paralelního portu a norma IEEE 1284</h1>

<p>V&nbsp;pøedchozí èásti tohoto seriálu jsme si popsali základní zpùsob
komunikace poèítaèe s&nbsp;nìjakým zaøízením (typicky s&nbsp;tiskárnou) pøes
paralelní port, oznaèovaný také jako <i>LPT</i>, neboli <i>Line Print
Terminal</i>. Tento port byl od svého uvedení firmou IBM koncipován tak, aby se
k&nbsp;nìmu daly snadno a bez dal¹ích podpùrných obvodù pøipojit tiskárny
s&nbsp;rozhraním <i>Centronics</i>. Ov¹em je ho mo¾né pou¾ít i pro dal¹í úèely,
napøíklad spolu s&nbsp;osmibitovým digitálnì-analogovým pøevodníkem pro
konstrukci jednoduché zvukové karty (<i>Covox</i>, <i>Stereo-Covox</i>), pro
ovládání textových i grafických LCD atd. V¹echna zmínìná zaøízení mají jednu
spoleènou vlastnost &ndash; témìø ve¹keré informace (a¾ na potvrzovací a
chybové signály) jsou pøená¹eny od poèítaèe smìrem k&nbsp;pøipojenému zaøízení.
V&nbsp;pøípadì, ¾e je zapotøebí data pøená¹et opaèným smìrem (vstupní èidla,
externí klávesnice, dotykové LCD, skenery) popø.&nbsp;obìma smìry (propojení
dvou poèítaèù), rychle zjistíme, ¾e se pro tyto úèely pùvodní paralelní port
pøíli¹ nehodí.</p>

<image id="7635" />
<p-center><i>Obrázek 1: Èíslování pinù na konektorech paralelního portu DB25.
Zde je zobrazen konektor umístìný na poèítaèi (typ
&bdquo;samice&ldquo;).</i></p-center>

<p>Ani rychlost pøenosu po standardním paralelním portu není nijak závratná,
dostaèuje pro pomalej¹í jehlièkové a inkoustové tiskárny. Zatí¾ení
mikroprocesoru pøi pøenosu je naopak velké, proto¾e standardní paralelní port
neobsahuje ¾ádné hardwarovì øízené datové fronty, sofistikovaný øadiè ani dal¹í
dnes obvyklé technologie &ndash; ve¹kerá komunikace je øízena pomocí datového,
øídicího a stavového registru doplnìného o jeden pøeru¹ovací vstup.
Z&nbsp;tohoto dùvodu se ji¾ po nìkolika letech existence osobních poèítaèù
(kompatibilních s&nbsp;IBM PC) objevily snahy o vylep¹ení paralelního portu.
Vzniklo vìt¹í mno¾ství rùzných technologií, které spolu nebyly zcela
sluèitelné. Kdy¾ k&nbsp;tomu pøipoèteme i nìkteré velmi nekvalitnì provedené
kabely (v&nbsp;podstatì neexistovala obecnì závazná norma specifikující jejich
elektrické charakteristiky), je zøejmé, ¾e se ukázala potøeba existence
standardizace i v&nbsp;této oblasti. Takový standard skuteènì vznikl &ndash;
jedná se o normu <i>IEEE 1284</i>. V&nbsp;normì IEEE 1284 jsou pomìrnì pøesnì
popsány re¾imy pøenosu dat, elektrické charakteristiky portu i mechanické
rozmìry konektorù a zpùsob jejich zapojení.</p>

<image id="7636" />
<p-center><i>Obrázek 2: Èíslování pinù na konektorech paralelního portu DB25.
Zde je zobrazen konektor umístìný na kabelu (typ
&bdquo;samec&ldquo;).</i></p-center>

<p>Specifikace hovoøí o tøech typech konektorù oznaèených
<strong>1284-A</strong>, <strong>1284-B</strong> a <strong>1284-C</strong>.
První typ je nám ji¾ známý konektor DB25 (obsahuje 13+12 pinù umístìných ve
dvou øadách, viz první a druhý obrázek), druhý typ je pøedstavován pùvodním
konektorem rozhraní <i>Centronics</i> (36-pin Champ) a tøetím typem je zmen¹ená
varianta 36pinového konektoru <i>Centronics</i>. Také jsou pøedepsány
charakteristiky dvou typù propojovacích kabelù. První odpovídá star¹ím kabelùm,
druhý typ je lépe stínìný a zaruèuje pøenos dat do vìt¹í vzdálenosti (10m).
Nejzajímavìj¹í jsou v¹ak standardizované pøenosové re¾imy (protokoly), kterých
je hned pìt. Dùle¾ité je, ¾e výchozím re¾imem by mìl v¾dy být re¾im
kompatibility s&nbsp;pùvodním paralelním portem, aby bylo mo¾né bez dal¹ích
úprav komunikovat se star¹ími zaøízeními, pøedev¹ím tiskárnami pøipojenými na
jednom konci na paralelní port a na konci druhém na rozhraní <i>Centronics</i>,
o nìm¾ jsme se zmínili v&nbsp;pøedchozí èásti tohoto seriálu. Tyto re¾imy jsou
struènì popsány v&nbsp;dal¹í kapitole.</p>

<image id="7637" original="no" />
<p-center><i>Obrázek 3: Vztah mezi piny paralelního portu a tøemi I/O adresami,
kterými se port øídí.</i></p-center>



<p><a name="k02"></a></p>
<h1>2. Re¾imy èinnosti podle normy IEEE 1284</h1>

<p>Jak jsme si ji¾ øekli v&nbsp;pøedchozích odstavcích, je v&nbsp;normì <i>IEEE
1284</i> rozli¹ováno celkem pìt od sebe navzájem odli¹ných re¾imù pøenosu dat.
Nìkteré re¾imy umo¾òují pøenos dat pouze jedním smìrem (buï z&nbsp;poèítaèe do
pøipojeného zaøízení èi naopak), dal¹í ji¾ zavádìjí poloduplexní re¾im pøenosu,
ve kterém se data pøená¹í støídavì mezi obìma zaøízeními po osmi datových
linkách. První dva re¾imy zaji¹»ují zpìtnou kompatibilitu s&nbsp;pùvodními
paralelními porty vyrábìnými firmou IBM a mnoha dal¹ími výrobci (paralelní port
byl umístìn napøíklad i na nìkterých grafických kartách èi multikartách spolu
s&nbsp;IDE rozhraním, rozhraním pro joystick èi MIDI a sériovými porty), dal¹í
tøi re¾imy ji¾ nejsou zpìtnì kompatibilní a vy¾adují hardwarovì upravený
paralelní port &ndash; napøíklad je nutné pou¾ívat obousmìrné datové linky,
v&nbsp;nìkterém re¾imu je vyu¾ívána hardwarová fronta (<i>FIFO</i>), pøímý
pøístup do pamìti (<i>DMA</i>) apod. Av¹ak právì díky tìmto roz¹íøeným re¾imùm
lze k&nbsp;paralelnímu portu pøipojit napøíklad i pevné disky èi ZIP mechaniky
(dnes se ji¾ jedná o pøekonanou technologii).</p>

<image id="7638" original="no" />
<p-center><i>Obrázek 4: Grafická karta, která obsahuje i øadiè paralelního
portu (viz pravá èást s&nbsp;vyvedeným konektorem a horní èást desky
s&nbsp;jumpery, pomocí kterých je mo¾né paralelní port povolit èi zakázat,
popø.&nbsp;zvolit, zda se jedná o LPT1 èi LPT2).</i></p-center>

<p>Norma popisuje tyto re¾imy èinnosti:</p>

<ol>

<li><strong>Compatibility mode</strong> (<i>SPP</i>) &ndash; jednosmìrná
komunikace od poèítaèe smìrem k&nbsp;zaøízení (tiskárnì) s&nbsp;vyu¾itím
handshakingu. Zaruèena kompatibilita s&nbsp;rozhraním <i>Centronics</i>.</li>

<li><strong>Nibble mode</strong> &ndash; jednosmìrný pøenos dat od zaøízení do
poèítaèe po stavových linkách (jedná se o jediné vstupní linky standardního
paralelního portu), pøièem¾ data musí být pøed pøenosem rozdìlena na ètveøice
bitù.</li>

<li><strong>Byte mode</strong> &ndash; jedná se o jednosmìrný pøenos dat
v&nbsp;simplexním re¾imu. Tento mód vy¾aduje, aby bylo mo¾né datové piny
pøepnout do re¾imu ètení, co¾ pùvodní paralelní port neumo¾òoval.</li>

<li><strong>Enhanced Parallel Port</strong> (<i>EPP</i>) &ndash; obousmìrný
pøenos dat v&nbsp;poloduplexním re¾imu (vysílací a pøijímací strany se podle
potøeb støídají, proto¾e se musí dìlit o stejné datové vodièe). Oproti
kompatibilnímu re¾imu pøenosu byla vylep¹ena komunikace s&nbsp;mikroprocesorem,
díky èemu¾ se sni¾uje jeho zatí¾ení. Maximální dosa¾itelná pøenosová rychlost
dosahuje v&nbsp;tomto re¾imu hodnoty 2 MB.s<sup>-1</sup>. Tento re¾im je
vìt¹inou nutné v&nbsp;pøípadì potøeby povolit v&nbsp;BIOSu nebo pomocí ovladaèe
paralelního portu.</li>

<li><strong>Extended Capability Port</strong> (<i>ECP</i>) &ndash; takté¾ se
jedná o obousmìrný pøenos dat v&nbsp;poloduplexním re¾imu, ov¹em samotný
protokol a význam øídicích signálù se od <i>EPP</i> odli¹uje. Je umo¾nìn pøímý
pøístup do pamìti (dal¹í sní¾ení zatí¾ení mikroprocesoru pøi pøenosu dat) a
maximální dosa¾itelná pøenosová rychlost se zvý¹ila na hodnotu 2,5
MB.s<sup>-1</sup> (pøi pou¾ití stínìného kabelu &bdquo;CC&ldquo;, jeho¾
charakteristiky jsou popsány v&nbsp;normì IEEE 1284). V&nbsp;minulosti se
jednalo o levnìj¹í variantu k&nbsp;externímu rozhraní <i>SCSI</i>. I tento
re¾im je nutné povolit v&nbsp;BIOSu èi ovladaèem paralelního portu.</li>

</ol>



<p><a name="k03"></a></p>
<h1>3. Kompatibilní re¾im &ndash; SPP</h1>

<p>Kompatibilní re¾im (<strong>SPP</strong>) jsme si v&nbsp;podstatì popsali
ji¾ v&nbsp;pøedchozí èásti tohoto seriálu. Jedná se o re¾im, ve kterém mù¾e
poèítaè komunikovat s&nbsp;tiskárnou, na ní¾ je rozhraní <i>Centronics</i>. Pøi
pøenosu dat, která jsou rozdìlena na osmice bitù, se vyu¾ívá metoda
<i>handshakingu</i>, jen¾ je zalo¾ený na øízení celého pøenosu poèítaèem, ov¹em
s&nbsp;tím, ¾e tiskárna (èi obecnì jakékoli pøipojené zaøízení) si sama podle
své momentální rychlosti urèuje, kdy mù¾e pøijmout dal¹í znak. Oproti ponìkud
vágnì specifikovaným délkám trvání øídicích a stavových signálù u rozhraní
<i>Centronics</i> je v¹ak norma IEEE 1284 pøesnìj¹í. Napøíklad jasnì
specifikuje, ¾e data na osmi datových linkách musí být ustálena po dobu
minimálnì 500&nbsp;ns a teprve poté je mo¾né vyslat signál
<strong>Strobe</strong>, jeho¾ délka takté¾ musí být vìt¹í ne¾ 500&nbsp;ns. I
poté, co se signál <strong>Strobe</strong> vrátí do neaktivní úrovnì (jedná se
o negovaný signál, neaktivní úroveò je tedy logická jednièka), musí být data na
osmi datových linkách nemìnná po dobu dal¹ích 500&nbsp;ns.</p>

<image id="7639" />
<p-center><i>Obrázek 5: Funkce a smìry toku dat jednotlivých pinù pøi pou¾ití
kompatibilního re¾imu.</i></p-center>

<p>I tiskárna musí odpovídat signálem <strong>nAck</strong>, jeho¾ délka je
minimálnì 500&nbsp;ns. V¹echny zmínìné èasy jsou stanoveny tak, aby spolu mohly
komunikovat i èipy vyrobené odli¹nou technologií a takté¾ aby se zamezilo vlivu
rùzného zpo¾dìní signálu na jednotlivých vodièích pøi pou¾ití dlouhých kabelù.
Na druhou stranu se v¹ak jedná o limitující faktor &ndash; pokud budeme
dodr¾ovat v¹echny pøedepsané minimální èasy trvání signálù a pøipoèteme
k&nbsp;nim je¹tì dobu, kterou stráví mikroprocesor nastavováním øídicího a
datového registru i ètením stavového registru (nesmíme zapomenout, ¾e porty
jsou dostupné pøes pomalou sbìrnici <i>ISA</i>), získáme maximální pøenosovou
rychlost v&nbsp;tomto re¾imu cca 150 kB.s<sup>-1</sup>, v&nbsp;reálném provozu
se v¹ak mù¾e jednat i o mnohem men¹í hodnotu, napøíklad jen 15
kB.s<sup>-1</sup>. To je sice hodnota, která mù¾e dostaèovat jehlièkovým
tiskárnám pracujícím v&nbsp;módu tisku textù (nikoli grafiky), ov¹em pro
tiskárny s&nbsp;<i>PostScriptem</i>, <i>PCL</i> èi (v&nbsp;nejhor¹ím pøípadì)
pro <i>GDI</i> tiskárny se paralelní port pracující v&nbsp;kompatibilním re¾imu
stává úzkým hrdlem, které tisk zdr¾uje.</p>

<p>Funkce signálù v&nbsp;kompatibilním re¾imu:</p>

<table>
<tr><th>Pin</th><th>Jméno signálu  </th><th>Význam</th></tr>
<tr><td>1  </td><td>nStrobe        </td><td>inverzní puls o délce 500&nbsp;ns tiskárnì potvrzuje, ¾e na datových pinech jsou platná data</td></tr>
<tr><td>10 </td><td>nAck           </td><td>inverzním pulsem tiskárna potvrdí, ¾e data pøijala, napojeno na pøeru¹ení</td></tr>
<tr><td>11 </td><td>Busy           </td><td>tento signál má úroveò logické jednièky po dobu pøenosu dat</td></tr>
<tr><td>12 </td><td>Paper-Out      </td><td>tímto signálem tiskárna posílá informaci o tom, ¾e nemá papír</td></tr>
<tr><td>13 </td><td>Select         </td><td>signál je nastaven na logickou jednièku, pokud je tiskárna pøipojena</td></tr>
<tr><td>14 </td><td>Linefeed       </td><td>rozli¹ení, zda poèítaè bude pro odøádkování posílat dvojici znakù CR a LF</td></tr>
<tr><td>15 </td><td>nError         </td><td>tímto signálem tiskárna posílá informaci o chybì (jakákoli chyba kromì do¹lého papíru)</td></tr>
<tr><td>16 </td><td>nInitialize    </td><td>inicializace tiskárny (reset)</td></tr>
<tr><td>17 </td><td>nSelect-Printer</td><td>výbìr tiskárny (signál je invertovaný, reaguje se na nulovou úroveò)</td></tr>
</table>

<image id="7640" />
<p-center><i>Obrázek 6: Øízení pøenosu jednoho bajtu pomocí handshakingu.
Signály <strong>nStrobe</strong> a <strong>Data</strong> ovládá poèítaè,
zaøízení (tiskárna) odpovídá signály <strong>Busy</strong> a
<strong>nAck</strong>. Minimální doba trvání tìchto signálù a jejich vzájemná
návaznost je popsána v&nbsp;normì IEEE 1284.</i></p-center>



<p><a name="k04"></a></p>
<h1>4. Jednosmìrný a obousmìrný pøenos dat po ètyøech bitech (nibble mode)</h1>

<p>V&nbsp;tomto re¾imu je mo¾né pøená¹et data rozdìlená po ètyøech bitech
(ètveøice sousedních bitù se nazývá <i>nibble</i>, odtud pochází i název
popisovaného re¾imu) smìrem od zaøízení k&nbsp;poèítaèi. Pro tento úèel jsou
vyu¾ity vstupní (z&nbsp;hlediska mikroprocesoru) stavové linky, konkrétnì piny
10, 11, 12 a 13, popøípadì i pin èíslo 15. Tento re¾im je mo¾né pou¾ít i na
star¹ích poèítaèích, které obsahují pouze paralelní port kompatibilní
s&nbsp;rozhraním Centronics a není u nìj tedy mo¾né pøepnutí datových vodièù do
stavu ètení. Ve¹keré øízení pøenosu musí na stranì poèítaèe provádìt
mikroprocesor, vèetnì zpìtného skládání pøeètených ètveøic bitù do bajtù èi
del¹ích slov &ndash; øadiè paralelního portu ¾ádný obvod pro zpìtné slo¾ení dat
neobsahuje. V&nbsp;minulosti se kombinace kompatibilního re¾imu a re¾imu nibble
(ka¾dý slou¾í k&nbsp;pøenosu dat opaèným smìrem) nazývala
<strong>Bi-tronics</strong>, i kdy¾ konkrétní protokol pou¾itý pøi duplexním
pøenosu nebyl ¾ádnou normou stanoven &ndash; takový protokol musí obsahovat
napøíklad zpùsob potvrzování dat, opakování pøenosu atd. Re¾im byl vyu¾íván i
populárním programem <i>Laplink</i> a jeho následovníky.</p>

<image id="7641" original="no" />
<p-center><i>Obrázek 7: Komunikace v&nbsp;re¾imu nibble. Nenechte se zmýlit
odli¹ným znaèením signálù. <strong>HostBusy</strong> napøíklad odpovídá
pùvodnímu signálu <strong>AutoFeed</strong>. Samotná data jsou pøená¹ena po
vodièích <strong>Busy</strong>, <strong>Paper-Out</strong>,
<strong>Select</strong> a <strong>nAck</strong>, v&nbsp;nìkterých pøípadech se
v¹ak místo <strong>nAck</strong> pou¾ívá signál <strong>nError</strong>,
pøièem¾ signál <strong>nAck</strong> je vyu¾íván pro hodinové
pulsy.</i></p-center>

<p><i>Nibble mode</i> se pou¾ívá buï pro pøenos dat z&nbsp;nìjakého externího
zaøízení, napøíklad èidla teploty vybaveného osmibitovým A/D pøevodníkem, nebo
pro propojení dvou poèítaèù. V&nbsp;prvním pøípadì je nutné data pøed vlastním
pøenosem rozdìlit na ètveøice bitù. O samotné rozdìlení se postará buï samo
zaøízení (napøíklad mù¾e být vybavené mikroøadièem) nebo lze pou¾ít TTL èi CMOS
obvod typu <i>74157</i>, který z&nbsp;osmice bitù na vstupu vybere buï horní
nebo dolní ètveøici. Výbìr konkrétní ètveøice provádí samotný mikroprocesor
v&nbsp;poèítaèi výstupním signálem <strong>Strobe</strong>. Tyto obvody lze
samozøejmì kombinovat a zvìt¹ovat tak poèet bitù na vstupu; pro adresování
konkrétní ètveøice se v&nbsp;tomto pøípadì dají pou¾ívat i datové signály
paralelního portu. Pokud se <i>nibble mode</i> pou¾ívá pro propojení dvou
poèítaèù, bývají data pøená¹ena po ètyøech bitech, tj.&nbsp;poèítaè vysílá
pouze po datových linkách D0 a¾ D3 &ndash; propojovací kabel v&nbsp;tomto
pøípadì zùstává jednoduchý bez nutnosti pou¾ití logických èlenù èi
multiplexerù.</p>

<image id="7642" />
<p-center><i>Obrázek 8: Jedno z&nbsp;mo¾ných øe¹ení rozdìlení vstupní osmice
bitù na dvì ètveøice. Výbìr konkrétní ètveøice (horní ètyøi bity nebo dolní
ètyøi bity) provádí mikroprocesor signálem <strong>Strobe</strong>. Existuje i
slo¾itìj¹í varianta (naznaèená na pøedchozím obrázku), ve které je vyu¾it
hodinový signál, který sám rozli¹uje, která ètveøice bitù se pøená¹í (sudý nebo
lichý puls).</i></p-center>



<p><a name="k05"></a></p>
<h1>5. Jednosmìrný a obousmìrný pøenos dat po osmi bitech (byte mode)</h1>

<p>Vý¹e popsaný <i>nibble mode</i> sice umo¾òoval jednosmìrný i obousmìrný
pøenos dat po standardním paralelním portu, ov¹em v&nbsp;praxi se po¾adoval
skuteèný paralelní pøenos po osmi bitech (ten je teoreticky dvakrát rychlej¹í
pøi pou¾ití stejné frekvence zmìny logických úrovní). Pomìrnì jednoduchou
úpravou obvodù paralelního portu a pøidáním jednoho bitu do øídicího registru
je toho mo¾né dosáhnout. Dokonce se spekuluje o tom, ¾e u¾ pùvodní IBM PC mìlo
mít obousmìrný paralelní port, nakonec se v¹ak kvùli sní¾ení výsledné ceny
pøe¹lo na port jednosmìrný (dnes je celý øadiè portu umístìn v&nbsp;ji¾ním
mùstku &ndash; <i>south bridge</i> &ndash;, pùvodní IBM PC v¹ak pou¾ívalo
v&nbsp;té dobì bì¾nou TTL logiku). Pro vysílání i pøíjem dat se vyu¾ívají
datové linky, které musí být mo¾né nastavit jak pro re¾im zápisu, tak i pro
re¾im ètení. Z&nbsp;tohoto dùvodu není tento re¾im dostupný na v¹ech
paralelních portech, proto¾e pùvodní paralelní port umo¾òoval pouze zápis na
datové linky, tj.&nbsp;vysílání dat smìrem od poèítaèe k&nbsp;zaøízení.</p>

<image id="7643" />
<p-center><i>Obrázek 9: Jednosmìrný pøenos dat po osmi bitech. Oproti
kompatibilnímu re¾imu se funkce poèítaèe a zaøízení pøi komunikaci obrací
&ndash; poèítaè potvrzuje zapsaná data.</i></p-center>

<p>I v&nbsp;tomto re¾imu se o zpracování pøenesených dat musí postarat samotný
mikroprocesor (nìkteré paralelní porty, napøíklad port pro originální <i>IBM
PS/2</i>, mu v¹ak mohou práci ponìkud ulehèit, proto¾e vyvolávají po pøijetí
bajtu pøeru¹ení). Pro pøepínání datových linek z&nbsp;výstupního módu do módu
vstupního se pou¾ívá pátý bit øídicího registru. Øídicí registr je typicky
umístìný na adrese 37a popø.&nbsp;27a, v&nbsp;závislosti na tom, zda se jedná o
port <i>LPT1</i> èi <i>LPT2</i> (uvedené adresy le¾í v&nbsp;adresovém prostoru
I/O zaøízení). Pokud se mají data pouze èíst, tj.&nbsp;k&nbsp;portu je
pøipojeno zaøízení typu A/D pøevodník nebo skener, je situace jednoduchá
&ndash; port se pøepne do re¾imu ètení a tok bajtù je postupnì naèítán a
programovì zpracováván. V&nbsp;pøípadì obousmìrné komunikace je nutné, aby se
poèítaè a zaøízení v&nbsp;posílání dat støídaly, co¾ je ov¹em vìcí pøenosového
protokolu na vy¹¹í vrstvì (tento re¾im ji¾ není základní normou IEEE 1284
specifikován).</p>



<p><a name="k06"></a></p>
<h1>6. Vysokorychlostní re¾im EPP</h1>

<p>Vysokorychlostní re¾im <strong>EPP</strong> (<i>Enhanced Parallel Port</i>)
je navr¾en pro poloduplexní pøenos dat, pøi nìm¾ se vysílací a pøijímací strany
podle potøeby støídají ve vyu¾ívání osmi datových vodièù. Oproti kompatibilnímu
re¾imu pøenosu byla vylep¹ena komunikace s&nbsp;mikroprocesorem, díky èemu¾ se
sni¾uje jeho zatí¾ení (to je dùle¾ité u multitaskových operaèních systémù).
Maximální dosa¾itelná pøenosová rychlost dosahuje v&nbsp;tomto re¾imu hodnoty 2
MB.s<sup>-1</sup> (reálnì se bì¾nì pøesahuje hodnota 500 kB.s<sup>-1</sup>,
zmínìné 2 MB.s<sup>-1</sup> pouze se stínìným kabelem typu &bdquo;CC&ldquo; na
krat¹í vzdálenosti &ndash; cca dva metry). Tento re¾im je vìt¹inou nutné
v&nbsp;pøípadì potøeby povolit v&nbsp;BIOSu nebo pomocí ovladaèe paralelního
portu. Samotný paralelní port je roz¹íøen o dal¹í registr nazvaný <strong>EPP
Data Port</strong>, jeho¾ adresa je o jednièku vy¹¹í, ne¾ adresa øídicího
registru. Následuje struèný popis pøenosu jednoho bytu z&nbsp;poèítaèe do
pøipojeného zaøízení (zde je nutné øíci, ¾e v&nbsp;ideálním pøípadì se ve¹kerá
komunikace odehraje v&nbsp;pouhém jednom taktu sbìrnice <i>ISA</i>):</p>

<ol>

<li>Nejprve program zapí¹e data do I/O portu <strong>EPP Data Port</strong>.
Øadiè paralelního portu tuto událost detekuje, proto¾e si hlídá zápis do tohoto
portu.</li>

<li>Signál <strong>nWrite</strong> je sní¾en na logickou nulu a data jsou
zapsána na datové piny (<strong>nWrite</strong> odpovídá pùvodnímu signálu
<strong>nStrobe</strong>).</li>

<li>Signál <strong>nDataStrobe</strong> je sní¾en na logickou nulu, èím¾ je
zaøízení informováno, ¾e jsou signály na datových vodièích ustáleny (signál
<strong>nDataStrobe</strong> odpovídá signálu <strong>lineFeed</strong>).</li>

<li>Nyní øadiè portu èeká na odpovìï zaøízení, tj.&nbsp;na zmìnu signálu
<strong>nWait</strong> (co¾ je pùvodní signál <strong>Busy</strong>)
z&nbsp;logické nuly na logickou jednièku.</li>

<li>Po pøijetí tohoto signálu je <strong>nDataStrobe</strong> i
<strong>nWrite</strong> vrácen na pùvodní hodnotu, èím¾ je pøenos jednoho bytu
dokonèen.</li>

<li>Zaøízení se vrátí do re¾imu pøíjmu dal¹ího bytu, co¾ se projeví návratem
stavu signálu <strong>nWait</strong> do stavu logické nuly.</li>

</ol>

<image id="7644" />
<p-center><i>Obrázek 10: Pøenos jednoho bytu z&nbsp;poèítaèe na zaøízení
v&nbsp;re¾imu EPP.</i></p-center>

<p>Re¾im EPP zavádí i novou mo¾nost &ndash; na paralelní port je mo¾né pøipojit
a¾ 128 zaøízení, pøièem¾ pøed zahájením komunikace je pomocí
&bdquo;adresového&ldquo; bytu urèeno, které zaøízení má data pøijímat nebo
naopak vysílat. V&nbsp;praxi se v¹ak tato mo¾nost prakticky vùbec neujala.</p>



<p><a name="k07"></a></p>
<h1>7. Vysokorychlostní re¾im ECP</h1>

<p>Vysokorychlostní re¾im <strong>ECP</strong> (<i>Extended Capability
Port</i>), který byl navr¾en firmami HP a Microsoft, pøedstavuje nejvyspìlej¹í
mo¾nost komunikace poèítaèe a zaøízení pøipojeného k&nbsp;paralelnímu portu.
Podobnì jako u vý¹e popsaného re¾imu <strong>EPP</strong>, je i zde pou¾it
poloduplexní pøenos po spoleèných osmi datových linkách. Maximální dosa¾itelná
pøenosová rychlost se zvý¹ila na hodnotu 2,5 MB.s<sup>-1</sup> (pøi pou¾ití
stínìného kabelu &bdquo;CC&ldquo;, jeho¾ charakteristiky jsou popsány
v&nbsp;normì IEEE 1284).</p>

<image id="7645" />
<p-center><i>Obrázek 11: Pøenos jednoho bytu z&nbsp;poèítaèe na zaøízení
v&nbsp;re¾imu ECP.</i></p-center>

<p>V&nbsp;minulosti se jednalo o levnìj¹í variantu
k&nbsp;externímu rozhraní <i>SCSI</i>, tento re¾im bylo mo¾né pou¾ít i pøi
pøímém propojení dvou poèítaèù &ndash; v&nbsp;dobì, kdy sí»ová karta je¹tì
nebyla nezbytnou souèástí ka¾dého poèítaèe, bylo propojení paralelním kabelem
pomìrnì èasto praktikováno. Dùle¾ité je, ¾e v&nbsp;re¾imu <strong>ECP</strong>
je mo¾né vyu¾ít hardwarovì øízené fronty (<i>FIFO</i>) a i samotný pøenosový
protokol je upraven tak, aby pøenos dat mohl být provádìn relativnì nezávisle
na mikroprocesoru. I v&nbsp;tomto re¾imu lze zaøízení adresovat, tak¾e se
teoreticky na jeden paralelní port mù¾e pøipojit a¾ 128 zaøízení.</p>

<image id="7646" />
<p-center><i>Obrázek 12: Pøenos jednoho bytu ze zaøízení do poèítaèe
v&nbsp;re¾imu ECP.</i></p-center>



<p><a name="k08"></a></p>
<h1>8. Odkazy na Internetu</h1>

<ol>

<li>Linux I/O port programming mini-HOWTO<br />
<a href="http://www.faqs.org/docs/Linux-mini/IO-Port-Programming.html">http://www.faqs.org/docs/Linux-mini/IO-Port-Programming.html</a></li>

<li>A tutorial on Parallel port Interfacing<br />
<a href="http://logix4u.net/Legacy_Ports/Parallel_Port/A_tutorial_on_Parallel_port_Interfacing.html">http://logix4u.net/Legacy_Ports/Parallel_Port/A_tutorial_on_Parallel_port_Interfacing.html</a></li>

<li>Introduction to the IEEE 1284-1994 Standard<br />
<a href="http://www.fapo.com/1284int.htm">http://www.fapo.com/1284int.htm</a></li>

<li>IEEE 1284<br />
<a href="http://en.wikipedia.org/wiki/IEEE_1284">http://en.wikipedia.org/wiki/IEEE_1284</a></li>

<li>Parallel port<br />
<a href="http://en.wikipedia.org/wiki/Parallel_port">http://en.wikipedia.org/wiki/Parallel_port</a></li>

<li>Interfacing the Standard Parallel Port<br />
<a href="http://www.beyondlogic.org/spp/parallel.htm">http://www.beyondlogic.org/spp/parallel.htm</a></li>

<li>LPT Line Print Terminal<br />
<a href="http://en.wikipedia.org/wiki/LPT">http://en.wikipedia.org/wiki/LPT</a></li>

<li>IEEE Standard 1284<br />
<a href="http://www.undocprint.org/formats/communication_protocols/ieee_1284">http://www.undocprint.org/formats/communication_protocols/ieee_1284</a></li>

<li>Jan's Parallel Port FAQ: Answers to some frequently asked questions about the PC's parallel port<br />
<a href="http://www.lvr.com/jansfaq.htm">http://www.lvr.com/jansfaq.htm</a></li>

<li>Powering devices from PC parallel port<br />
<a href="http://www.epanorama.net/circuits/lptpower.html">http://www.epanorama.net/circuits/lptpower.html</a></li>

<li>IEEE 1284<br />
<a href="http://ckp.made-it.com/ieee1284.html">http://ckp.made-it.com/ieee1284.html</a></li>

<li>IEEE 1284 - Updating the PC Parallel Port<br />
<a href="http://zone.ni.com/devzone/cda/tut/p/id/3466">http://zone.ni.com/devzone/cda/tut/p/id/3466</a></li>

<li>ECP Parallel LPT port (IEEE-1284A) pinout<br />
<a href="http://pinouts.ru/ParallelPorts/ParallelECP_pinout.shtml">http://pinouts.ru/ParallelPorts/ParallelECP_pinout.shtml</a></li>

</ol>



<p><a name="k09"></a></p>
<h1>9. Obsah dal¹í èásti seriálu</h1>

<p>V&nbsp;následující èásti seriálu o architekturách poèítaèù si popí¹eme
sériový port (<i>RS-232C</i>), který byl pùvodnì &ndash; dávno pøed vznikem
osobních poèítaèù &ndash; koncipován pro pøipojení textového terminálu
k&nbsp;modemu, posléze se v¹ak pùsobnost jeho nasazení dosti podstatným
zpùsobem roz¹íøila, a to i na osobních poèítaèích. Uvidíme, ¾e práce se
sériovým portem sice na první pohled nevypadá tak snadnì, jako práce
s&nbsp;portem paralelním, proto¾e je nutné nastavit parametry sériové
komunikace, na druhou stranu se v¹ak i dnes jedná o standardní zpùsob
komunikace (zejména s&nbsp;pomalej¹ími zaøízeními, jako jsou modemy,
jednoúèelová èidla, mìøicí a øídicí prùmyslové systémy, my¹i, vstup dotykových
displejù, perové a øezací plottery èi terminálové rozhraní) a pøi správnì
nastavených parametrech je mo¾né data pøes sériový port posílat èi naopak
pøijímat i s&nbsp;vyu¾itím vysokoúrovòových API (<i>Application Programming
Interface</i>) bez nutnosti &bdquo;ruèního&ldquo; ovládání celého portu èi
dokonce jeho jednotlivých pinù.</p>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Ti¹novský</a> &nbsp; 2008</small></p>
</body>
</html>

