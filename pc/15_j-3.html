<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Programovací jazyk J - operátory, u¾ivatelské funkce a tacit programming</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Programovací jazyk J - operátory, u¾ivatelské funkce a tacit programming</h1>

<h3>Pavel Ti¹novský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V&nbsp;patnácté èásti seriálu o historii výpoèetní techniky dokonèíme popis programovacího jazyka J. Budeme se zabývat pøedev¹ím pou¾itím operátorù a následnì zpùsobem tvorby monadických i dyadických u¾ivatelských funkcí. Takté¾ si vysvìtlíme význam termínu tacit programming.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Operátor / (reduce)</a></p>
<p><a href="#k02">2. Náhrada programových smyèek pomocí operátorù</a></p>
<p><a href="#k03">3. Dyadická forma operátoru /</a></p>
<p><a href="#k04">4. Operátor \</a></p>
<p><a href="#k05">5. Tvorba u¾ivatelských funkcí</a></p>
<p><a href="#k06">6. Monadické u¾ivatelské funkce</a></p>
<p><a href="#k07">7. Dyadické u¾ivatelské funkce</a></p>
<p><a href="#k08">8. Tacit programming</a></p>
<p><a href="#k09">9. Literatura</a></p>
<p><a href="#k10">10. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2>1. Operátor / (reduce)</h2>

<p>V&nbsp;pøedchozích dvou èástech seriálu o programovacím jazyku <i>J</i> jsme
se seznámili se základními (primitivními) funkcemi tohoto jazyka, které
pøedstavují základní stavební kameny v¹ech vytváøených aplikací. Programovací
jazyk <i>J</i> v¹ak kromì pomìrnì rozsáhlé øady primitivních funkcí obsahuje,
podobnì jako ji¾ popsaný jazyk <i>APL</i>, nìkolik <i>operátorù</i>, pomocí
nich¾ jsou funkce aplikovány nikoli na jeden èi dva parametry, ale postupnì na
celé vektory nebo matice. Díky operátorùm (význam tohoto slova je odli¹ný od
významu, který toto slovo má v&nbsp;jiných jazycích) je mo¾né eliminovat velké
mno¾ství programových smyèek a mnohdy tak napøíklad nìkolikaøádkovou proceduru
zapsat pomocí jediného výrazu (viz <a href="#k02">druhou kapitolu</a>). Jedním
z&nbsp;nejdùle¾itìj¹ích operátorù jazyka <i>J</i> je operátor
<strong>/</strong>, který jsme si ji¾ v&nbsp;jednodu¹¹í podobì pøedstavili pøi
popisu jazyka <i>APL</i>. Tento operátor, který se zapisuje za identifikátor
primitivní èi u¾ivatelské funkce, postupnì danou funkci aplikuje na první dva
prvky argumentu, dále ji aplikuje na prùbì¾ný výsledek a tøetí prvek atd., do
doby, ne¾ jsou v¹echny prvky argumentu zpracovány (jinými slovy &ndash; daná
dyadická funkce je jakoby zapsána mezi v¹echny prvky pøedané datové
struktury, poèet operací je roven <i>n-1</i> v&nbsp;pøípadì, ¾e pøedaný
vektor má poèet prvkù <i>n</i>):</p>

<pre>
   NB. Souèet v¹ech èísel v øadì od 1 do 10.
   + / 1 2 3 4 5 6 7 8 9 10
55

   NB. Vektor hodnot mù¾eme vytvoøit
   NB. takté¾ s vyu¾itím generátoru
   NB. indexù (viz pøedchozí èásti
   NB. seriálu). Ov¹em pozor - indexy
   NB. se generují od 0, nikoli od 1.
   + / i. 10
45

   NB. Zde se ji¾ vektor skuteènì vygeneruje
   NB. tak, ¾e jeho první prvek má
   NB. jednièkovou hodnotu.
   + / 1 + i. 10
55
</pre>

<p>Operátor <strong>/</strong> je v¹ak samozøejmì mo¾né pou¾ít i
v&nbsp;kombinaci s&nbsp;libovolnou dyadickou funkcí &ndash; mù¾e se jednat jak
o aritmetické funkce, tak i o funkce logické (booleovské), porovnávací
(relaèní), maticové aj. Následují pøíklady pou¾ití nìkterých tìchto funkcí;
nejprve funkcí booleovských aplikovaných na vektory binárních hodnot:</p>

<pre>
   NB. Pou¾ití booleovské funkce "or"
   NB. (logický souèet)
   +./ 0 0 0 0
0
   +./ 0 0 0 1
1
   +./ 1 1 1 1
1

   NB. Pou¾ití booleovské funkce "and"
   NB. (logický souèin)
   *./ 0 0 0 0
0
   *./ 0 0 0 1
0
   *./ 1 1 1 1
1

   NB. Pou¾ití booleovské funkce ekvivalence
   =/ 0 0 0 0
1
   =/ 0 0 0 1
0
   =/ 1 1 1 1
1

   NB. Pou¾ití booleovské funkce "xor"
   NB. (nonekvivalence)
   ~:/ 0 0 0 0
0
   ~:/ 0 0 0 1
1
   ~:/ 1 1 1 1
0
</pre>

<p>Mezi dal¹í dyadické funkce, které lze zkombinovat s&nbsp;operátorem
<strong>/</strong>, patøí napøíklad funkce pro výpoèet (zji¹tìní) minima,
maxima, souèinu (zde korespondujících prvkù vektorù) a mocniny o zvoleném
základu:</p>

<pre>
   NB. Výbìr nejmen¹ího prvku z vektoru.
   &lt;. / 5 4 67 2 1 42 3 7 6
1

   NB. Výbìr nejvìt¹ího prvku z vektoru.
   &gt;. / 5 4 67 2 1 42 3 7 6
67

   NB. Jeden ze zpùsobù výpoètu skalárního
   NB. souèinu dvou vektorù.
   +/ (1 2 3) * (1 2 3)
14

   NB. Skalární souèin dvou na sebe kolmých
   NB. vektorù je v¾dy nulový.
   +/ (1 0 0) * (0 1 0)
0

   NB. Výpoèet prvních deseti mocnin
   NB. základu 2 (vèetnì 2^0).
   2 ^ i. 10
1 2 4 8 16 32 64 128 256 512

   NB. Suma prvních deseti mocnin
   NB. základu 2. Výsledek by mìl
   NB. být roven: (2^(n+1))-1
   + / 2 ^ i. 10
1023

   NB. Výpoèet známé úlohy se ¹achovnicí a semínky
   NB. kladenými na jednotlivá políèka ¹achovnice.
   2 ^ i. 64
1 2 4 8 16 32 64 128 256 512 1024 2048 4096 8192
16384 32768 65536 131072 262144 524288 1.04858e6
2.09715e6 4.1943e6 8.38861e6 1.67772e7 3.35544e7
6.71089e7 1.34218e8 2.68435e8 5.36871e8 1.07374e9
2.14748e9 4.29497e9 8.58993e9 1.71799e10 3.43597e10 6.87195...

   NB. Celkový poèet v¹ech semínek na ¹achovnici.
   + / 2 ^ i. 64
1.84467e19
</pre>



<p><a name="k02"></a></p>
<h2>2. Náhrada programových smyèek pomocí operátorù</h2>

<p>Ve druhé kapitole si pro ilustraci pou¾ití operátoru <strong>/</strong>
v&nbsp;praxi uká¾eme pøíklad pøevzatý z&nbsp;elektronické knihy &bdquo;J for C
Programmers&ldquo;, ve kterém je pøedvedeno, jakým zpùsobem je mo¾né pomocí
operátoru <strong>/</strong> nalézt nejvìt¹í prvek v&nbsp;matici (zmínìná
elektronická kniha je obsa¾ena pøímo v&nbsp;instalaci vývojového prostøedí
programovacího jazyka <i>J</i>). Nejprve si uveïme odpovídající céèkový
program, který nalezne prvek s&nbsp;maximální hodnotou v&nbsp;(dvourozmìrné)
matici <i>x</i>, její¾ rozmìry jsou ulo¾eny v&nbsp;konstantách <i>xsize0</i> a
<i>xsize1</i>:</p>

<pre>
int i, j;
float maxval = x[0][0];
for (i = 0; i&jt;=xsize0; ++i)
{
    for (j = 0; j&lt;=xsize1; ++j)
    {
        if (x[i][j] &gt; maxval)
        {
            maxval = x[i][j];
        }
    }
}
</pre>

<p>V&nbsp;programovacím jazyku <i>J</i> lze maximální prvek v&nbsp;matici
nalézt dvojí aplikací operátoru <strong>/</strong> zkombinovaného s&nbsp;funkcí
<strong>&gt;.</strong> (ta provádí výbìr vìt¹í hodnoty z&nbsp;dvojice pøedaných
parametrù, tj.&nbsp;jak skalárních hodnot, tak i vektorù popø.&nbsp;matic).
První aplikace operátoru <strong>/</strong> slou¾í k&nbsp;výbìru tìch prvkù na
jednotlivých øádcích matice, které mají nejvìt¹í hodnotu, druhá aplikace pak
ji¾ z&nbsp;tohoto mezivýsledku (tj.&nbsp;vektoru) vybere pøímo maximální
hodnotu, tak¾e se celá sekvence zanoøených smyèek a podmínìného pøíkazu
v&nbsp;programovacím jazyku <i>J</i> zmen¹í na jediný výraz. Ve skuteènosti je
v¹ak mo¾né podmínìný pøíkaz eliminovat i v&nbsp;céèkovém programu, staèí ho
nahradit napøíklad voláním makra <strong>MAX</strong>, co¾ v¹ak ji¾ není mo¾né
v&nbsp;pøíkladu uvedeném ní¾e. Navíc si nikde nemusíme pamatovat rozmìry pole
(matice), nebo» ty lze kdykoli za bìhu programu zjistit:</p>

<pre>
   NB. Nejprve si vytvoøíme matici
   NB. s testovacími daty.
   matice =: 3 3 $ _4 + i.9
   matice
_4 _3 _2
_1  0  1
 2  3  4

   NB. Nalezneme nejvìt¹í prvek v matici
   NB. dvojím pou¾itím operátoru /
   (&lt;./) &lt;./ matice
4
</pre>

<p>Druhý pøíklad je ji¾ ponìkud slo¾itìj¹í &ndash; nalezení sloupce, ve kterém
se nachází prvek s&nbsp;maximální hodnotou &ndash;, ale pøi pou¾ití
programovacího jazyka <i>J</i> se opìt obejdeme bez nutnosti pou¾ití
programových smyèek a podmínek. Sloupec, ve kterém se prvek s&nbsp;nejvìt¹í
hodnotou v&nbsp;matici nachází, lze zjistit s&nbsp;vyu¾itím dyadické funkce
<strong>i.</strong> (<i>index of</i>), která vrací index prvního prvku
obsahujícího danou hodnotu (prvním parametrem této funkce je vìt¹inou vektor,
druhým parametrem hledaná hodnota). Pov¹imnìte si pøedev¹ím pou¾ití závorek,
které eliminují nutnost dvojího pou¾ití mezivýsledku &gt;./ matice
v&nbsp;zapisovaném výrazu (viz té¾ <a href="#k08">osmá kapitola</a>, v&nbsp;ní¾
se tímto tématem budeme zabývat podrobnìji):</p>

<pre>
(i. &gt;./) &gt;./ matice
</pre>

<p>Céèkovský ekvivalent je stále mnohonásobnì del¹í kvùli nutnosti pou¾ití
programových smyèek a podmínek:</p>

<pre>
int i, j, maxcol = 0;
float maxval = x[0][0];
for (i = 0; i&jt;=xsize0; ++i)
{
    for (j = 0; j&lt;=xsize1; ++j)
    {
        if (x[i][j] &gt; maxval)
        {
            maxval = x[i][j];
            maxcol = j
        }
    }
}
</pre>



<p><a name="k03"></a></p>
<h2>3. Dyadická forma operátoru /</h2>

<p>Pøi popisu programovacího jazyka <i>APL</i> jsme se mj.&nbsp;zmínili i o
operátoru &bdquo;outer product&ldquo; zapisovaného dvojicí symbolù &#9702;.
(koleèko+teèka) za nimi¾ následovalo jméno èi symbol nìjaké primitivní funkce
popø.&nbsp;identifikátor u¾ivatelské dyadické funkce. Tento operátor je zalo¾en
na principu aplikace zvolené dyadické funkce na dvojici vektorù <i>x</i> a
<i>y</i>, pøièem¾ vybraná funkce je aplikována na v¹echny mo¾né kombinace
slo¾ek prvního a druhého vektoru. Výsledkem je matice <i>Z</i> obsahující
v&nbsp;prvku <i>z<sub>ij</sub></i> návratovou hodnotu funkce aplikované na
prvky <i>x<sub>i</sub></i> a <i>y<sub>j</sub></i>. Význam tohoto operátoru jsme
si vysvìtlili na pøíkladu, ve kterém se vytvoøila a následnì vypsala èást
tabulky malé násobilky (pozor &ndash; následující úryvek kódu je zapsaný
v&nbsp;syntaxi odpovídající programovacímu jazyku <i>APL</i>, nikoli
<i>J</i>):</p>

<pre>
     1 2 3 4 5 &#9702;.&times; 1 2 3 4 5
1 2 3 4 5
2 4 6 8 10
3 6 9 12 15
4 8 12 16 20
5 10 15 20 25
</pre>

<p>Programovací jazyk <i>J</i> sice neobsahuje specializovaný operátor typu
&#9702;., ale ani to vlastnì není zapotøebí, proto¾e roz¹iøuje mo¾nosti
operátoru <strong>/</strong> popsaného v&nbsp;<a href="#k01">první</a> a <a
href="#k02">druhé kapitole</a>. Zatímco v&nbsp;<i>APL</i> byl operátor /
(reduce) pouze monadický (bylo ho mo¾né pou¾ít s&nbsp;parametrem zapisovaným
napravo od identifikátoru funkce), je mo¾né v&nbsp;programovacím jazyce
<i>J</i> vyu¾ít i jeho dyadickou formu, pøi ní¾ se první parametr (vektor)
zapisuje nalevo od operátoru+funkce a druhý parametr (vìt¹inou takté¾ vektor)
napravo. Výsledek aplikace &bdquo;dyadického&ldquo; operátoru
<strong>/</strong> (nazývaného ponìkud neobvykle <i>table</i>) je v&nbsp;tomto
pøípadì stejný, jako pøi pou¾ití operátoru &#9702;. v&nbsp;programovacím jazyce
<i>APL</i> (u nìkterých funkcí pou¾itých spolu s&nbsp;tímto operátorem dochází
k&nbsp;nìkolika malým zmìnám chování, které v¹ak nejsou v&nbsp;naprosté vìt¹inì
pøípadù podstatné).</p>

<p>Vý¹e uvedený pøíklad by se tedy dal pøepsat do programovacího jazyka
<i>J</i> dvìma zpùsoby: pøímým zápisem dvojic vektorù, na nì¾ by se aplikoval
operátor &bdquo;/&ldquo; v&nbsp;kombinaci s&nbsp;funkcí násobení, nebo vyu¾itím
generátoru indexù pro zkonstruování obou vektorù. Ve druhém pøípadì opìt
nesmíme zapomenout na to, ¾e se indexy generují od nuly a nikoli od
jednièky:</p>

<pre>
   NB. Tabulka malé násobilky vzniklá
   NB. aplikací operátoru "outer product"
   NB. na dvojici explicitnì zapsaných vektorù
   1 2 3 4 5 */ 1 2 3 4 5
1  2  3  4  5
2  4  6  8 10
3  6  9 12 15
4  8 12 16 20
5 10 15 20 25

   NB. Pou¾ití generátoru indexù pro výpoèet
   NB. tabulky malé násobilky.
   (1+i.5) */ (1+i.5)
1  2  3  4  5
2  4  6  8 10
3  6  9 12 15
4  8 12 16 20
5 10 15 20 25
</pre>

<p>S&nbsp;vyu¾itím operátoru <i>outer product</i> je mo¾né zkonstruovat velké
mno¾ství matic se speciálními vlastnostmi; tyto matice mohou mít samozøejmì
témìø libovolnou velikost. Jedná se napøíklad o jednotkové matice (obsahují
jednièky v&nbsp;diagonále, ostatní prvky jsou nulové), trojúhelníkové matice
rùzného typu (jednièky se nachází pod èi nad diagonálou, ostatní prvky jsou
nulové) atd. Tvorba tìchto matic je ilustrována na následujících pøíkladech, ve
kterých se èasto pou¾ívají porovnávací (relaèní) funkce:</p>

<pre>
   NB. Pomocný vektor obsahující èíselnou
   NB. øadu 0 1 2 3 4 5
   vect =. i. 5

   NB. Matice obsahující prvky se shodnými
   NB. hodnotami na vedlej¹ích diagonálách.
   vect +/ vect
0 1 2 3 4
1 2 3 4 5
2 3 4 5 6
3 4 5 6 7
4 5 6 7 8

   NB. Jednotková matice.
   vect =/ vect
1 0 0 0 0
0 1 0 0 0
0 0 1 0 0
0 0 0 1 0
0 0 0 0 1

   NB. Inverze v¹ech prvkù jednotkové
   NB. matice.
   vect ~:/ vect
0 1 1 1 1
1 0 1 1 1
1 1 0 1 1
1 1 1 0 1
1 1 1 1 0

   NB. Rotace jednotkové matice
   |. vect =/ vect
0 0 0 0 1
0 0 0 1 0
0 0 1 0 0
0 1 0 0 0
1 0 0 0 0

   NB. Matice obsahující NAD hlavní
   NB. diagonálou jednotkové prvky.
   vect &lt;/ vect
0 1 1 1 1
0 0 1 1 1
0 0 0 1 1
0 0 0 0 1
0 0 0 0 0

   NB. Matice obsahující NAD hlavní
   NB. diagonálou (vèetnì diagonály)
   NB. jednotkové prvky.
   vect &lt;/ vect
1 1 1 1 1
0 1 1 1 1
0 0 1 1 1
0 0 0 1 1
0 0 0 0 1

   NB. Matice obsahující POD hlavní
   NB. diagonálou (vèetnì diagonály)
   NB. jednotkové prvky.
   vect &gt;:/ vect
1 0 0 0 0
1 1 0 0 0
1 1 1 0 0
1 1 1 1 0
1 1 1 1 1

   NB. Na hlavní diagonále je
   NB. èíselná posloupnost zaèínající
   NB. nulou, ostatní prvky jsou nulové
   vect * vect =/ vect
0 0 0 0 0
0 1 0 0 0
0 0 2 0 0
0 0 0 3 0
0 0 0 0 4

   NB. Na hlavní diagonále je
   NB. èíselná posloupnost zaèínající
   NB. jednièkou, ostatní prvky jsou nulové
   (vect+1) * vect =/ vect
1 0 0 0 0
0 2 0 0 0
0 0 3 0 0
0 0 0 4 0
0 0 0 0 5

   NB. Rotace pøedchozí matice
   |. (vect+1) * vect =/ vect
0 0 0 0 5
0 0 0 4 0
0 0 3 0 0
0 2 0 0 0
1 0 0 0 0
</pre>

<p>Pøíklad pou¾ití operátoru <strong>/</strong> s&nbsp;nekomutativní
funkcí:</p>

<pre>
   (i.5) ^/ (i.5)
   1 0  0  0   0
   1 1  1  1   1
   1 2  4  8  16
   1 3  9 27  81
   1 4 16 64 256
</pre>

<p>Kdo dává pøednost transponované tabulce (mocniny rostou po jednotlivých
øádcích, základ po sloupcích), mù¾e pou¾ít funkci <strong>|:</strong>
aplikovanou na vypoètenou matici. I v&nbsp;tomto pøípadì toti¾ platí, ¾e jsou
funkce vyèíslovány zprava doleva, nejdøíve je tedy vypoètena matice 5&times;5
hodnot, která je a¾ následnì transponována:</p>

<pre>
   |: (i.5) ^/ (i.5)
   1 1  1  1   1
   0 1  2  3   4
   0 1  4  9  16
   0 1  8 27  64
   0 1 16 81 256

   NB. Krat¹í zápis pro ty, co ¹etøí
   NB. ka¾dý stisk klávesy :-)
   |:(i.5)^/i.5
   1 1  1  1   1
   0 1  2  3   4
   0 1  4  9  16
   0 1  8 27  64
   0 1 16 81 256
</pre>



<p><a name="k04"></a></p>
<h2>4. Operátor \</h2>

<p>Druhým operátorem, který si v&nbsp;dne¹ním èlánku popí¹eme, je operátor
<strong>\</strong>. Tento operátor zpracovává data podobným zpùsobem, jako vý¹e
popsaný operátor <strong>/</strong>, ov¹em s&nbsp;tím rozdílem, ¾e vrací
posloupnost obsahující v¹echny mezivýsledky postupné aplikace dané funkce na
vstupní parametr, napøíklad vektor (chování tohoto operátoru je tedy odli¹né od
stejnì oznaèeného operátoru známého z&nbsp;programovacího jazyka <i>APL</i>).
Na následujícím pøíkladu si pov¹imnìte, ¾e interpret programovacího jazyka
<i>J</i> automaticky zarovnal v¹echny výsledky tak, aby vytvoøily pravidelnou
matici. V&nbsp;tomto pøíkladu je funkce + pou¾ita jako identita, která vrací
pøímo svùj (jediný) argument &ndash; jedná se tedy o monadickou podobu této
funkce, nikoli o (u¾ ze své podstaty dyadický) souèet:</p>

<pre>
   NB. Základní pou¾ití operátoru \.
   +\ 1 2 3 4
1 0 0 0
1 2 0 0
1 2 3 0
1 2 3 4
</pre>

<p>V&nbsp;pøedchozí kapitole jsme si ukázali, jakým zpùsobem lze vytvoøit
trojúhelníkové matice. Ty je v¹ak mo¾né zkonstruovat i alternativním postupem
demonstrovaným na následující dvojici pøíkladù:</p>

<pre>
   NB. Jeden ze zpùsobù konstrukce trojúhelníkové matice.
   *\ 1 2 3 4
1 0 0 0
1 1 0 0
1 1 1 0
1 1 1 1

   NB. Vyu¾ití funkce |: provádìjící transpozici matice.
   NB. (pozor - funkce |: je odli¹ná od funkce |.)
   |: *\ 1 2 3 4
1 1 1 1
0 1 1 1
0 0 1 1
0 0 0 1
</pre>

<p>Pøedchozí pøíklady vyu¾ívající operátor <strong>\</strong> byly ponìkud
netypické. Mnohem èastìji se tento operátor vyu¾ívá spolu s&nbsp;vý¹e popsaným
operátorem <strong>/</strong> pro vytvoøení vektoru obsahujícího postupnou
aplikaci nìjaké dyadické funkce na pøedaný parametr, kterým je vìt¹inou vektor
nebo matice (zde se ji¾ pøibli¾ujeme pùvodnímu operátoru \ z&nbsp;jazyka
<i>APL</i>, v&nbsp;jazyku <i>J</i> je zvoleno obecnìj¹í a tím pádem i
universálnìj¹í øe¹ení). Pokud je napøíklad zavolán pøíkaz:</p>

<pre>
   +/\ 1 2 3 4
</pre>

<p>Vygeneruje se vektor obsahující tyto hodnoty:</p>

<pre>
1 3 6 10
</pre>

<p>které vznikly následující sekvencí výpoètù:</p>

<pre>
1
1+2
1+2+3
1+2+3+4
</pre>

<p>Tento zpùsob pou¾ití operátoru \ je v&nbsp;aplikacích psaných
v&nbsp;programovacím jazyku <i>J</i> pomìrnì èasto pou¾itý, proto¾e se
s&nbsp;ním dají i bez pou¾ití programových smyèek generovat napøíklad nìkteré
dùle¾ité èíselné øady:</p>

<pre>
   NB. Prvních deset prvkù posloupnosti øady faktoriálù.
   */\ 1 2 3 4 5 6 7 8 9 10
1 2 6 24 120 720 5040 40320 362880 3628800

   NB. Pøi náhradì vektoru (1 2 3 4 5 6 7 8 9 10) sekvencí
   NB. indexù musíme dát pozor na to, ¾e se indexuje od 0,
   NB. tj. v¹echny souèiny i jejich postupné souèty budou
   NB. nulové.
   */\ i. 10
0 0 0 0 0 0 0 0 0 0

   NB. Korektní zápis výpoètu prvních deseti prvkù
   NB. posloupnosti øady faktoriálù.
   */\ 1 + i. 10
1 2 6 24 120 720 5040 40320 362880 3628800
</pre>



<p><a name="k05"></a></p>
<h2>5. Tvorba u¾ivatelských funkcí</h2>

<p>V&nbsp;pøedchozích kapitolách jsme si ukázali, jakým zpùsobem je mo¾né
v&nbsp;interaktivním re¾imu interpretru programovacího jazyka <i>J</i> volat
jednotlivé základní (primitivní) funkce, popø.&nbsp;funkce zkombinované
s&nbsp;nìkterým operátorem. Ov¹em pøi tvorbì vìt¹ích aplikací se nevyhneme
nutnosti vytváøení u¾ivatelských funkcí, v&nbsp;nich¾ je mo¾né definovat
lokální i globální promìnné, pou¾ívat øídicí struktury (podmínìné pøíkazy a
programové smyèky) atd. U¾ivatelsky definované funkce mohou být monadické
(s&nbsp;jedním parametrem), dyadické (s&nbsp;dvojicí parametrù) nebo lze
jednomu identifikátoru (jménu) pøiøadit jak monadickou, tak i dyadickou funkci.
Speciálním pøípadem funkcí jsou funkce, v&nbsp;nich¾ se na pøedané parametry
pouze volají dal¹í u¾ivatelské i primitivní funkce, popø.&nbsp;operátory, bez
vytváøení pomocných promìnných. Tyto speciální funkce, které jsou v&nbsp;mnoha
ohledech velmi u¾iteèné, si popí¹eme <a href="#k08">v&nbsp;osmé kapitole</a>.
Nyní se ov¹em budeme zabývat bì¾nými u¾ivatelskými funkcemi s&nbsp;parametry
(jedním èi dvìma) a návratovou hodnotou. Obecný formát zápisu nové funkce jak
v&nbsp;monadické, tak i dyadické formì, má tvar:</p>

<pre>
jméno_funkce =: verb define
tìlo_monadické_funkce
:
tìlo_dyadické_funkce
)
</pre>

<p>V&nbsp;tuto chvíli mù¾eme pro jednoduchost pova¾ovat identifikátory
<strong>verb</strong> a <strong>define</strong> za klíèová slova, i kdy¾ se ve
skuteènosti jedná o náhradu numerických konstant s&nbsp;pevným významem
(napøíklad konstanta 3 øíká interpretru, ¾e má vytvoøit funkci, konstanta 0, ¾e
se jedná o funkci, její¾ tìlo se nachází na dal¹ích programových øádcích atd.).
Mezi tìlem monadické a dyadické funkce se nachází znak dvojteèky, celá funkce
(resp.&nbsp;definice tìl obou funkcí) je ukonèena znakem pravé kulaté závorky
(závorky tedy nejsou vyvá¾ené, na rozdíl od pou¾ití závorek
v&nbsp;aritmetických a logických výrazech). V&nbsp;pøípadì, ¾e u¾ivatel
potøebuje vytvoøit pouze monadickou nebo jen dyadickou funkci, její¾ tìlo je
mo¾né zapsat na jeden øádek, mù¾e pou¾ít zkrácenou formu zápisu funkce ukázanou
pod tímto odstavcem. Pov¹imnìte si, ¾e tìlo funkce (seznam pøíkazù) je pøi
pou¾ití tohoto zpùsobu zápisu umístìno v&nbsp;apostrofech:</p>

<pre>
name =: monad : 'text of verb'
name =: dyad : 'text of verb'
</pre>



<p><a name="k06"></a></p>
<h2>6. Monadické u¾ivatelské funkce</h2>

<p><i>Monadické</i> (jednoparametrické) funkce mohou ve svém tìle pøistupovat
ke svému jedinému parametru, který má v&nbsp;tomto pøípadì jméno
<strong>y</strong>. Dyadické (dvouparametrické) funkce mají dvojici parametrù:
levý je pojmenovaný <strong>x</strong>, pravý <strong>y</strong> (jedná se o
stejné pojmenování, jako u monadických funkcí, co¾ dává smysl, proto¾e i u
tìchto funkcí jde o parametr, který se nachází napravo od jména funkce). Nyní
si uka¾me, jakým zpùsobem je mo¾né vytvoøit jednoduchou monadickou funkci
nazvanou <strong>minus</strong>, která vrátí hodnotu svého jediného parametru,
ale s&nbsp;opaèným znaménkem (návratovou hodnotou funkce je výsledek posledního
výrazu ve funkci, podobnì jako napøíklad v&nbsp;<i>LISPu</i>). Jako parametr
je mo¾né pøedat skalární hodnotu, vektor, matici èi pole o libovolné dimenzi.
Tuto funkci lze vytvoøit jedním ze tøí zpùsobù:</p>

<pre>
   NB. První ze zpùsobù definice funkce
   NB. "minus". V tomto pøípadì se jakoby
   NB. souèasnì vytváøí monadická i dyadická
   NB. funkce, ov¹em uvede se pouze tìlo
   NB. monadické funkce.
   minus =: verb define
-y
)

   NB. Druhý ze zpùsobù definice funkce
   NB. "minus". Zde se ji¾ explicitnì uvádí,
   NB. ¾e se jedná o funkci monadickou.
   minus =: monad define
-y
)

   NB. Tøetí zpùsob definice funkce "minus",
   NB. pøi nìm¾ je tìlo funkce napsáno na
   NB. jednom øádku (v apostrofech).
   minus =: monad : '-y'
</pre>

<p>Vytvoøenou funkci <strong>minus</strong> si mù¾eme ihned otestovat, a to jak
na parametrech typu skalár, tak i na vektorech a maticích:</p>

<pre>
   NB. Pou¾ití skalární hodnoty
   NB. jako parametru monadické
   NB. funkce "minus".
   minus 10
_10
   minus 42
_42
   minus _42
42
   NB. Funkce se v programovacím jazyku
   NB. "J" vyhodnocují v¾dy zprava doleva.
   minus 1 + 2 + 3
_6
   1 + minus 2
_1

   NB. Pou¾ití vektoru
   NB. jako parametru monadické
   NB. funkce "minus".
   minus 1 2 3 4 5
_1 _2 _3 _4 _5

   minus 1+i.5
_1 _2 _3 _4 _5

   NB. Pou¾ití matice
   NB. jako parametru monadické
   NB. funkce "minus".
   matice =: 3 3 $ i.9
   matice
0 1 2
3 4 5
6 7 8
   minus matice
 0 _1 _2
_3 _4 _5
_6 _7 _8
</pre>

<p>Snadno se takté¾ mù¾eme pøesvìdèit, ¾e interpret programovacího jazyka
<i>J</i> hlídá, zda je u¾ivatelská funkce <strong>minus</strong> zavolána
s&nbsp;korektním poètem parametrù:</p>

<pre>
   NB. Pokus o zavolání dyadické funkce "minus"
   1 minus 2
|domain error: minus
|   1     minus 2
</pre>



<p><a name="k07"></a></p>
<h2>7. Dyadické u¾ivatelské funkce</h2>

<p>Dyadické funkce se vytváøí prakticky stejným zpùsobem jako funkce monadické,
ov¹em s&nbsp;pou¾itím slova <i>dyad</i> namísto <i>monad</i>. Jak ji¾ víme
z&nbsp;pøedchozího textu, jsou parametry u¾ivatelských dyadických funkcí
pojmenovány <i>x</i> (levý) a <i>y</i> (pravý). U¾ivatelskou funkci souètu dvou
hodnot (skalárù, vektorù èi matic) lze tedy zapsat velmi snadno, napøíklad
s&nbsp;pou¾itím &bdquo;jednoøádkové&ldquo; formy:</p>

<pre>
   NB. Jednoøádková u¾ivatelská funkce
   NB. "soucet" zapsaná na jednom radku
   soucet =: dyad : 'x + y'

   NB. Test, zda funkce pracuje korektne
   10 soucet 20
30

   1 2 3 soucet 4 5 6
5 7 9
</pre>

<p>Pøi definici monadické i dyadické funkce se stejným jménem je zapotøebí
pou¾ít formu definice zaèínající slovy <i>verb define</i>. Dùvod je prostý
&ndash; pokud by se nejdøíve definovala napøíklad monadická funkce a poté
(samostatným pøíkazem) funkce dyadická, do¹lo by k&nbsp;pøepisu definice funkce
pøiøazené ke zvolenému identifikátoru, stejnì jako dojde pøi pøiøazení hodnoty
do promìnné k&nbsp;pøepisu hodnoty pøedchozí (i =: 1, i =: 2). Monadickou i
dyadickou funkci <strong>minus</strong> je tedy mo¾né vytvoøit následovnì:</p>

<pre>
   NB. Definice monadické i dyadické
   NB. funkce "minus".
   minus =: verb define
- y
:
x - y
)

   NB. Test funkènosti obou variant
   NB. funkce "minus".
   minus 10
_10

   10 minus 20
_10

   100 minus 10
90

   minus 1 2 3 4 5
_1 _2 _3 _4 _5

   minus 1+i.5
_1 _2 _3 _4 _5

   1 2 3 minus 4 5 6
_3 _3 _3
</pre>



<p><a name="k08"></a></p>
<h2>8. Tacit programming</h2>

<p>Poslední zajímavou vlastností programovacího jazyka <i>J</i>, se kterou se
v&nbsp;tomto seriálu seznámíme, je takzvaný <i>tacit programming</i> (pøesný
èeský ekvivalent tohoto oznaèení mì nenapadá, proto radìji zùstanu u termínu
anglického, který se ostatnì snadnìji vyhledává). Jedná se o styl zápisu blokù
programù (typicky u¾ivatelských funkcí nebo výrazù), ve kterých se nachází
volání jiných funkcí, ov¹em bez explicitního udání jmen jejich argumentù
(parametrù). S&nbsp;tímto stylem programování jsme se ji¾ mohli seznámit
v&nbsp;seriálech o programovacím jazyku <i>Forth</i> a <i>Joy</i>, v&nbsp;nich¾
se vyu¾ívalo toho, ¾e v¹echny argumenty funkcí (operátorù) se nacházely na
nejvy¹¹ích místech zásobníku operandù. Ve <i>Forthu</i> tedy bylo mo¾né napsat
napøíklad následující funkci:</p>

<pre>
:foo + * ;
</pre>

<p>která na zásobníku oèekávala alespoò tøi èíselné hodnoty, které ov¹em uvnitø
funkce nebyly nikde explicitnì pojmenovány ani pou¾ity. Pou¾ití této funkce bylo
stejnì snadné jako její zápis:</p>

<pre>
3 2 1 foo .
9
</pre>

<p>Podobným zpùsobem je mo¾né vytváøet funkce i v&nbsp;programovacím jazyku
<i>J</i>. Typickým pøíkladem je funkce pro výpoèet prùmìru èíselných hodnot
ulo¾ených v&nbsp;nìjakém vektoru. Prùmìr se vypoèítá snadno: nejprve zjistíme
souèet (sumu) v¹ech prvkù (funkce <strong>+</strong> zkombinovaná
s&nbsp;operátorem <strong>/</strong>) a následnì tento souèet vydìlíme jejich
poètem (funkce <strong>#</strong> zjistí délku vektoru). Pøi tìchto výpoètech
není nutné nikde explicitnì pojmenovávat parametry &ndash; ty se pou¾ijí a¾
pøi aplikaci (pou¾ití) vytvoøené kombinace funkcí v&nbsp;dal¹í èásti
programu:</p>

<pre>
   NB. mean=suma(a1..an)/n
   mean =: +/ % #
</pre>



<p><a name="k09"></a></p>
<h2>9. Literatura</h2>

<ol>

<li>Linda Alvord and Norman Thomson, &bdquo;<i>Easy-J: An Introduction to the World's most Remarkable Programming Language</i>&ldquo;<br />October 2002</li>

<li>Ulf Grenander, &bdquo;<i>Mathematical Experiments on the Computer,</i>&ldquo;<br />Academic Press, 1982, ISBN 0-12-301750-5.</li>

<li>K. E. Iverson, &bdquo;<i>A Programming Language</i>&ldquo;,<br />Wiley, 1962.</li>

<li>K. E. Iverson, &bdquo;<i>Algebra : an algorithmic treatment</i>&ldquo;,<br />APL Press 1977, Copyright 1972 by Addison Wesley,<br />Preliminary Edition entitled &bdquo;<i>Elementary Algebra</i>&ldquo;<br />Copyright 1971 by IBM Corporation.</li>

<li>K. E. Iverson, &bdquo;<i>Elementary analysis</i>&ldquo;,<br />APL press 1976, Preliminary Edition &bdquo;<i>Elementary Functions</i>&ldquo;<br />Copyright 1974 by IBM Corporation ISBN 0-917326-01-6</li>

<li>K. E. Iverson, &bdquo;<i>A personal view of APL,</i>&ldquo;<br />IBM Systems Journal,</li>

<li>C. Reiter, &bdquo;<i>Fractuals Visualization and J</i>&ldquo;,<br />Iverson Software, Inc, 1995 ISBN 1-895721-11-3.</li>

<li>&bdquo;<i>J Phrases,</i>&ldquo;<br />Iverson Software, 1996, ISBN 1-895721-12-1</li>

<li>&bdquo;<i>Exploring Math</i>&ldquo;, Iverson Software, 1996, ISBN 1-895721-13-X</li>

<li>&bdquo;<i>J Primer,</i>&ldquo;<br />Iverson Software, 1996, ISBN 1-895721-14-8</li>

</ol>



<p><a name="k10"></a></p>
<h2>10. Odkazy na Internetu</h2>

<ol>

<li>Tacit programming<br />
<a href="http://en.wikipedia.org/wiki/Tacit_programming">http://en.wikipedia.org/wiki/Tacit_programming</a>
</li>

<li>Pure functions in APL and J<br />
<a href="http://portal.acm.org/citation.cfm?id=114065&amp;dl=GUIDE&amp;coll=GUIDE">http://portal.acm.org/citation.cfm?id=114065&amp;dl=GUIDE&amp;coll=GUIDE</a>
</li>

<li>Learning J (Roger Stokes)<br />
<a href="http://www.jsoftware.com/help/learning/contents.htm">http://www.jsoftware.com/help/learning/contents.htm</a>
</li>

<li>J: a modern, high-level, general-purpose, high-performance programming language<br />
<a href="http://www.jsoftware.com/">http://www.jsoftware.com/</a>
</li>

<li>K, Kdb: an APL derivative for Solaris, Linux, Windows<br />
<a href="http://www.kx.com">http://www.kx.com</a>
</li>

<li>Vector (obsahuje odkazy na èlánky, knihy a blogy o programovacích jazycích APL, J a K)<br />
<a href="http://www.vector.org.uk/">http://www.vector.org.uk/</a>
</li>

<li>APL &ndash; A Glimpse of Heaven<br />
<a href="http://www.vector.org.uk/archive/v231/legrand.htm">http://www.vector.org.uk/archive/v231/legrand.htm</a>
</li>

<li>APL Interpreters<br />
<a href="http://www.vector.org.uk/?area=interpreters">http://www.vector.org.uk/?area=interpreters</a>
</li>

<li>APL_(programming_language<br />
<a href="http://en.wikipedia.org/wiki/APL_(programming_language">http://en.wikipedia.org/wiki/APL_(programming_language</a>
</li>

<li>APL FAQ<br />
<a href="http://www.faqs.org/faqs/apl-faq/">http://www.faqs.org/faqs/apl-faq/</a>
</li>

<li>APL FAQ (nejnovìj¹í verze)<br />
<a href="http://home.earthlink.net/~swsirlin/apl.faq.html">http://home.earthlink.net/~swsirlin/apl.faq.html</a>
</li>

<li>A+<br />
<a href="http://www.aplusdev.org/">http://www.aplusdev.org/</a>
</li>

<li>Rosetta Code<br />
<a href="http://rosettacode.org/wiki/Main_Page">http://rosettacode.org/wiki/Main_Page</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Ti¹novský</a> &nbsp; 2009</small></p>
</body>
</html>

