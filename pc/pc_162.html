<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Instrukce typu SIMD na mikroprocesorech RISC</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Instrukce typu SIMD na mikroprocesorech RISC</h1>

<h3>Pavel Ti¹novský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V dne¹ní èásti seriálu o architekturách poèítaèù se seznámíme s instrukcemi typu SIMD (Single Instruction Multiple Data) vyu¾ívanými v nìkterých mikroprocesorech s architekturou RISC. Právì na tìchto mikroprocesorech, konkrétnì v HP-PA RISC a SPARC V9, byly SIMD instrukce pou¾ity døíve, ne¾ vznikly dnes známìj¹í technologie MMX, 3DNow! a SSE/SSE2/SSE4 vyu¾ívané na procesorech øady x86.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Instrukce typu SIMD na mikroprocesorech RISC</a></p>
<p><a href="#k02">2. Implementace instrukcí SIMD na mikroprocesorech RISC</a></p>
<p><a href="#k03">3. Malé historické porovnání: SIMD na RISC vs. CISC</a></p>
<p><a href="#k04">4. SIMD instrukce na RISCových mikroprocesorech øady MIPS</a></p>
<p><a href="#k05">5. Roz¹iøující instrukèní sada MDMX (MaDMaX)</a></p>
<p><a href="#k06">6. Nové operace implementované v&nbsp;instrukèní sadì MDMX</a></p>
<p><a href="#k07">7. Problémy provázející operaci multiply &amp; accumulate (MAC)</a></p>
<p><a href="#k08">8. Operace provádìné se &bdquo;¹irokým akumulátorem&ldquo;</a></p>
<p><a href="#k09">9. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2>1. Instrukce typu SIMD na mikroprocesorech RISC</h2>

<p>V&nbsp;pøedchozích tøech èástech seriálu o architekturách poèítaèù jsme se
zabývali popisem roz¹iøujících instrukèních sad obsahujících <i>SIMD</i>
instrukce, tj.&nbsp;instrukce urèené pro provádìní operací nad vektory
konstantní délky. Zamìøili jsme se pouze na platformu <i>x86</i>, na ní¾ byla
technologie <i>SIMD</i> instrukcí poprvé implementována na mikroprocesorech
<i>Pentium P55C</i> v&nbsp;roce 1996 (dal¹í èipy s&nbsp;technologií <i>SIMD</i>
zaèaly být prodávány hned následující rok). Jednalo se o instrukèní sadu
nazvanou <i>MMX</i>, která byla pozdìji následována instrukèní sadou
<i>3DNow!</i> a pozdìji té¾ sadami <i>SSE</i>, <i>SSE2</i>, <i>SSE4</i> atd.
Ov¹em <i>SIMD</i> instrukce samozøejmì nejsou pou¾ívány pouze na platformì
<i>x86</i>, ale mù¾eme se s&nbsp;nimi setkat i na mnoha typech procesorù
<i>RISC</i>. Ve skuteènosti se dokonce tento typ instrukcí poprvé objevil právì
na mikroprocesorech <i>RISC</i> a teprve se zhruba dvouletým zpo¾dìním byl
pøevzat i na pùvodnì èistì <i>CISCovou</i> architekturu <i>x86</i> (ostatnì se
zdaleka nejedná o první ani o poslední technologii, která byla na <i>x86</i>
pøevzata právì z&nbsp;<i>RISCových</i> procesorù).</p>

<img src="http://i.iinfo.cz/images/625/37cray-a-1.jpg" width="350" height="467" alt=" " />
<p><i>Obrázek 1: Superpoèítaè Cray-1 byl jedním ze superpoèítaèù s&nbsp;velmi
dobrou podporou vektorových operací, a» se to týkalo instrukèní sady, tak i
podpory v&nbsp;pøekladaèi Fortranu.</i></p>

<p>Dùvodù, proè se instrukce typu <i>SIMD</i> na RISCových procesorech vùbec
objevily, je vìt¹í mno¾ství. Jedním z&nbsp;nich je to, ¾e se tyto procesory
zaèaly pou¾ívat v&nbsp;grafických pracovních stanicích, mj.&nbsp;i pro
zpracování videa, provádìní rastrových operací i 3D operací, co¾ je pøesnì ta
oblast, v&nbsp;ní¾ je mo¾né informace zpracovávat nikoli jen ve formì
skalárních dat, ale i jako vektory pevné délky. Dal¹ím dùvodem byla snaha
výrobcù RISCových procesorù o prùnik na trh s&nbsp;poèítaèi urèenými pro
nároèné výpoèty (jedná se o urèitý mezistupeò mezi výkonnými pracovními
stanicemi a superpoèítaèi). V&nbsp;tomto oboru se mnoho algoritmù provádí nad
maticemi a vektory obsahujícími numerické hodnoty reprezentované v&nbsp;systému
plovoucí øádové èárky (FP: Floating Point). Tøetím dùvodem je samozøejmì snaha
o zvý¹ení výpoèetního výkonu a právì <i>SIMD</i> instrukce k&nbsp;nìmu mohou
vést, ani¾ by bylo nutné radikálnì mìnit pou¾ívanou výrobní technologii èipù
(zvy¹ovat úroveò integrace, sni¾ovat napì»ové úrovnì èi zvy¹ovat
frekvenci, popø.&nbsp;pøidávat vyrovnávací pamìti/cache).</p>

<img src="http://i.iinfo.cz/images/308/comp-hist-61-1.jpg" width="450" height="345" alt=" " />
<p><i>Obrázek 2: Superpoèítaè CDC 7600 je pøedchùdcem superpoèítaèù
Cray.</i></p>



<p><a name="k02"></a></p>
<h2>2. Implementace instrukcí SIMD na mikroprocesorech RISC</h2>

<p>Prakticky ka¾dá významnìj¹í spoleènost (v&nbsp;pøípadì PowerPC pak dokonce
aliance) navrhující mikroprocesory s&nbsp;architekturou <i>RISC</i> pøi¹la
døíve èi pozdìji na trh s&nbsp;instrukèní sadou obsahující
&bdquo;vektorové&ldquo; instrukce, které jsou dnes souhrnnì oznaèovány zkratkou
<i>SIMD</i> (pùvodní vektorové instrukce pou¾ívané na superpoèítaèích jsou
v&nbsp;nìkterých ohledech flexibilnìj¹í, proto budeme pou¾ívat spí¹e zkratku
<i>SIMD</i>). Roz¹iøující instrukèní sady byly pojmenovávány nejrùznìj¹ími
názvy a zkratkami a nikdy vlastnì nedo¹lo &ndash; na rozdíl od platformy
<i>x86</i> &ndash; ke sjednocení tìchto instrukcí do jediné skupiny &bdquo;SIMD
pro RISC&ldquo;, co¾ je vlastnì logické, proto¾e procesory <i>RISC</i> jsou
mnohdy urèeny pro specializované oblasti pou¾ití, od vestavných (embedded)
systémù pøes smartphony a tablety a¾ po superpoèítaèe.</p>

<img src="http://i.iinfo.cz/images/491/pc147-2.jpg" width="220" height="220" alt=" " />
<p><i>Obrázek 3: Mikroprocesor HP PA-RISC 7300LC (PA=Precision Architecture).
Jedná se moderní variantu procesorù RISC se zabudovaným matematickým
koprocesorem a sadou 32bitových celoèíselných registrù a takté¾ 64bitových
registrù pro FPU operace.<br />
Zdroj: Wikipedia</i></p>

<p>Nejvýznamnìj¹í implementace instrukcí <i>SIMD</i> na mikroprocesorech
s&nbsp;architekturou <i>RISC</i>, a» ji¾ se jedná o instrukce urèené pro
operace s&nbsp;celými èísly èi s&nbsp;èísly reálnými (pøesnìji øeèeno
s&nbsp;plovoucí øádovou èárkou), jsou vypsány v&nbsp;následující tabulce:</p>

<table>
<tr><th>#</th><th>Zkratka/název</th><th>Plný název</th><th>Rodina procesorù</th></tr>
<tr><td>1</td><td>MAX-1  </td><td>Multimedia Acceleration eXtensions v1</td><td>HP-PA RISC    </td></tr>
<tr><td>2</td><td>MAX-2  </td><td>Multimedia Acceleration eXtensions v2</td><td>HP-PA RISC    </td></tr>
<tr><td>3</td><td>VIS 1  </td><td>Visual Instruction v1                </td><td>Set SPARC V9  </td></tr>
<tr><td>4</td><td>VIS 2  </td><td>Visual Instruction v2                </td><td>Set SPARC V9  </td></tr>
<tr><td>5</td><td>AltiVec</td><td>(obchodní názvy Velocity Engine, VMX)</td><td>PowerPC       </td></tr>
<tr><td>6</td><td>MDMX   </td><td>MIPS Digital Media eXtension (MaDMaX)</td><td>MIPS          </td></tr>
<tr><td>7</td><td>MIPS-3D</td><td>MIPS-3D                              </td><td>MIPS          </td></tr>
<tr><td>8</td><td>MVI    </td><td>Motion Video Instructions            </td><td>DEC Alpha     </td></tr>
<tr><td>9</td><td>NEON   </td><td>Advanced SIMD                        </td><td>Cortex (ARMv7)</td></tr>
</table>

<img src="http://i.iinfo.cz/images/394/pc146-6.png" width="220" height="198" alt=" " />
<p><i>Obrázek 4: Jedna z&nbsp;mnoha 64bitových variant mikroprocesoru
vyu¾ívajícího instrukèní sadu MIPS.</i></p>



<p><a name="k03"></a></p>
<h2>3. Malé historické porovnání: SIMD na RISC vs. CISC</h2>

<p>RISCové procesory jsou i &ndash; i pøes své velké roz¹íøení v&nbsp;rùzných
typech elektronických zaøízení &ndash; mezi odbornou veøejností ponìkud ménì
známé, ne¾ na desktop orientované mikroprocesory øady <i>x86</i> a dnes takté¾
<i>x86_64</i>. Ménì známý je i fakt, ¾e instrukce typu <i>SIMD</i> byly, jak
jsme si ji¾ øekli v&nbsp;úvodní kapitole, poprvé implementovány právì na
mikroprocesorech s&nbsp;architekturou <i>RISC</i> a teprve o pøibli¾nì dva roky
pozdìji se ji¾ existujícími instrukèními sadami nechala inspirovat firma
<i>Intel</i> pøi návrhu své instrukèní sady <i>MMX</i>. Ostatnì podívejme se na
doby vzniku nìkterých instrukèních sad se <i>SIMD</i> instrukcemi ve svìtì
<i>RISC</i>:</p>

<table>
<tr><th>#</th><th>Název technologie</th><th>Rodina procesorù</th><th>Rok uvedení</th><th>Pøed x86?</th></tr>
<tr><td>1</td><td>MAX-1  </td><td>HP-PA RISC</td><td>1994</td><td>ano</td></tr>
<tr><td>2</td><td>MAX-2  </td><td>HP-PA RISC</td><td>1996</td><td>ne</td></tr>
<tr><td>3</td><td>VIS 1  </td><td>SPARC V9  </td><td>1994</td><td>ano</td></tr>
<tr><td>4</td><td>VIS 2  </td><td>SPARC V9  </td><td>1999</td><td>ne</td></tr>
<tr><td>5</td><td>AltiVec</td><td>PowerPC   </td><td>1998</td><td>ne</td></tr>
<tr><td>6</td><td>MDMX   </td><td>MIPS      </td><td>1996</td><td>ne</td></tr>
<tr><td>7</td><td>MIPS-3D</td><td>MIPS      </td><td>1999</td><td>ne</td></tr>
<tr><td>8</td><td>MVI    </td><td>DEC Alpha </td><td>1995</td><td>ano</td></tr>
</table>

<img src="http://i.iinfo.cz/images/161/pc159-5.jpg" width="242" height="208" alt="&#160;" />
<p><i>Obrázek 5: Pohled na mikroprocesor AMD K6-2 s&nbsp;implementací
instrukèní sady 3DNow! obsahující SIMD instrukce.</i></p>

<p>Pro historické porovnání si je¹tì uveïme, ve kterých letech byly
nejdùle¾itìj¹í instrukèní sady se <i>SIMD</i> instrukcemi uvedeny na platformì
<i>x86</i>, tj.&nbsp;pøedev¹ím na mikroprocesorech navrhovaných a vyrábìných
spoleènostmi <i>Intel</i> a <i>AMD</i>. Z&nbsp;této tabulky je zøejmé, ¾e
technologie <i>SIMD</i> byla na platformì <i>x86</i> skuteènì uvedena o nìco
pozdìji, ne¾ tomu bylo u nìkterých rodin mikroprocesorù s&nbsp;architekturou
<i>RISC</i>:</p>

<table>
<tr><th>#</th><th>Název technologie</th><th>Spoleènost</th><th>Rok uvedení</th><th>Poprvé pou¾ito v&nbsp;èipu</th></tr>
<tr><td>1</td><td>MMX   </td><td>Intel    </td><td>1996 </td><td>Intel Pentium P5</td></tr>
<tr><td>2</td><td>3DNow!</td><td>AMD      </td><td>1998 </td><td>AMD K6-2</td></tr>
<tr><td>3</td><td>SSE   </td><td>Intel    </td><td>1999 </td><td>Intel Pentium III (mikroarchitektura P6)</td></tr>
<tr><td>4</td><td>SSE2  </td><td>Intel    </td><td>2001 </td><td>Intel Pentium 4 (mikroarchitektura NetBurst)</td></tr>
<tr><td>5</td><td>SSE3  </td><td>Intel    </td><td>2004 </td><td>Intel Pentium 4 (Prescott)</td></tr>
<tr><td>6</td><td>SSSE3 </td><td>Intel    </td><td>2006 </td><td>mikroarchitektura Intel Core</td></tr>
<tr><td>7</td><td>SSE4  </td><td>Intel+AMD</td><td>2006 </td><td>AMD K10 (SSE4a) , mikroarchitektura Intel Core</td></tr>
</table>

<a href="http://i.iinfo.cz/images/394/pc146-7.jpg"><img src="http://i.iinfo.cz/images/394/pc146-7-prev.jpg" width="370" height="197" alt=" " /></a>
<p><i>Obrázek 6: Interní struktura mikroprocesorù SPARC, na ní¾ mù¾eme najít
jak moduly pro práci s&nbsp;celými èísly, tak i moduly FPU. Mikroprocesory
SPARC, popø.&nbsp;MicroSPARC a SuperSPARC mají své koøeny v&nbsp;popisované
architektuøe RISC 1.</i></p>



<p><a name="k04"></a></p>
<h2>4. SIMD instrukce na RISCových mikroprocesorech øady MIPS</h2>

<p>Instrukce typu <i>SIMD</i> se zaèaly relativnì brzy vyu¾ívat i na
mikroprocesorech <i>MIPS</i>, pøièem¾ se jednalo o roz¹íøení instrukèní sady
<i>MIPS V</i>. Tímto jménem je oznaèována pátá revize architektury <i>MIPS
(Microprocessor without Interlocked Pipeline Stages)</i>, s&nbsp;ní¾ jsme se
ji¾ <a href="http://www.root.cz/serialy/co-se-deje-v-pocitaci/">v&nbsp;seriálu
o architekturách poèítaèù</a> <a
href="http://www.root.cz/clanky/procesory-s-architekturou-risc-v-pracovnich-stanicich-a-serverech/">podrobnìji
seznámili</a>. Pùvodní architektura <i>MIPS</i> pøedstavovaná mikroprocesory
<i>R2000</i> (rok vzniku 1985) a <i>R3000</i> (rok vzniku 1988) byla typickou
ukázkou èisté 32bitové technologie <i>RISC</i> s&nbsp;jednoduchými instrukcemi
s&nbsp;pevným formátem o ¹íøce 32 bitù (jednalo se o instrukce provádìné nad
skalárními hodnotami). Aby bylo mo¾né ka¾dý krok instrukce provést
v&nbsp;pìtiøezové instrukèní pipeline za jediný takt, neobsahovaly tyto
mikroprocesory ani instrukce se slo¾itými adresovacími re¾imy, ani instrukce
pro celoèíselné násobení a dìlení.</p>

<img src="http://i.iinfo.cz/images/582/pc9903.jpg" width="400" height="285" alt="pc9903" />
<p><i>Obrázek 7: Výkonná a na dobu svého vzniku revoluèní grafická stanice Onyx
2 vybavená systémem Infinite Reality. Tato grafická stanice je postavena na
bázi mikroprocesorù R10000 vycházejících z&nbsp;pùvodní architektury
MIPS.</i></p>

<p>V&nbsp;dal¹ích revizích architektury <i>MIPS</i> v¹ak docházelo
k&nbsp;postupnému roz¹iøování instrukèní sady a tím pádem i k&nbsp;pøidávání
dal¹ích funkèních jednotek buï pøímo na èip s&nbsp;mikroprocesorem, nebo na
dal¹í pomocné èipy (koprocesory). Instrukèní sada byla roz¹íøena zejména o ji¾
zmínìné instrukce pro násobení a dìlení (které se ve skuteènosti provádìly mimo
vlastní pipeline ve <a
href="http://programmedlessons.org/AssemblyTutorial/Chapter-14/ass14_3.html">specializované
jednotce</a> a s&nbsp;vyu¾itím dvojice specializovaných registrù), ale i o
instrukce matematického koprocesoru a posléze i o instrukce typu <i>SIMD</i>
(nìkteøí odborníci se domnívají, ¾e tím procesory <i>MIPS</i> ztratily jak
svoji jednoduchost, tak i urèitou eleganci). V&nbsp;roce 1996 byly pøedstaveny
první èipy implementující roz¹iøující instrukèní sadu <i>MDMX</i> neboli
<i>MIPS Digital Media eXtension</i>. Tato instrukèní sada byla o tøi roky
pozdìji následována dal¹í roz¹iøující instrukèní sadou s&nbsp;v¹eøíkajícím
názvem <i>MIPS-3D</i>. Obì tyto technologie budou popsány v&nbsp;navazujících
kapitolách.</p>

<a href="http://i.iinfo.cz/images/411/pc9906.jpg"><img src="http://i.iinfo.cz/images/411/pc9906-prev.jpg" width="370" height="95" alt="pc9906" /></a>
<p><i>Obrázek 8: Laboratoø specializovaná na simulace a vizualizace, její¾
nezbytnou souèástí jsou stroje Onyx 2 Infinite Reality, co¾ znamená, ¾e se
jedná o dal¹í zpùsob vyu¾ití mikroprocesorù s&nbsp;architekturou RISC a
souèasnì i o jednu z&nbsp;oblastí, kde je mo¾né vyu¾ívat SIMD instruce.</i></p>



<p><a name="k05"></a></p>
<h2>5. Roz¹iøující instrukèní sada MDMX (MaDMaX)</h2>

<p>Instrukèní sada <i>MDMX (MIPS Digital Media eXtension)</i>, nazývaná takté¾
<i>MaDMaX</i>, se v&nbsp;mnoha ohledech podobá technologii <i>MMX</i>,
s&nbsp;ní¾ jsme se ji¾ v&nbsp;tomto seriálu seznámili. Podobností mezi obìma
zmínìnými technologiemi mù¾eme nalézt celou øadu &ndash; týká se jak orientace
na operace provádìné pouze s&nbsp;celými èísly, tak i existence instrukcí pro
aritmetické operace souètu a rozdílu se saturací i o vyu¾ití registrù urèených
pùvodnì pro operace matematického koprocesoru (co¾ mj.&nbsp;zaji¹»uje zpìtnou
kompatibilitu s&nbsp;existujícími operaèními systémy). Podívejme se v¹ak na
instrukèní sadu <i>MDMX</i> ponìkud podrobnìji. Tato technologie byla navr¾ena
s&nbsp;ohledem na to, aby ji bylo mo¾né snadno vyu¾ít k&nbsp;urychlení rùzných
rastrových operací i operací provádìných s&nbsp;audio daty. U rastrových
operací (operací provádìných s&nbsp;pixely obrazu) se uva¾ovalo i o diskrétní
kosinové transformaci (<i>DCT</i>) a inverzní diskrétní kosinové transformaci
pou¾ívané mj.&nbsp;i u formátu <i>JFIF/JPEG</i>.</p>

<img src="http://i.iinfo.cz/images/38/pc-160-09.png" width="461" height="117" alt="&#160;" />
<p><i>Obrázek 9: První typ MDMX instrukcí: instrukce typu &bdquo;vector to
vector&ldquo;.</i></p>

<p>Z&nbsp;tohoto dùvodu pracují instrukce <i>MDMX</i> s&nbsp;celoèíselnými
osmibitovými hodnotami (bajty), popø.&nbsp;se ¹estnáctibitovými hodnotami
(polovièními slovy). Tyto hodnoty jsou umístìny do vektorù konstantní délky
pøedstavovanými 64bitovými registry pùvodnì urèenými pouze pro matematický
koprocesor mikroprocesorù <i>MIPS</i>. Snadno mù¾eme spoèítat, ¾e pøi ulo¾ení
osmibitových prvkù (pojmenovaných <strong>OB</strong> &ndash; <i>oct byte</i>)
do vektoru pøedstavovaného 64bitovým registrem má tento vektor délku osm prvkù
a pøi ulo¾ení ¹estnáctibitových prvkù (<strong>QH</strong> &ndash; <i>quad
half</i>) má vektor délku ètyøi prvky. Jedná se tedy o formáty podobné tìm,
které mù¾eme nalézt i u instrukèní sady <i>MMX</i>, ov¹em jsou zde dva rozdíly
&ndash; v&nbsp;<i>MDMX</i> nejsou podporovány operace s&nbsp;32bitovými a
64bitovými hodnotami, na druhou stranu se v¹ak pro ulo¾ení 64bitových vektorù
mù¾e vyu¾ít kterýkoli registr matematického koprocesoru, kterých je na
architektuøe <i>MIPS</i> celkem 32, co¾ je velký rozdíl oproti pouhým osmi
registrùm v&nbsp;pøípadì instrukcí <i>MMX</i>.</p>

<img src="http://i.iinfo.cz/images/149/pc-160-10.png" width="461" height="142" alt="&#160;" />
<p><i>Obrázek 10: První typ MDMX instrukcí: instrukce typu &bdquo;vector to
scalar&ldquo;</i></p>



<p><a name="k06"></a></p>
<h2>6. Nové operace implementované v&nbsp;instrukèní sadì MDMX</h2>

<p>V&nbsp;instrukèní sadì mikroprocesorù s&nbsp;architekturou <i>MIPS</i> do¹lo
kvùli implementaci technologie <i>MDMX</i> k&nbsp;roz¹íøení významu nìkterých
instrukcí a samozøejmì té¾ k&nbsp;pøidání instrukcí nových. Upraveny byly
pøedev¹ím aritmetické instrukce <strong>ADD</strong>, <strong>SUB</strong>,
<strong>MUL</strong>, <strong>MIN</strong> a <strong>MAX</strong>, které
v&nbsp;pøípadì vyu¾ití pøíznakù <strong>OB</strong> (<i>oct byte</i>) èi
<strong>QH</strong> (<i>quad half</i>) pracují nad ètyøprvkovými
popø.&nbsp;osmiprvkovými vektory a navíc s&nbsp;aritmetikou se saturací, kdy
nedochází k&nbsp;pøeteèení ani podteèení. Podporovány jsou tøi nové re¾imy
instrukcí. První re¾im se nazývá &bdquo;vector to vector&ldquo; a nejde o nic
jiného, ne¾ o re¾im, v&nbsp;nìm¾ se operace provádí s&nbsp;dvojicí vektorù a
výsledkem operace je vìt¹inou opìt vektor. Druhý re¾im je nazývaný
&bdquo;vector to scalar&ldquo;. V&nbsp;tomto re¾imu lze vybrat kterýkoli prvek
z&nbsp;vektorového registru a provést operaci s&nbsp;tímto prvkem zkombinovaným
s&nbsp;libovolným skalárním registrem. Tøetí re¾im &bdquo;vector to
immediate&ldquo; slou¾í k&nbsp;provedení operace nad vektorem zkombinovaným
s&nbsp;konstantou.</p>

<img src="http://i.iinfo.cz/images/151/pc-160-11.png" width="461" height="103" alt="&#160;" />
<p><i>Obrázek 11: Tøetí typ MDMX instrukcí: instrukce typu &bdquo;vector to
immediate&ldquo;</i></p>

<p>Nìkteré operace mohou nastavovat pøíznaky (<i>flags</i>). Z&nbsp;tohoto
dùvodu je v&nbsp;technologii <i>MDMX</i> implementován i vektor obsahující osm
jednobitových prvkù, do nìj¾ se mohou pøíznaky ukládat. Tento vektor je mapován
do registru pøíznakù matematického koprocesoru; dùvodem je opìt kompatibilita
se star¹ími operaèními systémy. Se ètveøicí nebo osmicí jednobitových pøíznakù
pracují porovnávací instrukce <strong>C.EQ</strong>, <strong>C.LT</strong> a
<strong>C.LE</strong>, jejich¾ význam je pravdìpodobnì zøejmý (EQ=equals,
LT=less than, LE=less or equal). Dal¹í tøi relaèní (porovnávací) operace lze
implementovat prostým otoèením operandù nebo bitovou negací vektoru
s&nbsp;bitovými pøíznaky (navíc instrukce vyu¾ívající vektor pøíznakù doká¾ou
pracovat jak s&nbsp;pøímými hodnotami, tak i s&nbsp;hodnotami negovanými).
Dal¹í skupinou instrukcí upravených pro vyu¾ití technologie <i>MDMX</i> jsou
instrukce <strong>ALNI</strong> a <strong>ALNV</strong> slou¾ící pro zarovnání
(bitový posun) vektorù a instrukce pro operace s&nbsp;akumulátorem, které budou
popsány v&nbsp;navazující kapitole.</p>

<a href="http://i.iinfo.cz/images/41/pc-160-12.png"><img src="http://i.iinfo.cz/images/41/pc-160-12-prev.png" width="370" height="127" alt="&#160;" /></a>
<p><i>Obrázek 12: Zpùsob zakódování nových èi modifikovaných MDMX
instrukcí.</i></p>



<p><a name="k07"></a></p>
<h2>7. Problémy provázející operaci multiply &amp; accumulate (MAC)</h2>

<p>Dal¹í instrukce, které byly na platformu <i>MIPS</i> pøidány, jsou urèeny
pro práci s&nbsp;takzvaným &bdquo;¹irokým akumulátorem&ldquo; (<i>wide
accumulator</i>). Jedná se o technologii urèenou pøedev¹ím pro usnadnìní
násobení s&nbsp;akumulací výsledku, která je implementovaná i na moderních
digitálních signálových procesorech. Operace násobení (následovaná akumulací
výsledku), jen¾ je velmi èasto pou¾ívaná v&nbsp;mnoha algoritmech pro
zpracování audio i video signálu, toti¾ vede k&nbsp;tomu, ¾e poèet bitù
výsledku obecnì odpovídá souètu bitù obou operandù, co¾ napøíklad znamená, ¾e
pøi násobení dvou osmibitových èísel je nutné výsledek ulo¾it do 16bitového
slova (naproti tomu u sèítání následujícího za násobením se poèet bitù zvý¹í
pouze o jednièku; tento pøebývající bit je typicky ukládán do pøíznakového bitu
<i>carry</i>). Pro operace násobení lze zvolit nìkolik typù <i>SIMD</i>
instrukcí. V&nbsp;instrukèní sadì <i>MMX</i> se jedná napøíklad o instrukci
<strong>PMADDWD</strong> provádìjící násobení a souèet (akumulaci) výsledku,
ov¹em výsledek násobení dvou 16bitových slov je ulo¾en do 32 bitù, co¾ pomìrnì
zásadním zpùsobem sni¾uje paralelismus této operace.</p>

<a href="http://i.iinfo.cz/images/579/pc-160-13.png"><img src="http://i.iinfo.cz/images/579/pc-160-13-prev.png" width="370" height="117" alt="&#160;" /></a>
<p><i>Obrázek 13: Nové instrukce urèené pro práci se ¹irokým
akumulátorem<br />
Zdroj: Digital, MIPS Add Multimedia Extensions Digital Focuses on Video, MIPS
on 3D Graphics; Vendors Debate Differences</i></p>



<p><a name="k08"></a></p>
<h2>8. Operace provádìné se &bdquo;¹irokým akumulátorem&ldquo;</h2>

<p>V&nbsp;pøípadì instrukèní sady <i>MDMX</i> byla zvolena jiná technologie
zalo¾ená na ji¾ zmínìném &bdquo;¹irokém akumulátoru&ldquo;, co¾ je registr
s&nbsp;opravdu velkou ¹íøkou &ndash; celých 192 bitù. Tento speciální registr
mù¾e být rozdìlen na osm 24bitových slov, popøípadì na ètyøi 48bitová slova.
Tyto bitové ¹íøky jednotlivých prvkù osmiprvkového èi ètyøprvkového vektoru
zaruèují, ¾e lze provést 256 násobení typu 8&times;8 bitù, popø.&nbsp;65536
násobení typu 16&times;16 bitù, ani¾ by do¹lo k&nbsp;pøeteèení postupnì
akumulovaného výsledku. K&nbsp;dispozici jsou samozøejmì instrukce, které
doká¾ou do tohoto akumulátoru ulo¾it data, popø.&nbsp;data vyzvednout, a to se
souèasným provedením v¹ech potøebných konverzí (bitových posunù a maskování).
Jedinou nevýhodou této technologie je existence pouze jednoho ¹irokého
akumulátoru, co¾ napøíklad znamená, ¾e optimalizace spoèívající
v&nbsp;rozbalení smyèek nemusí být tak úèinná jako v&nbsp;jiných pøípadech,
proto¾e se nutnost práce jen s&nbsp;jedním akumulátorem stává úzkým hrdlem
systému &ndash; nicménì bez existence ¹irokého akumulátoru by byla situace
je¹tì hor¹í.</p>

<a href="http://i.iinfo.cz/images/394/pc-160-14.png"><img src="http://i.iinfo.cz/images/394/pc-160-14-prev.png" width="370" height="137" alt="&#160;" /></a>
<p><i>Obrázek 14: Porovnání základních vlastností nìkterých instrukèních sad se
SIMD instrukcemi.<br />
Zdroj: Digital, MIPS Add Multimedia Extensions Digital Focuses on Video, MIPS
on 3D Graphics; Vendors Debate Differences</i></p>



<p><a name="k09"></a></p>
<h2>9. Odkazy na Internetu</h2>

<ol>

<li>NEON<br />
<a href="http://www.arm.com/products/processors/technologies/neon.php">http://www.arm.com/products/processors/technologies/neon.php</a>
</li>

<li>Architecture and Implementation of the ARM Cortex-A8 Microprocessor<br />
<a href="http://www.design-reuse.com/articles/11580/architecture-and-implementation-of-the-arm-cortex-a8-microprocessor.html">http://www.design-reuse.com/articles/11580/architecture-and-implementation-of-the-arm-cortex-a8-microprocessor.html</a>
</li>

<li>Multimedia Acceleration eXtensions (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/Multimedia_Acceleration_eXtensions">http://en.wikipedia.org/wiki/Multimedia_Acceleration_eXtensions</a>
</li>

<li>AltiVec (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/AltiVec">http://en.wikipedia.org/wiki/AltiVec</a>
</li>

<li>Visual Instruction Set (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/Visual_Instruction_Set">http://en.wikipedia.org/wiki/Visual_Instruction_Set</a>
</li>

<li>MAJC (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/MAJC">http://en.wikipedia.org/wiki/MAJC</a>
</li>

<li>MDMX (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/MDMX">http://en.wikipedia.org/wiki/MDMX</a>
</li>

<li>MIPS Multiply Unit<br />
<a href="http://programmedlessons.org/AssemblyTutorial/Chapter-14/ass14_3.html">http://programmedlessons.org/AssemblyTutorial/Chapter-14/ass14_3.html</a>
</li>

<li>Silicon Graphics Introduces Enhanced MIPS Architecture<br />
<a href="http://bwrc.eecs.berkeley.edu/CIC/otherpr/enhanced_mips.html">http://bwrc.eecs.berkeley.edu/CIC/otherpr/enhanced_mips.html</a>
</li>

<li>MIPS-3D (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/MIPS-3D">http://en.wikipedia.org/wiki/MIPS-3D</a>
</li>

<li>MIPS Technologies, Inc. announces new MIPS-3D technology to provide silicon-efficient 3D graphics acceleration<br />
<a href="http://www.design-reuse.com/news/2057/mips-mips-3d-technology-silicon-efficient-3d-graphics-acceleration.html">http://www.design-reuse.com/news/2057/mips-mips-3d-technology-silicon-efficient-3d-graphics-acceleration.html</a>
</li>

<li>MIPS-3D Built-in Function (gcc.gnu.org)<br />
<a href="http://gcc.gnu.org/onlinedocs/gcc/MIPS_002d3D-Built_002din-Functions.html">http://gcc.gnu.org/onlinedocs/gcc/MIPS_002d3D-Built_002din-Functions.html</a>
</li>

<li>
Baha Guclu Dundar:<br />
Intel MMX, SSE, SSE2, SSE3/SSSE3/SSE4 Architectures
</li>

<li>
SSE (Streaming SIMD Extentions)<br />
<a href="http://www.songho.ca/misc/sse/sse.html">http://www.songho.ca/misc/sse/sse.html</a>
</li>

<li>
Timothy A. Chagnon: SSE and SSE2<br />
<a href="http://www.cs.drexel.edu/~tc365/mpi-wht/sse.pdf">http://www.cs.drexel.edu/~tc365/mpi-wht/sse.pdf</a>
</li>

<li>
Intel corporation: Extending the Worldr's Most Popular Processor Architecture<br />
<a href="http://download.intel.com/technology/architecture/new-instructions-paper.pdf">http://download.intel.com/technology/architecture/new-instructions-paper.pdf</a>
</li>

<li>
SIMD architectures:<br />
<a href="http://arstechnica.com/old/content/2000/03/simd.ars/">http://arstechnica.com/old/content/2000/03/simd.ars/</a>
</li>

<li>
Tour of the Black Holes of Computing!: Floating Point<br />
<a href="http://www.cs.hmc.edu/~geoff/classes/hmc.cs105.../slides/class02_floats.ppt">http://www.cs.hmc.edu/~geoff/classes/hmc.cs105.../slides/class02_floats.ppt</a>
</li>

<li>3Dnow! Technology Manual<br />
AMD Inc., 2000</li>

<li>Intel MMX<sup>TM</sup> Technology Overview<br />
Intel corporation, 1996</li>

<li>MultiMedia eXtensions<br />
<a href="http://softpixel.com/~cwright/programming/simd/mmx.php">http://softpixel.com/~cwright/programming/simd/mmx.php</a>i
</li>

<li>AMD K5 ("K5" / "5k86")<br />
<a href="http://www.pcguide.com/ref/cpu/fam/g5K5-c.html">http://www.pcguide.com/ref/cpu/fam/g5K5-c.html</a>
</li>

<li>Sixth Generation Processors<br />
<a href="http://www.pcguide.com/ref/cpu/fam/g6.htm">http://www.pcguide.com/ref/cpu/fam/g6.htm</a>
</li>

<li>Great Microprocessors of the Past and Present<br />
<a href="http://www.cpushack.com/CPU/cpu1.html">http://www.cpushack.com/CPU/cpu1.html</a>
</li>

<li>Very long instruction word (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/Very_long_instruction_word">http://en.wikipedia.org/wiki/Very_long_instruction_word</a>
</li>

<li>CPU design (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/CPU_design">http://en.wikipedia.org/wiki/CPU_design</a>
</li>

<li>Control unit (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/Control_unit">http://en.wikipedia.org/wiki/Control_unit</a>
</li>

<li>Cray History<br />
<a href="http://www.cray.com/About/History.aspx?404;http://www.cray.com:80/about_cray/history.html">http://www.cray.com/About/History.aspx?404;http://www.cray.com:80/about_cray/history.html</a>
</li>

<li>Cray Historical Timeline<br />
<a href="http://www.cray.com/Assets/PDF/about/CrayTimeline.pdf">http://www.cray.com/Assets/PDF/about/CrayTimeline.pdf</a>
</li>

<li>Computer Speed Claims 1980 to 1996<br />
<a href="http://homepage.virgin.net/roy.longbottom/mips.htm">http://homepage.virgin.net/roy.longbottom/mips.htm</a>
</li>

<li>Superpoèítaèe Cray<br />
<a href="http://www.root.cz/clanky/superpocitace-cray/">http://www.root.cz/clanky/superpocitace-cray/</a>
</li>

<li>Superpoèítaèe Cray (druhá èást)<br />
<a href="http://www.root.cz/clanky/superpocitace-cray-druha-cast/">http://www.root.cz/clanky/superpocitace-cray-druha-cast/</a>
</li>

<li>Superpoèítaèe Cray (tøetí èást)<br />
<a href="http://www.root.cz/clanky/superpocitace-cray-treti-cast/">http://www.root.cz/clanky/superpocitace-cray-treti-cast/</a>
</li>

<li>Superpoèítaèe Cray (ètvrtá èást)<br />
<a href="http://www.root.cz/clanky/superpocitace-cray-ctvrta-cast/">http://www.root.cz/clanky/superpocitace-cray-ctvrta-cast/</a>
</li>

<li>Superpoèítaèe Cray (pátá èást): architektura Cray X-MP<br />
<a href="http://www.root.cz/clanky/superpocitace-cray-pata-cast-architektura-pocitace-cray-x-mp-a-jeho-pouziti-ve-filmovem-prumyslu/">http://www.root.cz/clanky/superpocitace-cray-pata-cast-architektura-pocitace-cray-x-mp-a-jeho-pouziti-ve-filmovem-prumyslu/</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Ti¹novský</a> &nbsp; 2011</small></p>
</body>
</html>

