<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Vykreslování 3D scén grafickým akcelerátorem Intel 740</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Vykreslování 3D scén grafickým akcelerátorem Intel 740</h1>

<h3>Pavel Ti¹novský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V dne¹ní èásti seriálu o architekturách poèítaèù se budeme zabývat zpùsobem vykreslování prostorových (3D) scén grafickým akcelerátorem Intel 740 spolu s podrobnìj¹ím popisem celého vykreslovacího øetìzce (rendering pipeline) i nìkterých unikátních vlastností tohoto grafického akcelerátoru.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Vykreslování 3D scén grafickým akcelerátorem Intel 740</a></p>
<p><a href="#k02">2. Podporované grafické re¾imy</a></p>
<p><a href="#k03">3. Výstup na televizor</a></p>
<p><a href="#k04">4. Organizace pamìti vyu¾ívané grafickým akcelerátorem Intel 740</a></p>
<p><a href="#k05">5. Grafický øetìzec provádìjící vykreslování 3D scén</a></p>
<p><a href="#k06">6. Setup Engine</a></p>
<p><a href="#k07">7. Scan Converter</a></p>
<p><a href="#k08">8. Texture Pipeline</a></p>
<p><a href="#k09">9. Color Calculator</a></p>
<p><a href="#k10">10. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2>1. Vykreslování 3D scén grafickým akcelerátorem Intel 740</h2>

<p>V&nbsp;pøedchozí èásti seriálu o architekturách poèítaèù jsme si
mj.&nbsp;popsali i základní 2D operace, které jsou podporovány na grafickém
akcelerátoru <i>Intel 740</i>. Jedná se pøedev¹ím o podporu blokových pøenosù
obrazu bez zatí¾ení mikroprocesoru, které je provádìné funkèními bloky
nazvanými <i>Fixed Blitter (BLT)</i> a <i>Stretch Blitter (STRBLT)</i> spolu
s&nbsp;mo¾nou aplikací nìkterých rastrových operací (maskování bitù logickou
operací AND, aplikace bitové operace XOR, konverze z a do rùzných formátù
pixelù, expanze barev, zvìt¹ení èi zmen¹ení obrázku, výplò èástí obrazu aj.)
v&nbsp;prùbìhu blokového pøenosu. Mezi dal¹í podporované 2D operace patøí
zobrazení kurzorù my¹i, jejich¾ velikost se mù¾e pohybovat od 32&times;32
pixelù a¾ po &bdquo;maxikurzory&ldquo; majícími velikost 128&times;128 pixelù.
Tato èást grafického akcelerátoru <i>Intel 740</i> je pomìrnì intenzivnì
vyu¾ívána operaèními systémy pøi zobrazení grafického u¾ivatelského rozhraní
(napøíklad pøesuny oken lze realizovat sekvencí blokových operací provádìných
modulem <i>Fixed Blitter</i>).</p>

<img src="http://i.iinfo.cz/images/201/pc9508.jpg" width="283" height="227" alt="pc9508" />
<p><i>Obrázek 1: Grafická karta s&nbsp;èipem Intel 740. Jedná se o jednu
z&nbsp;prvních grafických karet, která dokázala v&nbsp;plné míøe vyu¾ít
vlastností pøenosového kanálu AGP (Accelerated Graphics Port).</i></p>

<p>Minule jsme si takté¾ øekli, ¾e vykreslovací øetìzec (<i>rendering
pipeline</i> nebo pouze <i>pipeline</i>) provádìjící ve¹keré grafické operace
je na akcelerátoru <i>Intel 740</i> rozdìlen do dvou relativnì nezávisle
pracujících èástí &ndash; èást provádìjící 2D operace (viz pøedchozí odstavec)
a èást urèenou pro vykreslování prostorových (3D) scén. Dnes se budeme zabývat
popisem druhé èásti vykreslovacího øetìzce, tj.&nbsp;zpracováním prostorových
scén: výpoètem osvìtlení, Gouraudovým stínováním, texturovací jednotkou (vèetnì
popisu MIP map), rasterizaèní jednotkou, operací s&nbsp;barvami pøi rasterizaci
tìles atd. Zajímavá je také organizace pamìti vyu¾ívaná tímto grafickým
akcelerátorem, která sice vyu¾ívala v¹ech pøedností pøenosového kanálu
<i>AGP</i> (z&nbsp;pohledu firmy Intel se jednalo o technologické demo), na
druhou stranu v¹ak chyba v&nbsp;návrhu zpùsobila, ¾e vykreslování slo¾itìj¹ích
otexturovaných tìles mohlo být zpomaleno kvùli neustálým pøesunùm dat mezi
operaèní pamìtí poèítaèe a grafickým akcelerátorem.</p>

<a href="http://i.iinfo.cz/images/378/pc9602.png"><img src="http://i.iinfo.cz/images/378/pc9602-prev.png" width="370" height="226" alt="pc9602" /></a>
<p><i>Obrázek 2: Bloková struktura èipu Intel 740 spolu s&nbsp;jeho vstupními a
výstupními rozhraními a interními pøenosovými kanály.</i></p>



<p><a name="k02"></a></p>
<h2>2. Podporované grafické re¾imy</h2>

<p>Grafický akcelerátor <i>Intel 740</i> umo¾òoval pou¾ití mnohem vìt¹ího poètu
grafických re¾imù, ne¾ tomu bylo u minule a pøedminule popsaného grafického
akcelerátoru <i>Voodoo 1</i>. Je to ostatnì logické &ndash; zatímco <i>Voodoo
1</i> byl urèen pouze pro vykreslování prostorových scén s&nbsp;tím, ¾e o bì¾né
zobrazení grafického u¾ivatelského rozhraní se postará bì¾ná grafická karta
(<i>VGA</i>, <i>SVGA</i>) zapojená do &bdquo;série&ldquo;, byl grafický
akcelerátor <i>Intel 740</i> vybaven, jak jsme si ji¾ øekli, 2D i 3D èástí,
pøièem¾ doba pøístupu do video pamìti i rychlost digitálnì-analogového
pøevodníku umo¾òovala dosáhnout mnohem vy¹¹ích rozli¹ení i obnovovacích
frekvencí obrazu (dnes se ji¾ tato velièina díky pou¾ití LCD monitorù
nezvy¹uje, ov¹em pøi vyu¾ití monitorù vybavených obrazovkami CRT se za
ergonomické frekvence pova¾ovalo minimálnì 75 Hz, radìji v¹ak 85 Hz).
V&nbsp;následující tabulce jsou vypsána jak podporovaná rozli¹ení, tak i
maximální obnovovací frekvence obrazu pøi pou¾ití rùzných barevných hloubek
(minimální obnovovací frekvence jsou rovny 60 Hz a v&nbsp;nìkterých re¾imech
pouze 56 Hz):</p>

<table>
<tr><th>Rozli¹ení</th><th>8bpp</th><th>16bpp (hi-color)</th><th>24bpp (true color)</th></tr>
<tr><td> 320&times; 200</td><td>85 Hz</td><td>85 Hz</td><td>85 Hz</td></tr>
<tr><td> 320&times; 240</td><td>85 Hz</td><td>85 Hz</td><td>85 Hz</td></tr>
<tr><td> 512&times; 384</td><td>85 Hz</td><td>85 Hz</td><td>85 Hz</td></tr>
<tr><td> 640&times; 350</td><td>85 Hz</td><td>85 Hz</td><td>85 Hz</td></tr>
<tr><td> 640&times; 480</td><td>85 Hz</td><td>85 Hz</td><td>85 Hz</td></tr>
<tr><td> 800&times; 600</td><td>85 Hz</td><td>85 Hz</td><td>85 Hz</td></tr>
<tr><td>1024&times; 768</td><td>85 Hz</td><td>85 Hz</td><td>85 Hz</td></tr>
<tr><td>1280&times;1024</td><td>85 Hz</td><td>75 Hz</td><td>&times;</td></tr>
<tr><td>1600&times;1200</td><td>75 Hz</td><td>&times;</td><td>&times;</td></tr>
</table>

<p>Jak je z&nbsp;vý¹e uvedené tabulky patrné, nìkteré kombinace rozli¹ení a
barevné hloubky nejsou podporovány. Jedná se o omezení dané rychlostí
grafického øetìzce pøi naèítání hodnot pixelù z&nbsp;framebufferu a jejich
posílání na digitálnì-analogový pøevodník. Napøíklad v&nbsp;grafickém re¾imu
s&nbsp;rozli¹ením 1600&times;1200 pixelù, barevnou hloubkou 8bpp (maximálnì 256
barev, jde o grafický re¾im s&nbsp;barvovou paletou) a obnovovací frekvenci
obrazu 75 Hz je nutné za jednu sekundu naèíst a pøenést celkem
1600&times;1200&times;75=144000000 bajtù, tj.&nbsp;cca 137 MB, pøièem¾
digitálnì-analogový pøevodník zabudovaný na èipu má mezní frekvenci 220
MHz.</p>



<p><a name="k03"></a></p>
<h2>3. Výstup na televizor</h2>

<p>Kromì generování signálù kompatibilních s&nbsp;poèítaèovými monitory
(podpora &bdquo;analogového&ldquo; rozhraní pou¾ívaného kartami VGA a SVGA)
umo¾òuje grafický akcelerátor <i>Intel 740</i> i výstup obrazu na televizor.
Ov¹em samotný èip <i>740</i> negeneruje pøímo video signál urèený pro pøipojení
televizoru (S-video apod.). Namísto toho je vybaven specializovanou
dvanáctibitovou datovou sbìrnicí urèenou pro pøipojení èipu, který se o
generování potøebných signálù postará sám. Jedná se napøíklad o èip
<i>BT869</i> firmy Rockwell (podobné èipy v¹ak produkují i dal¹í výrobci). Po
zmínìné dvanáctibitové sbìrnici se pøená¹í informace o jednotlivých pixelech
kódované v&nbsp;bì¾ném 24bitovém formátu RGB. Pøi výstupu na televizor jsou
podporována následující rozli¹ení:</p>

<table>
<tr><th>Rozli¹ení</th></tr>
<tr><td>320&times;200</td></tr>
<tr><td>320&times;240</td></tr>
<tr><td>640&times;400</td></tr>
<tr><td>640&times;480</td></tr>
<tr><td>720&times;480</td></tr>
<tr><td>720&times;576</td></tr>
<tr><td>800&times;600</td></tr>
</table>

<img src="http://i.iinfo.cz/images/192/pc9603.png" width="410" height="242" alt="pc9603" />
<p><i>Obrázek 3: Zpùsob propojení grafického akcelerátoru Intel 740
s&nbsp;èipem BT869 (Rockwell), který zaji¹»uje generování signálù pro
televizory.</i></p>



<p><a name="k04"></a></p>
<h2>4. Organizace pamìti vyu¾ívané grafickým akcelerátorem Intel 740</h2>

<p>Grafický akcelerátor <i>Intel 740</i> pøi své práci (pøesnìji øeèeno pøi
vykreslování trojrozmìrných scén) vyu¾ívá dva typy pamìtí &ndash; pamì»
nainstalovanou pøímo na grafické kartì a èást operaèní (hlavní) pamìti
poèítaèe, která mù¾e obsahovat regiony mapované do adresového prostoru grafické
karty. V&nbsp;pamìti nainstalované na grafické kartì je ulo¾en celý
framebuffer, tj.&nbsp;pøedev¹ím pøední i zadní barvový buffer a pamì» hloubky
(<i>front (color) buffer, back (color) buffer, Z-buffer/depth buffer)</i>,
pøièem¾ zadní barvový buffer mù¾e být zdvojený, co¾ umo¾òuje napøíklad pou¾ití
tripple bufferingu (viz pøedchozí díly tohoto seriálu, v&nbsp;nich¾ jsme si
vysvìtlili princip <i>double bufferingu</i> i <i>tripple bufferingu</i>). Oba
zadní barvové buffery i pamì» hloubky mù¾e být vymazána blokovým zápisem, co¾
samozøejmì urychluje celý proces vykreslování (pøi bì¾ném postupu vykreslování
se jak právì aktivní zadní buffer tak i pamì» hloubky ma¾e pøed zaèátkem
vykreslování ka¾dého nového snímku, pouze pøi realizaci nìkterých efektù se
tento výmaz neprovádí).</p>

<p>Tvùrci grafického akcelerátoru <i>Intel 740</i> zvolili pøi jeho návrhu
ponìkud diskutabilní zpùsob ukládání textur. Namísto ulo¾ení textur pøímo
v&nbsp;pamì»ových modulech umístìných na grafickém akcelerátoru (jako je tomu
napøíklad u ji¾ popsaného grafického akcelerátoru <i>Voodoo 1</i>) se textury
ukládaly do operaèní pamìti, ze které byly v&nbsp;prùbìhu vykreslování postupnì
pøená¹eny do grafického vykreslovacího øetìzce (<i>pipeline</i>)
s&nbsp;vyu¾itím pøenosového protokolu, který umo¾òoval prokládání informací o
jednotlivých texelech dal¹ími pøená¹enými daty, napøíklad informacemi o
souøadnicích vrcholù jednotlivých trojúhelníkù, normálových vektorech, barvách
atd. Na první pohled by se mohlo zdát, ¾e se jedná o dobøe navr¾enou
technologii, proto¾e tvùrci prostorových scén, které se mìly pomocí tohoto
grafického akcelerátoru vykreslovat, ji¾ nebyli omezeni kapacitou pamìti
instalované pøímo na grafické kartì (co¾ mj.&nbsp;dovolovalo pou¾ít pomìrnì
velké textury o rozli¹ení a¾ 1024&times;1024 texelù) a rychlost samotného
<i>AGP</i> se zdála být dostateèná na to, aby grafický akcelerátor nebyl pøi
vykreslování brzdìn nedostatkem dat.</p>

<p>To je samozøejmì do jisté míry pravda, ov¹em ve skuteènosti bylo ètení dat
(texelù) z&nbsp;operaèní pamìti a jejich následný pøenos na grafický
akcelerátor v&nbsp;nìkterých pøípadech a¾ osmkrát pomalej¹í, ne¾ naèítání
z&nbsp;pamì»ových modulù umístìných pøímo na grafické kartì (samozøejmì
v&nbsp;závislosti na parametrech operaèních pamìtí a pou¾itém èipsetu, Intel 740
je bì¾nì vybaven 64bitovým rozhraním pro pøipojení SDRAM s&nbsp;frekvencemi
66 a 100 MHz), co¾ se
jasnì ukázalo napøíklad pøi porovnání reálné výkonnosti <i>Intelu 740</i>
s&nbsp;nìkterými dal¹ími grafickými akcelerátory, zejména <i>Voodoo 2</i> nebo
slavné <i>NVidia RIVA TNT</i> (více informací o tomto grafickém akcelerátoru si
uvedeme v&nbsp;nìkteré z&nbsp;dal¹ích èástí tohoto seriálu). Právì kvùli tomuto
technologickému nedostatku (výhodnìj¹í by bylo mít nìkteré textury ulo¾ené
v&nbsp;operaèní pamìti a ty èastìji pou¾ívané na grafickém akcelerátoru) nebyl
grafický akcelerátor <i>Intel 740</i> tak úspì¹ný, jak se pøedpokládalo pøi
jeho uvedení na trh poèátkem roku 1998, tak¾e se jeho masová výroba ukonèila
ji¾ po cca osmnácti mìsících (i pøes velmi pìknì navr¾enou 2D èást).</p>



<p><a name="k05"></a></p>
<h2>5. Grafický øetìzec provádìjící vykreslování 3D scén</h2>

<p>Ve druhé èásti èlánku si popí¹eme funkce provádìné grafickým øetìzcem
akcelerátoru <i>Intel 740</i> urèeným pro vykreslování prostorových scén.
Struktura tohoto øetìzce je zobrazena na ètvrtém obrázku. Z&nbsp;tohoto obrázku
je patrné, ¾e vykreslovací øetìzec obsahuje ètyøi bloky, které pracují soubì¾nì
(ka¾dý ov¹em s&nbsp;jinými daty) a relativnì nezávisle na sobì; navíc je mo¾né
ka¾dý z&nbsp;blokù programovì konfigurovat. Jedná se o následující bloky:</p>

<ol>
<li><a href="#k06">Setup Engine</a></li>
<li><a href="#k07">Scan Converter</a></li>
<li><a href="#k08">Texture Pipeline</a></li>
<li><a href="#k09">Color Calculator</a></li>
</ol>

<a href="http://i.iinfo.cz/images/550/pc9604.png"><img src="http://i.iinfo.cz/images/550/pc9604-prev.png" width="271" height="270" alt="pc9604" /></a>
<p><i>Obrázek 4: Struktura vykreslovacího øetìzce grafického akcelerátoru Intel
740.</i></p>



<p><a name="k06"></a></p>
<h2>6. Setup Engine</h2>

<p>Do tohoto bloku vstupují data popisující geometrii vykreslovaných
trojúhelníkù a úseèek, vèetnì dal¹ích atributù tìchto geometrických objektù
(primitiv). Tyto údaje jsou bì¾nì ulo¾ené v&nbsp;operaèní pamìti, odkud si je
grafický akcelerátor naèítá a pøená¹í pøes port <i>AGP</i>. V&nbsp;rámci
pøedzpracování geometrických dat dochází napøíklad ke konverzím do jednotného
formátu èi výpoètùm dal¹ích potøebných hodnot (napøíklad vzdálenost od
pozorovatele je konvertována podobným zpùsobem, jaký jsme si popsali u
grafického akcelerátoru <i>Voodoo 1</i>), pøièem¾ pøesnost výpoètù
s&nbsp;geometrickými informacemi (souøadnicemi) je vìt¹í, ne¾ velikost jednoho
pixelu, co¾ znamená, ¾e chyba vzniklá napøíklad zaokrouhlením èi oøezáním,
nepovede ke vzniku ne¾ádoucího vizuálního artefaktu. V&nbsp;tomto bloku se také
provádí odstranìní tìch trojúhelníkù, které jsou odvrácené od pozorovatele
(<i>back face culling</i> nebo té¾ pouze <i>culling</i>). Rozhodnutí, zda je
nìjaký trojúhelník potenciálnì viditelný èi zcela neviditelný (odvrácený), se
provádí pomìrnì jednodu¹e zji¹tìním polohy jeho normálového vektoru vùèi
pozorovateli.</p>

<img src="http://i.iinfo.cz/images/534/pc9605.png" width="380" height="240" alt="pc9605_" />
<p><i>Obrázek 5: Datová struktura známá pod jménem triangle strip (pruh
trojúhelníkù) umo¾òuje uchovávat informace o povrchu tìlesa v&nbsp;èásteènì
optimalizované formì, proto¾e u trojúhelníkù le¾ících uvnitø pruhu (nikoli na
jeho zaèátku) se zaznamenává souøadnice pouze jednoho vrcholu.</i></p>



<p><a name="k07"></a></p>
<h2>7. Scan Converter</h2>

<p>Druhým blokem, ze kterého se skládá vykreslovací øetìzec grafického
akcelerátoru <i>Intel 740</i>, je blok, v&nbsp;nìm¾ dochází k&nbsp;rasterizaci
trojúhelníkù a úseèek na jednotlivé <i>fragmenty</i>, tj.&nbsp;na pixely
nesoucí i dal¹í dùle¾ité atributy, pøedev¹ím jejich hloubku (vzdálenost od
pozorovatele). Rychlost rasterizace je konstantní, tj.&nbsp;do znaèné míry
nezávislá na velikosti trojúhelníkù a úseèek, které do tohoto bloku vstupují
(zpracovány jsou i degenerované trojúhelníky). Pøi rasterizaci se provádí
interpolace nìkterých atributù zadaných pro jednotlivé trojúhelníky èi úseèky
&ndash; jedná se pøedev¹ím o interpolaci barvy (Gouraudovo stínování) a
interpolaci hloubky/vzdálenosti od pozorovatele (pou¾ito pøi Z-bufferingu).
Maximální rychlost generování fragmentù je rovna 66 milionùm za sekundu, ov¹em
pøi vyu¾ití nìkterých grafických efektù (realizovaných na dále popsaných
blocích) se rychlost sni¾uje k&nbsp;hodnotám cca 45&ndash;55 milionù fragmentù
za sekundu.</p>

<img src="http://i.iinfo.cz/images/565/pc9606.png" width="380" height="240" alt="pc9606" />
<p><i>Obrázek 6: Dal¹í datová struktura umo¾òující zmen¹it mno¾ství dat
potøebných pro ulo¾ení geometrie tìles. V&nbsp;tomto pøípadì se jedná o
takzvaný triangle fan, neboli trs trojúhelníkù.</i></p>



<p><a name="k08"></a></p>
<h2>8. Texture Pipeline</h2>

<p>Tøetím blokem vykreslovacího øetìzce je blok nazvaný <i>Texture
Pipeline</i>. Jedná se o pomìrnì slo¾itý blok, který je urèen pro zpracování
texelù naèítaných z&nbsp;operaèní pamìti poèítaèe. Výstupem tohoto bloku je
barva le¾ící v¾dy v&nbsp;barvovém prostoru RGB (nezávisle na formátu ulo¾ení
textury), která je posléze pøenesena do bloku nazvaného <i>Color
Calculator</i>, kde mù¾e být pøiøazena jednomu èí více fragmentùm. Ji¾
v&nbsp;pøedchozích kapitolách jsme si øekli, ¾e textury jsou ulo¾ené
v&nbsp;operaèní pamìti poèítaèe, nikoli v&nbsp;pamì»ových modulech
nainstalovaných pøímo na akcelerátoru. Grafický akcelerátor <i>Intel 740</i>
podporuje mnoho formátù textur, zalo¾ených jak na barvovém prostoru RGB, tak i
na prostoru YUV, s&nbsp;ním¾ jsme se ji¾ také v&nbsp;pøedchozích dílech tohoto
seriálu seznámili. Kromì toho mohou být texely ulo¾eny ve formì indexù do
barvové palety. V&nbsp;následující tabulce jsou uvedeny nìkteré èasto pou¾ívané
formáty ulo¾ení textur (resp.&nbsp;texelù):</p>

<table>
<tr><th>Oznaèení</th><th>Význam</th></tr>
<tr><td>Palettized</td><td>Texely jsou ulo¾ené ve formì indexù do palety</td></tr>
<tr><td>1555 ARGB </td><td>1 bit prùhlednost, R, G, B mají pìt bitù</td></tr>
<tr><td>0565 ARGB </td><td>bez prùhlednosti, R a B pìt bitù, G ¹est bitù</td></tr>
<tr><td>4444 ARGB </td><td>4 bity pro prùhlednost, R, G i B</td></tr>
<tr><td>0422 YUV  </td><td>4 bity pro luminanci, 2 bity pro obì chrominance</td></tr>
<tr><td>0555 YUV  </td><td>5 bitù pro luminanci i obì chrominance</td></tr>
<tr><td>1544 YUV  </td><td>1 bit prùhlednost</td></tr>
</table>

<p>Velikost textur se mù¾e pohybovat v&nbsp;rozsahu 1&times;1 texel a¾
1024&times;1024 texelù. Grafický akcelerátor <i>Intel 740</i> podporuje
mj.&nbsp;i pou¾ití MIP map, jejich¾ barevný formát je shodný s&nbsp;formátem
bì¾ných textur (viz tabulka uvedená vý¹e) a i jejich rozli¹ení mù¾e dosahovat
maximálnì 1024&times;1024 texelù. Pøi po¾adavcích na co nejvìt¹í kvalitu
výsledného obrázku je mo¾né zapnout bilineární interpolaci pou¾itou pøi výpoètu
barev jednotlivých fragmentù na základì barev pøeètených ze dvou nejbli¾¹ích
úrovní MIP mapy. Pokud je naopak preferována vy¹¹í rychlost vykreslování, je
mo¾né buï MIP mapy nepou¾ívat (textura má jen jednu úroveò velikosti), nebo
vybírat texely pouze z&nbsp;jedné úrovnì MIP mapy, ov¹em s&nbsp;tím rizikem, ¾e
pøi pohybu tìlesa (typicky pøi jeho pøibli¾ování a vzdalování) mù¾e na jeho
povrchu docházet k&nbsp;nepøíjemnému poblikávání nìkterých pixelù.</p>

<img src="http://i.iinfo.cz/images/501/pc9509.png" width="256" height="256" alt="pc9509" />
<p><i>Obrázek 7: Pøi pou¾ití MIP mappingu je textura ulo¾ena v&nbsp;rekurzivní
podobì naznaèené na tomto obrázku. Mù¾eme zde vidìt rozdìlení textury na
trojici obrázkù, z&nbsp;nich¾ ka¾dý obsahuje pouze jednu barvovou slo¾ku a ve
zbylém ètverci je umístìna tatá¾ textura, ov¹em zmen¹ená na polovinu (ètvrtinu,
osminu atd.) svého pùvodního horizontálního i vertikálního rozli¹ení.
Texturovací jednotka pøi vykreslování vybírá na základì vzdálenosti objektu od
pozorovatele dvojici texelù (z&nbsp;nejbli¾¹í vy¹¹í a ni¾¹í úrovnì MIP mapy),
ze kterých následnì pomocí lineární interpolace vypoète barvu fragmentu, co¾
znamená, ¾e pøi práci s&nbsp;jediným fragmentem je zapotøebí provést hned
nìkolik pøístupù do texturovací pamìti.</i></p>



<p><a name="k09"></a></p>
<h2>9. Color Calculator</h2>

<p>Posledním blokem pou¾itým na grafickém akcelerátoru <i>Intel 740</i> pøi
vykreslování prostorových scén, je blok nazvaný <i>Color Calculator</i>. Jak
ji¾ název tohoto bloku naznaèuje, dochází v&nbsp;nìm k&nbsp;výpoètu barev
jednotlivých fragmentù s&nbsp;následným ulo¾ením fragmentù (které projdou
nìkolika testy, viz dal¹í text) do framebufferu, tj.&nbsp;do zadního barvového
bufferu a/nebo do pamìti hloubky (Z-bufferu). Barva ka¾dého fragmentu mù¾e být
vypoètena z&nbsp;nìkolika zdrojù &ndash; barvy ji¾ ulo¾ené ve framebufferu
(realizace poloprùhledných povrchù), barvy samotného fragmentu vypoètené na
základì lineární interpolace (Gouraudovo stínování) èi konstantního stínování,
barvy naètené z&nbsp;textury (texturování) v&nbsp;bloku popsaném
v&nbsp;pøedchozí kapitole, barvy mlhy vypoètené na základì vzdálenosti
fragmentu od pozorovatele atd. V¹echny uvedené barvy jsou smíchány na základì
takzvané míchací funkce (<i>blending function</i>), její¾ parametry jsou zadané
programátorem. Pøed ulo¾ením fragmentu do framebufferu mù¾e být navíc porovnána
jeho hloubka s&nbsp;hloubkou ulo¾enou v&nbsp;pamìti hloubky (Z-bufferu), tak¾e
nìkteré fragmenty jsou z&nbsp;dal¹ího zpracování odstranìny (jsou to vìt¹inou
ty fragmenty, které le¾í dále od pozorovatele, ov¹em funkci pamìti hloubky lze
zmìnit).</p>

<img src="http://i.iinfo.cz/images/23/pc9608.png" width="450" height="400" alt="pc9608" />
<p><i>Obrázek 8: Rozmazání pøíli¹ blízkých a naopak pøíli¹ vzdálených objektù
ve scénì. Jedná se o grafický efekt, který je mo¾né (za cenu pomìrnì výrazného
zpomalení vykreslování) realizovat i na grafickém akcelerátoru Intel
740.</i></p>



<p><a name="k10"></a></p>
<h2>10. Odkazy na Internetu</h2>

<ol>

<li>Intel i740<br />
<a href="http://en.wikipedia.org/wiki/Intel740">http://en.wikipedia.org/wiki/Intel740</a>
</li>

<li>Intel i740 Datasheet<br />
<a href="ftp://download.intel.com/support/graphics/intel740/29061902.pdf">ftp://download.intel.com/support/graphics/intel740/29061902.pdf</a>
</li>

<li>Intel740(TM) Graphics Accelerator P854 Hardware<br />
<a href="ftp://download.intel.com/support/graphics/intel740/29062202.pdf">ftp://download.intel.com/support/graphics/intel740/29062202.pdf</a>
</li>

<li>S3 Savage<br />
<a href="http://en.wikipedia.org/wiki/S3_Savage">http://en.wikipedia.org/wiki/S3_Savage</a>
</li>

<li>Savage (S3)<br />
<a href="http://www.economy-point.org/s/savage-s3.html">http://www.economy-point.org/s/savage-s3.html</a>
</li>

<li>3dfx Interactive<br />
<a href="http://en.wikipedia.org/wiki/3dfx_Voodoo_Graphics">http://en.wikipedia.org/wiki/3dfx_Voodoo_Graphics</a>
</li>

<li>Intel 860@cpu-collection<br />
<a href="http://www.cpu-collection.de/?l0=co&l1=Intel&l2=i860">http://www.cpu-collection.de/?l0=co&l1=Intel&l2=i860</a>
</li>

<li>S3 Graphics<br />
<a href="http://www.s3graphics.com/en/index.aspx">http://www.s3graphics.com/en/index.aspx</a>
</li>

<li>TSENG ET6000 Performance Page<br />
<a href="http://dani75.tripod.com/TSENG.htm">http://dani75.tripod.com/TSENG.htm</a>
</li>

<li>Tseng Labs Ships ET6000 Advanced Graphics Chip, Announces Additional Manufacturing Sources<br />
<a href="http://www.encyclopedia.com/doc/1G1-18088868.html">http://www.encyclopedia.com/doc/1G1-18088868.html</a>
</li>

<li>CyberMax chooses Tseng Labs' ET6000 Graphics and Video Controller for Max and ProMax Series PCs<br />
<a href="http://findarticles.com/p/articles/mi_m0EIN/is_1996_Oct_9/ai_18754932/">http://findarticles.com/p/articles/mi_m0EIN/is_1996_Oct_9/ai_18754932/</a>
</li>

<li>Intel i860<br />
<a href="http://en.wikipedia.org/wiki/Intel_860">http://en.wikipedia.org/wiki/Intel_860</a>
</li>

<li>Intel i860 64-Bit Microprocessor<br />
<a href="http://www.microprocessor.sscc.ru/i860.html">http://www.microprocessor.sscc.ru/i860.html</a>
</li>

<li>25 Microchips That Shook the World<br />
<a href="http://www.synbio.org.uk/scientific-computing-news/1351.html">http://www.synbio.org.uk/scientific-computing-news/1351.html</a>
</li>

<li>Sprite (computer graphics)<br />
<a href="http://en.wikipedia.org/wiki/Sprite_(computer_graphics)">http://en.wikipedia.org/wiki/Sprite_(computer_graphics)</a>
</li>

<li>Sprite (poèítaèová grafika)<br />
<a href="http://cs.wikipedia.org/wiki/Sprite_(poèítaèová_grafika)">http://cs.wikipedia.org/wiki/Sprite_(poèítaèová_grafika)</a>
</li>

<li>Wikipedia: Video Display Controller<br />
<a href="http://en.wikipedia.org/wiki/Video_Display_Controller">http://en.wikipedia.org/wiki/Video_Display_Controller</a>
</li>

<li>3dfx Voodoo1 PCI<br />
<a href="http://www.v3info.de/english/html/v1.shtml">http://www.v3info.de/english/html/v1.shtml</a>
</li>

<li>Glide 2.2 Programming Guide<br />
<a href="http://www.gamers.org/dEngine/xf3D/glide/glidepgm.htm">http://www.gamers.org/dEngine/xf3D/glide/glidepgm.htm</a>
</li>

<li>Glide API<br />
<a href="http://en.wikipedia.org/wiki/Glide_API">http://en.wikipedia.org/wiki/Glide_API</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Ti¹novský</a> &nbsp; 2009</small></p>
</body>
</html>

