<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title></title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1></h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p></p>



<h2>Obsah</h2>

<p><a href="#k01">*** 1. </a></p>
<p><a href="#k02">*** 2. </a></p>
<p><a href="#k03">*** 3. </a></p>
<p><a href="#k04">*** 4. Základy práce s&nbsp;rozšířením <strong>sqlite-vec</strong></a></p>
<p><a href="#k05">*** 5. Vizualizace výpočtů vzdáleností pro 2D vektory</a></p>
<p><a href="#k06">*** 6. Vytvoření a naplnění tabulky pro uložení 2D vektorů</a></p>
<p><a href="#k07">*** 7. Výpis obsahu tabulky se sloupcem s&nbsp;vektory</a></p>
<p><a href="#k08">*** 8. </a></p>
<p><a href="#k09">*** 9. </a></p>
<p><a href="#k10">*** 10. </a></p>
<p><a href="#k11">*** 11. </a></p>
<p><a href="#k12">*** 12. </a></p>
<p><a href="#k13">*** 13. </a></p>
<p><a href="#k14">*** 14. </a></p>
<p><a href="#k15">*** 15. </a></p>
<p><a href="#k16">*** 16. </a></p>
<p><a href="#k17">*** 17. </a></p>
<p><a href="#k18">*** 18. </a></p>
<p><a href="#k19">*** 19. </a></p>
<p><a href="#k20">*** 20. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. </h2>



<p><a name="k02"></a></p>
<h2 id="k02">2. </h2>



<p><a name="k03"></a></p>
<h2 id="k03">3. </h2>

<pre>
$ <strong>sudo dnf install sqlite-devel</strong>
&nbsp;
Updating and loading repositories:
Repositories loaded.
Package                                      Arch        Version                                      Repository                    Size
Installing:
 sqlite-devel                                x86_64      3.47.2-5.fc42                                updates                  673.4 KiB

Transaction Summary:
 Installing:         1 package

Total size of inbound packages is 146 KiB. Need to download 146 KiB.
After this operation, 673 KiB extra will be used (install 673 KiB, remove 0 B).
Is this ok [y/N]: y
[1/1] sqlite-devel-0:3.47.2-5.fc42.x86_64                                                       100% | 617.3 KiB/s | 146.3 KiB |  00m00s
----------------------------------------------------------------------------------------------------------------------------------------
[1/1] Total                                                                                     100% | 143.4 KiB/s | 146.3 KiB |  00m01s
Running transaction
[1/3] Verify package files                                                                      100% | 166.0   B/s |   1.0   B |  00m00s
[2/3] Prepare transaction                                                                       100% |   4.0   B/s |   1.0   B |  00m00s
[3/3] Installing sqlite-devel-0:3.47.2-5.fc42.x86_64                                            100% |   1.4 MiB/s | 674.1 KiB |  00m00s
Complete!
</pre>

<pre>
$ make loadable static
mkdir -p dist
cc \
        -fPIC -shared \
        -Wall -Wextra \
        -Ivendor/ \
        -O3 \
        -lm \
        sqlite-vec.c -o dist/vec0.so
        ...
        ...
        ...
</pre>

<pre>
$ ls -l dist
total 360
-rw-r--r--. 1 ptisnovs ptisnovs 210222 Jan  8 16:50 libsqlite_vec0.a
-rwxr-xr-x. 1 ptisnovs ptisnovs 153120 Jan  8 16:50 vec0.so
</pre>



<p><a name="k04"></a></p>
<h2 id="k04">4. Základy práce s&nbsp;rozšířením <strong>sqlite-vec</strong></h2>

<p></p>

<pre>
$ <strong>sqlite3 test1.db</strong>
&nbsp;
SQLite version 3.47.2 2024-12-07 20:39:59
Enter ".help" for usage hints.
</pre>

<pre>
sqlite&gt; <strong>.load ./vec0</strong>
</pre>

<pre>
sqlite&gt; <strong>.tables</strong>
</pre>

<pre>
sqlite&gt; <strong>create virtual table vec_examples using vec0(</strong>
  <strong>sample_embedding float[8]</strong>
<strong>);</strong>
</pre>

<pre>
sqlite&gt; <strong>.tables</strong>
&nbsp;
vec_examples                  vec_examples_rowids
vec_examples_chunks           vec_examples_vector_chunks00
vec_examples_info
</pre>

<pre>
sqlite&gt; <strong>select * from vec_examples_info ;</strong>
&nbsp;
CREATE_VERSION|v0.1.7-alpha.2
CREATE_VERSION_MAJOR|0
CREATE_VERSION_MINOR|1
CREATE_VERSION_PATCH|7
</pre>

<pre>
sqlite&gt; <strong>insert into vec_examples(rowid, sample_embedding) values (1, '[1, 0, 0, 0, 0, 0, 0, 0]');</strong>
sqlite&gt; <strong>insert into vec_examples(rowid, sample_embedding) values (2, '[0, 1, 0, 0, 0, 0, 0, 0]');</strong>
sqlite&gt; <strong>insert into vec_examples(rowid, sample_embedding) values (3, '[0, 0, 1, 0, 0, 0, 0, 0]');</strong>
sqlite&gt; <strong>insert into vec_examples(rowid, sample_embedding) values (4, '[1, 0, 1, 0, 0, 0, 0, 0]');</strong>
</pre>

sqlite&gt; <strong>select * from vec_examples_rowids ;</strong>
1||1|0
2||1|1
3||1|2
4||1|3

sqlite&gt; <strong>select</strong>
  rowid,
  distance
from vec_examples
where sample_embedding match '[0, 0.5, 0.5, 0., 0., 0., 0., 0.]'
order by distance limit 4;
3|0.70710676908493
2|0.70710676908493
4|1.22474491596222
1|1.22474491596222

sqlite&gt; <strong>select</strong>
  rowid,
  distance
from vec_examples
where sample_embedding match '[1, 0., 0., 0., 0., 0., 0., 0.]'
order by distance limit 4;
1|0.0
4|1.0
3|1.41421353816986
2|1.41421353816986

sqlite> select * from vec_examples_rowids ;
┌───────┬──────┬──────────┬──────────────┐
│ rowid │  id  │ chunk_id │ chunk_offset │
├───────┼──────┼──────────┼──────────────┤
│ 1     │ NULL │ 1        │ 0            │
│ 2     │ NULL │ 1        │ 1            │
│ 3     │ NULL │ 1        │ 2            │
│ 4     │ NULL │ 1        │ 3            │
└───────┴──────┴──────────┴──────────────┘
sqlite> select rowid, distance from vec_examples where sample_embedding match '[0, 0.5, 0.5, 0., 0., 0., 0., 0.]' order by distance limit 4;
┌───────┬──────────────────┐
│ rowid │     distance     │
├───────┼──────────────────┤
│ 3     │ 0.70710676908493 │
│ 2     │ 0.70710676908493 │
│ 4     │ 1.22474491596222 │
│ 1     │ 1.22474491596222 │
└───────┴──────────────────┘



<p><a name="k05"></a></p>
<h2 id="k05">5. Vizualizace výpočtů vzdáleností pro 2D vektory</h2>

<p>Na 2D vektory se můžeme (i když to není zcela přesné) dívat jako na koncové
souřadnice orientovaných šipek vycházejících z&nbsp;počátku kartézské soustavy
souřadnic. V&nbsp;případě, že si tyto souřadnice vykreslíme, získáme například
následující graf (do kterého jsem doplnil numerické souřadnice u vybraných
koncových bodů):</p>

<pre>
                                       │ y
                                       │
                                       │
                                       │
                                       │                [5,5]
                     o       o         │          o   o   o
                                       │          o   o   o
                         o             │          o   o   o
                      [-4, 3]          │
                                       │
─────────────────────────────────────[0,0]──────────────────────────────────────
                                       │                                       x
                                       │              o
                                       │
                                       │          o       o
                                       │                [5,-5]
                                       │
                                       │
                                       │
                                       │
</pre>



<p><a name="k06"></a></p>
<h2 id="k06">6. Vytvoření a naplnění tabulky pro uložení 2D vektorů</h2>

<p></p>

<pre>
CREATE virtual TABLE v2 USING vec0(
  embedding float[2]
);
</pre>

<p></p>

<pre>
INSERT INTO v2(rowid, embedding) VALUES(1, '[-5,  5]');
INSERT INTO v2(rowid, embedding) VALUES(2, '[-4,  3]');
INSERT INTO v2(rowid, embedding) VALUES(3, '[-3,  5]');
INSERT INTO v2(rowid, embedding) VALUES(4, '[ 3, -5]');
INSERT INTO v2(rowid, embedding) VALUES(5, '[ 4, -3]');
INSERT INTO v2(rowid, embedding) VALUES(6, '[ 5, -5]');
INSERT INTO v2(rowid, embedding) VALUES(7, '[ 3,  3]');
INSERT INTO v2(rowid, embedding) VALUES(8, '[ 3,  4]');
INSERT INTO v2(rowid, embedding) VALUES(9, '[ 3,  5]');
INSERT INTO v2(rowid, embedding) VALUES(10, '[ 4,  3]');
INSERT INTO v2(rowid, embedding) VALUES(11, '[ 4,  4]');
INSERT INTO v2(rowid, embedding) VALUES(12, '[ 4,  5]');
INSERT INTO v2(rowid, embedding) VALUES(13, '[ 5,  3]');
INSERT INTO v2(rowid, embedding) VALUES(14, '[ 5,  4]');
INSERT INTO v2(rowid, embedding) VALUES(15, '[ 5,  5]');
</pre>

<pre>
sqlite&gt; <strong>select * from v2;</strong>
</pre>



<p><a name="k07"></a></p>
<h2 id="k07">7. Výpis obsahu tabulky se sloupcem s&nbsp;vektory</h2>

<p></p>

<pre>
┌───────┬─────────────────────┐
│ rowid │      embedding      │
├───────┼─────────────────────┤
│ 1     │ x'0000a0c00000a040' │
│ 2     │ x'000080c000004040' │
│ 3     │ x'000040c00000a040' │
│ 4     │ x'000040400000a0c0' │
│ 5     │ x'00008040000040c0' │
│ 6     │ x'0000a0400000a0c0' │
│ 7     │ x'0000404000004040' │
│ 8     │ x'0000404000008040' │
│ 9     │ x'000040400000a040' │
│ 10    │ x'0000804000004040' │
│ 11    │ x'0000804000008040' │
│ 12    │ x'000080400000a040' │
│ 13    │ x'0000a04000004040' │
│ 14    │ x'0000a04000008040' │
│ 15    │ x'0000a0400000a040' │
└───────┴─────────────────────┘
</pre>

<p></p>

<pre>
sqlite&gt; <strong>select rowid, vec_to_json(embedding) from v2;</strong>
</pre>

<p></p>

<pre>
┌───────┬────────────────────────┐
│ rowid │ vec_to_json(embedding) │
├───────┼────────────────────────┤
│ 1     │ '[-5.000000,5.000000]' │
│ 2     │ '[-4.000000,3.000000]' │
│ 3     │ '[-3.000000,5.000000]' │
│ 4     │ '[3.000000,-5.000000]' │
│ 5     │ '[4.000000,-3.000000]' │
│ 6     │ '[5.000000,-5.000000]' │
│ 7     │ '[3.000000,3.000000]'  │
│ 8     │ '[3.000000,4.000000]'  │
│ 9     │ '[3.000000,5.000000]'  │
│ 10    │ '[4.000000,3.000000]'  │
│ 11    │ '[4.000000,4.000000]'  │
│ 12    │ '[4.000000,5.000000]'  │
│ 13    │ '[5.000000,3.000000]'  │
│ 14    │ '[5.000000,4.000000]'  │
│ 15    │ '[5.000000,5.000000]'  │
└───────┴────────────────────────┘
</pre>

$ uv init
Initialized project `test-sqlite-vec`

$ uv add sqlite-vec
Using CPython 3.13.9 interpreter at: /usr/bin/python3.13
Creating virtual environment at: .venv
Resolved 2 packages in 258ms
Prepared 1 package in 156ms
Installed 1 package in 3ms
 + sqlite-vec==0.1.6



$ uv add sqlite-utils
Resolved 12 packages in 363ms
Prepared 9 packages in 428ms
Installed 9 packages in 22ms
 + click==8.3.1
 + click-default-group==1.2.4
 + pip==25.3
 + pluggy==1.6.0
 + python-dateutil==2.9.0.post0
 + six==1.17.0
 + sqlite-fts4==1.0.3
 + sqlite-utils==3.39
 + tabulate==0.9.0


$ uv run sqlite-utils install sqlite-utils-sqlite-vec
Collecting sqlite-utils-sqlite-vec
  Downloading sqlite_utils_sqlite_vec-0.1.6-py3-none-any.whl.metadata (275 bytes)
Requirement already satisfied: sqlite-utils in ./.venv/lib64/python3.13/site-packages (from sqlite-utils-sqlite-vec) (3.39)
Requirement already satisfied: sqlite-vec==0.1.6 in ./.venv/lib64/python3.13/site-packages (from sqlite-utils-sqlite-vec) (0.1.6)
Requirement already satisfied: sqlite-fts4 in ./.venv/lib64/python3.13/site-packages (from sqlite-utils->sqlite-utils-sqlite-vec) (1.0.3)
Requirement already satisfied: click>=8.3.1 in ./.venv/lib64/python3.13/site-packages (from sqlite-utils->sqlite-utils-sqlite-vec) (8.3.1)
Requirement already satisfied: click-default-group>=1.2.3 in ./.venv/lib64/python3.13/site-packages (from sqlite-utils->sqlite-utils-sqlite-vec) (1.2.4)
Requirement already satisfied: tabulate in ./.venv/lib64/python3.13/site-packages (from sqlite-utils->sqlite-utils-sqlite-vec) (0.9.0)
Requirement already satisfied: python-dateutil in ./.venv/lib64/python3.13/site-packages (from sqlite-utils->sqlite-utils-sqlite-vec) (2.9.0.post0)
Requirement already satisfied: pluggy in ./.venv/lib64/python3.13/site-packages (from sqlite-utils->sqlite-utils-sqlite-vec) (1.6.0)
Requirement already satisfied: pip in ./.venv/lib64/python3.13/site-packages (from sqlite-utils->sqlite-utils-sqlite-vec) (25.3)
Requirement already satisfied: six>=1.5 in ./.venv/lib64/python3.13/site-packages (from python-dateutil->sqlite-utils->sqlite-utils-sqlite-vec) (1.17.0)
Downloading sqlite_utils_sqlite_vec-0.1.6-py3-none-any.whl (2.3 kB)
Installing collected packages: sqlite-utils-sqlite-vec
Successfully installed sqlite-utils-sqlite-vec-0.1.6

import sqlite3
import sqlite_vec

db = sqlite3.connect(":memory:")
db.enable_load_extension(True)
sqlite_vec.load(db)
db.enable_load_extension(False)

vec_version, = db.execute("select vec_version()").fetchone()
print(f"vec_version={vec_version}")

import sqlite3
import sqlite_vec

db = sqlite3.connect("test1.db")
db.enable_load_extension(True)
sqlite_vec.load(db)
db.enable_load_extension(False)

vec_version, = db.execute("select vec_version()").fetchone()
print(f"vec_version={vec_version}")



<p><a name="k07"></a></p>
<h2 id="k07">7. </h2>



<p><a name="k08"></a></p>
<h2 id="k08">8. </h2>







SELECT rowid, distance FROM v2 WHERE embedding MATCH '[-4, 4]' ORDER BY distance LIMIT 3;

┌───────┬──────────────────┐
│ rowid │     distance     │
├───────┼──────────────────┤
│ 2     │ 1.0              │
│ 3     │ 1.41421353816986 │
│ 1     │ 1.41421353816986 │
└───────┴──────────────────┘


SELECT rowid, distance FROM v2 WHERE embedding MATCH '[4, 4]' ORDER BY distance LIMIT 5;
┌───────┬──────────┐
│ rowid │ distance │
├───────┼──────────┤
│ 11    │ 0.0      │
│ 14    │ 1.0      │
│ 12    │ 1.0      │
│ 10    │ 1.0      │
│ 8     │ 1.0      │
└───────┴──────────┘


SELECT rowid, distance FROM v2 WHERE embedding MATCH '[3, 3]' ORDER BY distance LIMIT 3;
┌───────┬──────────┐
│ rowid │ distance │
├───────┼──────────┤
│ 7     │ 0.0      │
│ 10    │ 1.0      │
│ 8     │ 1.0      │
└───────┴──────────┘

sqlite&gt; <strong>SELECT rowid, distance FROM v2 WHERE embedding MATCH '[3, 3]' and k=10;</strong>
┌───────┬──────────────────┐
│ rowid │     distance     │
├───────┼──────────────────┤
│ 7     │ 0.0              │
│ 10    │ 1.0              │
│ 8     │ 1.0              │
│ 11    │ 1.41421353816986 │
│ 13    │ 2.0              │
│ 9     │ 2.0              │
│ 14    │ 2.2360680103302  │
│ 12    │ 2.2360680103302  │
│ 15    │ 2.82842707633972 │
│ 5     │ 6.08276271820068 │
└───────┴──────────────────┘


CREATE virtual TABLE v3 USING vec0(
  embedding float[2],
  name text
);

INSERT INTO v3(rowid, embedding, name) VALUES(1, '[-5,  5]', 'one');
INSERT INTO v3(rowid, embedding, name) VALUES(2, '[-4,  3]', 'two');
INSERT INTO v3(rowid, embedding, name) VALUES(3, '[-3,  5]', 'three');
INSERT INTO v3(rowid, embedding, name) VALUES(4, '[ 3, -5]', 'four');
INSERT INTO v3(rowid, embedding, name) VALUES(5, '[ 4, -3]', 'five');
INSERT INTO v3(rowid, embedding, name) VALUES(6, '[ 5, -5]', 'six');
INSERT INTO v3(rowid, embedding, name) VALUES(7, '[ 3,  3]', 'seven');
INSERT INTO v3(rowid, embedding, name) VALUES(8, '[ 3,  4]', 'eight');
INSERT INTO v3(rowid, embedding, name) VALUES(9, '[ 3,  5]', 'nine');
INSERT INTO v3(rowid, embedding, name) VALUES(10, '[ 4,  3]', 'ten');
INSERT INTO v3(rowid, embedding, name) VALUES(11, '[ 4,  4]', 'evelen');
INSERT INTO v3(rowid, embedding, name) VALUES(12, '[ 4,  5]', 'twelve');
INSERT INTO v3(rowid, embedding, name) VALUES(13, '[ 5,  3]', 'thirteen');
INSERT INTO v3(rowid, embedding, name) VALUES(14, '[ 5,  4]', 'fourteen');
INSERT INTO v3(rowid, embedding, name) VALUES(15, '[ 5,  5]', 'fifteen');

SELECT rowid, distance, name FROM v3 WHERE embedding MATCH '[-4, 4]' ORDER BY distance LIMIT 10;

sqlite&gt; <strong>.mode qbox</strong>
sqlite&gt; <strong>SELECT rowid, distance, name FROM v3 WHERE embedding MATCH '[-4, 4]' ORDER BY distance LIMIT 10;</strong>
┌───────┬──────────────────┬────────────┐
│ rowid │     distance     │    name    │
├───────┼──────────────────┼────────────┤
│ 2     │ 1.0              │ 'two'      │
│ 3     │ 1.41421353816986 │ 'three'    │
│ 1     │ 1.41421353816986 │ 'one'      │
│ 8     │ 7.0              │ 'eight'    │
│ 9     │ 7.07106781005859 │ 'nine'     │
│ 7     │ 7.07106781005859 │ 'seven'    │
│ 11    │ 8.0              │ 'evelen'   │
│ 12    │ 8.06225776672363 │ 'twelve'   │
│ 10    │ 8.06225776672363 │ 'ten'      │
│ 14    │ 9.0              │ 'fourteen' │
└───────┴──────────────────┴────────────┘



<p><a name="k09"></a></p>
<h2 id="k09">9. </h2>



<p><a name="k10"></a></p>
<h2 id="k10">10. </h2>



<p><a name="k11"></a></p>
<h2 id="k11">11. </h2>



<p><a name="k12"></a></p>
<h2 id="k12">12. </h2>



<p><a name="k13"></a></p>
<h2 id="k13">13. </h2>



<p><a name="k14"></a></p>
<h2 id="k14">14. </h2>



<p><a name="k15"></a></p>
<h2 id="k15">15. </h2>



<p><a name="k16"></a></p>
<h2 id="k16">16. </h2>



<p><a name="k17"></a></p>
<h2 id="k17">17. </h2>



<p><a name="k18"></a></p>
<h2 id="k18">18. </h2>



<p><a name="k19"></a></p>
<h2 id="k19">19. </h2>



<p><a name="k20"></a></p>
<h2 id="k20">20. Odkazy na Internetu</h2>

<ol>
</ol>



<p></p><p></p>
<p><small>Autor: <a href="https://github.com/tisnik/">Pavel Tišnovský</a> &nbsp; 2026</small></p>
</body>
</html>

