<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title></title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1></h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p></p>



<h2>Obsah</h2>

<p><a href="#k01">*** 1. </a></p>
<p><a href="#k02">*** 2. Instalace Redisu</a></p>
<p><a href="#k03">*** 3. Konfigurace vhodná pro první seznámení s&nbsp;Redisem</a></p>
<p><a href="#k04">*** 4. Spuštění Redisu a první experimenty</a></p>
<p><a href="#k05">*** 5. Perzistentní uložení databáze</a></p>
<p><a href="#k06">*** 6. AOF &ndash; Append Only File</a></p>
<p><a href="#k07">*** 7. Formát klíčů</a></p>
<p><a href="#k08">*** 8. Podporované datové typy, s&nbsp;nimiž Redis pracuje</a></p>
<p><a href="#k09">*** 9. Práce s&nbsp;řetězci uloženými do databáze</a></p>
<p><a href="#k10">*** 10. Seznamy</a></p>
<p><a href="#k11">*** 11. Množiny a uspořádané množiny</a></p>
<p><a href="#k12">*** 12. Mapy (asociativní pole)</a></p>
<p><a href="#k13">*** 13. Bitová pole</a></p>
<p><a href="#k14">*** 14. </a></p>
<p><a href="#k15">*** 15. </a></p>
<p><a href="#k16">*** 16. </a></p>
<p><a href="#k17">*** 17. </a></p>
<p><a href="#k18">*** 18. </a></p>
<p><a href="#k19">*** 19. </a></p>
<p><a href="#k20">*** 20. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. </h2>



<p><a name="k02"></a></p>
<h2 id="k02">2. Instalace Redisu</h2>

<p></p>

$ <strong>sudo dnf install redis</strong>
&nbsp;
Last metadata expiration check: 0:15:30 ago on StÂ 24.Â ĹĂ­jenÂ 2018,Â 22:50:11Â CEST.
Dependencies resolved.
================================================================================
 Package           Arch            Version               Repository        Size
================================================================================
Installing:
 redis             x86_64          4.0.9-1.fc27          updates          580 k
Installing dependencies:
 jemalloc          x86_64          4.5.0-5.fc27          updates          210 k
&nbsp;
Transaction Summary
================================================================================
Install  2 Packages
&nbsp;
Total download size: 790 k
Installed size: 2.0 M
Is this ok [y/N]:
</pre>

<pre>
Downloading Packages:
(1/2): jemalloc-4.5.0-5.fc27.x86_64.rpm         1.0 MB/s | 210 kB     00:00    
(2/2): redis-4.0.9-1.fc27.x86_64.rpm            2.3 MB/s | 580 kB     00:00    
--------------------------------------------------------------------------------
Total                                           1.0 MB/s | 790 kB     00:00     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Installing       : jemalloc-4.5.0-5.fc27.x86_64                           1/2 
  Running scriptlet: jemalloc-4.5.0-5.fc27.x86_64                           1/2 
  Running scriptlet: redis-4.0.9-1.fc27.x86_64                              2/2 
  Installing       : redis-4.0.9-1.fc27.x86_64                              2/2 
  Running scriptlet: redis-4.0.9-1.fc27.x86_64                              2/2 
Running as unit: run-r389424a3db894d8e83bddf2d54cd6d4e.service
  Verifying        : redis-4.0.9-1.fc27.x86_64                              1/2 
  Verifying        : jemalloc-4.5.0-5.fc27.x86_64                           2/2 
&nbsp;
Installed:
  redis.x86_64 4.0.9-1.fc27             jemalloc.x86_64 4.5.0-5.fc27            
&nbsp;
Complete!
</pre>



<p><a name="k03"></a></p>
<h2 id="k03">3. Konfigurace vhodná pro první seznámení s&nbsp;Redisem</h2>

<p></p>

<pre>
<strong>bind 127.0.0.1</strong>
<strong>protected-mode yes</strong>
port 6379
tcp-backlog 511
timeout 0
tcp-keepalive 300
daemonize no
supervised no
pidfile /var/run/redis_6379.pid
loglevel notice
<strong>logfile redis.log</strong>
databases 16
always-show-logo yes
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb
<strong>dir .</strong>
slave-serve-stale-data yes
slave-read-only yes
repl-diskless-sync no
repl-diskless-sync-delay 5
repl-disable-tcp-nodelay no
slave-priority 100
lazyfree-lazy-eviction no
lazyfree-lazy-expire no
lazyfree-lazy-server-del no
slave-lazy-flush no
appendonly yes
<strong>appendfilename "appendonly.aof"</strong>
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
aof-load-truncated yes
aof-use-rdb-preamble no
lua-time-limit 5000
slowlog-log-slower-than 10000
slowlog-max-len 128
latency-monitor-threshold 0
notify-keyspace-events ""
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-size -2
list-compress-depth 0
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64
hll-sparse-max-bytes 3000
activerehashing yes
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit slave 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60
hz 10
aof-rewrite-incremental-fsync yes
</pre>



<p><a name="k04"></a></p>
<h2 id="k04">4. Spuštění Redisu a první experimenty</h2>

<pre>
$ <strong>redis-cli</strong>
127.0.0.1:6379&gt;
</pre>

<pre>
127.0.0.1:6379&gt; <strong>ping</strong>
PONG
127.0.0.1:6379&gt; <strong>ping test</strong>
"test"
</pre>

<pre>
127.0.0.1:6379&gt; <strong>set answer 42</strong>
OK
127.0.0.1:6379&gt; <strong>get answer</strong>
"42"
127.0.0.1:6379&gt; <strong>get foobar</strong>
(nil)
</pre>

<pre>
127.0.0.1:6379&gt; <strong>shutdown</strong>
not connected&gt;
</pre>



<p><a name="k05"></a></p>
<h2 id="k05">5. Perzistentní uložení databáze</h2>

pamet + swap, lze ulozit na disk
novy soubor + prejmenovani



<p><a name="k06"></a></p>
<h2 id="k06">6. AOF &ndash; Append Only File</h2>

zapis prikazu
lze z neho databazi obnovit
dochazi ke snizeni vykonu, lze nastavit, jak casto se zapisuje
-vyhody, nevyhody

<pre>
*2
$6
SELECT
$1
0
*3
$3
set
$6
answer
$2
42
</pre>



<p><a name="k07"></a></p>
<h2 id="k07">7. Formát klíčů</h2>

<p></p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Podporované datové typy, s&nbsp;nimiž Redis pracuje</h2>

<p></p>

<table>
<tr><th>Jméno</th><th>Stručná charakteristika</th></tr>
<tr><td>string</td><td></td></tr>
<tr><td>list</td><td></td></tr>
<tr><td>set</td><td></td></tr>
<tr><td>hash</td><td></td></tr>
<tr><td>sorted set</td><td></td></tr>
<tr><td>bitmap (bit array)</td><td></td></tr>
<tr><td>HyperLogLogs</td><td></td></tr>
</table>



<p><a name="k09"></a></p>
<h2 id="k09">9. Práce s&nbsp;řetězci uloženými do databáze</h2>

<p></p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Seznamy</h2>

<p></p>



<p><a name="k11"></a></p>
<h2 id="k11">11. Množiny a uspořádané množiny</h2>

<p></p>



<p><a name="k12"></a></p>
<h2 id="k12">12. Mapy (asociativní pole)</h2>

<p></p>



<p><a name="k13"></a></p>
<h2 id="k13">13. Bitová pole</h2>

<p></p>



<p><a name="k14"></a></p>
<h2 id="k14">14. </h2>

<p></p>



<p><a name="k15"></a></p>
<h2 id="k15">15. Použití Redisu z&nbsp;Pythonu</h2>

<p></p>

<pre>
$ <strong>pip3 install --user redis</strong>
&nbsp;
Collecting redis
  Downloading https://files.pythonhosted.org/packages/3b/f6/7a76333cf0b9251ecf49efff635015171843d9b977e4ffcf59f9c4428052/redis-2.10.6-py2.py3-n
    100% |████████████████████████████████| 71kB 909kB/s
Installing collected packages: redis
Successfully installed redis-2.10.6
</pre>

<p></p>

<pre>
&gt;&gt;&gt; import redis
&gt;&gt;&gt; r = redis.Redis(host='127.0.0.1', port=6379)
&gt;&gt;&gt; r
Redis&lt;ConnectionPool&lt;Connection&lt;host=127.0.0.1,port=6379,db=0&gt;&gt;&gt;
</pre>

<p></p>

<pre>
&gt;&gt;&gt; r.get("answer")
b'42'
</pre>

<p></p>

<pre>
&gt;&gt;&gt; r.get("foo")
</pre>

<p></p>

<pre>
&gt;&gt;&gt; r.set("foo", -1)
True
&gt;&gt;&gt; r.get("foo")
b'-1'
</pre>



<p><a name="k16"></a></p>
<h2 id="k16">16. </h2>



<p><a name="k17"></a></p>
<h2 id="k17">17. </h2>



<p><a name="k18"></a></p>
<h2 id="k18">18. </h2>



<p><a name="k19"></a></p>
<h2 id="k19">19. </h2>



<p><a name="k20"></a></p>
<h2 id="k20">20. Odkazy na Internetu</h2>

<ol>

Stránky projektu Redis
https://redis.io/

Introduction to Redis
https://redis.io/topics/introduction

Try Redis
http://try.redis.io/

Python Redis
https://redislabs.com/lp/python-redis/

Redis: key-value databáze v paměti i na disku
https://www.zdrojak.cz/clanky/redis-key-value-databaze-v-pameti-i-na-disku/

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2018</small></p>
</body>
</html>

