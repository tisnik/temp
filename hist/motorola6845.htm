<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title></title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1></h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p></p>



<h2>Obsah</h2>

<p><a href="#k01">*** 1. </a></p>
<p><a href="#k02">*** 2. </a></p>
<p><a href="#k03">*** 3. Grafický řadič Motorola MC6845</a></p>
<p><a href="#k04">*** 4. Generování obrazu s&nbsp;podporou čipu MC6845</a></p>
<p><a href="#k05">*** 5. Typická konfigurace grafického subsystému</a></p>
<p><a href="#k06">*** 6. Podpora pro zobrazení textového kurzoru</a></p>
<p><a href="#k07">*** 7. Triky použité pro grafické režimy</a></p>
<p><a href="#k08">*** 8. Řídicí registry čipu MC6845</a></p>
<p><a href="#k09">*** 9. Grafická karta MDA &ndash; Monochrome Display Adapter</a></p>
<p><a href="#k10">*** 10. Standardní textový režim karty MDA</a></p>
<p><a href="#k11">*** 11. Grafická karta CGA &ndash; Color Graphics Adapter</a></p>
<p><a href="#k12">*** 12. Oficiální grafické režimy karty CGA</a></p>
<p><a href="#k13">*** 13. Organizace paměti v&nbsp;monochromatickém režimu (hi-res)</a></p>
<p><a href="#k14">*** 14. Standardní čtyřbarevný grafický režim karty CGA: 320&times;200</a></p>
<p><a href="#k15">*** 15. Cílená modifikace řídicích registrů karty CGA a nestandardní režimy zobrazování</a></p>
<p><a href="#k16">*** 16. Grafická karta Hercules &ndash; první vážnější konkurence IBM postavený opět na čipu 6845</a></p>
<p><a href="#k17">*** 17. Základní technické parametry karty Hercules</a></p>
<p><a href="#k18">*** 18. Textový režim karty Hercules</a></p>
<p><a href="#k19">*** 19. Grafický režim karty Hercules</a></p>
<p><a href="#k20">*** 20. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. </h2>



<p><a name="k02"></a></p>
<h2 id="k02">2. </h2>



<p><a name="k03"></a></p>
<h2 id="k03">3. Grafický řadič Motorola MC6845</h2>

<p>Grafický řadič <i>Motorola MC6845</i> byl navržen pro řízení jednoduchých počítačových monitorů či přímo jejich obrazovek (CRT), tj.&nbsp;jedná se o čip obecně nazývaný <i>CRTC &ndash; Cathode Ray Tube Controller</i>. Řízení obrazovek spočívá, zjednodušeně řečeno, v&nbsp;postupném načítání barev jednotlivých pixelů či kódů znaků (serializaci) z&nbsp;obrazové paměti, dále o převod načtených dat na výslednou grafickou informaci a následném poslání této informace na výstup &ndash; tedy buď přímo na monitor nebo do VF modulátoru v&nbsp;případě použití televizoru namísto monitoru. K&nbsp;vlastní obrazové informaci jsou navíc přidány i horizontální a vertikální synchronizační signály, o jejichž generování se taktéž stará grafický řadič. Tento čip byl používán už v&nbsp;sedmdesátých letech minulého století, zejména pro řízení obrazovek u počítačových terminálů (samozřejmě textových). Pro tento typ úloh byl řadič <i>MC6845</i> vybaven možností zobrazovat data v&nbsp;textové podobě, ve skutečnosti však bylo při vhodném nastavení řídicích registrů možné použít i různé více či méně komplikované grafické režimy, čehož bylo využito již u některých domácích osmibitových počítačů vybavených tímto čipem; později byl tento čip použit i u výkonnějších osobních mikropočítačů.</p>

<a href="http://i.iinfo.cz/images/559/pc83-1.png"><img src="http://i.iinfo.cz/images/559/pc83-1-prev.png" alt="pc83" height="180" width="370" /></a>
<p><i>Obrázek 1: Textový režim adaptéru MDA.</i></p>

<p><div class="rs-tip-major">Poznámka: ve skutečnosti provádí Motorola MC6845 pouze některé výše zmíněné operace. Například přímo neřeší způsob načítání pixelů či znaků z&nbsp;obrazové paměti; vlastně je do značné míry nezávislý na struktuře této paměti. Nejdůležitější prováděnou operací je časování, generování adres do obrazové paměti a podpora pro textový kurzor. Podrobnosti si ukážeme níže.</div></p>

<p>Kromě toho bylo možné k&nbsp;čipu <i>MC6845</i> připojit světelné pero, které mohlo s&nbsp;využitím poměrně přesného měření hodin řídicích výstup jednotlivých obrazových řádků a pixelů, lokalizovat umístění aktivního hrotu světelného pera na obrazovce (samozřejmě za předpokladu, že výrobce počítače vyvedl příslušné piny čipu <i>MC6845</i> přes zesilovač na konektor). Podpora pro textový režim byla u tohoto grafického řadiče na poměrně vysoké úrovni, zejména s&nbsp;ohledem na dobu vzniku čipu: znaky mohly mít proměnnou výšku a dokonce byl podporován takzvaný <i>hardwarový kurzor</i>, což není nic jiného, než ona známá blikající čárka či obdélník (většinou o šířce jednoho znaku) na obrazovce. Podpora spočívá ve zmíněném blikání, které nemuselo být řízeno programově, stejně tak jako přepis znaku, který se nachází pod kurzorem (to mimo jiné znamenalo, že i když počítač &bdquo;zamrzl&ldquo;, textový kurzor si dál vesele blikal, což spoustu lidí dokonale zmátlo, protože si mysleli, že počítač stále pracuje :-).</p>

<p>Celkem byly vyráběny tři základní verze tohoto čipu (MC6845 &ndash; 1 MHz, MC68A45 &ndash; 1,5 MHz, MC68B45 &ndash; 2 MHz), ovšem kromě původního výrobce (Motorola) se tento čip vyráběl v&nbsp;modifikované podobě i v&nbsp;několika dalších firmách. Mezi jednotlivými čipy existovaly větší i menší rozdíly, a to jak v&nbsp;časování signálů, tak i ve významu některých bitů řídicích registrů. Co se ovšem nezměnilo a později způsobilo odklon od tohoto čipu, bylo omezení na adresaci 16 kB obrazové paměti v&nbsp;grafickém (bitmapovém) režimu, což například dostačovalo pro potřeby karet CGA či Hercules, ovšem nikoli již pro grafické režimy karty EGA apod.</p>

<a href="http://i.iinfo.cz/images/559/pc83-2.png"><img src="http://i.iinfo.cz/images/559/pc83-2-prev.png" alt="pc83" height="135" width="370" /></a>
<p><i>Obrázek 2: Grafický řadič Motorola MC6845.</i></p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Generování obrazu s&nbsp;podporou čipu MC6845</h2>

<p>Rozlišení a barevná hloubka grafických režimů nebyly omezeny přímo čipem <i>MC6845</i>, ale dalšími obvody, které se k&nbsp;tomuto integrovanému obvodu připojovaly. Při použití vyšších frekvencí hodinových impulsů bylo možné používat stabilní grafické režimy o rozlišení 768&times;384 pixelů, teoretická hranice se pohybovala u rozlišení 800&times;400 pixelů; při &bdquo;přetaktování&ldquo; čipu však bylo možné použít i vyšších rozlišení, samozřejmě pouze za předpokladu, že se využily dostatečně rychlé paměťové čipy tvořící obrazovou paměť (a to nebylo, jak uvidíme dále, vůbec jednoduché nebo levné). Kromě přímého výstupu grafiky byl podporován i takzvaný <i>interlace</i> režim, tj.&nbsp;střídavé vykreslování lichých a sudých obrazových řádků, používaný zejména při zobrazování na televizorech. Čip <i>MC6845</i> dokázal adresovat až 2<sup>14</sup> textových řádků, přičemž každý řádek mohl mít výšku 2<sup>5</sup> obrazových řádků. Celková adresovatelná kapacita paměti byla rovna 2<sup>(14+5)</sup>=512 kB, čehož však žádná grafická karta nevyužívala. Pokud se šířka textového řádku snížila na jeden obrazový řádek, simuloval se grafický režim, ovšem velikost obrazové paměti byla pouhých 2<sup>14</sup>=16 kB (viz například dále popsaná karta <i>CGA</i>).</p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Typická konfigurace grafického subsystému</h2>

<p></p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Podpora pro zobrazení textového kurzoru</h2>



<p><a name="k07"></a></p>
<h2 id="k07">7. Triky použité pro grafické režimy</h2>

<p>Z&nbsp;důvodu podpory jak textových tak i grafických režimů si právě tento řadič displeje vybrala firma IBM pro návrh grafických karet určených pro vznikající IBM PC a jeho následovníky (PC XT, PC AT), což je poněkud paradoxní, protože se jedná o čip navržený především pro použití s&nbsp;mikroprocesorovou řadou <i>Motorola M68xx</i> a firma IBM se při návrhu PC schválně orientovala především na obvody kompatibilní se stavebnicemi 8080 a 8085 (důvodů bylo více, některé si ještě řekneme).</p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Řídicí registry čipu MC6845</h2>

<p>Nastavení grafického řadiče <i>MC6845</i> se provádělo přes osmnáct osmibitových řídicích registrů. Některé z&nbsp;těchto registrů byly určeny pro zápis (počet znaků na řádek atd.), jiné zase pro čtení (pozice světelného pera). Číselné hodnoty, které mohly být větší než 2<sup>8</sup>, se musely ukládat do dvou sousedních registrů (poloha kurzoru atd.). Registry byly programátorům přístupné přes dvojici adres &ndash; zápis do první adresy vybíral příslušný řídicí registr, čtení či zápis do druhé adresy (o jedničku vyšší) již vedl ke čtení či zápisu do příslušného řídicího registru. O které adresy se konkrétně jedná záleželo na zapojení konkrétní grafické karty.  Například u dále popsané grafické karty <i>CGA</i> se jedná o I/O porty 0x3d4 a 0x3d5 a u grafické karty <i>Hercules</i> se naopak o I/O porty 0x3b4 a 0x3b5.  Význam jednotlivých řídicích registrů je uveden v&nbsp;následující tabulce (povšimněte si, že jednotkami při udávání horizontálních velikostí jsou znaky a nikoli pixely &ndash; přesné časování je odvozeno od externího hodinového signálu řízeného krystalem):</p>

<table>
<tr><th>Číslo registru</th><th>Význam</th></tr>
<tr><td>0 </td><td>celkový počet znaků horizontálně, včetně okrajů</td></tr>
<tr><td>1 </td><td>počet horizontálně zobrazených znaků (typicky 40 či 80)</td></tr>
<tr><td>2 </td><td>horizontální pozice synchronizačního signálu (lze posouvat obrazem na monitoru, ovšem omezeně)</td></tr>
<tr><td>3 </td><td>šířka horizontálního a vertikálního synchronizačního signálu</td></tr>
<tr><td>4 </td><td>celkový počet textových řádků (například 27)</td></tr>
<tr><td>5 </td><td>mikroposun textových řádků po jednotlivých obrazových řádcích</td></tr>
<tr><td>6 </td><td>zobrazený počet textových řádků (například 25)</td></tr>
<tr><td>7 </td><td>vertikální pozice synchronizačního signálu (lze posouvat obrazem, opět omezeně)</td></tr>
<tr><td>8 </td><td>mód prokládání (interlace) a posunutí</td></tr>
<tr><td>9 </td><td>počet obrazových řádků pro jeden textový řádek &ndash; výška znaku (většinou 8 či 14)</td></tr>
<tr><td>10</td><td>začátek hardwarového kurzoru (většinou výška_znaku-3)</td></tr>
<tr><td>11</td><td>konec hardwarového kurzoru (kurzor může mít například výšku dvou obrazových řádků)</td></tr>
<tr><td>12</td><td>počáteční adresa obrazové paměti (vyšší bajt)</td></tr>
<tr><td>13</td><td>počáteční adresa obrazové paměti (nižší bajt)</td></tr>
<tr><td>14</td><td>adresa kurzoru &ndash; vyšší bajt (klasický posun hardwarového kurzoru)</td></tr>
<tr><td>15</td><td>adresa kurzoru &ndash; nižší bajt</td></tr>
<tr><td>16</td><td>adresa světelného pera &ndash; vyšší bajt</td></tr>
<tr><td>17</td><td>adresa světelného pera &ndash; nižší bajt</td></tr>
</table>

<p>omezení</p>



<p><a name="k09"></a></p>
<h2 id="k09">9. Grafická karta MDA &ndash; Monochrome Display Adapter</h2>

<p>Jak jsme si již řekli v&nbsp;předchozích kapitolách, nabízela firma IBM do svých prvních počítačů PC buď grafickou kartu <i>MDA</i> (<i>Monochrome Display Adapter</i>), nebo grafickou kartu <i>CGA</i> (dokonce bylo možné, aby byly v&nbsp;jednom počítači současně nainstalovány obě zmíněné karty, protože ani adresy jejich řídicích registrů &ndash; portů, ani adresní rozsah video paměti, se nepřekrýval). Počátek výroby obou typů karet se datuje do roku 1981.  Grafická karta <i>MDA</i> se od prakticky všech dalších grafických adaptérů vyráběných pro počítače IBM PC odlišovala především v&nbsp;tom, že neumožňovala vykreslování rastrové grafiky (označení termínem &bdquo;grafická karta&ldquo; je tedy poněkud nepřesné), jelikož podporovala pouze textový režim 80&times;25 znaků, který je používán například při startu počítače či v&nbsp;operačním systému MS-DOS; teoreticky by však mělo být možné pracovat s&nbsp;graficko-textovou :-) kartou <i>MDA</i> i pod systémy Linux či Open/Free BSD, například pro řízení zobrazování na druhém monitoru u starších systémů vybavených sběrnicí ISA (v&nbsp;moderních PC se pro zobrazení na více monitorech využívá poněkud odlišná technologie). V&nbsp;minulosti se &ndash; zejména právě v&nbsp;dobách DOSu &ndash; pro tuto činnost nejčastěji používaly výprodejové karty typu <i>Hercules</i>, protože i ty byly navrženy tak, aby jejich řídicí porty ani adresy video paměti nekolidovaly s&nbsp;primární grafickou kartou.</p>

<a href="http://i.iinfo.cz/images/559/pc83-3.jpg"><img src="http://i.iinfo.cz/images/559/pc83-3-prev.jpg" alt="pc83" height="185" width="370" /></a>
<p><i>Obrázek 3: Grafická karta MDA s&nbsp;čipem MC6845.</i></p>

<p>Jednoznačnou předností této grafické karty je způsob namapování do adresního prostoru procesoru. Karta totiž využívala segment začínající adresou <strong>b000:0000</strong> (používám zde známé Intelovské šestnáctibitové adresování typu segment:offset), který nebyl na dalších grafických kartách využit. Proto bylo možné tuto kartu kombinovat s&nbsp;kartou jinou a vytvořit tak vícemonitorový systém, který využívaly aplikace jako <strong>AutoCAD</strong> (grafická plocha a terminál s&nbsp;příkazovým řádkem), <strong>Turbo Pascal</strong> (vývojové prostředí zobrazené spolu s&nbsp;laděnou aplikací), <strong>Turbo C++</strong>, <strong>Lotus 1-2-3</strong> apod. V&nbsp;praxi bylo možné použít například kombinace grafických karet <i>CGA+MDA</i>, <i>EGA+MDA</i> a později i <i>VGA+MDA</i>.  Vzhledem k&nbsp;tomu, že firma IBM tuto kartu přestala po několika letech vyrábět, převzal úlohu sekundární grafické karty její konkurent <i>Hercules</i> (viz další část tohoto seriálu), který kromě zobrazení textového režimu podporoval i režim grafický.</p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Standardní textový režim karty MDA</h2>

<p>Při zobrazování znaků v&nbsp;textovém režimu <strong>80&times;25</strong> znaků byl každý znak definovaný v&times;masce 9&times;14 pixelů, což znamená, že rozlišení obrazovky bylo rovno 720&times;350 pixelům. Poměrně velké horizontální rozlišení (a tím i velmi dobře čitelný text) bylo dále použito až u grafických karet <i>Hercules</i> a <i>VGA</i> o několik let později (grafické karty <i>CGA</i> a <i>EGA</i> byly v&nbsp;tomto ohledu zklamáním, zejména pro uživatele pracující převážně v&nbsp;textovém režimu). Znaková sada byla na grafické kartě uložena v&nbsp;paměti ROM, což znamená, že se při požadavku na zobrazení textů v&nbsp;jazycích s&nbsp;nabodeníčky (jedná se o  prakticky všechny jazyky kromě angličtiny) musela tato paměť vyměnit za EPROM (typ 2764 případně 27C64) s&nbsp;vypálenou národní znakovou sadou (původní znaková sada dodávaná firmou IBM odpovídá kódové stránce 437, tj.&nbsp;jedná se o &bdquo;rozšířenou&ldquo; ASCII tabulku). Každý znak na obrazovce měl k&nbsp;dispozici i svůj atributový byte, ve kterém bylo specifikováno, zda se má tento znak zobrazit normálně, zvýrazněně (větší intenzita), s&nbsp;podtržením, inverzně či zda by měl blikat; dokonce bylo možné nastavit i některé kombinace těchto atributů. Barevné atributy znaků byly použity (i když s&nbsp;poněkud jiným významem) i u dalších grafických karet na PC.</p>

<p>Kapacita video paměti na této kartě byla rovna čtyřem kilobajtům, přičemž 2000 bytů bylo zapotřebí pro uložení všech 80&times;25 znaků a dalších 2000 bytů pro uložení jejich atributů (z&nbsp;pohledu PC se ukládala vždy dvojice znak-atribut, tj.&nbsp;jednalo se o souvislou oblast paměti), zbylých 96 bytů bylo nevyužito. Zajímavé jsou signálové poměry, kterými se musely řídit připojené monitory. Snímková frekvence byla rovna 50&nbsp;Hz, řádková frekvence 18,432&nbsp;kHz (tj.&nbsp;tato frekvence byla poněkud vyšší než u dále popisované grafické karty <i>CGA</i>). Při prvním pohledu na údaj o snímkovém kmitočtu to může vypadat tak, že 50&nbsp;Hz je pro práci na počítači naprosto nedostatečné, musíme si však uvědomit, že se ponejvíce používalo tmavé pozadí, na kterém není poblikávání obrazu tak patrné, jako na pozadí světlém či dokonce bílém.</p>



<p><a name="k11"></a></p>
<h2 id="k11">11. Grafická karta CGA &ndash; Color Graphics Adapter</h2>

<p>První dostupnou kartou s&nbsp;podporou zobrazování rastrové grafiky na osobních počítačích typu IBM PC byla grafická karta <i>CGA</i>, což je označení, které vzniklo z&nbsp;celého názvu <i>Color Graphics Adapter</i>. Tato karta, jež byla jako oficiální standard uvedena (spolu s&nbsp;výše popsanou kartou <i>MDA</i>) v&nbsp;roce 1981, oficiálně podporuje celkem dva grafické režimy a dva režimy textové. Kromě toho je však pro televizní výstup použit třetí grafický režim a vhodnou manipulací s&nbsp;řídicími registry lze vytvořit i další textové, grafické či smíšené režimy. Vzhledem k&nbsp;omezení tohoto grafického adaptéru, který byl způsobem velmi nízkou řádkovou frekvencí (pouhých 15,75&nbsp;kHz), bylo možné zobrazit pouze 200 obrazových řádků, a to i v&nbsp;textových režimech. Z&nbsp;tohoto důvodu jsou jednotlivé masky znaků definovány v&nbsp;rastru pouhých 8x8 pixelů, tedy stejně jako u mnohých osmibitových počítačů (<i>Atari</i>, <i>C64</i> atd.). První znakový režim dokázal zobrazit 40 znaků na textovém řádku, počet textových řádků byl roven 25. Ve druhém textovém režimu bylo možné zobrazit 80 znaků na řádku. Každý znak mohl mít přiřazenou jednu ze šestnácti předdefinovaných barev, pozadí znaku bylo možné zvolit také ze šestnácti barev, nebo pouze z&nbsp;osmi barev v případě, že se jeden bit atributu rezervoval pro blikání. Jak barva popředí, tak i barva pozadí byly zapsány do takzvaného <i>atributu</i>, který měl velikost jeden byte.</p>

<img src="http://i.iinfo.cz/images/559/pc83-4.png" alt="pc83" height="200" width="320" />
<p><i>Obrázek 4: Grafický režim 320&times;200 se čtyřmi barvami (King's Quest).  Jak je z&nbsp;tohoto obrázku patrné, je malý počet barev kompenzován ditheringem, který ovšem při relativně malém rozlišení situaci snad ještě více zhoršuje. Paradoxní je, že většina rozšířených osmibitových počítačů dokáže &ndash; a to dokonce s&nbsp;poloviční velikostí obrazové paměti &ndash; tento obrázek zobrazit mnohem lépe.</i></p>



<p><a name="k12"></a></p>
<h2 id="k12">12. Oficiální grafické režimy karty CGA</h2>

<p>Mnohem zajímavější a flexibilnější než textové režimy jsou režimy grafické, která grafická karta <i>CGA</i> také podporovala. Oficiálně jsou podle dokumentace IBM podporovány pouze dva grafické režimy. V&nbsp;prvním grafickém režimu bylo možné zobrazit obraz v&nbsp;rastru 320&times;200 pixelů ve čtyřech barvách, druhý režim měl rozlišení 640&times;200 pixelů dvoubarevně. V&nbsp;grafickém režimu o rozlišení 320&times;200 pixelů mohl každý pixel nabývat jedné ze čtyř barev, které byly vybrány z&nbsp;barevné palety. Tato paleta však nemohla být libovolná (z&nbsp;předchozího textu víme, že v&nbsp;textovém režimu je možné použít šestnáct barev), protože existovaly pouze dvě fixní barevné palety, přičemž při výběru barev se IBM skutečně &bdquo;předvedla&ldquo;, protože její nevkusná barevná schémata byla prakticky nepoužitelná :-) První paleta fixně obsahovala barvy zelenou, červenou a hnědou (<i>red</i>, <i>green</i>, <i>brown</i>), druhá paleta barvy azurovou, fialovou a bílou (<i>cyan</i>, <i>magenta</i>, <i>white</i>). Je patrné, že obě palety se liší pouze přidáním modré barvové složky.</p>

<img src="http://i.iinfo.cz/images/559/pc83-5.png" alt="pc83" height="200" width="320" />
<p><i>Obrázek 5: Pro porovnání &ndash; tentýž obrázek, ovšem zobrazený v&nbsp;grafickém režimu 320&times;200 s&nbsp;barvami šestnácti na modernější grafické kartě.</i></p>

<p>Čtvrtá barva byla při práci s&nbsp;BIOSem (přesněji řečeno při používání služeb BIOSu, například přechodu do grafického režimu) vždy nastavena na černou; ve skutečnosti se však přes řídicí registry grafické karty dala tato barva (jako jediná) nastavit na jednu ze šestnácti předdefinovaných barev. Tuto poměrně zajímavou možnost však, vzhledem k&nbsp;nedostupnosti technických informací, mnoho aplikací nevyužívalo. Kapacita obrazové paměti byla rovna 320&times;200/8&times;2=16000 bytům, což znamenalo, že adresovací schopnosti čipu <i>Motorola MC6845</i> byly využity jen částečně &ndash; ve skutečnosti se v&nbsp;grafických režimech používalo pouze čtrnáct bitů adresy textových řádků (viz předchozí kapitoly s&nbsp;popisem tohoto čipu), přičemž výška textových řádků byla nastavena na jeden obrazový řádek. Ve druhém grafickém režimu o rozlišení 640&times;200 pixelů mohl každý pixel nabývat pouze jedné ze dvou barev, které jsou při inicializaci tohoto režimu pomocí BIOSu nastaveny na černou a bílou. S&nbsp;využitím služeb BIOSu tyto barvy nastavit nelze, ale pomocí změny konfiguračních registrů je to možné &ndash; lze tak generovat například zeleno-červený obraz či libovolnou jinou kombinaci šestnácti základních barev. Kapacita obrazové paměti byla při použití tohoto režimu rovna 640&times;200/8=16000 bytům, tj. stejně, jako v&nbsp;předchozím grafickém režimu.</p>

<img src="http://i.iinfo.cz/images/407/p83-1.gif" alt="p83_" height="200" width="320" />
<p><i>Obrázek 6: Známá hra Arcade Voleyball pro dva hráče taktéž využívá
čtyřbarevný grafický režim karty CGA.</i></p>

<p>Vzhledem k&nbsp;tomu, že přímá změna hodnot konfiguračních registrů při nastavování grafického režimu je poměrně složitá a některé hodnoty dokonce mohly vést ke zničení připojeného monitoru (elektronika tehdejších monitorů byla velmi jednoduchá a především &ndash; nejednalo se o multifrekvenční monitory, které jsou vůči nekorektnímu nastavení již odolnější), byly do BIOSu zavedeny služby určené jak pro nastavení grafických či textových režimů, tak i služby umožňující provádění základních grafických operací &ndash; výpis znaku, vykreslení pixelu, posun kurzoru, přečtení hodnoty pixelu atd. V&nbsp;případě grafické karty <i>CGA</i> byly pomocí služeb BIOSu dostupné dva režimy &ndash; monochromatický režim s&nbsp;rozlišením 640&times;200 pixelů a čtyřbarevný režim, který nabízel rozlišení 320&times;200 pixelů.</p>

<img src="http://i.iinfo.cz/images/407/p83-3.png" alt="p83_" height="200" width="320" />
<p><i>Obrázek 7: Další známá CGA hra &ndash; Paratroopers.</i></p>



<p><a name="k13"></a></p>
<h2 id="k13">13. Organizace paměti v&nbsp;monochromatickém režimu (hi-res)</h2>

<p>Nejprve si popíšeme práci v&nbsp;monochromatickém režimu, která nebyla zcela jednoduchá, ač by se na první pohled mohlo znát, že v&nbsp;tomto případě bude situace triviální &ndash; ostatně co může být jednoduššího, než obyčejná pravidelná bitmapa? (v&nbsp;původním významu tohoto slova).</p>

<p>V&nbsp;monochromatickém režimu karty <i>CGA</i> s&nbsp;rozlišením 640&times;200 pixelů se na obrazovce pracovalo s&nbsp;celkem 128000 pixely, pro jejichž uložení ve video paměti bylo nutné alokovat 16000 bajtů. Ovšem přístup k&nbsp;jednotlivým pixelům nebyl zcela přímočarý, protože celá obrazová paměť byla rozdělena na dvě podoblasti. První podoblast byla (z&nbsp;hlediska mikroprocesoru) mapována na adresy <strong>0xb800:0x0000-0xb900:0xffff</strong>, druhá oblast na adresy <strong>0xba00:0x0000-0xbb00:0xffff</strong> (opět je použito adresování segment:offset). V&nbsp;první oblasti obrazové paměti byly umístěny sudé obrazové řádky, ve druhé oblasti řádky liché; vždy osmdesát bajtů na řádek (80&times;8=640). Z&nbsp;této organizace obrazové paměti, která byla použita kvůli omezené rychlosti použitých paměťových čipů, vyplývá, že i na první pohled poměrně jednoduché operace, jako je vykreslení úsečky, se implementovaly poměrně obtížně a byly z&nbsp;tohoto důvodu také pomalé.</p>



<p><a name="k14"></a></p>
<h2 id="k14">14. Standardní čtyřbarevný grafický režim karty CGA: 320&times;200</h2>

<p>Druhým standardním grafickým režimem podporovaným kartou <i>CGA</i>, který bylo možné nastavit pomocí služeb BIOSu, byl čtyřbarevný režim nabízející rozlišení 320&times;200 pixelů. V&nbsp;tomto režimu je každý pixel v&nbsp;obrazové paměti uložen ve dvou bitech (čtyři pixely v&nbsp;každém bajtu), což znamená, že je opět využito celkem 16000 bajtů video paměti z&nbsp;dostupných 16 kB. Obrazová paměť je rozdělena podobným způsobem (sudé/liché řádky) jako u režimu monochromatického, což je pochopitelné, protože z&nbsp;hlediska čipu <i>MC6845</i> se jedná o naprosto stejný mód, liší se jen způsob interpretace načtených dat. U všech režimů karty <i>CGA</i> se však vyskytuje jeden fenomén, který uživatelé jiných počítačů neznali &ndash; souběžný přístup mikroprocesoru a grafického řadiče do obrazové paměti nebyl kupodivu nijak ošetřen, což způsobovalo nechvalně známé &bdquo;sněžení&ldquo;. Jediná možnost, jak zabránit &bdquo;sněžení&ldquo;, byl zápis do obrazové paměti při vertikálním zatemnění elektronového paprsku (horizontální zatemnění má příliš krátký interval).</p>

<p><div class="rs-tip-major">Poznámka: </div></p>

<img src="http://i.iinfo.cz/images/360/pc84-2.png" alt="pc84" height="200" width="320" />
<p><i>Obrázek 2: Úvodní obrazovka hry Golden Axe spuštěná v&nbsp;grafickém
režimu karty CGA. Jedná se o čtyřbarevný režim s&nbsp;rozlišením 320&times;200
pixelů.</i></p>


<img src="http://i.iinfo.cz/images/360/pc84-3.png" alt="pc84" height="200" width="320" />
<p><i>Obrázek 3: Pro porovnání &ndash; tentýž obrázek, ovšem spuštěný
v&nbsp;šestnáctibarevném režimu karty EGA. Rozlišení sice zůstalo zachováno,
ale větší počet barev je na první pohled patrný.</i></p>


<img src="http://i.iinfo.cz/images/360/pc84-4.png" alt="pc84" height="200" width="320" />
<p><i>Obrázek 4: Teprve s&nbsp;256 barvami (grafická karta VGA) bylo možné
odstranit dithering.</i></p>



<p><a name="k15"></a></p>
<h2 id="k15">15. Cílená modifikace řídicích registrů karty CGA a nestandardní režimy zobrazování</h2>

<p>Kromě základních (řekněme standardních) grafických režimů, které se nastavovaly pomocí služeb BIOSu, byly díky poměrně širokým možnostem čipu <i>MC6845</i> podporovány i mnohé další grafické módy. První z&nbsp;těchto módů je &bdquo;legální&ldquo; tj.&nbsp;zmiňuje se o něm i dokumentace firmy IBM (ale například náš <i>SYSMAN</i> již nikoli, což je však pochopitelné &ndash; viz další text). V&nbsp;tomto režimu bylo možné zobrazit rastrový obraz o rozměrech 160&times;200 pixelů, přičemž každý pixel mohl nabývat jedné ze šestnácti barev, podobně jako v&nbsp;textovém režimu. Potřebná kapacita video paměti je stejná, jako v&nbsp;případě režimu monochromatického &ndash; 16000 bajtů. Tento režim však byl použitelný pouze pro kompozitní video, tj.&nbsp;například pro televizory připojené ke grafické kartě pomocí konektoru RCA. Vzhledem k&nbsp;tomu, že obrazová frekvence je rovna 60Hz, neměl tento režim pro naši oblast (ČR, Evropa) velký smysl, protože tento kmitočet je určen pro televizory podporující normu NTSC.</p>

<img src="http://i.iinfo.cz/images/360/pc84-5.png" alt="pc84" height="200" width="320" />
<p><i>Obrázek 5: Další porovnání &ndash; screenshot ze hry Golden Axe spuštěné
ve čtyřbarevném režimu grafické karty CGA.</i></p>

<p>Druhý nestandardní mód je již možné použít na jakémkoli monitoru. Ve své podstatě se jedná o režim textový, u nějž je pomocí řídicích registrů čipu <i>MC6845</i> upravena výška znaků na pouhé dva skenovací řádky. Z&nbsp;toho vyplývá, že se zobrazuje 80 znaků na 100 textových řádků (u <i>CGA</i> je počet skenovacích řádků vždy roven 200, a to i v&nbsp;textových režimech). Pokud se bude zobrazovat pouze znak ve tvaru polovičního obdélníku (viz rozšířená tabulka ASCII), zvyšuje se rozlišení tohoto pseudografického režimu na 160&times;100 &bdquo;pixelů&ldquo;, přičemž každý pixel může nabývat jedné z&nbsp;šestnácti barev (programátor tedy mění pouze barvové atributy znaků, tj.&nbsp;každý lichý bajt). Z&nbsp;jakého důvodu se však nemůže zvýšit vertikální rozlišení na plných 200 řádků, tj.&nbsp;snížit výšku znaku na jeden skenovací řádek? V&nbsp;tomto případě totiž narážíme na neefektivní práci s&nbsp;obrazovou pamětí, protože pro každý znak se musí uložit i jeho barvový atribut (dva bajty). Pro rozlišení 160&times;100 pixelů je zapotřebí alokovat: 80&times;100 znaků=8000&times;2 bytů=16000 bytů, tj.&nbsp;dostáváme se na horní mez kapacity obrazové paměti.</p>

<img src="http://i.iinfo.cz/images/360/pc84-6.png" alt="pc84" height="200" width="320" />
<p><i>Obrázek 6: Táž scéna, ovšem zobrazená kartou EGA v&nbsp;šestnácti barvách.</i></p>

<p>Tento poměrně zajímavý režim, použitý například i v&nbsp;několika hrách, je možné nastavit i u dalších grafických karet, přesněji řečeno u všech karet, které emulují funkce čipu <i>MC6845</i>, tj.&nbsp;například u karty <i>EGA</i> i <i>VGA</i>. Ve většině případů to ale postrádá smysl, protože jejich grafické režimy již nejsou omezeny malým počtem barev tak, jak je tomu u grafické karty <i>CGA</i>. Programátoři se v&nbsp;minulosti pokoušeli nastavovat i další grafické režimy. Teoreticky to není problematické, protože čip <i>MC6845</i> je velmi flexibilní, ale mnohé monitory nedokázaly korektně pracovat v&nbsp;těch případech, kdy se změnilo časování horizontálních a vertikálních synchronizačních signálů &ndash; grafická karta <i>CGA</i> měla pouze jeden krystal sloužící ke generování hodinového signálu (vstup do čipu <i>MC6845</i>), takže například při změně horizontálního rozlišení (počtu pixelů na obrazovém řádku) se buď musel snížit počet obrazových řádků, nebo muselo dojít ke změně obrazové frekvence.</p>

<img src="http://i.iinfo.cz/images/360/pc84-7.png" alt="pc84" height="200" width="320" />
<p><i>Obrázek 7: Stejná scéna zobrazená kartou VGA (256 barev).</i></p>

<p>Pro doplnění přidávám vzpomínky jednoho uživatele grafické karty <i>CGA</i>:</p>

<p><i>Sending random bytes to the video registers, by the way, was
<strong>extremely</strong> dangerous. If I had known that then, I wouldn't have
even tried at all; I was lucky I didn't break anything. The monitors back then
(1987 and earlier) were fixed frequency monitors, and ran at low frequencies.
If you told the video card to do something outside of those frequencies, you
stood an excellent change of damaging the monitor. A friend of mine was trying
to get the rumored CGA 16-color mode to work and <strong>destroyed</strong> his
Compaq's build-in monitor, a small monochrome monitor that emulated color with
different shades of gray. He went to nearest Compaq dealership to get it
replaced, and when they refused to fix it, he answered with something like,
"Well, I could demonstrate how easy it is to break the monitor to your
customers by typing a three-line BASIC program on, oh... this machine over
here," and pointed to their top-of-the-line machine that some customers were
huddled around. They quickly replaced his monitor to shut him up.</i> :-)</p>



<p><a name="k16"></a></p>
<h2 id="k16">16. Grafická karta Hercules &ndash; první vážnější konkurence IBM postavený opět na čipu 6845</h2>

<p>Obě výše zmíněné grafické karty, tj.&nbsp;jak MDA, tak i CGA, mají i přes mnohé rozdíly několik společných vlastností. Jedná se o karty navržené a prodávané (od roku 1981) firmou IBM, které jsou vybavené rozhraním pro osmibitovou variantu universální interní sběrnice ISA (<i>Industry Standard Architecture</i>). Obě karty jsou taktéž založeny na minule popsaném grafickém řadiči <i>Motorola MC6845</i>, což by sice na první pohled mohlo znamenat určitou míru kompatibility, ale přesný opak byl pravdou &ndash; firma IBM u obou karet zvolila odlišné řádkové frekvence (18,432 kHz u karty <i>MDA</i> a 15,75 kHz u karty <i>CGA</i>) i jiný typ videosignálů, což ve výsledku vedlo k&nbsp;tomu, že pro každou kartu musel být použitý odlišný monitor. Zatímco grafická karta <i>CGA</i> nabízela možnost barevného zobrazení (viz předchozí kapitoly) na úkor menšího &ndash; pro mnohé uživatele neakceptovatelného &ndash; horizontálního i vertikálního zobrazení, umožňovala sice karta <i>MDA</i> zobrazení čitelného textu, ovšem bez možnosti použití jakéhokoli grafického režimu.</p>

<a href="http://i.iinfo.cz/images/360/pc84-8.png"><img src="http://i.iinfo.cz/images/360/pc84-8-prev.png" alt="pc84" height="181" width="370" /></a>
<p><i>Obrázek 8: Slavný textový editor T602 spuštěný na počítači s&nbsp;grafickou kartou Hercules.</i></p>

<p>V&nbsp;této situaci se, pravděpodobně poprvé, projevila jedna z&nbsp;největších předností architektury IBM PC &ndash; modularita. Zatímco firma IBM nereagovala na oprávněné výtky, které od uživatelů přicházely především kvůli vlastnostem grafické karty <i>CGA</i> (i mnohé osmibitové počítače totiž měly grafický subsystém vyřešený mnohem elegantněji), objevil se v&nbsp;roce 1982 konkurenční výrobek &ndash; grafická karta <i>Hercules Graphics Card (HGC)</i> firmy <i>Hercules Computer Technology</i>. Výrobce tuto grafickou kartu navrhl tak, aby ji bylo možné použít s&nbsp;monitorem určeným pro kartu <i>MDA</i>, ovšem včetně možnosti přepnutí do monochromatického grafického režimu s&nbsp;relativně vysokým rozlišením 720&times;348 pixelů.  Dodržení zpětné kompatibility s&nbsp;kartou <i>MDA</i> nebylo složité &ndash; v&nbsp;textovém i grafickém režimu (viz další text) byly použity takové frekvence synchronizačních signálů (řádková a snímková frekvence), která odpovídaly signálům generovaným kartou <i>MDA</i>.</p>

<a href="http://i.iinfo.cz/images/360/pc84-9.png"><img src="http://i.iinfo.cz/images/360/pc84-9-prev.png" alt="pc84" height="231" width="370" /></a>
<p><i>Obrázek 9: T602 zobrazený kartou CGA (skutečný obraz má ve skutečnosti jen 200 řádků, nikoli 400).</i></p>

<p>I způsob práce v&nbsp;textovém režimu se od karty <i>MDA</i> téměř nelišil, což znamenalo, že na této kartě bylo možné provozovat všechny aplikace pracující v&nbsp;textovém režimu (navíc bylo možné s&nbsp;využitím rezidentních programů simulovat i grafické režimy karty <i>CGA</i>, přičemž se jednotlivé barevné odstíny nahrazovaly ditheringem). Především z&nbsp;těchto důvodů byla grafická karta <i>Hercules</i> v&nbsp;první polovině osmdesátých let minulého století velmi oblíbená a do svých sestav ji instalovali i tehdejší přední výrobci osobních počítačů. K&nbsp;velké oblíbenosti přispěla i poměrně nízká cena, takže se karta <i>Hercules</i> používala i v&nbsp;době nástupu grafické karty <i>EGA</i>, jejímž popisem se budeme zabývat až v&nbsp;následující části tohoto seriálu. Firma <i>Hercules Computer Technology</i> vytvořila i následníka této grafické karty &ndash; <i>Hercules Plus</i> &ndash; jenž se odlišoval především v&nbsp;tom, že bylo možné programově měnit znakovou sadu v&nbsp;textovém režimu a docílit tak například zobrazení českých znaků (u původního <i>Herculesu</i> či <i>MDA</i> se znaková sada měnila přeprogramováním paměti EPROM).</p>

<a href="http://i.iinfo.cz/images/360/pc84-10.png"><img src="http://i.iinfo.cz/images/360/pc84-10-prev.png" alt="pc84" height="202" width="370" /></a>
<p><i>Obrázek 10: T602 zobrazený kartou EGA v&nbsp;rozlišení 640&times;350 v&nbsp;šestnácti barvách.</i></p>



<p><a name="k17"></a></p>
<h2 id="k17">17. Základní technické parametry karty Hercules</h2>

<p>Grafická karta <i>Hercules</i> je založena, podobně jako oba již popsané grafické adaptéry firmy IBM, na čipu <i>Motorola MC6845</i>, nebo (v&nbsp;případě klonů) na VLSI obvodu se stejnými vlastnostmi i významem řídicích portů. Jak bude z&nbsp;dalšího popisu patrné, je čip <i>MC6845</i> v&nbsp;této kartě zapojen a naprogramován poněkud jiným způsobem než tomu bylo u grafické karty <i>CGA</i> i <i>MDA</i>. Kartu <i>Hercules</i> lze připojit do osmibitové sběrnice ISA (v&nbsp;dokumentaci firmy IBM také označované termínem PC-BUS), přičemž se předpokládalo, že frekvence hodinových signálů této sběrnice bude rovna 4,77 MHz (frekvence základního oscilátoru 14,285 MHz je při generování hodinových signálů dělená třemi). Modernější osobní počítače měly frekvenci hodinových signálů sběrnice ISA zvýšenou na 8, 8.33, 10 či 12 MHz, ovšem při takto vysokých frekvencích mohlo na kartě <i>Hercules</i> docházet k&nbsp;výpadkům dat při zápisu do video paměti. Na grafické kartě byl kromě řadiče, podpůrných obvodů a video paměti přítomný i jeden paralelní port, což také přispívalo k&nbsp;oblíbenosti <i>Herculesu</i> mezi zákazníky, protože první personální počítače typu IBM PC tyto porty neměly nainstalovány přímo na základní desce a bylo je zapotřebí zvlášť dokupovat (a tím mimo jiné přicházet o jednu pozici na ISA sběrnici).</p>

<a href="http://i.iinfo.cz/images/360/pc84-11.png"><img src="http://i.iinfo.cz/images/360/pc84-11-prev.png" alt="pc84" height="270" width="360" /></a>
<p><i>Obrázek 11: Textový editor T602 zobrazený poměrně neznámou kartou MCGA, která v&nbsp;režimu nejvyššího rozlišení 640&times;480 měla jen jednu bitovou rovinu a tím pádem podporovala pouze dvě barvy.</i></p>

<p>Kapacita obrazové paměti byla oproti kartě <i>CGA</i> zvýšena na dvojnásobek, tj.&nbsp;na 32&nbsp;kB. Kromě paměťových modulů tvořících obrazovou paměť byla na kartě nainstalována i paměť typu ROM popř.&nbsp;EPROM, ve které byla uložena znaková sada. tj.&nbsp;bitové podoby znaků (viz další kapitola). Ovládání grafického čipu bylo prováděno pomocí parametrů ukládaných přes vstupně/výstupní porty umístěné na adresách <strong>0x3b0</strong> až <strong>0x3bf</strong>, přičemž na adresy <strong>0x3b4</strong> a <strong>0x3b5</strong> byly namapovány řídicí registry čipu <i>MC6845</i> (těchto registrů je, jak již víme z&nbsp;předchozí části tohoto seriálu, celkem osmnáct). Vhodnou změnou parametrů docházelo k&nbsp;přepínání mezi textovým a grafickým režimem, bylo však možné také měnit parametry zobrazení grafiky (rozlišení, zpoždění synchronizačních signálů, pozice hardwarového textového kurzoru, mikroposun textových řádků apod.), čehož se často používalo při emulaci grafických režimů karty <i>CGA</i>.</p>

<a href="http://i.iinfo.cz/images/360/pc84-12.png"><img src="http://i.iinfo.cz/images/360/pc84-12-prev.png" alt="pc84" height="270" width="360" /></a>
<p><i>Obrázek 12: Nejlepší rozlišení i největší počet barev pro textový editor T602 nabízela grafická karta VGA &ndash; 640&times;480 pixelů v&nbsp;šestnácti barvách (editor však využil jen podmnožinu barvové palety).</i></p>

<p>Čtením stavových bitů z&nbsp;portu <strong>0x3ba</strong> bylo možné testovat průběh horizontálního i vertikálního zatemnění (synchronizace používaná například ve hrách) a číst polohu hrotu světelného pera. Vzhledem k&nbsp;tomu, že grafická paměť byla z&nbsp;hlediska mikroprocesoru mapována od adresy <strong>b000:0000</strong> do adresy <strong>b000:7fff</strong> (způsob adresování segment:offset), nedocházelo k&nbsp;překryvu s&nbsp;obrazovou pamětí grafické karty <i>CGA</i> a proto lze tyto dvě karty provozovat současně i na jednom počítači. Taktéž nedochází k&nbsp;překryvům vstupně/výstupních portů, neboť ty jsou v&nbsp;případě karty <i>CGA</i> umístěny o 16 bajtů výše. <i>Hercules</i> je v&nbsp;případě použití této kombinace využit pro kvalitní zobrazování textu a monochromatické grafiky, <i>CGA</i> pro zobrazení barevné (ehm :-) grafiky. Další poměrně oblíbenou kombinací z&nbsp;pozdější doby byla <i>VGA</i>+<i>Hercules</i>, ovšem v&nbsp;tomto případě <i>Hercules</i> většinou sloužil pro práci v&nbsp;textovém režimu (IDE firmy Borland, AutoCAD atd.).</p>



<p><a name="k18"></a></p>
<h2 id="k18">18. Textový režim karty Hercules</h2>

<p>V&times;textovém režimu je grafická karta <i>Hercules</i> prakticky stoprocentně kompatibilní s&nbsp;kartou <i>MDA</i>, tj.&nbsp;pracuje se s&nbsp;textem o 80 sloupcích a 25 řádcích, včetně stejného způsobu práce s&nbsp;atributy jednotlivých znaků (podtržení apod.). Text je zobrazován v&nbsp;rozlišení 720&nbsp;350 pixelů, což umožňuje na jeden znak použít masku o velikosti 9&times;14 pixelů. Textovou obrazovku lze mapovat buď od adresy <strong>b000:0000</strong> nebo od adresy <strong>b800:0000</strong>. Jedinou nevýhodou textového režimu grafické karty <i>Hercules</i> je fakt, že znaková sada je uložena v&nbsp;paměti EPROM typu 27C64 a nelze ji tedy programově změnit, pouze &bdquo;přepálit&ldquo; (pro zajímavost &ndash; všechny <i>Herculesy</i> s&nbsp;&bdquo;přepálenou&ldquo; znakovou sadou, které jsem viděl, používaly kódování Kamenických, viz další odstavec). Tvary znaků jsou v&nbsp;paměti EPROM uloženy tak, jakoby jejich maska měla velikost 8&times;16 pixelů, avšak pro každý znak se při jeho vykreslování dva řádky ignorují a podle pozice znaku v&nbsp;ASCII tabulce se doplňuje devátý sloupec pixelů, čímž se dostáváme k&nbsp;výsledné masce 9&times;14 pixelů (devátý sloupec vzniká kopií osmého sloupce u znaků představujících rámečky).</p>

<p>Z&nbsp;výše uvedených informací vyplývá, že pro uložení celé znakové sady by měly dostačovat pouhé čtyři kilobajty, neboť 16 řádků&times;1 bajt&times;256 znaků=4096 bajtů. Ovšem vzhledem k&nbsp;tomu, že paměť EPROM 27C64 má kapacitu 8&nbsp;kB, jsou horní 4&nbsp;kB nevyužity. Vhodnou hardwarovou úpravou je však možné implementovat dvě znakové sady &ndash; u nás se většinou používala originální sada US-ASCII a již zmíněné české znaky v&nbsp;kódu Kamenických.  Kromě původní karty <i>Hercules</i> se vyráběla taktéž již zmíněná karta <i>Hercules Plus</i>, která se od původního modelu odlišuje především v&nbsp;tom, že znakovou sadu ukládá do paměti typu (D)RAM a umožňuje tak programově měnit používanou znakovou sadu. U této karty je dokonce možné rozšířit počet znaků ve znakové sadě až na teoretickou hodnotu 2<sup>12</sup>=4096 tím způsobem, že se čtyři bity v&nbsp;atributovém bajtu použijí na definici atributů znaků a zbylé čtyři bity se připojí k&nbsp;osmibitovému ASCII kódu znaku. Ne všechny kódy však mohou být skutečně využity, protože velikost paměti vyhrazené pro znakovou sadu dosahuje 48 kB a ne 64 kB.</p>



<p><a name="k19"></a></p>
<h2 id="k19">19. Grafický režim karty Hercules</h2>

<p>Grafický režim karty <i>Hercules</i> je, ostatně jako téměř ve všech obdobných případech, mnohem zajímavější a flexibilnější, než režim textový.  <i>Hercules</i> podporoval na svou dobu poměrně vysoké rozlišení 720&times;348 obrazových bodů zobrazovaných černobíle nebo dvoubarevně. Konkrétní barvy použité při zobrazování byly závislé na typu obrazovky monitoru; kromě obligátní kombinace černá+zelená byla mezi výrobci obrazovek oblíbená například kombinace tmavě modrá a světle červená nebo tmavě modrá a žlutá. Horizontální rozlišení grafického režimu je stejné, jako v&nbsp;případě režimu textového, protože platí 80 znaků na řádku &times; 9 horizontálních pixelů na znak = 720 pixelů. Vertikální rozlišení se však liší o dva skenovací řádky.  V&nbsp;textovém režimu je vertikální rozlišení, tj.&nbsp;počet obrazových řádků, rovno 350 pixelům, protože platí vztah: 25 textových řádků &times; 14 skenovacích/obrazových řádků na výšku znaku=350 skenovacích řádků celkem. V&nbsp;grafickém režimu je zvolena hodnota 348 skenovacích řádků proto, že je toto číslo dělitelné čtyřmi, což souvisí s&nbsp;režimem přístupu do obrazové paměti, jehož princip bude popsán v&nbsp;následujícím odstavci (ostatně změnou řídicích registrů čipu <i>MC6845</i> lze počet obrazových řádků v&nbsp;určitém rozsahu měnit).</p>

<p>Pokud porovnáme signálové poměry obou podporovaných režimů, je grafický režim totožný s&nbsp;režimem textovým. Snížení počtu skenovacích řádků se projeví pouze delším časovým okamžikem vertikálního zpětného běhu elektronového paprsku. Obrazová paměť je při zapnutí grafického režimu rozdělena do čtyřech oblastí. V&nbsp;paměťové oblasti <strong>b000:0000-b000:1fff</strong> se nachází skenovací řádky 0, 4, 8,..., v&nbsp;oblasti <strong>b000:2000-b000:3fff</strong> řádky 1, 5, 9,..., na adresách <strong>b000:4000-b000:5fff</strong> řádky 2, 6, 10, ... a konečně v&nbsp;paměťové oblasti <strong>b000:6000-b000:7fff</strong> skenovací řádky 3, 7, 11, ... . Přístup k&nbsp;jednotlivým pixelům je tak poměrně komplikovaný, což umocňuje také fakt, že v&nbsp;jednom bytu je uložena vždy osmice pixelů.  Celková spotřeba paměti pro grafický režim karty <i>Hercules</i> se dá vypočítat snadno. Na jeden řádek je zapotřebí alokovat 720/8=90 bytů, na celý snímek pak 90&times;348 = 31320 bajtů. Zbylých 1440 bajtů obrazové paměti, která má, jak již víme z&nbsp;předchozího textu kapacitu 32 kB, zůstává nevyužito.</p>

<p>Adresa pro operaci zápisu či čtení pixelu zadaného souřadnicemi <i>x, y</i>
se vypočte následovně:</p>

<pre>
offset = 0x2000 * (y % 4) + 90 * (y &gt;&gt; 2) + (x &gt;&gt; 3)
</pre>

<p>Index bitu, který se má zapsat či přečíst na výše vypočtené adrese, lze
vyjádřit takto:</p>

<pre>
offset bit = 7 - (x % 8)
</pre>



<p><a name="k20"></a></p>
<h2 id="k20">20. Odkazy na Internetu</h2>

<ol>

<li>Support/peripheral/other chips - 6800 family<br />
<a href="http://www.cpu-world.com/Support/6800.html">http://www.cpu-world.com/Support/6800.html</a>
</li>

<li>Motorola 6845<br />
<a href="http://en.wikipedia.org/wiki/Motorola_6845">http://en.wikipedia.org/wiki/Motorola_6845</a>
</li>

<li>The 6845 Cathode Ray Tube Controller (CRTC)<br />
<a href="http://www.tinyvga.com/6845">http://www.tinyvga.com/6845</a>
</li>

<li>IBM Monochrome Display Adapter<br />
<a href="http://en.wikipedia.org/wiki/Monochrome_Display_Adapter">http://en.wikipedia.org/wiki/Monochrome_Display_Adapter</a>
</li>

<li>Color Graphics Adapter<br />
<a href="http://en.wikipedia.org/wiki/Color_Graphics_Adapter">http://en.wikipedia.org/wiki/Color_Graphics_Adapter</a>
</li>

<li>Wikipedia CZ: Sběrnice:<br />
<a href="http://cs.wikipedia.org/wiki/Sb%C4%9Brnice">http://cs.wikipedia.org/wiki/Sb%C4%9Brnice</a>
</li>

<li>Wikipedia EN: Industry Standard Architecture:<br />
<a href="http://en.wikipedia.org/wiki/Industry_Standard_Architecture">http://en.wikipedia.org/wiki/Industry_Standard_Architecture</a>
</li>

<li>Macintosh 128K/512K technical details<br />
<a href="https://en.wikipedia.org/wiki/Macintosh_128K/512K_technical_details">https://en.wikipedia.org/wiki/Macintosh_128K/512K_technical_details</a>
</li>

<li>MOS Technology 6522<br />
<a href="https://en.wikipedia.org/wiki/MOS_Technology_6522">https://en.wikipedia.org/wiki/MOS_Technology_6522</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2021</small></p>
</body>
</html>

