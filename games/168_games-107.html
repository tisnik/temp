<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Historie vývoje poèítaèových her (107. èást - grafický a zvukový subsystém konzole Sega Saturn)</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Historie vývoje poèítaèových her (107. èást - grafický a zvukový subsystém konzole Sega Saturn)</h1>

<h3>Pavel Ti¹novský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V dne¹ní èásti seriálu o historii vývoje her i herního hardware dokonèíme popis interní struktury herní konzole Sega Saturn. Zamìøíme se pøedev¹ím vysvìtlení základních vlastností èipù VDP1, VDP2 a SCSP, které byly urèeny pro vykreslování grafiky i pro generování zvukù a hudby.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Základní funkce vykonávané èipem VDP1</a></p>
<p><a href="#k02">2. Struktura obrazové pamìti</a></p>
<p><a href="#k03">3. Podporované grafické re¾imy pøi pøipojení Saturnu k&nbsp;televizoru</a></p>
<p><a href="#k04">4. Tabulky s&nbsp;vykreslovacími pøíkazy</a></p>
<p><a href="#k05">5. Typy objektù, které lze èipem VDP1 vykreslit</a></p>
<p><a href="#k06">6. Zobecnìné sprity jako základ pro 3D grafiku</a></p>
<p><a href="#k07">7. Otoèení framebufferu</a></p>
<p><a href="#k08">8. Základní funkce vykonávané èipem VDP2</a></p>
<p><a href="#k09">9. Zvukový subsystém herní konzole Sega Saturn</a></p>
<p><a href="#k10">10. FM syntéza, nastavení operátorù</a></p>
<p><a href="#k11">11. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Základní funkce vykonávané èipem VDP1</h2>

<p>V&nbsp;pøedchozí èásti <a
href="http://www.root.cz/serialy/unixove-vykopavky/">seriálu o historii vývoje
her a herního hardware</a> byla popsána interní struktura herní konzole <i>Sega
Saturn</i>. Pøipomeòme si, ¾e konstruktéøi této herní konzole pøi jejím návrhu
pou¾ili pomìrnì velké mno¾ství rùzných èipù, které spolu dokázaly komunikovat
s&nbsp;vyu¾itím tøech interních sbìrnic. Základem této herní konzole byly
mikroprocesory <i>Hitachi SH-2</i> s&nbsp;architekturou RISC. Dále tato herní
konzole obsahovala èip <i>SMPC (System Manager and Peripheral Control)</i>,
jen¾ se staral napøíklad o ètení dat z&nbsp;pøipojených periferních zaøízení.
Ústøedním prvkem konzole <i>Sega Saturn</i> byl integrovaný obvod <i>SCU
(System Control Unit)</i> starající se pøedev¹ím o zaji¹tìní komunikace
ostatních modulù. Dal¹ími specializovanými obvody, které si popí¹eme dnes, jsou
èipy <i>VDP1 (Video Processor 1)</i>, <i>VDP2 (Video Processor 2)</i> a <i>SCSP
(Saturn Custom Sound Processor)</i>, jen¾ byl doplnìný podpùrným øadièem
<i>Motorola MC68E000</i>.</p>

<img src="http://i.iinfo.cz/images/123/sega-saturn-1.png" class="image-155159" width="262" height="243" alt="&#160;" />
<p><i>Obrázek 1: Blokové schéma herní konzole Sega Saturn, které jsme si
popsali v&nbsp;pøedchozí èásti tohoto seriálu.</i></p>

<p>O generování grafiky se starala dvojice èipù <i>VDP1</i> a <i>VDP2</i>,
která byla navíc doplnìna nìkolika pamì»mi. Zamìøme se nyní pøedev¹ím na èip
<i>VDP1</i>, proto¾e právì tento èip svými vlastnostmi a schopnostmi do znaèné
míry urèoval grafické mo¾nosti <i>Saturnu</i>, které byly znaènì odli¹né od
v¹ech dal¹ích herních konzolí (nejenom) páté generace. Tento èip v&nbsp;první
øadì øídil ve¹keré vykreslování, a to na základì údajù, pøíkazù a obrazových
dat ulo¾ených v&nbsp;jeho øídicích registrech a pøedev¹ím pak v&nbsp;obrazové
pamìti. Dále èip <i>VDP1</i> dokázal v&nbsp;prùbìhu vykreslování provádìt dal¹í
specializované operace, napøíklad výpoèet barev v&nbsp;prostoru RGB (Gouraudovo
stínování, poloprùhlednost, sní¾ení jasu za úèelem vytvoøení stínu atd.) a
dokonce bylo mo¾né i otoèit celým framebufferem a dosáhnout tak nìkterých
zajímavých grafických efektù. Vykreslování bylo øízeno hodinovým signálem o
frekvenci 28 MHz (stejnou frekvencí byly øízeny i oba mikroprocesory), pøièem¾
jeden cyklus hodin odpovídal vykreslení jednoho pixelu.</p>

<img src="http://i.iinfo.cz/images/123/sega-saturn-2.png" class="image-155160" width="397" height="91" alt="&#160;" />
<p><i>Obrázek 2: Grafický subsystém herní konzole Sega Saturn tvoøený video
procesory VDP1 a VDP2 i nìkolika pamì»mi.</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Struktura obrazové pamìti</h2>

<p>Vzhledem ke zpùsobu vykreslování grafiky nepøímo (s&nbsp;vyu¾itím
vykreslovacích pøíkazù a èipù <i>VDP1</i> a <i>VDP2</i>) bylo pøi návrhu
interní struktury herní konzole <i>Sega Saturn</i> nutné oddìlit hlavní
operaèní pamì» od pamìti grafické, aby mohly oba RISCové mikroprocesory
v&nbsp;ideálním pøípadì pracovat nezávisle na obou grafických procesorech.
Tento po¾adavek vyústil v&nbsp;pøekvapivì moderní návrh struktury obrazové
pamìti, která byla rozdìlena do nìkolika blokù (regionù) s&nbsp;rùznou
kapacitou a takté¾ odli¹nou funkcí. Obrazová pamì» byla od hlavní pamìti
oddìlena skuteènì dùslednì, proto¾e hlavní pamì» byla spoleènì s&nbsp;obìma
RIScovými mikroprocesory pøipojena k&nbsp;interní sbìrnici <i>CPU-Bus</i>,
zatímco obrazová pamì» byla pøipojena ke sbìrnici <i>B-Bus</i> a tím pádem
k&nbsp;ní mohly nejsnáze pøistupovat právì video èipy (ov¹em díky <i>SCU</i>
bylo snadné pøeru¹it vykreslování a zapisovat data do framebufferu pøímo
nìkterým z&nbsp;hlavních mikroprocesorù).</p>

<img src="http://i.iinfo.cz/images/660/pc93-1.png" alt="pc93" height="275" width="450" />
<p><i>Obrázek 3: Vykreslovací øetìzec pou¾ívaný klasickými grafickými
akcelerátory pøi zpracovávání trojrozmìrných scén. Do vykreslovacího øetìzce
vstupují dva typy dat &ndash; informace o vrcholech polygonù (trojúhelníkù,
plo¹ných ètyøúhelníkù atd.) a rastrová data, vìt¹inou bitmapy (znaky
v&nbsp;rastrové podobì, bitové masky, sprity, kurzory my¹i) a pøedev¹ím textury
naná¹ené na vykreslované polygony. V&nbsp;herní konzoli Sega Saturn byl pou¾it
odli¹ný systém, kdy se nìkteré operace musely implementovat programovì.</i></p>

<p>Video procesor <i>VDP1</i> pøistupoval k&nbsp;samostatné obrazové pamìti o
kapacitì jednoho megabajtu. Tato obrazová pamì» byla postavena na technologii
DRAM, co¾ znamená, ¾e se nejednalo o ¾ádnou specializovanou technologii (to ani
nebylo vzhledem k&nbsp;relativnì nízkým pøenosovým rychlostem a po¾adované dobì
pøístupu nutné). Polovina, tj.&nbsp;512kB obrazové pamìti bylo vyhrazeno pro
ulo¾ení tabulek s&nbsp;vykreslovacími pøíkazy a takté¾ rastrovými daty
pou¾itými mj.&nbsp;i pro texturování a vykreslování spritù. Dal¹ích 512kB bylo
vyhrazeno pro klasický framebuffer. Vzhledem k&nbsp;podpoøe pøedního a zadního
bufferu (<i>front buffer</i>), (<i>back buffer</i>) se zmínìných 512 kB
rozdìlilo na poloviny o kapacitì 256 kB, pøièem¾ bitová hloubka mohla být 8bpp
èi 16bpp v&nbsp;závislosti na zvoleném grafickém re¾imu. Pov¹imnìte si, ¾e
v&nbsp;<i>Saturnu</i> nenalezneme napøíklad pamì» hloubky (<i>depth buffer,
Z-buffer</i>) ani dal¹í typy bufferù, s&nbsp;nimi¾ se mù¾eme setkat na
souèasných grafických akcelerátorech (<i>accumulation buffer</i>, <i>stencil
buffer</i>). Zpùsob vykreslování s&nbsp;vyu¾itím <i>VDP1</i> a <i>VDP2</i> byl
toti¾ v&nbsp;porovnání se souèasnými systémy znaènì odli¹ný.</p>

<img src="http://i.iinfo.cz/images/660/pc93-7.png" alt="pc93" height="280" width="450" />
<p><i>Obrázek 4: Typické operace s&nbsp;takzvanými fragmenty (pixely
s&nbsp;pøiøazenou hloubkou) provádìné pøi rasterizaci trojúhelníkù èi
obecnìj¹ích konvexních polygonù na grafickém akcelerátoru. Naznaèené operace
s&nbsp;fragmenty je mo¾né pomìrnì snadno programovì implementovat,
popø.&nbsp;nìkteré z&nbsp;nich realizovat na specializovaných èipech, mezi nì¾
patøí i VDP1 a VDP2.</i></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Podporované grafické re¾imy pøi pøipojení Saturnu k&nbsp;televizoru</h2>

<p>Ka¾dý buffer (<i>front buffer</i>, <i>back buffer</i>) o kapacitì 256kB
postaèoval pro ulo¾ení celého snímku, proto¾e herní konzole <i>Sega Saturn</i>
podporovala pouze grafické re¾imy se støedním rozli¹ením a bitovou hloubkou
8bpp èi 16bpp (relativnì nízké rozli¹ení v¹ak pøed pøíchodem HDTV pøíli¹
nevadilo). V&nbsp;následující tabulce jsou vypsány grafické re¾imy dostupné pøi
pøipojení <i>Saturnu</i> k&nbsp;bì¾ným televizorùm:</p>

<table>
<tr><th>Typ</th><th>Bitová hloubka</th><th>Rozli¹ení (PAL+NTSC)</th><th>Rozli¹ení (pouze PAL)</th></tr>
<tr><td>Normal neprokládané</td><td>16</td><td>320&times;224<br />320&times;240<br />352&times;224<br />352&times;240</td><td>320&times;256<br />352&times;256</td></tr>
<tr><td>Normal prokládané  </td><td> 8</td><td>320&times;448<br />320&times;480<br />352&times;448<br />352&times;480</td><td>320&times;512<br />352&times;512</td></tr>
</table>

<p>Pov¹imnìte si, ¾e v&nbsp;pøípadì pou¾ití televizoru pracujícího v&nbsp;normì
PAL bylo dostupné i rozli¹ení s&nbsp;256 resp.&nbsp;512 obrazovými øádky,
zatímco v&nbsp;normì NTSC toto rozli¹ení kvùli rozdílnému èasování nebylo mo¾né
vyu¾ít. V&nbsp;neprokládaných (<i>non-interlaced</i>) grafických re¾imech byly
v¾dy dva po sobì jdoucí pùlsnímky shodné, zatímco v&nbsp;re¾imech prokládaných
(<i>interlaced</i>) se oba pùlsnímky mohly odli¹ovat, èím¾ sice bylo mo¾né
dosáhnout dvojnásobného vertikálního rozli¹ení, ov¹em na úkor stability obrazu,
vzniku nepøíjemné poblikávání atd. Kromì re¾imù vypsaných v&nbsp;pøedchozí
tabulce bylo mo¾né pou¾ít i takzvaný HTDV re¾im, v&nbsp;nìm¾ se pixely
sdru¾ovaly do blokù 2&times;2.</p>

<p>Nezávisle na zvoleném grafickém re¾imu mohla mít struktura framebufferu dvì
podoby. Pøi pou¾ití bitové hloubky 16bpp byla velikost virtuální kreslicí
plochy rovna 512&times;256 pixelùm, zatímco pøi pou¾ití polovièní bitové
hloubky 8bpp se virtuální kreslicí plocha zvìt¹ila na 512&times;512 pixelù
(ov¹em souøadnice pro vykreslování objektù mohly mít rozsah -1024 a¾ 1023
v&nbsp;ose X i v&nbsp;ose Y). Dá se snadno vypoèítat, ¾e v&nbsp;obou pøípadech
se bezezbytku vyu¾ila celá kapacita obou bufferù, tj.&nbsp;256+256 kB.</p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Tabulky s&nbsp;vykreslovacími pøíkazy</h2>

<p>Èip <i>VDP1</i> pracuje jako samostatný specializovaný procesor, který
z&nbsp;obrazové pamìti (konkrétnì z&nbsp;prvních 512 kB) postupnì ète
vykreslovací pøíkazy, provádí vlastní vykreslování (rendering) a ukládá
výsledek vykreslování do zadního bufferu (<i>back buffer</i>), tj.&nbsp;do
bufferu, který aktuálnì není zobrazen na televizoru. Po vykreslení celého
snímku se úlohy pøedního a zadního bufferu mohou automaticky prohodit. Nyní se
budeme zabývat samotnými <i>vykreslovacími pøíkazy</i>, proto¾e právì
v&nbsp;této oblasti se herní konzole <i>Sega Saturn</i> odli¹uje od vìt¹iny
dal¹ích herních konzolí a vlastnì i od osobních mikropoèítaèù. Vykreslovací
pøíkazy mohou být do obrazové pamìti ulo¾eny buï jedním z&nbsp;hlavních
mikroprocesorù, nebo sem mohou být pøeneseny s&nbsp;vyu¾itím DMA (pøímý pøístup
do pamìti). Jednotlivé vykreslovací pøíkazy jsou strukturovány do takzvaných
<i>tabulek pøíkazù</i>, které jsou doplnìny tabulkami s&nbsp;bitmapovými vzorky
(moderním jazykem jim mù¾eme øíkat <i>textury</i>), tabulkami pou¾itými pro
Gouraudovo stínování a koneènì tabulkami obsahujícími barvovou paletu.</p>

<p>Tabulky pøíkazù budou vysvìtleny v&nbsp;následující kapitole, tak¾e nám
zbývají tøi typy tabulek &ndash; textury/sprity, barvy a tabulky pro Gouraudovo
stínování. Textury èi sprity jsou ukládány jako bì¾né rastrové obrázky
s&nbsp;volitelnou barvovou hloubkou, typicky 4bpp (barvová paleta), 8bpp
(takté¾ barvová paleta) èi 16bpp (RGB "555"). Tabulky s&nbsp;barvovou paletou
jsou v&nbsp;základním re¾imu pomìrnì jednoduché &ndash; obsahují toti¾
¹estnáctibitové záznamy barev ve formátu RGB, pøièem¾ na ka¾dou barvu je
vyu¾ito pìt bitù (formát "555", poslední bit mù¾e mít rùzný význam, typicky
reprezentuje prùhlednost 0% èi 100%). Tabulky s&nbsp;barvami pou¾itými pro
Gouraudovo stínování obsahují takté¾ barvy ve formátu RGB ("555"), a to pro
ètyøi vrcholy. Pøi vykreslování se provádí interpolace mezi v¹emi ètyømi
barvami, co¾ znamená, ¾e <i>Sega Saturn</i> doká¾e mìnit i barvové odstíny a
nejenom svìtlost (klasický algoritmus Gouraudova stínování pøitom mìní jen
svìtlost).</p>

<img src="http://i.iinfo.cz/images/660/pc93-2.jpg" alt="pc93" height="260" width="368" />
<p><i>Obrázek 5: Slavná Uta¾ská èajová konvice (Utah teapot) vykreslená pomocí
grafického akcelerátoru. Povrch konvice byl pøed provedením vykreslování
programovì pøeveden ze spline ploch na sí» trojúhelníkù a ètyøúhelníkù. Pro
ka¾dý vrchol polygonu byla programovì vypoètena jeho barva pomocí Phongova
osvìtlovacího modelu a polygony byly následnì vykresleny na akcelerátoru
s&nbsp;vyu¾itím Gouraudova stínování, které interpoluje barvu v&nbsp;ka¾dém
bodì povrchu polygonu na základì pozice tohoto bodu oproti vrcholùm polygonu.
Algoritmus Gouraudova stínování je tak jednoduchý, ¾e ho bylo mo¾né relativnì
snadno implementovat ji¾ v&nbsp;první generaci 3D grafických akcelerátorù i na
konzoli Sega Saturn.</i></p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Typy objektù, které lze èipem VDP1 vykreslit</h2>

<p>Pøíkazy, které doká¾e video procesor <i>VDP1</i> vykonávat, je mo¾né
rozdìlit do tøí skupin. V&nbsp;první skupinì se nachází pøíkazy pro
vykreslování, ve skupinì druhé pøíkazy pro nastavení oøezávání vykreslovaných
objektù a koneènì ve skupinì tøetí mù¾eme najít pøíkazy pou¾itelné pro
nastavení a zmìnu souøadného systému. Nejzajímavìj¹í jsou samozøejmì
vykreslovací pøíkazy. <i>VDP1</i> doká¾e vykreslit otevøené objekty (úseèky a
polyèáry), uzavøené objekty vyplnìné barvou (polygony) a koneènì uzavøené
objekty pokryté rastrovým obrázkem/texturou (sprity nìkolika typù). V¹echny
typy objektù, s&nbsp;nimi¾ doká¾e <i>VDP1</i> pracovat (pøesnìji øeèeno, které
doká¾e vykreslit) jsou vypsány v&nbsp;následující tabulce:</p>

<table>
<tr><th>#</th><th>Objekt</th><th>Skupina</th><th>Typ</th><th>Zpùsob zadání</th></tr>
<tr><td>1</td><td>Úseèka</td><td>Bez textury</td><td>Otevøené objekty</td><td>dva vrcholy V1 a V2</td></tr>
<tr><td>2</td><td>Polyèára</td><td>Bez textury</td><td>Otevøené objekty</td><td>ètyøi vrcholy V1, V2, V3 a V4</td></tr>
<tr><td>3</td><td>Polygon</td><td>Bez textury</td><td>Výplò barvou</td><td>ètyøi vrcholy V1, V2, V3 a V4</td></tr>
<tr><td>4</td><td>Sprite#1</td><td>S texturou</td><td>Výplò texturou</td><td>jeden vrchol V1 + pøíznaky zrcadlení</td></tr>
<tr><td>5</td><td>Sprite#2</td><td>S texturou</td><td>Výplò texturou</td><td>dva protilehlé vrcholy (zmìna mìøítka)</td></tr>
<tr><td>6</td><td>Sprite#3</td><td>S texturou</td><td>Výplò texturou</td><td>ètyøi vrcholy V1, V2, V3 a V4</td></tr>
</table>

<p>Nejjednodu¹¹ím grafickým objektem je úseèka, která je zadána dvìma vrcholy a
samozøejmì i dal¹ími pøíznaky, zejména barvou. Dal¹í dva typy objektù &ndash;
polyèára a polygon &ndash; mají spoleènou jednu základní vlastnost: jsou zadány
ètyømi vrcholy a mù¾e se jednat jak o konvexní, tak i o konkávní útvary
(dokonce lze hrany pøekøí¾it), co¾ je rozdílné oproti nìkterým dal¹ím typùm
grafických subsystémù, kde jsou buï podporovány pouze trojúhelníky (které jsou
konvexní ji¾ z&nbsp;geometrické podstaty), popø.&nbsp;obecnìj¹í konvexní
mnohoúhelníky.</p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Zobecnìné sprity jako základ pro 3D grafiku</h2>

<p>Nejzajímavìj¹ími typy objektù podporovaných video procesorem <i>VDP1</i>
jsou sprity. Jak ji¾ bylo naznaèeno v&nbsp;tabulce zobrazené <a
href="#k05">v&nbsp;pøedchozí kapitole</a>, existují tøi typy spritù, které jsem
pro jednoduchost oznaèil èísly #1, #2 a #3. Sprity patøící do první skupiny
jsou urèeny jediným vrcholem, odkazem na bitmapu a dvojicí bitových pøíznakù,
které urèují horizontální a/nebo vertikální zrcadlení spritu. Tento typ spritù
se tedy pou¾ívá pøevá¾nì v&nbsp;2D hrách a má podobné vlastnosti jako klasické
sprity, které známe ji¾ z&nbsp;popisu osmibitových a ¹estnáctibitových herních
konzolí, ov¹em s&nbsp;tím rozdílem, ¾e sprity mohou mít v&nbsp;pøípadì konzole
<i>Sega Saturn</i> rùznou velikost a rùznou bitovou hloubku, podle po¾adavkù
vývojáøù.</p>

<img src="http://i.iinfo.cz/images/442/obr1.png" class="image-156651" width="512" height="137" alt="&#160;" />
<p><i>Obrázek 6: První typ spritù. Velikost spritu nelze mìnit, ale pou¾itím
dvou bitových pøíznakù je mo¾né sprity zrcadlit, a to nezávisle ve vertikálním
i horizontálním smìru.</i></p>

<p>Druhý typ spritù je zadán dvojicí protilehlých vrcholù, co¾ znamená, ¾e je
mo¾né snadno specifikovat zmìnu mìøítka v&nbsp;horizontálním a vertikálním
smìru. Tento typ spritù je tedy mo¾né &bdquo;natahovat&ldquo; a
&bdquo;stlaèovat&ldquo; jednodu¹e tak, ¾e se bude mìnit poloha druhého
vrcholu.</p>

<img src="http://i.iinfo.cz/images/413/obr2.png" class="image-156654" width="524" height="200" alt="&#160;" />
<p><i>Obrázek 7: Druhý typ spritù je zadán dvìma protilehlými vrcholy. Zmìnou
vzájemné polohy vrcholù lze mìnit mìøítko spritu, a to opìt nezávisle
v&nbsp;horizontálním i ve vertikálním smìru.</i></p>

<p>Ov¹em konstruktéøi konzole <i>Sega Saturn</i> se s&nbsp;tìmito mo¾nostmi
nespokojili a vybavili video procesor <i>VDP1</i> i sprity tøetího typu, které
jsou specifikovány ètyømi vrcholy. Zmìnou souøadnic tìchto vrcholù lze sprite
libovolnì natahovat, otáèet jím a dokonce i pøekøí¾it dvì hrany &ndash;
<i>VDP1</i> stále bude provádìt korektní vykreslování. Na tento typ spritù se
tedy mù¾eme dívat jako na otexturovaný obecný ètyøúhelník! (a¾ na absenci
perspektivního zkreslení, i to je v¹ak èásteènì podporováno).</p>

<img src="http://i.iinfo.cz/images/548/obr3.png" class="image-156652" width="529" height="154" alt="&#160;" />
<p><i>Obrázek 8: Tøetí typ spritù je zadán ètyømi vrcholy, které mohou mít
prakticky zcela libovolnou vzájemnou polohu, co¾ v&nbsp;nìkterých pøípadech
mù¾e vést ke vzniku tvaru s&nbsp;pøekøí¾enými hranami.</i></p>

<p>Grafický subsystém <i>Segy Saturn</i> se v&nbsp;tomto ohledu znaènì
odli¹oval od ostatních 3D systémù, které byly vìt¹inou zalo¾eny na
trojúhelnících pokrytých texturou, ov¹em s&nbsp;tím, ¾e souøadnice
v&nbsp;prostoru textur (uv) bylo mo¾né specifikovat pro ka¾dý vrchol
trojúhelníka. Sega Saturn namísto trojúhelníkù nabízela ètyøúhelníky, co¾ je
z&nbsp;urèitého pohledu vylep¹ení, ov¹em na druhou stranu nebylo snadné mìnit
souøadnice v&nbsp;prostoru textury, nebo» celý ètyøúhelník/sprite byl pokryt
v¾dy celou bitmapou. Samozøejmì existovaly rùzné triky, jak toto omezení
obejít, i tak se v¹ak pro vývojáøe i grafiky (3D modeláøe) jednalo o ponìkud
neobvyklý systém, s&nbsp;ním¾ se prakticky nikdy plnì nes¾ili, co¾ je mo¾ná
¹koda.</p>



<p><a name="k07"></a></p>
<h2 id="k07">7. Otoèení framebufferu</h2>

<p>Musíme se zmínit je¹tì o dal¹í zajímavé a neobvyklé funkci nabízené tandemem
èipù <i>VDP1+VDP2</i>. Jedná se o otáèení celého framebufferu. Obsah
framebufferu se toti¾ pøi zobrazování nemusel èíst øádek po øádku, jak je to
bì¾né, ale mohl probíhat diagonálnì. Tím se vlastnì zajistila rotace
vykresleného snímku. Pokud pøi ètení a vykreslování orotovaného framebufferu
do¹lo k&nbsp;pokusu o ètení barvy pixelu le¾ícího mimo virtuální obrazovku, byl
takový pixel chápán jako prùhledný, tak¾e ve snímku zobrazeném na televizoru
nedo¹lo ke vzniku ne¾ádoucích poruch. Pøi otáèení framebufferu se vìt¹inou
nastavovala osmibitová hloubka, èím¾ do¹lo k&nbsp;roz¹íøení virtuálního snímku
z&nbsp;512&times;256 pixelù na 512&times;512 pixelù, co¾ je výhodnìj¹í, proto¾e
horizontální rozli¹ení 512 pixelù je dostateènì velké v&nbsp;porovnání
s&nbsp;fyzickým horizontálním rozli¹ením 320 èi 352 pixelù, zatímco vertikální
rozli¹ení 256 pixelù je ji¾ srovnatelné (a tudí¾ nedostateèné) v&nbsp;porovnání
s&nbsp;fyzickým vertikálním rozli¹ením 224, 240 èi dokonce 256 obrazových
øádkù.</p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Základní funkce vykonávané èipem VDP2</h2>

<p>Spoleènì s&nbsp;popisem rotace celého framebufferu uvedeného <a
href="#k07">v&nbsp;pøedchozí kapitole</a> se koneènì dostáváme ke druhému video
procesoru nazvanému jednodu¹e <i>VDP2</i>. Hlavním úkolem tohoto èipu bylo
zpracování obrazových dat pøicházejících z&nbsp;prvního video procesoru
<i>VDP1</i> a pøípadná kombinace tìchto dat s&nbsp;obrazovými daty
pocházejícími z&nbsp;externího zdroje (mohlo se napøíklad jednat o dekódovaný
video stream ulo¾ený ve formátu MPEG na CD-ROM). Výsledkem èinnosti
integrovaného obvodu <i>VDP2</i> ji¾ byly barvonosné a synchronizaèní signály
posílané po dal¹ím zpracování (vìt¹inou jen VF modulace, ...) pøímo na
televizor. Èip <i>VDP2</i> navíc obsahoval interní pamì» RAM o kapacitì ètyøi
kilobajty, která slou¾ila pro ulo¾ení barvových palet ve formátu RGB "555"
(tj.&nbsp;pìt bitù rezervovaných pro ka¾dou barvovou slo¾ku) i ve formátu RGB
"888" (osm bitù na rezervovaných ka¾dou barvovou slo¾ku).</p>

<p>Kromì toho dokázal èip <i>VDP1</i> provádìt i dal¹í grafické operace,
napøíklad urèoval prioritu zobrazení jednotlivých typù objektù, dokázal
provádìt scrolling obrazu, zmìnu mìøítka obrazu èi vybraného grafického
objektu, rotace okolo tøí os (vèetnì perspektivního zkreslení) i nìkteré
pokroèilej¹í grafické operace typu práce s&nbsp;barvami (pøiètení offsetu
k&nbsp;barvám, výpoèet stínù &ndash; barvy polovièního jasu...), efekt
&bdquo;pixelate&ldquo; a dokonce i efekt &bdquo;motion blur&ldquo;.
Pravdìpodobnì nejzajímavìj¹í operací je ji¾ zmínìná rotace èi zmìna mìøítka
nìkterého dvourozmìrného objektu, proto¾e samotná transformace byla
pøedstavována transformaèní maticí 3&times;3, co¾ znamenalo mo¾nost provádìní i
dal¹ích typù transformací (rotace+zmìna mìøítka, zrcadlení, zkosení). Tuto
rotaci bylo mo¾né vyu¾ít spoleènì s&nbsp;vý¹e zmínìným vykreslováním spritù pro
tvorbu trojrozmìrných scén, ov¹em s&nbsp;tím omezením, ¾e viditelnost musela
být vypoètena programovì kvùli absenci plnohodnotné pamìti hloubky
(<i>depth/Z-bufferu</i>).</p>



<p><a name="k09"></a></p>
<h2 id="k09">9. Zvukový subsystém herní konzole Sega Saturn</h2>

<p>Zvukový subsystém herní konzole <i>Sega Saturn</i> byl slo¾en, podobnì jako
tomu bylo u grafického subsystému, ze dvou èipù a samostatné pamìti vyhrazené
pro ulo¾ení zvukových vzorkù a dal¹ích dat. Základem zvukového subsystému byl
èip <i>SCSP</i>, jen¾ dokázal vytváøet zvuky a hudbu buï pouhým pøehráváním
vzorkù s&nbsp;aplikovanými filtry (DSP), tak i pomocí FM syntézy. Tomuto èipu
asistoval mikroprocesor <i>Motorola MC68EC000</i> a ji¾ zmínìná pamì» o
kapacitì 512 kB. Zvukové schopnosti konzole <i>Sega Saturn</i> vùbec nebyly na
dobu jejího vzniku ¹patné &ndash; v¹echny zvuky se zpracovávaly digitálnì se
vzorkovací frekvencí 44,1 kHz (&bdquo;CD kvalita&ldquo;), byl podporován stereo
výstup a samotná hudba mohla vznikat v&nbsp;32 kanálech, které bylo
v&nbsp;pøípadì potøeby mo¾né spojit a pou¾ít je pro FM syntézu. Kromì toho
obsahoval <i>SCSP</i> i digitální mixér (zesílení, panning, ...) a pou¾ít bylo
mo¾né i rozhraní MIDI.</p>

<img src="http://i.iinfo.cz/images/658/obr4.png" class="image-156653" width="454" height="223" alt="&#160;" />
<p><i>Obrázek 9: Blokové schéma zvukového subsystému herní konzole Sega
Saturn.</i></p>



<p><a name="k10"></a></p>
<h2 id="k10">10. FM syntéza, nastavení operátorù</h2>

<p>Na èipu <i>SCSP</i> je nejzajímavìj¹í blok urèený pro FM syntézu. Spoleènost
Sega se tohoto typu tvorby zvukù nechtìla vzdát pravdìpodobnì ve snaze o
zachování alespoò èásteèné kompatibility se star¹ími konzolemi Sega, které
mnohdy byly èipem pro FM syntézu vybaveny. Jak jsme si ji¾ øekli
v&nbsp;pøedchozí kapitole, obsahoval <i>SCSP</i> 32 zvukových kanálù, pøièem¾
ka¾dý zvukový kanál bylo mo¾né pou¾ít buï pro pøehrávání zvukových vzorkù
(PCM), popø.&nbsp;bylo mo¾né v¾dy ètyøi kanály spojit a vyu¾ít je pro FM
syntézu (ka¾dý kanál potom pracoval jako &bdquo;operátor&ldquo;).
V&nbsp;extrémním pøípadì tedy bylo mo¾né <i>SCSP</i> nakonfigurovat pro
pøehrávání 32 PCM vzorkù souèasnì na jedné stranì èi pro syntézu hudby pøes FM
s&nbsp;osmi kanály (32/4) na stranì druhé, ov¹em zále¾elo jen na vývojáøích,
zda si napøíklad nezvolí nìjakou støední cestu, napøíklad s&nbsp;osmi PCM
kanály a ¹esti FM kanály.</p>

<img src="http://i.iinfo.cz/images/271/obr5.png" class="image-156655" width="451" height="317" alt="&#160;" />
<p><i>Obrázek 10: Blokové schéma zdroje signálu pro FM syntézu.</i></p>

<p>Pøi vytvoøení FM kanálu mìl ka¾dý operátor na vstupu LFO (<i>Low Frequency
Oscillator</i>), který mohl být vybrán ze ètyø vstupù &ndash; zdroj
obdélníkového signálu, zdroj pilového signálu, zdroj trojúhelníkového signálu a
koneènì generátor bílého ¹umu (zde se neurèovala frekvence). Operátor mìl
pøiøazen i generátor obálky ADSR (Attack, Decay, Sustain, Release), který byl
v&nbsp;SCSP èásteènì upraven na ADDR (Attack, Decay1, Decay2, Release), proto¾e
tøetí èást obálky mohla mít takté¾ specifikován pokles, na rozdíl od jiných
syntetizérù, kde se zde vìt¹inou nacházela pouze konstantní úroveò. Kromì toho
mohla být v&nbsp;pamìti ulo¾ena a následnì vyu¾ita tabulka s&nbsp;funkcí sinus,
tak¾e bylo mo¾né alespoò èásteènì nahradit neexistující zdroj sinusového
signálu, který je pou¾it v&nbsp;mnoha jiných systémech pro FM syntézu. I pøes
pomìrnì pokroèilou technologii, kterou èip SCSP nabízel, v¹ak byla FM syntéza
vyu¾ívána spí¹e sporadicky.</p>

<img src="http://i.iinfo.cz/images/229/obr6.png" class="image-156656" width="339" height="183" alt="&#160;" />
<p><i>Obrázek 11: Obálka typu ADSR.</i></p>



<p><a name="k11"></a></p>
<h2 id="k11">11. Odkazy na Internetu</h2>

<ol>

<li>Sega documentation<br />
<a
href="http://koti.kapsi.fi/~antime/sega/docs.html">http://koti.kapsi.fi/~antime/sega/docs.html</a>
</li>

<li>1995 Programming on the Sega Saturn<br />
<a
href="http://cowboyprogramming.com/2010/06/03/1995-programming-on-the-sega-saturn/">http://cowboyprogramming.com/2010/06/03/1995-programming-on-the-sega-saturn/</a>
</li>

<li>Sega Myths-Saturn was the most difficult console to program for of 5th Gen<br />
<a href="http://forums.sega.com/showthread.php?313485-Sega-Myths-Saturn-was-the-most-difficult-console-to-program-for-of-5th-Gen">http://forums.sega.com/showthread.php?313485-Sega-Myths-Saturn-was-the-most-difficult-console-to-program-for-of-5th-Gen</a>
</li>

<li>SuperH RISC engine Family<br />
<a href="http://www.renesas.com/products/mpumcu/superh/index.jsp">http://www.renesas.com/products/mpumcu/superh/index.jsp</a>
</li>

<li>Sega Saturn<br />
<a href="http://en.wikipedia.org/wiki/Sega_saturn">http://en.wikipedia.org/wiki/Sega_saturn</a>
</li>

<li>Jaguar Sector - II<br />
<a href="http://www.jaguarsector.com/index.php">http://www.jaguarsector.com/index.php</a>
</li>

<li>Atari Age: Atari Jaguar History<br />
<a href="http://www.atariage.com/Jaguar/history.html">http://www.atariage.com/Jaguar/history.html</a>
</li>

<li>Jaguar<br />
<a href="http://www.giantbomb.com/jaguar/3045-28/">http://www.giantbomb.com/jaguar/3045-28/</a>
</li>

<li>Consoles that won't die: The Atari Jaguar<br />
<a href="http://venturebeat.com/2013/04/25/consoles-that-wont-die-atari-jaguar/">http://venturebeat.com/2013/04/25/consoles-that-wont-die-atari-jaguar/</a>
</li>

<li>Atari Jaguar and Atari Jaguar CD<br />
<a href="http://videogamecritic.com/jaguarinfo.htm">http://videogamecritic.com/jaguarinfo.htm</a>
</li>

<li>Atari Jaguar Documentation (Forum)<br />
<a href="http://www.jaguarsector.com/index.php?showforum=65">http://www.jaguarsector.com/index.php?showforum=65</a>
</li>

<li>Atari Jaguar Programming (Forum)<br />
<a href="http://www.jaguarsector.com/index.php?showforum=63">http://www.jaguarsector.com/index.php?showforum=63</a>
</li>

<li>The Jaguar Underground Documentation<br />
<a href="http://justclaws.atari.org/devcats/dox/dox.htm">http://justclaws.atari.org/devcats/dox/dox.htm</a>
</li>

<li>Blitter (Wikipedia CZ)<br />
<a href="http://cs.wikipedia.org/wiki/Blitter">http://cs.wikipedia.org/wiki/Blitter</a>
</li>

<li>Blitter (Wikipedia EN)<br />
<a href="http://en.wikipedia.org/wiki/Blitter">http://en.wikipedia.org/wiki/Blitter</a>
</li>

<li>Bit blit<br />
<a href="http://en.wikipedia.org/wiki/Bit_blit">http://en.wikipedia.org/wiki/Bit_blit</a>
</li>

<li>Disassembler for the portable Jaguar DSP emulator (zdrojový kód s&nbsp;instrukcemi)<br />
<a href="http://mamedev.org/source/src/emu/cpu/jaguar/jagdasm.c.html">http://mamedev.org/source/src/emu/cpu/jaguar/jagdasm.c.html</a>
</li>

<li>Fourth-Generation Consoles<br />
<a href="http://gaming.wikia.com/wiki/Fourth-Generation_Consoles">http://gaming.wikia.com/wiki/Fourth-Generation_Consoles</a>
</li>

<li>Fifth-Generation Consoles<br />
<a href="http://gaming.wikia.com/wiki/Fifth-Generation_Consoles">http://gaming.wikia.com/wiki/Fifth-Generation_Consoles</a>
</li>

<li>History of video game consoles (fifth generation)<br />
<a href="http://en.wikipedia.org/wiki/History_of_video_game_consoles_(fifth_generation)">http://en.wikipedia.org/wiki/History_of_video_game_consoles_(fifth_generation)</a>
</li>

<li>Atari Jaguar<br />
<a href="http://gaming.wikia.com/wiki/Atari_Jaguar">http://gaming.wikia.com/wiki/Atari_Jaguar</a>
</li>

<li>Atari Jaguar Games<br />
<a href="http://gaming.wikia.com/wiki/List_of_Atari_Jaguar_games">http://gaming.wikia.com/wiki/List_of_Atari_Jaguar_games</a>
</li>

<li>MyMedia Games Network Retrospective - Nintendo Super FX chip<br />
<a href="http://psp.mmgn.com/News/MyMedia-Games-Network-Retrospe-G6W">http://psp.mmgn.com/News/MyMedia-Games-Network-Retrospe-G6W</a>
</li>

<li>Wikipedia: Super FX<br />
<a href="http://en.wikipedia.org/wiki/Super_FX">http://en.wikipedia.org/wiki/Super_FX</a>
</li>

<li>IGN: Top 25 Consoles<br />
<a href="http://www.ign.com/top-25-consoles/13.html">http://www.ign.com/top-25-consoles/13.html</a>
</li>

<li>Sega Mega Drive<br />
<a href="http://sega.jp/archive/segahard/md/">http://sega.jp/archive/segahard/md/</a>
</li>

<li>The16bit Era Of Console Video Games<br />
<a href="http://tvtropes.org/pmwiki/pmwiki.php/Main/The16bitEraOfConsoleVideoGames">http://tvtropes.org/pmwiki/pmwiki.php/Main/The16bitEraOfConsoleVideoGames</a>
</li>

<li>The Console Wars<br />
<a href="http://www.cracked.com/funny-2590-the-console-wars/">http://www.cracked.com/funny-2590-the-console-wars/</a>
</li>

<li>Console Wars<br />
<a href="http://tvtropes.org/pmwiki/pmwiki.php/Main/ConsoleWars">http://tvtropes.org/pmwiki/pmwiki.php/Main/ConsoleWars</a>
</li>

<li>Era of the "Bit Wars"<br />
<a href="http://www.gtplanet.net/forum/threads/era-of-the-bit-wars.119796/">http://www.gtplanet.net/forum/threads/era-of-the-bit-wars.119796/</a>
</li>

<li>Rez Wars: How the Bit Wars never really ended<br />
<a href="http://www.ign.com/blogs/beastmastertoad/2013/01/31/rez-wars-how-the-bit-wars-never-really-ended">http://www.ign.com/blogs/beastmastertoad/2013/01/31/rez-wars-how-the-bit-wars-never-really-ended</a>
</li>

<li>Which system ended the "Bit Wars"?<br />
<a href="http://atariage.com/forums/topic/199163-which-system-ended-the-bit-wars/">http://atariage.com/forums/topic/199163-which-system-ended-the-bit-wars/</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Ti¹novský</a> &nbsp; 2013</small></p>
</body>
</html>

