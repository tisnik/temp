<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Grafické adventury společnosti Sierra On-Line využívající engine AGI</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Grafické adventury společnosti Sierra On-Line využívající engine AGI</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>V dnešní části seriálu o historii vývoje počítačových her si popíšeme některé další grafické adventury vydané společností Sierra On-Line v&nbsp;letech 1985 až 1986. Zabývat se budeme i popisem některých dalších vlastností herního enginu AGI.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Grafické adventury společnosti Sierra On-Line využívající engine AGI</a></p>
<p><a href="#k02">2. King's Quest II: Romancing the Throne</a></p>
<p><a href="#k03">3. Remake hry King's Quest II</a></p>
<p><a href="#k04">4. Galerie screenshotů ze hry King's Quest II</a></p>
<p><a href="#k05">5. King's Quest III: To Heir Is Human</a></p>
<p><a href="#k06">6. Galerie screenshotů ze hry King's Quest III</a></p>
<p><a href="#k07">7. Co vznikne spojením adventury King's Quest a textovky Planetfall?</a></p>
<p><a href="#k08">8. Space Quest: The Sarien Encounter</a></p>
<p><a href="#k09">9. Minihry použité ve hře Space Quest</a></p>
<p><a href="#k10">10. Galerie screenshotů ze hry Space Quest</a></p>
<p><a href="#k11">11. Další zajímavosti o interních strukturách enginu AGI</a></p>
<p><a href="#k12">12. Ladicí režimy v&nbsp;adventurách založených na AGI</a></p>
<p><a href="#k13">13. Prioritní bitmapy jako nástroj pro vytvoření "3D" lokací</a></p>
<p><a href="#k14">14. Řídicí čáry</a></p>
<p><a href="#k15">15. Priority vs.&nbsp;řídicí úsečky</a></p>
<p><a href="#k16">16. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Grafické adventury společnosti Sierra On-Line využívající engine AGI</h2>

<p><a
href="http://www.root.cz/clanky/historie-vyvoje-pocitacovych-her-vznik-grafickych-adventur/">V&nbsp;minulé
části</a> seriálu o historii vývoje výpočetní techniky a především pak
počítačových her jsme se seznámili se společností Sierra On-Line, která je
známá především díky grafickým adventurám, tj.&nbsp;hrám, jež se původně
vyvinuly z&nbsp;textovek doplněných o statické vektorové obrázky. Připomeňme
si, že první komerčně dostupnou a navíc i komerčně úspěšnou grafickou
adventurou byla hra <a
href="http://www.root.cz/clanky/historie-vyvoje-pocitacovych-her-vznik-grafickych-adventur/#k06">King's
Quest</a>.</p>

<img src="https://i.iinfo.cz/images/404/kq1-13.png" class="image-242292" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 1: Screenshot ze hry King's Quest I popsané v&nbsp;předchozím
článku.</i></p>

<p>Tato hra si nárokuje hned několik prvenství, ať již se to týká způsobu
ovládání hlavního hrdiny (volný pohyb po jednotlivých lokacích, kombinace
s&nbsp;textovým parserem), tak použití triků při zobrazování herních scén na
televizorech pracujících v&nbsp;normě NTSC. King's Quest byla současně hrou,
pro níž byl vyvinut engine AGI (<i>Adventure Game Interpreter</i>), což je
vlastně specializovaný programovací jazyk určený právě pro grafické adventury
(dnes by se tento jazyk honosně označil zkratkou <i>DSL &ndash; Domain Specific
Language</i>).</p>

<img src="https://i.iinfo.cz/images/457/kq2-1.png" class="image-242805" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 2: Úvodní obrazovka hry King's Quest II: Romancing the Throne.</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. King's Quest II: Romancing the Throne</h2>

<p>Přibližně rok po vydání hry <i>King's Quest I</i> začal být nabízen a
prodáván druhý díl této hry nazvaný <i>King's Quest II: Romancing the
Throne</i>. Děj hry přeskakuje (pravděpodobně) o několik let, protože se hlavní
hrdina mezitím již stal králem, který však má malý problém &ndash; stále hledá
manželku. Zkusí mj.&nbsp;i magické zrcadlo (s&nbsp;ním jsme se seznámili už
v&nbsp;prvním dílu), které mu ukáže krásnou <a
href="http://kingsquest.wikia.com/wiki/Valanice">Valanice</a> uvězněnou ve
věži, jež se nachází ve vzdálené zemi Kolyma. Zbytek děje asi již uhodnete sami
&ndash; hlavní hrdina (i když je král) musí všechny překážky nakonec zvládnout
sám a Valanice osvobodit.</p>

<img src="https://i.iinfo.cz/images/457/kq2-4.png" class="image-242808" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 3: V&nbsp;této lokaci mají autoři úplnou pravdu &ndash; král má
hledat manželku a ne se věnovat botanice.</i></p>

<p>Tato hra byla díky použití enginu AGI úspěšně a poměrně rychle portována na
několik typů osobních mikropočítačů, především na IBM PC, PCjr (tento systém
společnost Sierra posléze přestala podporovat, ostatně i firma IBM opustila od
jeho dalšího rozvoje), Amiga, Atari ST a taktéž Apple II a Apple IIGS. Většina
těchto počítačů podporovala grafické režimy s&nbsp;barvami (4 nebo 16), ovšem
na IBM PC byla podporována i monochromatická grafika používaná <a
href="http://www.root.cz/clanky/pocatky-grafiky-na-pc-graficke-karty-cga-a-hercules/#k04">grafickými
kartami Hercules</a>.</p>

<img src="https://i.iinfo.cz/images/457/kq2-16.png" class="image-242820" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 4: I s&nbsp;pouhými šestnácti barvami se dají dělat
různá grafická kouzla.</i></p>

<img src="https://i.iinfo.cz/images/457/kq2-20.png" class="image-242824" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 5: I s&nbsp;pouhými šestnácti barvami se dají dělat
různá grafická kouzla.</i></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Remake hry King's Quest II</h2>

<p>Mimochodem, v&nbsp;roce 2002 byl vydán neoficiální, ale o to podařenější
remake této hry, v&nbsp;níž se objevuje nový způsob ovládání. Namísto
klasického textového parseru je totiž použito uživatelské rozhraní typu
<i>point-and-click</i> známé z&nbsp;novějších her Sierry
popř.&nbsp;z&nbsp;konkurenčních her založených na enginu SCUMM (proto se taky
tento typ her při škatulkování nazývá point-and-click graphical adventure).
Dále zde nalezneme i vylepšenou grafiku s&nbsp;256 barvami, digitalizovaný zvuk
a nadabované postavy.</p>

<img src="https://i.iinfo.cz/images/457/kq2-30.png" class="image-242834" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 6: Ve hrách Sierry často najdeme odkazy na další tituly, zde
například na v&nbsp;té době vznikající Space Quest I.</i></p>

<p>I v&nbsp;samotné hře došlo k&nbsp;několika poměrně zásadním změnám,
například v&nbsp;mapě hry (nové lokace), v&nbsp;chování některých NPC apod.
Bohužel však neexistuje a ani se neplánuje nativní klient pro Linux, takže je
nutné použít Wine. Existence tohoto remaku, kterého se ostatně dočkaly i mnohé
další adventury, jen dokládá, jak jsou (resp.&nbsp;především jak byly) hry
společnosti Sierra On-Line oblíbené. V&nbsp;případě zájmu je možné navštívit
adresu společnosti <a
href="http://www.agdinteractive.com/games/kq2/about/about.html">ADG
Interactive</a> (pozor jen na to, že návody a hint listy na původní hru zde
kvůli výše popsaným změnám nebudou moc užitečné).</p>

<img src="https://i.iinfo.cz/images/457/kq2-32.png" class="image-242836" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 7: A skutečně...toto je prostředí planety ze hry Space
Quest.</i></p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Galerie screenshotů ze hry King's Quest II</h2>

<div class="gallery" id="gallery-5608"><em>King's Quest II</em></div>



<p><a name="k05"></a></p>
<h2 id="k05">5. King's Quest III: To Heir Is Human</h2>

<p>Třetí hra ze série <i>King's Quest</i> nesla název <i>King's Quest III: To
Heir Is Human</i> a vydána byla již v&nbsp;roce 1986. I tato hra využívá stejný
engine, jako předchozí dva tituly (a tedy i podobné ovládání); ostatně právě
díky existenci AGI se mohla Roberta Williams a skupina grafiků soustředit na
vytvoření herního světa i příběhu a současně se věnovat paralelně připravovaným
herním sériím. Kromě změny hráčova alter ega (už bylo na čase) se ve třetím
díle série objevila nová vlastnost, která mnohé hráče iritovala. Jednalo se o
omezení herního času, což samo o sobě vlastně není až tak špatný koncept
(používal se i v&nbsp;některých klasických textovkách, včetně slavné <a
href="http://www.root.cz/clanky/historie-vyvoje-pocitacovych-her-134-cast-ceske-textovky-ii/#k04">Pomsty
šíleného ataristy</a>), ovšem i rychlí hráči museli v&nbsp;King's Questu čekat
na některé události a NPC, což mohlo být frustrující, především pro fanoušky
adventur a ne akčních her.</p>

<img src="https://i.iinfo.cz/images/473/kq3-6.png" class="image-242933" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 8: K&nbsp;této lokaci se ještě vrátíme v&nbsp;navazujících
kapitolách.</i></p>

<p>V&nbsp;některých variantách taktéž zmizelo hlavní menu, takže se například i
příkazy pro uložení a obnovení hry musely zadávat z&nbsp;klávesnice či
s&nbsp;využitím klávesové zkratky. Pokud k&nbsp;omezenému hernímu času
připočteme i <a
href="http://vignette3.wikia.nocookie.net/kingsquest/images/0/08/Worldmap1stedition.jpg/revision/latest?cb=20090224054001">rozsáhlejší
herní svět</a>, větší množství předmětů atd., není divu, že tento díl je
považován za jeden z&nbsp;nejtěžších z&nbsp;celé série.</p>

<img src="https://i.iinfo.cz/images/666/king-s-quest-iii-3.png" class="image-242912" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 9: Hlavní hrdina vlastně zpočátku žádný hrdina není, spíš úplně
naopak.</i></p>

<img src="https://i.iinfo.cz/images/666/king-s-quest-iii-10.png" class="image-242919" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 10: V&nbsp;adventurách se sice musí zkoušet všechny možnosti...</i></p>

<img src="https://i.iinfo.cz/images/666/king-s-quest-iii-11.png" class="image-242920" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 11: ...ale někdy se to už přehání.</i></p>

<img src="https://i.iinfo.cz/images/666/king-s-quest-iii-15.png" class="image-242924" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 12: Tato lokace je pro mnoho hráčů velmi frustrující. Povšimněte
si úzké cestičky uprostřed a části cesty skryté za kamenem. Hráči používající
joystick asi museli zuřit...</i></p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Galerie screenshotů ze hry King's Quest III</h2>

<div class="gallery" id="gallery-5609"><em>King's Quest III</em></div>



<p><a name="k07"></a></p>
<h2 id="k07">7. Co vznikne spojením adventury King's Quest a textovky Planetfall?</h2>

<p>Při popisu klasických textovek jsme se kromě jiných her seznámili i
s&nbsp;textovkami vydanými společností <i>Infocom</i>. Velmi úspěšnou hrou
vytvořenou právě pod hlavičkou Infocomu je (samozřejmě kromě slavné série
<i>Zork</i>) i textovka nazvaná <i>Planetfall</i> pocházející z&nbsp;roku 1983
(datum vydání je v&nbsp;tomto kontextu poměrně důležité, povšimněte si, že
King's Quest je jen o rok mladší). Hra <i>Planetfall</i> byla vytvořena Stevem
Meretzkym. Jedná se o jiného autora, než tomu bylo u původní série Zork, což je
poznat zejména ze stylu vyprávění i z&nbsp;celkového vyznění příběhu. Tato hra
byla vytvořena, podobně jako prakticky všechny hry společnosti <i>Infocom</i>
pro virtuální stroj Z-machine, což znamenalo, že <i>Planetfall</i> bylo možné
relativně snadno a navíc i velmi rychle vydat souběžně pro mnoho počítačových
platforem, včetně osmibitových domácích mikropočítačů Atari, Commodore C64,
Apple II, Atari ST, Amiga atd.</p>

<img src="http://i.iinfo.cz/images/200/if1-14.png" class="image-174403" width="336" height="240" alt="&#160;" />
<p><i>Obrázek 13: Úvodní obrazovka hry Planetfall.</i></p>

<p>Humorně laděný příběh je zasazen do sci-fi prostředí a začíná poměrně
nehrdinsky. Hráč se totiž ocitá v&nbsp;roli uklízeče, který má umývat podlahu
na vesmírné lodi S.P.S. Feinstein. U umývání podlahy samozřejmě nezůstane a
hráč navštíví o mnohé zajímavější lokace.</p>

<img src="http://i.iinfo.cz/images/200/if1-15.png" class="image-174404" width="336" height="240" alt="&#160;" />
<p><i>Obrázek 14: Prostě je nutné, jako v&nbsp;každé správné textovce, slovník
otestovat.</i></p>

<img src="http://i.iinfo.cz/images/200/if1-16.png" class="image-174405" width="336" height="240" alt="&#160;" />
<p><i>Obrázek 15: Příběh se dále rozvíjí.</i></p>

<img src="http://i.iinfo.cz/images/200/if1-17.png" class="image-174406" width="336" height="240" alt="&#160;" />
<p><i>Obrázek 16: Příběh Planetfall se dále vyvíjí, ale pro hlavního
pseudohrdinu ne moc dobře.</i></p>



<p><a name="k08"></a></p>
<h2 id="k08">8. Space Quest: The Sarien Encounter</h2>

<p>Proč jsem se však vůbec zmiňoval o hře Planetfall, která je klasickou
textovkou a navíc ani nebyla vydána společností Sierra On-Line? Je to
z&nbsp;toho důvodu, že v&nbsp;roce 1986 byla vydána hra <i>Space Quest</i>,
která je sice postavena na stejném engine jako <i>King's Quest</i>, ovšem jak
herní příběh, tak i ladění hry (humorná sci-fi) a ostatně i povolání hlavního
pseudohrdiny, je s&nbsp;velkou pravděpodobností inspirováno právě hrou
Planetfall. Ve hře ovšem najdeme i více či méně skryté odkazy na mnohé filmy,
zejména na Star Wars (poslední scéna s&nbsp;gratulací, navigující droid), Star
Trek (Star Generator), Lost in Space (&bdquo;it does not compute&ldquo;)
apod.</p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-6.png" class="image-242959" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 17: Úvodní třetina hry.</i></p>

<p>I <i>Space Quest I</i> používala systém AGI, takže se ovládání této hry
prakticky neodlišovalo od série King's Quest. Celá hra je poměrně lineární a je
rozdělena na tři části. V&nbsp;první části se dozvíme, že hlavní hrdina přežil
útok na kosmickou loď Arcada jen díky tomu, že zrovna uklízel ve spíži. Poté se
musí z&nbsp;kosmické lodi zachránit, vyřešit několik úkolů na pouštní planetě
Kerona (odkaz na Dunu Franka Herberta?), koupit si kosmickou loď a následně
zničit ukradený Star Generator. Poměrně náročné úkoly na někoho, kdo měl
předtím jednu z&nbsp;nejnižších hodností vůbec... Hra <i>Space Quest</i> se
záhy po svém vydání stala velmi populární, takže následovaly její další díly
(popsané příště) a dokonce i nové varianty s&nbsp;lepší grafikou (VGA) a
upraveným příběhem a ovládáním (ikonami namísto textového parseru).</p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-8.png" class="image-242961" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 18: Hráč se blíží k&nbsp;záchrannému modulu (tedy jestli to
stihne).</i></p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-10.png" class="image-242963" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 19: Toto není zrovna nejúspěšnější konec hry.</i></p>



<p><a name="k09"></a></p>
<h2 id="k09">9. Minihry použité ve hře Space Quest</h2>

<p>Ve hře Space Quest nalezneme, podobně jako v&nbsp;některých dalších
adventurách společnosti Sierra On-Line, několik takzvaných miniher (či her ve
hře). První minihra je čistě akční a odehrává se při příletu
k&nbsp;mimozemskému baru. Hráč ovládá vznášedlo, kterým se musí vyhýbat letícím
kamenům. V&nbsp;této minihře se sice přímo neztrácí (ani nepočítají) životy,
ale nárazem kamenu se vznášedlo postupně poškozuje. Vzhledem k&nbsp;tomu, že i
v&nbsp;průběhu minihry je možné ukládat stav hry, se jedná o sice zdlouhavý,
ale jednoduše splnitelný úkol.</p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-24.png" class="image-242977" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 20: První minihra připomíná tituly známé z&nbsp;osmibitových
herních konzolí &ndash; hráč se musí vyhýbat letícím kamenům.</i></p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-25.png" class="image-242978" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 21: První minihra připomíná tituly známé z&nbsp;osmibitových
herních konzolí &ndash; hráč se musí vyhýbat letícím kamenům.</i></p>

<p>Druhá minihra následuje vlastně ihned po první minihře. Hráč totiž navštíví
mimozemský bar, v&nbsp;němž musí vyslechnout rozhovor emzáků u piva a navíc i
musí vyhrát velký obnos peněz na výherním/proherním automatu, který se
v&nbsp;baru nachází. Tato minihra je dosti zdlouhavá a nudná, protože spočívá
v&nbsp;neustálém ukládání stavu hry, sázení, obnovování stavu hry
v&nbsp;případě prohry atd.</p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-26.png" class="image-242979" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 22: V&nbsp;tomto baru se nachází i zajímavý výherní/proherní
automat. Emzák, co u něj stojí, skončí co nevidět dost špatně.</i></p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-29.png" class="image-242982" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 23: Ve druhé minihře je nutné hrát tak dlouho, dokud se automat
nepokazí a nevydá 250 buckazoidů.</i></p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-27.png" class="image-242980" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 24: Nevadí, samozřejmě jsem si hru uložil...</i></p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Galerie screenshotů ze hry Space Quest</h2>

<div class="gallery" id="gallery-5610"><em>Space Quest I</em></div>



<p><a name="k11"></a></p>
<h2 id="k11">11. Další zajímavosti o interních strukturách enginu AGI</h2>

<p>Vzhledem k&nbsp;tomu, že grafické adventury vydávané společností Sierra
On-Line byly mezi hráči velmi populární a současně i poměrně těžké (snad
v&nbsp;každé hře se vyskytuje alespoň jeden &bdquo;zásek&ldquo;), není divu, že
hráči začali zkoumat chování enginu AGI i strukturu datových souborů, které
tvořily jádro hry. K&nbsp;tomu dopomohl i fakt, že struktura souborů se téměř
neměnila ani mezi platformami ani mezi jednotlivými hrami (existují tři hlavní
verze enginu).</p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-15.png" class="image-242968" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 25: Kupodivu se po stlačení tlačítka s&nbsp;nápisem &bdquo;Don't
Touch&ldquo; nic zlého nestane (spíše naopak).</i></p>

<p>Analyzovány byly především soubory <strong>WORDS.TOK</strong> obsahující
slovník textového parseru. Tyto soubory byly komprimovány a navíc i zakódovány,
protože autorům enginu bylo zřejmé, že na tyto soubory se hráči zaměří
nejdříve. Dále byly prozkoumány a popsány i další standardní soubory, tedy
<strong>AGI</strong> (vlastní engine), <strong>VOL.*</strong> (ostatní data,
tj.&nbsp;grafika, logika hry apod.). V&nbsp;následujících kapitolách se budu
zabývat především způsobem zobrazení jednotlivých lokací a pohybu hlavního
hrdiny po obrazovce, protože právě tato část by mohla inspirovat nějakého
čtenáře ve výrobě vlastní adventury (naopak textový parser je již dnes
povětšinou nahrazen rozhraním typu point-and-click).</p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-30.png" class="image-242983" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 26: Co má společného koňský handlíř, typický prodejce
v&nbsp;českém autobazaru a pán Tiny (který je mimochodem dost tlustý)?</i></p>



<p><a name="k12"></a></p>
<h2 id="k12">12. Ladicí režimy v&nbsp;adventurách založených na AGI</h2>

<p>V&nbsp;průběhu vývoje a taktéž při testování grafických adventur založených
na enginu AGI samozřejmě programátoři a testeři potřebovali zobrazit další
podrobnější informace (nedostupné pro hráče) popř.&nbsp;změnit stav hry,
například přemístit hlavního hrdinu na jiné místo, přidat do jeho inventáře
další předmět, zobrazit takzvanou prioritní bitmapu (viz další text) atd.</p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-33.png" class="image-242986" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 27: Právě byla položena nejdůležitější otázka v&nbsp;celém Space
Questu...</i></p>

<p>K&nbsp;tomuto účelu sloužil ladicí režim (<i>debug mode</i>), což samozřejmě
není nic překvapivého. Zajímavější ovšem je, že ladicí režim zůstal
v&nbsp;naprosté většině her společnosti Sierra On-Line ponechán i
v&nbsp;komerčně prodávaných variantách; nejenom tedy v&nbsp;testovacích
verzích. Pokud se stlačí klávesová zkratka Alt+D, provede se přepnutí do
ladicího režimu, což se kromě zobrazení informace o verzi enginu atd. projeví
tak, že textový parser začne rozpoznávat další příkazy. Jen pro zajímavost se
podívejme na některé &bdquo;nové&ldquo; příkazy, které začnou být
v&nbsp;ladicím režimu dostupné ve hře <i>Space Quest 1</i>:</p>

<table>
<tr><td>be alien</td><td>převlečení za Sariena</td></tr>
<tr><td>no helmet</td><td>dtto ale bez helmy (jak na konci hry)</td></tr>
<tr><td>drink flight suit</td><td>obléci skafandr</td></tr>
<tr><td>tp</td><td>teleport (hra se zeptá na číslo místnosti)</td></tr>
<tr><td>position</td><td>přemístění postavy kamkoli na obrazovku (hra se zeptá na souřadnice)</td></tr>
<tr><td>get object</td><td>získání libovolného objektu do inventáře (hra se zeptá na číslo)</td></tr>
</table>



<p><a name="k13"></a></p>
<h2 id="k13">13. Prioritní bitmapy jako nástroj pro vytvoření "3D" lokací</h2>

<p>Společnost Sierra On-Line v&nbsp;manuálech ke svým grafickým adventurám
používala slovní spojení &bdquo;Animated 3D Adventure&ldquo;. To se týká
například i výše popsané hry <i>Space Quest I</i>, která však z&nbsp;dnešního
pohledu pojmu &bdquo;3D&ldquo; příliš neodpovídá. Ve skutečnosti však prvky
trojrozměrného světa i v&nbsp;těchto hrách nalezneme. Hlavní hrdina se totiž
mohl pohybovat po jednotlivých lokacích takovým způsobem, že některé předměty a
objekty jakoby obcházel &ndash; někdy se nacházel před nimi, v&nbsp;dalším
okamžiku je obešel a byl schovaný za nimi, padal ze skály (schodů, stromu)
atd.</p>

<img src="https://i.iinfo.cz/images/473/kq3-4.png" class="image-242931" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 28: Takto vidí herní lokaci hráči.</i></p>

<p>Toto chování, které do hry umožnilo vložit i složité lokace typu jeskyně
s&nbsp;mnoha cestami, les apod., bylo zajištěno pomocí takzvané prioritní
bitmapy. Ta byla vytvářena pro každou místnost zvlášť. Bitmapa obsahovala
dvanáct úrovní priorit, přičemž nejnižší možná priorita (4) byla vyhrazena pro
pozadí (hráč byl vždy zobrazen před pozadím) a naopak nejvyšší priorita 15 byla
vyhrazena pro ty objekty/předměty, které se nacházely za všech okolností před
hráčem.</p>

<img src="https://i.iinfo.cz/images/473/kq3-7.png" class="image-242934" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 29: A takto vypadá prioritní bitmapa. Povšimněte si, jak se plot
postupně vzdaluje od pozorovatele, kameny jsou blíže než dům atd.</i></p>

<p>Výchozí nastavení bylo spočítáno na základě y-ové souřadnice hráče podle
jednotlivých obrazových řádků takto:</p>

<table>
<tr><th>Řádky</th><th>Výchozí priorita hráče</th></tr>
<tr><td>není nastaveno</td><td> 4</td></tr>
<tr><td>od  48 do 59</td><td> 5</td></tr>
<tr><td>od  60 do 71</td><td> 6</td></tr>
<tr><td>od  72 do 83</td><td> 7</td></tr>
<tr><td>od  84 do 95</td><td> 8</td></tr>
<tr><td>od  96 do 107</td><td> 9</td></tr>
<tr><td>od 108 do 119</td><td>10</td></tr>
<tr><td>od 120 do 131</td><td>11</td></tr>
<tr><td>od 132 do 143</td><td>12</td></tr>
<tr><td>od 144 do 155</td><td>13</td></tr>
<tr><td>od 156 do 167</td><td>14</td></tr>
<tr><td>168</td><td>15</td></tr>
</table>

<img src="https://i.iinfo.cz/images/59/space-quest-i-21.png" class="image-242974" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 30: S&nbsp;využitím prioritních bitmap je možné vytvořit i
poměrně komplexní 3D lokace s&nbsp;dobře stanoveným rozdílem &bdquo;přede
mnou&ldquo;&ndash;&bdquo;za mnou&ldquo; v&nbsp;každém pixelu obrazovky.</i></p>

<p>Z&nbsp;tabulky je patrné, že hráč se při pohybu po obrazovce nahoru vlastně
pohyboval směrem <strong>od</strong> pozorovatele, což dobře odpovídá běžnému
zobrazení s&nbsp;perspektivou. Designéři jednotlivých lokací měli možnost u
objektů specifikovat i jejich prioritu (= vzdálenost od pozorovatele), což
například znamenalo, že při nastavení priority na 10 u stromu se mohl hráč
nacházet jak před stromem (dolní část obrazovky), tak i za stromem (horní část
obrazovky). Zmíněných dvanáct úrovní postačovalo pro všechny typy her (na tomto
místě si povšimněte, jak se chování bitmapy priorit vlastně přibližuje
k&nbsp;chování Z-bufferu, takže i další spojitost s&nbsp;3D grafikou zde určitě
existuje).</p>

<img src="https://i.iinfo.cz/images/59/space-quest-i-22.png" class="image-242975" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 31: Zajímavý domácí mazlíček.</i></p>



<p><a name="k14"></a></p>
<h2 id="k14">14. Řídicí čáry</h2>

<p>Po nakreslení každé lokace a určení priorit jednotlivých objektů se kód
s&nbsp;lokací připojil do vyvíjené hry a následně se předal testerům. Ti
manuálním zkoušením určili ta místa ve scéně, kde bylo nutné postavičce zakázat
přístup (například není možné projít stromem či stěnou domu) a taktéž místa,
v&nbsp;nichž má například dojít k&nbsp;pádu postavy, ponoření do vody apod.
Tato místa je nutné ošetřit, a to konkrétně s&nbsp;použitím takzvaných řídicích
čar. V&nbsp;předchozí kapitole jsme si řekli, že pro priority je vyhrazeno
dvanáct kódů, takže pro čtyřbitovou bitmapu nám zbývají první čtyři kódy/barvy:
černá, modrá, zelená a modrozelená. Černá a modrá barva se používá pro ta místa
na obrazovce, kam postava nemůže vstoupit, což je dobře patrné i ze screenshotu
(hrana domu, základna kamenů, hrana plotu). Povšimněte si, že je možné sejít až
ke kamenům v&nbsp;popředí a částečně se za ně schovat, ovšem nelze jimi úplně
projít, protože tomu zabraňuje právě modrá čára. Zelená barva je vyhrazena pro
ta místa, která vyvolají nějakou událost. Na obrázku jsou to místa, kde může
postava spadnout. Modrozelená barva je použita typicky pro vodu atd.</p>

<img src="https://i.iinfo.cz/images/473/kq3-7.png" class="image-242934" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 32: Podívejte se ještě jednou na tento obrázek &ndash; uvidíte
v&nbsp;něm i řídicí čáry.</i></p>



<p><a name="k15"></a></p>
<h2 id="k15">15. Priority vs.&nbsp;řídicí čáry</h2>

<p>Vzhledem k&nbsp;tomu, že v&nbsp;prioritní bitmapě jsou současně uloženy jak
řídicí čáry, tak i vlastní priority jednotlivých pixelů, dochází
k&nbsp;situacím, kdy herní engine musí zjistit, jakou prioritu má pixel ležící
přímo na řídicí čáře (prioritu tohoto pixelu samozřejmě nezná). Zde se používá
malý trik &ndash; postupně se prochází odshora dolů sloupcem pixelů
v&nbsp;prioritní bitmapě tak dlouho, až se narazí na pixel, jehož hodnota je
větší nebo rovna 4 (tj.&nbsp;jedná se o prioritu a nikoli o součást řídicí
čáry). Hodnota (priorita) tohoto pixelu je následně použita. Díky tomuto triku
se sice ušetřilo poměrně velké množství paměti (osm kilobajtů), ovšem může to
vést k&nbsp;některým vizuálním chybám ve hře (části předmětů či objektů mohou
být jakoby průhledné, resp.&nbsp;je průhledný například jen jeden pixel). Tyto
chyby jsou některými hráči aktivně vyhledávány, stejně jako &bdquo;díry&ldquo;
v&nbsp;řídicích čarách, které umožňují procházet do zakázaných míst
v&nbsp;herním světě (samozřejmě s&nbsp;využitím ladicího režimu).</p>

<img src="https://i.iinfo.cz/images/312/king-s-quest-ii-6.png" class="image-242862" alt="&#160;" width="320" height="200" />
<p><i>Obrázek 33: Skutečně užitečná rada...</i></p>



<p><a name="k16"></a></p>
<h2 id="k16">16. Odkazy na Internetu</h2>

<ol>

<li>AGI/Specifications/OverviewAGI/Specifications/Overview<br />
<a href="http://wiki.scummvm.org/index.php/AGI/Specifications/Overview">http://wiki.scummvm.org/index.php/AGI/Specifications/Overview</a>
</li>

<li>Sierra Game Debug modes<br />
<a href="http://www.sierrahelp.com/Cheats/DebugModes.html">http://www.sierrahelp.com/Cheats/DebugModes.html</a>
</li>

<li>Nástroje pro AGI<br />
<a href="http://www.ifarchive.org/indexes/if-archiveXprogrammingXagi.html">http://www.ifarchive.org/indexes/if-archiveXprogrammingXagi.html</a>
</li>

<li>Utilities (další staré nástroje pro AGI)<br />
<a href="http://www.agifans.com/utilities-1">http://www.agifans.com/utilities-1</a>
</li>

<li>Space Quest: Chapter I - The Sarien Encounter<br />
<a href="http://www.gamefaqs.com/pc/562689-space-quest-chapter-i-the-sarien-encounter/cheats">http://www.gamefaqs.com/pc/562689-space-quest-chapter-i-the-sarien-encounter/cheats</a>
</li>

<li>King's Quest II (Moby games)<br />
<a href="http://www.mobygames.com/game/kings-quest-ii-romancing-the-throne">http://www.mobygames.com/game/kings-quest-ii-romancing-the-throne</a>
</li>

<li>King's Quest II (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/King's_Quest_II">https://en.wikipedia.org/wiki/King's_Quest_II</a>
</li>

<li>AGI Webring<br />
<a href="http://hub.gamesntoys.org/hub/agiring">http://hub.gamesntoys.org/hub/agiring</a>
</li>

<li>Hi-Res Adventure #0: Mission Asteroid<br />
<a href="http://www.mobygames.com/game/hi-res-adventure-0-mission-asteroid">http://www.mobygames.com/game/hi-res-adventure-0-mission-asteroid</a>
</li>

<li>Hi-Res Adventure #2: The Wizard and the Princess<br />
<a href="https://www.mobygames.com/game/hi-res-adventure-2-the-wizard-and-the-princess">https://www.mobygames.com/game/hi-res-adventure-2-the-wizard-and-the-princess</a>
</li>

<li>Hi-Res Adventure #4: Ulysses and the Golden Fleece<br />
<a href="https://www.mobygames.com/game/hi-res-adventure-4-ulysses-and-the-golden-fleece">https://www.mobygames.com/game/hi-res-adventure-4-ulysses-and-the-golden-fleece</a>
</li>

<li>Wizard and the Princess (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/Wizard_and_the_Princess">https://en.wikipedia.org/wiki/Wizard_and_the_Princess</a>
</li>

<li>Ulysses and the Golden Fleece (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/Ulysses_and_the_Golden_Fleece">https://en.wikipedia.org/wiki/Ulysses_and_the_Golden_Fleece</a>
</li>

<li>King's Quest I (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/King's_Quest_I">https://en.wikipedia.org/wiki/King's_Quest_I</a>
</li>

<li>Adventure Game Interpreter<br />
<a href="https://en.wikipedia.org/wiki/Adventure_Game_Interpreter">https://en.wikipedia.org/wiki/Adventure_Game_Interpreter</a>
</li>

<li>Point-and-click adventure games<br />
<a href="https://en.wikipedia.org/wiki/Adventure_game#Graphic_adventure">https://en.wikipedia.org/wiki/Adventure_game#Graphic_adventure</a>
</li>

<li>Sample Code From Text-Adventure Game Platforms<br />
<a href="http://www.secretgeek.net/text_adventure_samples">http://www.secretgeek.net/text_adventure_samples</a>
</li>

<li>Making adventure games with AGI<br />
<a href="http://www.adventureclassicgaming.com/index.php/site/features/143/">http://www.adventureclassicgaming.com/index.php/site/features/143/</a>
</li>

<li>AGI Dev Articles<br />
<a href="http://www.agidev.com/articles/">http://www.agidev.com/articles/</a>
</li>

<li>Hry vytvořené v&nbsp;AGI<br />
<a href="http://www.agidev.com/games/">http://www.agidev.com/games/</a>
</li>

<li>A history on remaking King's Quest<br />
<a href="http://www.adventureclassicgaming.com/index.php/site/features/329/">http://www.adventureclassicgaming.com/index.php/site/features/329/</a>
</li>

<li>Top 10 retro graphic adventure games of all time from PC to consoles<br />
<a href="http://www.adventureclassicgaming.com/index.php/site/features/230/">http://www.adventureclassicgaming.com/index.php/site/features/230/</a>
</li>

<li>Adventure of the Week: Stranded (Atari 8-bit, 1984)<br />
<a href="http://gamingafter40.blogspot.cz/2013/11/adventure-of-week-stranded-atari-8-bit.html">http://gamingafter40.blogspot.cz/2013/11/adventure-of-week-stranded-atari-8-bit.html</a>
</li>

<li>Colossal Cave Adventure Map<br />
<a href="http://www.spitenet.com/cave/">http://www.spitenet.com/cave/</a>
</li>

<li>Colossal Cave Adventure<br />
<a href="http://www.rickadams.org/adventure/">http://www.rickadams.org/adventure/</a>
</li>

<li>Here's where it all began...<br />
<a href="http://www.rickadams.org/adventure/a_history.html">http://www.rickadams.org/adventure/a_history.html</a>
</li>

<li>David Kinder's guide to Adventure downloads at the Interactive Fiction Archive<br />
<a href="http://www.rickadams.org/adventure/e_downloads.html">http://www.rickadams.org/adventure/e_downloads.html</a>
</li>

<li>Everything you ever wanted to know about ...the magic word XYZZY<br />
<a href="http://www.rickadams.org/adventure/c_xyzzy.html">http://www.rickadams.org/adventure/c_xyzzy.html</a>
</li>

<li>Colossal Cave Adventure jako Java Applet<br />
<a href="http://www.astrodragon.com/zplet/advent.html">http://www.astrodragon.com/zplet/advent.html</a>
</li>

<li>Colossal Cave Adventure<br />
<a href="http://en.wikipedia.org/wiki/Colossal_Cave_Adventure">http://en.wikipedia.org/wiki/Colossal_Cave_Adventure</a>
</li>

<li>iPod Adventure Game<br />
<a href="http://hamimiami.com/ipod/adventure/index.html">http://hamimiami.com/ipod/adventure/index.html</a>
</li>

<li>Ohlédnutí za herní historií: Textovky<br />
<a href="http://www.slunecnice.cz/tipy/ohlednuti-za-herni-historii-textovky/">http://www.slunecnice.cz/tipy/ohlednuti-za-herni-historii-textovky/</a>
</li>

<li>Tribute to text-mode games<br />
<a href="http://www.textmodegames.com/">http://www.textmodegames.com/</a>
</li>

<li>Text-based game (Wikipedia)<br />
<a href="http://en.wikipedia.org/wiki/Text-based_game">http://en.wikipedia.org/wiki/Text-based_game</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2016</small></p>
</body>
</html>

