<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Collapse OS - operační systém do světa Falloutu?</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Collapse OS - operační systém do světa Falloutu?</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>Dnes se ve stručnosti seznámíme s projektem nazvaným Collapse OS. Jedná se o minimalisticky pojatý operační systém, který je možné v případě potřeby provozovat i na &bdquo;starém šrotu&ldquo;, například na osmibitových mikroprocesorech a mikrořadičích s několika kilobajty ROM a RAM.</p>



<h2>Obsah</h2>

<p><a href="#k01">*** 1. Collapse OS &ndash; operační systém do světa Falloutu?</a></p>
<p><a href="#k02">*** 2. Podporované procesorové architektury</a></p>
<p><a href="#k03">*** 3. Podpora periferních zařízení</a></p>
<p><a href="#k04">*** 4. Vývoj Collapse OS - od assembleru k&nbsp;jazyku Forth</a></p>
<p><a href="#k05">*** 5. Vlastnosti Collapse OS z&nbsp;pohledu uživatele</a></p>
<p><a href="#k06">*** 6. Uživatelské nástroje</a></p>
<p><a href="#k07">*** 7. Uložení zdrojového kódu programu do bloků (obrazovek)</a></p>
<p><a href="#k08">*** 8. </a></p>
<p><a href="#k09">*** 9. </a></p>
<p><a href="#k10">*** 10. </a></p>
<p><a href="#k11">*** 11. </a></p>
<p><a href="#k12">*** 12. </a></p>
<p><a href="#k13">*** 13. </a></p>
<p><a href="#k14">*** 14. </a></p>
<p><a href="#k15">*** 15. </a></p>
<p><a href="#k16">*** 16. </a></p>
<p><a href="#k17">*** 17. </a></p>
<p><a href="#k18">*** 18. </a></p>
<p><a href="#k19">*** 19. </a></p>
<p><a href="#k20">*** 20. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Collapse OS &ndash; operační systém do světa Falloutu?</h2>

<p>Na stránkách Roota se poměrně často setkáme s&nbsp;alternativními technologiemi. Do této oblasti velmi dobře zapadá i projekt nazvaný <i>Collapse OS</i>. Jméno tohoto projektu naznačuje jeho možné (teoretické) využití &ndash; Collapse OS by totiž měl být provozovatelný i na &bdquo;starém šrotu&ldquo;, například na osmibitových mikrořadičích a mikroprocesorech s&nbsp;několika kilobajty paměti ROM i RAM, na starých herních konzolích apod. Mnohé z&nbsp;těchto mikroprocesorů či mikrořadičů lze v&nbsp;případě skutečné katastrofy (nebo za katastrofických podmínek) provozovat pouze s&nbsp;minimálními dalšími nároky na další pomocné obvody (což je v&nbsp;přímém kontrastu s&nbsp;komplexním PC, kde i čip pro připojení pouhé klávesnice svojí komplexností převyšuje zmíněné osmibitové CPU a MCU).</p>

<p><div class="rs-tip-major">Poznámka: mohlo by se možná zdát, že současná situace na trhu s&nbsp;čipy již je katastrofická, ovšem v&nbsp;tomto případě se jedná o pouhé přerušení dodavatelsko-odvěratelského řetězce. Možná je dokonce dobře, že k&nbsp;této situaci došlo, protože odhaluje potenciální větší problémy plynoucí z&nbsp;naprosté globalizace a současně i velké konsolidace trhu s&nbsp;integrovanými obvody.</div></p>

<p>Vraťme se však k&nbsp;<i>Collapse OS</i>; budeme se přitom soustředit spíše na technologie, na nichž je tento operační systém postaven, protože jeho &bdquo;plánované&ldquo; použití pravděpodobně nenastane &ndash; v&nbsp;případě skutečné katastrofy bude asi lidstvo řešit závažnější problémy, než je nedostatek počítačů (resp.&nbsp;jinak &ndash; vcelku s&nbsp;velkou pravděpodobností se do skutečného scénáře stejně netrefíme).</p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Podporované procesorové architektury</h2>

<p>Současná verze systému <i>Collapse OS</i> je podporována na osmibitových mikroprocesorech <i>Zilog Z80</i>, na taktéž osmibitovém mikroprocesoru <i>Motorola 6809</i>, dále na mikrořadičích <i>AVR</i> (z&nbsp;rodiny <i>megaAVR</i>, ovšem bylo by možné použít i čipy z&nbsp;rodiny <i>tinyAVR</i>) a taktéž na klasických mikroprocesorech <i>Intel 8086</i> v&nbsp;reálném režimu (což čistě teoreticky zahrnuje i běžná PC). Výběr těchto čipů je přitom dán spíše preferencemi autora Collapse OS (chtěl se například naučit assembler mikroprocesoru Z80) i v&nbsp;té době dostupných zařízení (herní konzole Sega Master System resp. Sega MegaDrive). Ovšem plánuje se portace i na slavné osmibitové mikroprocesory <i>MOS 6502</i>. Oficiální důvod podpory těchto dnes již spíše muzeálních čipů je fakt, že (podle mínění autora Collapse OS) bude možné tyto jednoduché čipy relativně snadno vyrábět v&nbsp;továrnách, které se po kolapsu podaří obnovit. To je velmi zajímavá myšlenka, protože například Z80 má pouze 9000 tranzistorů a je tedy skutečně mnohem snadněji replikovatelný než moderní mikroprocesory s&nbsp;o několik řádů vyšší složitostí.</p>

<p>Z&nbsp;čistě praktického hlediska &ndash; tedy pokud se zamyslíme nad tím, jaký &bdquo;šrot&ldquo; by bylo možné v&nbsp;případě katastrofy najít a oživit &ndash; by pochopitelně bylo vhodnější se orientovat nikoli na historické mikroprocesory, ale na moderní mikrořadiče, které lze najít prakticky kdekoli (například i v&nbsp;termostatu apod.). Kromě <i>AVR</i>, což je velmi rozšířená řada mikrořadičů, by se tedy mohla provést portace i na vybrané šestnáctibitové a popř.&nbsp;i 32bitové mikrořadiče. V&nbsp;oblasti šestnáctibitových mikrořadičů se jedná o řadu Freescale (Motorola) 68HC11, čipy od Texas Instruments (MSP430) či Infineonu, které by bylo možné získat z&nbsp;automobilů. Zajímavý je i segment 32bitových mikrořadičů, v&nbsp;nichž se kromě MIPS ujaly i čipy s&nbsp;jádrem ARM Cortex-M0 popř.&nbsp;ARM Cortex-M1. Výhodou Collapse OS je, že portace na další mikrořadiče a mikroprocesory by měla být relativně snadná, a to dokonce do takové míry, že na všech prozatím podporovaných architekturách lze provést <i>bootstrap</i>.</p>

<p>V&nbsp;předchozím odstavci jsem se nezmínil o mikrořadičích z&nbsp;rodiny 8051, které jsou i přes stáří této architektury stále používány a jejich zapojení je většinou jednoduché a především známé. Problém je, že i moderní mikrořadiče, které jsou nad 8051 postaveny, nabízí pouze omezenou kapacitu RAM (například 256 bajtů), přičemž Collapse OS vyžaduje spíše kapacitu ve vyšších jednotkách kilobajtů. Totéž lze říci i o některých rodinách mikrořadičů PIC. V&nbsp;této oblasti nám tak zbývají například mikrořadiče z&nbsp;rodiny S08 a HC08.</p>

<p><div class="rs-tip-major">Poznámka: jedním z&nbsp;dalších důvodů, proč byly vybrány starší typy čipů je fakt, že tyto mikroprocesory jsou dostupné i v&nbsp;pouzdrech typu DIL. Tudíž je lze použít i na běžném plošném spoji &bdquo;s&nbsp;dírkami&ldquo; bez nutnosti využívat technologii povrchové montáže. U relativně malých pouzder s&nbsp;40 piny a 2,5(4) mm mezi nožkami (což odpovídá všem zmíněným mikroprocesorům) se navíc ani nemusí použít skutečný plošný spoj (kde ho také po pádu dodavatelských řetězců sehnat), ale pouze deska s&nbsp;drátovými propojkami (což sice není elegantní řešení, ale je uskutečnitelné).</div></p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Podpora periferních zařízení</h2>

<p>Samotný mikroprocesor popř.&nbsp;mikrořadič je pochopitelně nutné doplnit o periferní zařízení. Z&nbsp;paměťových zařízení jsou podporovány SD karty, což je ostatně logické, protože protokol pro jejich ovládání je velmi jednoduchý. V&nbsp;některých variantách jsou podporovány i disketové jednotky, tedy dnes již spíše historické paměťové médium. Podporován je i přenos dat po sériové sběrnici (zde ovšem záleží na konkrétním mikroprocesoru resp.&nbsp;v&nbsp;tomto případě spíše na mikrořadiči, které sériové sběrnice či porty podporuje) a taktéž klávesnice PS/2 &ndash; ostatně i ta používá sériový protokol pro přenos dat (s&nbsp;adaptérem je tedy možné připojit i USB klávesnici). Navíc je na herní konzoli Sega Master System podporován i D-Pad, tedy ovládací prvek, jenž je primárním vstupním zařízením na této konzoli (s&nbsp;dvojicí tlačítek).</p>

<p><div class="rs-tip-major">Poznámka: vzhledem k&nbsp;podpoře osmibitových mikrořadičů AVR je však ve skutečnosti možné připojit i mnohá další zařízení, například jednoduché numerické klávesnice popř.&nbsp;textové či dokonce grafické displeje. Ty totiž podporují ovládání přes SPI, I<sup>2</sup>C či v&nbsp;případě displejů pro mobilní telefony <i>MIPI</i> neboli <i>Mobile Industry Processor Interface</i> (zde je ovšem ovládání již poměrně složité a vyžaduje větší prostor v&nbsp;ROM). Některé displeje, například ty vybavené čipem <a href="https://en.wikipedia.org/wiki/Hitachi_HD44780_LCD_controller">Hitachi HD44780</a> se ovládají ještě jednodušeji, protože je lze přímo připojit na osmibitovou sběrnici.</div></p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Vývoj Collapse OS - od assembleru k&nbsp;jazyku Forth</h2>

<p>Samotný vývoj <i>Collapse OS</i> od prvních verzí až k&nbsp;verzi současné je prakticky ukázkovým &bdquo;školním&ldquo; příkladem nasazení programovacího jazyka Forth. <i>Collapse OS</i> totiž začal zdánlivě logickým krokem &ndash; byl totiž prakticky kompletně naprogramován v&nbsp;assembleru. To je zajisté s&nbsp;ohledem na použité mikroprocesory dobrá volba, ovšem naráží na jeden problém &ndash; celý OS by totiž mělo být možné &bdquo;bootstrapovat&ldquo; (přeložit a spustit) přímo na daném systému, tedy například konkrétně na zbastleném počítači s&nbsp;procesorem Zilog Z80 a řekněme 16kB RAM. Jádro problému spočívá v&nbsp;tom, že zatímco operační systém získaný překladem z&nbsp;assembleru je dostatečně rychlý a kompaktní, neplatí to už pro překlad (tedy pro fázi, které se přesněji říká <i>assembly</i>, nikoli <i>compile</i>). Samotný assembler totiž v&nbsp;žádném případě není jednoduchý program. Typické jednodušší assemblery vyžadují 8kB ROM jen pro vlastní kód, mnohé makroassemblery pak 16kB ROM. A assemblery pro moderní mikroprocesory jsou již z&nbsp;tohoto pohledu až absurdně obrovské:</p>

<pre>
$ <strong>ls -l /usr/bin/as</strong>
&nbsp;
-rwxr-xr-x 1 root root 356952 dub 25  2017 /usr/bin/as
</pre>

<p></p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Vlastnosti Collapse OS z&nbsp;pohledu uživatele</h2>

<p>Jaké vlastnosti vlastně Collapse OS případným uživatelům nabízí? V&nbsp;první řadě je nutné již na úvod zdůraznit, že se v&nbsp;žádném případě nejedná o nějakou plnohodnotnou náhradu za moderní operační systémy &ndash; takové ambice ani není možné splnit s&nbsp;ohledem na hardwarová omezení použitých mikroprocesorů a při snaze udržet velikost celého projektu v&nbsp;mezích jednotek či maximálně desítek kilobajtů ROM. Taktéž se nejedná o realtime systém, i když k&nbsp;němu má blíže, než například klasické unixové/linuxové jádro. Collapse OS je v&nbsp;současnosti možné nastartovat (bez použití BIOSu či jakéhokoli uzavřeného binárního bloku), ovládat ho z&nbsp;klávesnice nebo přes sériovou konzoli s&nbsp;výstupem buď na sériovou konzoli nebo na připojený řádkový resp.&nbsp;grafický displej (zde pouze s&nbsp;omezeními). Collapse OS taktéž dokáže ovládat podporovaná bloková zařízení, což jsou v&nbsp;současnosti SD karty a u některých architektur i disketové jednotky.</p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Uživatelské nástroje</h2>

<p>Součástí Collapse OS jsou i základní utility. V&nbsp;první řadě je k&nbsp;dispozici shell jazyka Forth (jak již víme, ovladatelný z&nbsp;klávesnice nebo ze sériové konzole). To však není vše, protože součástí Collapse OS jsou i dva editory. První z&nbsp;nich je označován jako <i>binární editor</i>, i když se ve skutečnosti jedná o <i>hexa editor</i>, což je speciální forma editorů, jimiž jsme se <a href="https://www.root.cz/clanky/hexadecimalni-prohlizece-a-editory-s-textovym-uzivatelskym-rozhranim/">již na suživamtelůmtránkách Roota zabývali</a>. Právě tento typ editorů je pro danou aplikační oblast nejvhodnější. Ovšem k&nbsp;dispozici je i (vizuální) textový editor, jehož ovládání a chování je inspirováno editory Vi a <a href="https://www.root.cz/serialy/textovy-editor-vim-jako-ide/">Vim</a>. Ovšem použití tohoto textového editoru je poněkud neobvyklé, protože odráží fakt, že s&nbsp;blokovými zařízeními se skutečně pracuje po blocích, což je ostatně ve světě jazyka Forth obvyklé.</p>



<p><a name="k07"></a></p>
<h2 id="k07">7. Uložení zdrojového kódu programu do bloků (obrazovek)</h2>

<p>Již při popisu základních možností a součástí <i>Collapse OS</i> jsem se zmínil o (vizuálním) textovém editoru, který si ovšem zaslouží bližší popis, protože ukazuje, jak se celková architektura tohoto operačního systému projevila i na uživatelských programech. První rozdíl oproti běžným operačním systémům spočívá v&nbsp;tom, že Collapse OS celý souborový systém chápe jako prostou sekvenci bloků o velikosti 1024 kB. Tyto bloky mohou obsahovat libovolná data, která ovšem nejsou organizována do klasických adresářů a souborů. Existuje ovšem relativně jednoduchý mechanismus, jak s&nbsp;těmito bloky pracovat jako s&nbsp;textovým dokumentem rozděleným do takzvaných obrazovek neboli <i>screen(s)</i>.</p>

<p>Prakticky stejně je tomu v&nbsp;tradičních Forthech, v&nbsp;nichž se zdrojový text kódu programu neukládal do textových souborů (jak je tomu dnes), ale taktéž do jednotlivých bloků. V&nbsp;případě práce se zdrojovým textem se ovšem většinou nemluví o blocích, ale o již zmíněných obrazovkách (<i>screens</i>).</p>

<p>Velikost obrazovky je za jakýchkoli podmínek rovna šestnácti řádkům, kde na každém řádku je uloženo šedesát čtyři znaků. Celková velikost obrazovky je tedy rovna 64&times;16 = 1024 znakům/bytům, což přesně odpovídá velikosti jednoho bloku. Všimněte si, že délka řádku je vždy rovna 64 znakům, nezávisle na aktuálním obsahu řádku. Pokud je řádek &bdquo;prázdný&ldquo;, je v&nbsp;bloku jednoduše zapsáno 64 mezer (ASCII znaků s&nbsp;kódem 32).</p>

<p>Jisté je, že tento způsob zápisu je neúsporný, zejména při zápisu programů &bdquo;vertikálním&ldquo; způsobem. I z&nbsp;tohoto důvodu ostatně někteří zkušení programátoři zapisují definice nových slov &bdquo;horizontálním&ldquo; způsobem, tj.&nbsp;na jeden řádek &ndash; slova tak musejí být krátká, což vede k&nbsp;důsledné faktorizaci kódu (ta ostatně není nikdy na škodu, zvláště ve Forthu).</p>

<p>Pro načtení a zpracování (tj.&nbsp;překlad a interpretaci) celé obrazovky se používá slovo <strong>LOAD</strong>, jehož zásobníkový diagram je následující: <strong>( u –)</strong>. Před provedením tohoto slova musí být na zásobník operandů uloženo číslo bloku, který se má načíst a přeložit. Z&nbsp;hlediska operačního systému se jedná o triviální operaci, zcela jistě jednodušší, než používání sofistikovaných souborových systémů.</p>

<p>Pro souvislé načítání bloků/obrazovek je ve Forthu vytvořeno slovo s&nbsp;krásným zápisem <strong>--></strong> (tedy pomlčka pomlčka nerovnítko), které načte následující blok z&nbsp;blokového zařízení, tj.&nbsp;po bloku <strong>U</strong> je načten blok <strong>U+1</strong>. Pro automatizované načítání sekvence obrazovek je možné využít malého triku: na konci každé obrazovky je uvedeno výše popsané slovo -->, které při interpretaci automaticky způsobí odskok.</p>

<p>Pro výpis obsahu obrazovky na obrazovku :-) (tj.&nbsp;na monitor nebo na sériovou konzoli) lze použít slovo <strong>LIST</strong> se zásobníkovým diagramem <strong>( U – )</strong>, kde <strong>u</strong> je index požadované obrazovky.</p>

<p>Orientace v&nbsp;číslech obrazovek může být složitá, takže se, především u rozsáhlejších aplikací, na některé z&nbsp;prvních obrazovek uvádějí konstanty, které lze pro indexaci používat. Jednoduchý příklad:</p>

<pre>
1   constant app-init
90  constant graphics
125 constant sound
&nbsp;
app-init load
graphics load
graphics list
sound load
</pre>

<p>Pro tisk obsahu obrazovek na tiskárnu se v&nbsp;klasických Forthech (ovšem ne v&nbsp;Collapse OS) používá slovo <strong>TRIAD</strong>, které způsobí tisk třech obrazovek (index první z&nbsp;nich je uložen na zásobníku operandů). Proč zrovna tři obrazovky? Na tiskárnách formátu A4 popř.&nbsp;US Letter je možné vytisknout přibližně 60 řádků, což pro čtyři obrazovky nedostačuje (16&times;4 &gt; 60), ale pro tři obrazovky je tato hodnota ideální (obrazovky mohou být odděleny prázdným řádkem nebo několika řádky). Z&nbsp;tohoto důvodu se mnohdy zdrojový kód organizuje tak, aby důležité části (například začátky modulů) začínaly na začátku tiskové strany.</p>

<p>Při tisku lze také využít slovo <strong>INDEX</strong>, které vytiskne první řádky získané z&nbsp;šedesáti po sobě jdoucích obrazovek. Pokud tedy obsahuje každá obrazovka stručný popis (samozřejmě v&nbsp;poznámce), je možné velmi jednoduchým způsobem získat &bdquo;obsah&ldquo; programu. Důležitá jsou zejména odsazení prvních řádků tak, aby se při tisku zdůraznila hierarchie. Případnou implementaci slova <strong>INDEX</strong> ponechám na čtenáři, je totiž poměrně jednoduchá &ndash; stačí použít počítaný cyklus, dále slovo <strong>TYPE</strong> a nezapomenout na uložení délky řetězce na zásobník operandů.</p>

<p>Při zápisu zdrojových textů se často používají dvě slova uvozující poznámku. První slovo se zapisuje <strong>\</strong> a značí, že se ignoruje zbytek aktuálního řádku (tj.&nbsp;podobně jako v C-čku znaky <strong>//</strong>). Druhé slovo, které se zapisuje jako <strong>\S</strong>, způsobí, že se ignoruje text až do konce aktuální obrazovky. Pokud je tedy toto slovo uvedeno na prvním řádku, je celá obrazovka považována za komentář. Takovým způsobem je ostatně okomentována i značná část samotného Collapse OS.</p>


<p><a name="k08"></a></p>
<h2 id="k08">8. Technologie použité pro implementaci Collapse OS</h2>

    Run on minimal and improvised machines.
    Interface through improvised means (serial, keyboard, display).
    Edit text and binary contents.
    Compile assembler source for a wide range of MCUs and CPUs.
    Read and write from a wide range of storage devices.
    Assemble itself and deploy to another machine.


taktéž terminály, grafický výstup atd.
Forth

Programovacímu jazyku Forth jsme se již na stránkách Rootu kdysi věnovali v samostatném seriálu. Tento jazyk, který je založený na konceptu dvou zásobníků (jeden je používaný pro operandy a druhý pro uložení návratových adres volajících funkcí), je známý mj. i tím, že jeho implementaci lze v nejjednodušší variantě provést v několika stovkách bajtů paměti, tj. přibližně s 300 až 500 strojovými instrukcemi a navíc se některé dialekty Forthu provozovaly bez použití operačního systému (Forthovské jazyky byly součástí i několika BIOSů). V takto malém počtu instrukcí bude složité uložit jakákoli nebezpečná zadní vrátka. Na druhou stranu je nutné poznamenat, že Forth tvoří svůj velmi zajímavý, ale dosti izolovaný svět, takže v něm pravděpodobně nikdy nevznikne překladač C ani dalšího vyššího programovacího jazyka (typicky se ovšem Forth spojuje s assemblerem, což je ostatně i logičtější).

19. Tiny BASIC

Zajímavě je koncipován i jazyk Tiny BASIC, jehož specifikace byla napsána Dennisem Allisonem. Tento jazyk vznikl částečně jako reakce na známý otevřený dopis Billa Gatese komunitě „pirátů“. Na základě článku Dennise Allisona vzniklo a vzápětí se i rozšířilo několik různých implementací BASICu, které byly většinou nazvány (opět podle článku) Tiny BASIC. Tyto implementace byly dostupné jak pro osmibitové mikroprocesory firmy Intel, tak i pro procesor Motorola 6800 či MOS 6502, a to buď zcela zdarma nebo pod de-facto symbolickou částkou pěti dolarů (tato částka většinou zahrnovala i poštovné). Ovšem díky vzniku tolik žádoucí konkurence na trhu s domácími osmibitovými počítači se firmy začaly přetahovat o zákazníky, takže se snažily nabízet počítače již se základním programovým vybavením (uloženým v naprosté většině případů přímo v ROM) a nejenom skládačku typu počítače Altair, kde si uživatelé kromě ceny za počítač (400 dolarů) většinou museli připlatit i již zmíněných 150 dolarů za interpret programovacího jazyka.

<p><i>&bdquo;Who would want to work within the constraint of 64x16 blocks filesystem? Someone who knows the complexity associated with implementing a filesystem and everything that underpins it. When simplicity is valued, such constraints are gladly accepted.&ldquo;</i></p>



<p><a name="k09"></a></p>
<h2 id="k09">9. </h2>



<p><a name="k10"></a></p>
<h2 id="k10">10. </h2>



<p><a name="k11"></a></p>
<h2 id="k11">11. </h2>



<p><a name="k12"></a></p>
<h2 id="k12">12. </h2>



<p><a name="k13"></a></p>
<h2 id="k13">13. </h2>



<p><a name="k14"></a></p>
<h2 id="k14">14. </h2>



<p><a name="k15"></a></p>
<h2 id="k15">15. </h2>



<p><a name="k16"></a></p>
<h2 id="k16">16. </h2>



<p><a name="k17"></a></p>
<h2 id="k17">17. </h2>



<p><a name="k18"></a></p>
<h2 id="k18">18. Herní konzole Sega Master System</h2>



<p><a name="k19"></a></p>
<h2 id="k19">19. Základní technické parametry herní konzole Sega Master System</h2>

<p>Ústředním čipem herní konzole <i>Sega Master System</i> byl, stejně jako
v&nbsp;případě starší osmibitové konzole <i>SG-1000</i>, slavný osmibitový
mikroprocesor <i>Zilog Z80</i>. Tento osvědčený čip dokázal přímo obsluhovat
adresový prostor o velikosti 64 kB, tj.&nbsp; 0x0000 až 0xffff. Tento paměťový
prostor byl rozdělen na tři oblasti takovým způsobem, jak je to naznačeno
v&nbsp;následující tabulce:</p>

<table>
<tr><th>Od</th><th>Do</th><th>Popis</th></tr>
<tr><td>0x0000</td><td>0xbfff</td><td>paměť, do níž je adresován paměťový modul se hrou</td></tr>
<tr><td>0xc000</td><td>0xdfff</td><td>paměť RAM o kapacitě 8 kB</td></tr>
<tr><td>0xe000</td><td>0xffff</td><td>zrcadlená paměť RAM (jeden adresový vodič je ignorován)</td></tr>
</table>

<p>První oblast, do níž byl adresován paměťový modul, bylo možné použít jako
jeden dále nijak nerozdělený adresový prostor o velikosti 48 kilobajtů, ovšem u
paměťových modulů o větší kapacitě bylo prvních 32 kilobajtů mapováno přímo
(zde se tedy musel nacházet startovní kód hry) a zbývajících 16 kilobajtů
sloužilo pro přístup do vybraného <i>banku</i>. Těch mohlo být čistě teoreticky
až 256, v&nbsp;praxi se však používaly paměťové moduly o maximální kapacitě 256
kilobajtů (to se již ovšem jednalo o poměrně rozsáhlé hry).</p>

<img src="http://i.iinfo.cz/images/147/8205.jpg" width="450" height="328" alt="&#160;" />
<p><i>Obrázek 5: Herní konzole Sega Master System (SMS).</i></p>

<p>Kromě osmibitového mikroprocesoru <i>Zilog Z80</i> byly v&nbsp;herní konzoli
<i>Sega Master System</i> použity tři další čipy. Jedná se především o grafický
řadič <i>VDC</i>, což je upravená varianta původního řadiče <i>Texas
Instruments TMS9918</i>, dále pak o zvukový generátor <i>Texas Instruments
SN76489</i> (ten byl sloučen s&nbsp;<i>VDC</i>) a konečně se v&nbsp;herní
konzoli <i>SMS</i> objevil i velmi zvláštní čip <i>Yamaha YM2413</i>, který se
staral a zvukovou syntézu (jak si řekneme dále, byl tento čip vytvořen jako
levnější varianta ke známému čipu <i>Yamaha YM3812</i>, s&nbsp;nímž jsme se již
setkali například při popisu zvukové karty <i>Adlib</i> či
<i>SoundBlaster</i>). Díky použití čipu <i>YM2413</i> bylo možné ve hrách
poměrně jednoduše přehrávat hudbu, aniž by docházelo k&nbsp;přílišné zátěži
mikroprocesoru. Navíc má <i>YM2413</i> specifický zvuk, kterým bylo možné
konzoli <i>Sega Master System</i> a taktéž <i>MSX</i> odlišit od dalších
výrobků.</p>

<p><ins>Poznámka: <i>MSX</i> jsme se zatím úspěšně vyhýbali, takže jen stručně:
jedná se o počítač založený na procesoru <i>Zilog Z80</i>, který měl ambice se
stát jakousi obdobou IBM PC, ovšem v&nbsp;oblasti osmibitových počítačů &ndash;
tedy standardní platformou. S&nbsp;nadsázkou se říkalo, že <i>MSX</i> znamená
&bdquo;MicroSoft eXtended&ldquo;, a to kvůli angažovanosti Microsoftu na vývoji
této platformy.</ins></p>

<img src="http://i.iinfo.cz/images/338/8206.jpg" width="450" height="185" alt="&#160;" />
<p><i>Obrázek 6: Plošný spoj herní konzole Sega Master System (SMS).</i></p>

<p>Z&nbsp;pohledu Collapse OS a jeho teoretického nasazení však není důležitý
zvuk, ale spíše obrazový výstup. V&nbsp;herní konzoli <i>Sega Master System</i>
byl pro generování video signálů použit čip nazvaný <i>VDC</i>. Jednalo se o
integrovaný obvod, který byl sice odvozený od původního čipu <i>Texas
Instruments TMS9918</i>, ovšem došlo u něj k&nbsp;několika vylepšením, která
měla za cíl zvýšit konkurenceschopnost konzole <i>SMS</i>, především
v&nbsp;porovnání s&nbsp;<i>Atari 7800</i>, která firmě Sega tehdy konkurovala.
Čip <i>Texas Instruments TMS9918</i> dokázal pracovat s&nbsp;maximálně
šestnácti barvami, zatímco <i>Atari 7800</i> umožňovalo zobrazit (i když
s&nbsp;mnoha omezeními) až 128 resp.&nbsp;256 barev. Taktéž rozlišení
v&nbsp;grafických režimech, které bylo nabízeno čipem <i>TMS9918</i>, bylo
relativně malé. Z&nbsp;tohoto důvodu došlo při návrhu integrovaného obvodu
<i>VDC</i> k&nbsp;několika změnám. Zejména bylo možné pracovat až s&nbsp;32
barvami rozdělenými do dvou barvových palet &ndash; jedna paleta byla vyhrazena
pro statickou grafiku (pozadí) a druhá paleta byla vyhrazena pro sprity (ve
skutečnosti mohla být použita pro pozadí i sprity stejná paleta).</p>



<p><a name="k20"></a></p>
<h2 id="k20">20. Odkazy na Internetu</h2>

<ol>

<li>Collapse OS<br />
<a href="https://collapseos.org/">https://collapseos.org/</a>
</li>

<li>Public Domain Books to Restart Computer Technology<br />
<a href="https://blogbyjoshcogliati.blogspot.com/2021/05/public-domain-books-to-restart-computer.html">https://blogbyjoshcogliati.blogspot.com/2021/05/public-domain-books-to-restart-computer.html</a>
</li>

<li>Understanding Digital Computers<br />
<a href="https://archive.org/details/understanding_digital_computers">https://archive.org/details/understanding_digital_computers</a>
</li>

<li>Collapse OS Web Emulators<br />
<a href="https://schierlm.github.io/CollapseOS-Web-Emulator/">https://schierlm.github.io/CollapseOS-Web-Emulator/</a>
</li>

<li>Download: CollapseOS<br />
<a href="https://collapseos.org/download.html">https://collapseos.org/download.html</a>
</li>

<li>Civboot: a civilizational bootstrapper<br />
<a href="https://github.com/civboot/civboot">https://github.com/civboot/civboot</a>
</li>

<li>Můžeme věřit překladačům? Projekty řešící schéma „důvěřivé důvěry“<br />
<a href="https://www.root.cz/clanky/muzeme-verit-prekladacum-projekty-resici-schema-duverive-duvery/">https://www.root.cz/clanky/muzeme-verit-prekladacum-projekty-resici-schema-duverive-duvery/</a>
</li>

<li>'Collapse OS' Is An Open-Source Operating System For the Post-Apocalypse<br />
<a href="https://news.slashdot.org/story/19/10/08/2036204/collapse-os-is-an-open-source-operating-system-for-the-post-apocalypse">https://news.slashdot.org/story/19/10/08/2036204/collapse-os-is-an-open-source-operating-system-for-the-post-apocalypse</a>
</li>

<li>LCD 16 x 2 Basics<br />
<a href="https://exploreembedded.com/wiki/LCD_16_x_2_Basics">https://exploreembedded.com/wiki/LCD_16_x_2_Basics</a>
</li>

<li>How To Control an I2C LCD with Arduino<br />
<a href="https://www.make-it.ca/i2c-lcd-display-on-arduino/">https://www.make-it.ca/i2c-lcd-display-on-arduino/</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2021</small></p>
</body>
</html>

