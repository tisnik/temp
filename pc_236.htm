<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Čipy PIC24 a dsPIC: na rozhraní mezi mikrořadiči a DSP</title>
<meta name="Author" content="Pavel Tisnovsky" />
<meta name="Generator" content="vim" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<style type="text/css">
         body {color:#000000; background:#ffffff;}
         h1  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#c00000; text-align:center; padding-left:1em}
         h2  {font-family: arial, helvetica, sans-serif; color:#ffffff; background-color:#0000c0; padding-left:1em; text-align:left}
         h3  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#c0c0c0; padding-left:1em; text-align:left}
         h4  {font-family: arial, helvetica, sans-serif; color:#000000; background-color:#e0e0e0; padding-left:1em; text-align:left}
         a   {font-family: arial, helvetica, sans-serif;}
         li  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ol  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         ul  {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify; width:450px;}
         p   {font-family: arial, helvetica, sans-serif; color:#000000; text-align:justify;}
         pre {background:#e0e0e0}
</style>
</head>

<body>

<h1>Čipy PIC24 a dsPIC: na rozhraní mezi mikrořadiči a DSP</h1>

<h3>Pavel Tišnovský</h3>

<p></p>

<h1>Úvodník</h1>

<p>Mikrořadiče PIC jsme si již v tomto seriálu popisovali, ovšem prozatím jsme se zabývali pouze osmibitovými mikrořadiči řady PIC10, PIC12, PIC16 a PIC18. Ve skutečnosti je však svět čipů PIC rozsáhlejší, protože v něm nalezneme i šestnáctibitové mikrořadiče a jednoduché DSP.</p>



<h2>Obsah</h2>

<p><a href="#k01">1. Čipy PIC24 a dsPIC: na rozhraní mezi mikrořadiči a DSP</a></p>
<p><a href="#k02">2. Historie mikrořadičů PIC</a></p>
<p><a href="#k03">3. Rodiny mikrořadičů PIC</a></p>
<p><a href="#k04">4. Řada PIC10</a></p>
<p><a href="#k05">5. Řada PIC12</a></p>
<p><a href="#k06">6. Řada PIC16</a></p>
<p><a href="#k07">*** 7. Řada PIC18</a></p>
<p><a href="#k08">8. Šestnáctibitové mikrořadiče PIC24 a dsPIC</a></p>
<p><a href="#k09">9. Sada pracovních registrů</a></p>
<p><a href="#k10">10. Akumulátory u řady dsPIC</a></p>
<p><a href="#k11">*** 11. Stavový registr <strong>SRH</strong>+<strong>SRL</strong></a></p>
<p><a href="#k12">*** 12. Řídicí registr <strong>CORCON</strong></a></p>
<p><a href="#k13">*** 13. Podpora pro programové smyčky <strong>RCOUNT</strong></a></p>
<p><a href="#k14">*** 14. DSP modul</a></p>
<p><a href="#k15">*** 15. Instrukční soubor mikrořadičů PIC24 a dsPIC</a></p>
<p><a href="#k16">16. Odkazy na Internetu</a></p>



<p><a name="k01"></a></p>
<h2 id="k01">1. Čipy PIC24 a dsPIC: na rozhraní mezi mikrořadiči a DSP</h2>

<p>S&nbsp;mikrořadiči řady <i>PIC</i> vyráběnými společností <i>Microchip
Technology</i> jsme se již v&nbsp;tomto seriálu několikrát setkali, což
samozřejmě není náhoda, protože tato firma v&nbsp;současnosti nabízí několik
set(!) různých typů těchto čipů, které se od sebe odlišují jak počtem
využitelných vstupně/výstupních pinů (GPIO), tak i kapacitou interní paměti dat
(RAM) a taktéž interní paměti programu (ROM), počtem a typem modulů, které jsou
na mikrořadiči implementovány (sběrnice, porty atd.), rozsahem povoleného
napájecího napětí, rozsahem frekvencí hodinového signálu, kterým se čip řídí,
přítomností hardwarové &bdquo;DSP&ldquo; násobičky atd. Pod označením
<i>PIC</i> se dnes skrývá celá řada čipů; od jednoduchých osmibitových
mikrořadičů <i>PIC10</i> a <i>PIC12</i> (&bdquo;programovatelné
součástky&ldquo;), přes populární řady <i>PIC16</i> a <i>PIC18</i> až po
šestnáctibitové čipy <i>PIC24</i> a <i>dsPIC</i>, kterými se budeme podrobněji
zabývat ve druhé části dnešního článku a v&nbsp;navazující části seriálu.</p>

<a href="http://i.iinfo.cz/images/197/pc127-1.png"><img src="http://i.iinfo.cz/images/197/pc127-1-prev.png" width="338" height="270" alt=" " /></a>
<p><i>Obrázek 1: Pro vývoj aplikací určených pro osmibitové mikrořadiče PIC je
možné použít i mnoho open source nástrojů. Na tomto screenshotu jsou zobrazena
některá okna nástroje nazvaného gpsim (simulátoru mikrořadičů), který lze
provozovat jak na Linuxu, tak i na systémech MS Windows. Tento nástroj
v&nbsp;současné verzi simuluje mikrořadiče řady PIC10, PIC12, PIC16 i PIC18,
tedy celou dnes dostupnou sérii osmibitových mikrořadičů.</i></p>



<p><a name="k02"></a></p>
<h2 id="k02">2. Historie mikrořadičů PIC</h2>

<p>Mikrořadiče <i>PIC</i> mají za sebou velmi dlouhý a v&nbsp;několika ohledech
i zajímavý vývoj. Ten vlastně začal již v&nbsp;polovině sedmdesátých let
minulého století, kdy vznikl mikrořadič nazvaný <i>Signetics 8x300</i>. Jednalo
se o jeden z&nbsp;prvních mikrořadičů založených na Harvardské architektuře
(tj.&nbsp;s&nbsp;oddělenou pamětí pro data a pamětí pro program), který ještě
byl vytvořený na bázi bipolárních tranzistorů, podobně jako například logické
obvody řady TTL. Tento mikrořadič ovšem postrádal některé důležité vlastnosti
používané v&nbsp;praxi; například neměl zásobník, indexové registry a dokonce
ani možnost zpracovávat přerušení (což souviselo, i když jen okrajově,
s&nbsp;neexistencí zásobníku). Taktéž adresování paměti programu bylo poněkud
složité &ndash; provádělo se přes osmibitový registr nazvaný
<strong>IVB</strong>, navíc aritmeticko-logická jednotka dokázala provádět
pouze instrukce <strong>MOV</strong>, <strong>ADD</strong>,
<strong>AND</strong>, <strong>XOR</strong> a bitové posuny. Z&nbsp;výše
uvedených důvodů se mikrořadič <i>Signetics 8x300</i> v&nbsp;praxi příliš
nerozšířil.</p>

<a href="http://i.iinfo.cz/images/197/pc127-13.jpg"><img src="http://i.iinfo.cz/images/197/pc127-13-prev.jpg" width="332" height="270" alt=" " /></a>
<p><i>Obrázek 2: Vývojový kit BASIC Stamp ve verzi vybavené rozhraním
universální sériové sběrnice (USB). Jedná se o jednodeskový mikropočítač
vybavený mikrořadičem PIC a pamětí ROM s&nbsp;interpretrem programovacího
jazyka BASIC. Po tomto kitu se začal prodávat kit nazvaný Spin Stamp vybavený
pro změnu interpretrem programovacího jazyka SPIN (výrobcem je ve všech
případech společnost Parallax).</i></p>

<p>V&nbsp;sedmdesátých letech minulého století ovšem vznikl i šestnáctibitový
mikroprocesor s&nbsp;označením <i>CP1600</i> firmy <i>General Instruments</i>
(s&nbsp;touto firmou jsme se již ostatně v&nbsp;tomto seriálu setkali, protože
stojí i za vznikem slavného zvukového čipu <i>AY-3-8910</i>, lidově
&bdquo;áýčka&ldquo;). Aby se vylepšila výkonnost tohoto nepříliš úspěšného
mikroprocesoru při provádění různých vstupně/výstupních operací, byl vytvořen
pomocný čip nesoucí označení <i>PIC1640</i>, kde první tři písmena
&bdquo;PIC&ldquo; znamenala &bdquo;Programmable Interface Controller&ldquo; a
číslo 16 začalo označovat řadu čipů s&nbsp;podobnou (většinou zcela totožnou)
instrukční sadou.</p>

<a href="http://i.iinfo.cz/images/692/pc126-14.png"><img src="http://i.iinfo.cz/images/692/pc126-14-prev.png" width="370" height="205" alt=" " /></a>
<p><i>Obrázek 3: Vývojový kit Amicus s&nbsp;mikrořadičem PIC. Tento vývojový
kit byl inspirován kitem Arduino určeným pro mikrořadiče Atmel AVR, i když ani
zdaleka není tak populární.</i></p

<p>Úkolem tohoto čipu byla skutečně komunikace s&nbsp;periferními zařízeními,
kterou tak nemusel obstarávat mikroprocesor <i>CP1600</i>. Původní
<i>PIC1640</i> a na něj navazující čip <i>PIC1650</i> obsahovaly interní paměť
ROM programovanou pomocí poslední masky přímo při výrobě čipu (což je podobné
prakticky všem čtyřbitovým mikrořadičům, jimž jsme se věnovali
v&nbsp;předchozích pěti částech tohoto seriálu). Ovšem většího rozšíření se
mikrořadiče <i>PIC</i> dočkaly až po oddělení divize mikroelektroniky
z&nbsp;firmy <i>General Instruments</i> do nově vzniklé firmy s&nbsp;názvem
<i>Microchip Technology</i> (tato firma existuje dodnes).</p>

<a href="http://i.iinfo.cz/images/197/pc127-4.png"><img src="http://i.iinfo.cz/images/197/pc127-4-prev.png" width="370" height="85" alt=" " /></a>
<p><i>Obrázek 4: Hlavní okno simulátoru mikrořadičů PIC &ndash; aplikace
gpsim.</i></p>

<p>Právě v&nbsp;této nové firmě došlo k&nbsp;zásadní proměně mikrořadiče
&ndash; náhradě neměnné ROM za paměť EPROM (mazatelné ultrafialovým zářením
přes okénko na čipu) a posléze i náhradě EPROM za EEPROM (elektronicky
mazatelnou paměť) a Flash (vylepšenou EEPROM s&nbsp;větším množstvím zápisů a
rychlejším blokovým algoritmem přepisu dat). Mimochodem &ndash; první
mikrořadič <i>PIC</i> s&nbsp;pamětí typu EEPROM nesoucí jméno <strong>PIC
16C84</strong> se díky svému významu pro další vývoj celého odvětví dostal i
mezi 25 čipů, které (podle autora tohoto žebříčku) nejvíce změnily svět:
&bdquo;25 Microchips That Shoot The World&ldquo; (varianta <i>PIC 16F84</i> již
obsahovala Flash). <i>PIC 16C84</i> je zde zmíněn například vedle známého
časovače <i>555</i>, osmibitového mikroprocesoru <i>MOS 6502</i>, 8/16bitového
mikroprocesoru <i>Intel 8088</i> (právě ten stál u vzniku platformy IBM PC,
nikoli jeho výkonnější bráška <i>Intel 8086</i>) či 16/32bitového
mikroprocesoru <i>Motorola 68000</i> (majitelům osobních mikropočítačů značek
Atari ST, Amiga či Macintosh 68k zajisté netřeba zdlouhavě představovat).</p>

<a href="http://i.iinfo.cz/images/197/pc127-5.png"><img src="http://i.iinfo.cz/images/197/pc127-5-prev.png" width="264" height="270" alt=" " /></a>
<p><i>Obrázek 5: Editor paměti programu v&nbsp;simulátoru gpsim.</i></p>

<p>V&nbsp;současnosti se čipy PIC vyrábí právě ve firmě Microchip, ovšem
někteří další výrobci nabízí čipy, které jsou z&nbsp;hlediska instrukční sady
s&nbsp;PICy částečně či úplně kompatibilní. Mezi tyto výrobce klonů patří
Parallax, Hycom, Holtek či ELAN.</p>



<p><a name="k03"></a></p>
<h2 id="k03">3. Rodiny mikrořadičů PIC</h2>

<p>Mikrořadiče označované jménem <i>PIC</i> jsou rozděleny do takzvaných rodin.
Čipy z&nbsp;jednotlivých rodin se od sebe odlišují především počtem
vstupně/výstupních portů (a tím pádem i pinů), počtem universálních registrů
(neboli kapacitou paměti údajů), kapacitou paměti programu (EPROM, Flash) a
v&nbsp;neposlední řadě také instrukční sadou &ndash; nejjednodušší mikrořadiče,
konkrétně se jedná o mikrořadiče spadající do rodiny <i>PIC10</i>, mají ve své
instrukční sadě pouze 33 instrukcí, pouzdra těchto čipů mají v&nbsp;extrémním
případě jen šest vývodů (což je například méně než počet vývodů známého obvodu
555), kapacita paměti programu dosahuje 256 nebo 512 bajtů a počet
universálních registrů je roven 16 nebo 24 (takže kapacita interní RAM je 16 či
24 bajtů). Naproti tomu některé mikrořadiče z&nbsp;rodiny <i>PIC18</i> jsou
umístěny v&nbsp;pouzdře s&nbsp;28 až 40 piny, jejich instrukční sada má 75
instrukcí, paměť pro uložení programu může mít kapacitu 8 kB a počet
universálních registrů dosahuje typicky 256 bajtů.</p></p>

<a href="http://i.iinfo.cz/images/197/pc127-11.jpg"><img src="http://i.iinfo.cz/images/197/pc127-11-prev.jpg" width="345" height="270" alt=" " /></a>
<p><i>Obrázek 6: Source browser &ndash; součást nástroje gpsim zmíněného
v&nbsp;úvodní kapitole.</i></p>

<p>Samostatnou skupinu tvoří mikrořadiče <i>PIC24</i> a <i>dsPIC</i>, které
jsou šestnáctibitové a jimiž se budeme podrobněji zabývat níže. Další
samostatnou skupinou jsou mikrořadiče <i>PIC32MX</i>, <i>PIC32MZ</i> a
<i>PIC32MM</i> založené na 32bitovém <a
href="https://www.root.cz/clanky/procesory-s-architekturou-risc-v-pracovnich-stanicich-a-serverech/">RISCovém
jádru MIPS</a>, tedy na druhé straně výkonnostního spektra v&nbsp;porovnání
s&nbsp;řadami <i>PIC1x</i>.</p>

<p>Základní rozdělení osmibitových mikrořadičů <i>PIC</i> je znázorněno na
následujícím obrázku. Povšimněte si, že jedním z&nbsp;hlavních ukazatelů je
nejenom počet pinů (který omezuje i počet modulů, například přítomnost
sériového portu, A/D převodníku či PWM) ale i bitová šířka instrukcí, protože u
čipů s&nbsp;větším počtem universálních registrů (RAM) i větší kapacitou paměti
programu (ROM) je nutné v&nbsp;instrukčním slově rezervovat větší množství bitů
pro uložení indexu universálního registru nebo adresy, na které se má provést
skok:</p>

<a href="http://i.iinfo.cz/images/197/pc127-10.png"><img src="http://i.iinfo.cz/images/197/pc127-10-prev.png" width="370" height="213" alt=" " /></a>
<p><i>Obrázek 7: Základní rozdělení osmibitových mikrořadičů PIC. Skupiny se
od sebe odlišují podle toho, jak široká jsou instrukční slova (z&nbsp;toho jsou
odvozeny další vlastnosti, například velikost adresovatelné paměti atd.).
Zdroj: firma Microchip Technology.</i></p>

<p>Pro lepší porovnání možností mikrořadičů z&nbsp;jednotlivých rodin jsou
v&nbsp;následující tabulce vypsány parametry některých vybraných mikrořadičů
<i>PIC</i>:</p>

<table>
<tr><th>Mikrořadič<br />&nbsp;</th><th>Frekvence<br />(MHz/MIPS)</th><th>Pinů<br />&nbsp;</th><th>RAM<br />(bajtů)</th><th>ROM<br />(slov/kB)</th><th>Instrukční sada<br />(bitů)</th><th>Počet instrukcí<br />&nbsp;</th></tr>
<tr><td>PIC10F200         </td><td>4</td><td>6-8</td><td>16</td><td>256</td><td>12</td><td>33</td></tr>
<tr><td>PIC10F206         </td><td>4</td><td>6-8</td><td>16</td><td>512</td><td>12</td><td>33</td></tr>
<tr><td>PIC12F683         </td><td>8</td><td>14</td><td>128</td><td>2048</td><td>14</td><td>35</td></tr>
<tr><td>PIC16F87          </td><td>až 20</td><td>18</td><td>368</td><td>4096</td><td>14</td><td>35</td></tr>
<tr><td>PIC18F1220        </td><td>až 40</td><td>18-28</td><td>256</td><td>2048</td><td>16</td><td>78</td></tr>
<tr><td>PIC18F1320        </td><td>až 40</td><td>18-28</td><td>256</td><td>4096</td><td>16</td><td>78</td></tr>
<tr><td>PIC24F04KA200     </td><td>16</td><td>14</td><td>512</td><td>4096</td><td>24</td><td>94</td></tr>
<tr><td>PIC24FJ128GA010   </td><td>16</td><td>100</td><td>8192</td><td>128kB</td><td>24</td><td>94</td></tr>
<tr><td>PIC24FJ128GA110   </td><td>16</td><td>100</td><td>16384</td><td>256kB</td><td>24</td><td>94</td></tr>
<tr><td>dsPIC30F1010      </td><td>30</td><td>28</td><td>256</td><td>6kB</td><td>24</td><td>110</td></tr>
<tr><td>dsPIC30F6015      </td><td>30</td><td>64</td><td>8192</td><td>144kB</td><td>24</td><td>110</td></tr>
<tr><td>dsPIC33FJ256GP510A</td><td>40</td><td>100</td><td>16384</td><td>256kB</td><td>24</td><td>110</td></tr>
</table>

<p>Poznámka: instrukční sady pro řady PIC18, PIC24 a dsPIC jsou navrženy
takovým způsobem, aby se zefektivnil překlad z&nbsp;céčka, i když se nejedná o
klasické RISCy. Zde se již příliš nepočítá s&nbsp;použitím assembleru,
samozřejmě kromě specifických subrutin. Naproti tomu u řad PIC10, PIC12 a
částečně i PIC16 se většinou programy zapisovaly v&nbsp;assembleru &ndash;
ostatně jednalo se většinou o programy dlouhé několik desítek maximálně stovek
instrukcí.</p>



<p><a name="k04"></a></p>
<h2 id="k04">4. Řada PIC10</h2>

<p>Mikrořadiče řady <i>PIC10</i> (a <i>PIC12</i>) patří mezi nejmenší čipy
<i>PIC</i> vůbec, a to jak z&nbsp;hlediska počtu pinů, tak i dostupné kapacity
datové paměti RAM či programové paměti ROM. Instrukce mají konstantní šířku
dvanáct bitů, což omezuje zejména možnosti adresování (jak operandů
v&nbsp;rámci RAM, tak i cíle skoku v&nbsp;EPROM či Flash). Příkladem může být
čip <i>PIC10F200</i> nabízený v&nbsp;pouzdru s&nbsp;pouhými šesti či osmi piny
&ndash; ostatně i z&nbsp;tohoto důvodu se těmto mikrořadičům přezdívá
&bdquo;programovatelné součástky&ldquo;. Maximální hodinová frekvence tohoto
čipu je 4 MHz (díky internímu oscilátoru není nutné připojovat externí hodinový
signál), kapacita programové paměti 256 instrukcí (po dvanácti bitech) a
kapacita datové paměti pouze šestnáct bajtů. Kromě vlastního CPU je na čipu
umístěn i konfigurovatelný osmibitový čítač a v&nbsp;případě nepatrně
upraveného obvodu <i>PIC10F204</i> zde najdeme i jeden komparátor. Výhodou je i
automatický reset (ušetření dalšího pinu).</p>

<img src="http://i.iinfo.cz/images/77/pc12801.png" width="250" height="179" alt=" " />
<p><i>Obrázek 8: Mikrořadič PIC10F2xx umístěný v&nbsp;pouzdru SOT-23. Celkové
rozměry tohoto čipu jsou minimální: šířka 2,2mm, délka 2,7mm a výška
0,9mm.<br />
(zdroj: PIC10F200/202/204/206 Data Sheet)</i></p>

<p>I tyto minimalistické mikrořadiče podporují programování pomocí protokolu
<i>In-Circuit Serial Programming (ICSP)</i> vyvinutého samotnou firmou
Microchip Technology. Tento protokol, jak již ostatně jeho název napovídá,
umožňuje zápis dat do paměti programu pomocí třívodičového sériového kanálu
&ndash; jedním vodičem se přenáší data a řídicí příkazy, druhý vodič slouží pro
přenos hodinového signálu a třetí vodič je společná (datová) zem pro vysílač
(například osobní počítač) i přijímač (kterým je mikrořadič). ICSP je patrná i
na schématu zapojení pinů mikrořadiče PIC10F200, které je zobrazeno na
následujícím obrázku:</p>

<img src="http://i.iinfo.cz/images/495/pc12802.png" width="450" height="150" alt=" " />
<p><i>Obrázek 9: Zapojení pinů mikrořadičů PIC10F200 a PIC10F202 při použití
pouzdra typu SOT-23. Jak je z&nbsp;obrázku patrné, mají některé piny přiřazeno
více funkcí, které lze samozřejmě uživatelsky konfigurovat.<br />
(zdroj: PIC10F200/202/204/206 Data Sheet)</i></p>



<p><a name="k05"></a></p>
<h2 id="k05">5. Řada PIC12</h2>

<p>Další rodinou mikrořadičů <i>PIC</i> jsou čipy řady <i>PIC12</i>, které jsou
již v&nbsp;mnoha ohledech lépe vybavené než mikrořadiče <i>PIC10</i>, a to při
zachování příznivé ceny a v&nbsp;mnoha případech i zachování malého pouzdra,
v&nbsp;němž jsou tyto mikrořadiče umístěny (víme již, že s&nbsp;rostoucím
počtem pinů roste i cena, spotřeba a poruchovost celého zařízení, a to sice ne
výrazně, ale při sériové výrobě se již může jednat o položku ovlivňující
například koncovou cenu zařízení).</p>

<img src="http://i.iinfo.cz/images/181/pc129-4.jpg" width="220" height="165" alt=" " />
<p><i>Obrázek 10: Starší mikrořadiče PIC s&nbsp;paměťmi typu EPROM mazatelnými
ultrafialovým zářením (právě z&nbsp;tohoto důvodu jsou na čipech okénka
propouštějící UV záření na buňky paměti EPROM).</i></p>

<p>Zástupcem rodiny <i>PIC12</i> je mikrořadič <i>PIC12F675</i>, který
prakticky ve všech ohledech překonává čipy <i>PIC10F2xx</i> popsané výše. Tento
mikrořadič obsahuje interní paměť programu schopnou uložit až 1024 instrukcí.
Paměť dat je rozšířena na 64 bajtů, k&nbsp;nimž je navíc přidáno 128 bajtů
paměti EEPROM, jejíž buňky by měly umožnit až jeden milion přepisů (to
například znamená, že pokud se výsledek nějakého měření zapíše do stejné buňky
EEPROM jednou za čtvrt hodiny, překračuje životnost této paměti 28 let,
tj.&nbsp;mnohonásobně plánovanou životnost celého zařízení). Tato paměť je
samozřejmě nevolatilní, tudíž &bdquo;přežije&ldquo; i výpadky napájení.</p>

<p>I další technické parametry tohoto mikrořadiče jsou oproti řadě <i>PIC10</i>
vylepšeny &ndash; například počet vstupně/výstupních pinů se zvýšil na šest
(celkem čip používá 8 pinů), časovač byl rozšířen na šestnáct bitů a navíc byl
přidán i čtyřkanálový analogově-digitální převodník, což mj.&nbsp;znamená, že
čtyři vstupní piny mohou být využity pro čtení analogových údajů, což je na
osmipinový čip poměrně zajímavá hodnota (převodník je jen jeden, ovšem je
vybaven multiplexorem). Taktéž výpočetní rychlost se zvýšila, a to pětkrát
&ndash; ovšem za předpokladu, že je použit externí oscilátor.</p>



<p><a name="k06"></a></p>
<h2 id="k06">6. Řada PIC16</h2>

<p>Řada <i>PIC16</i>, kam zařazujeme mj.&nbsp;i stále populární čipy
<i>PIC16F87</i> a <i>PIC16F88</i>, je sice uvedena až třetí v&nbsp;pořadí,
ovšem ve skutečnosti právě tato řada stála za úspěchem celé série <i>PIC</i>.
Čipy řady <i>PIC16</i> používají instrukční sadu s&nbsp;instrukčními slovy
širokými čtrnáct bitů (to mj.&nbsp;znamená, že se změnila i organizace paměti
programu, resp.&nbsp;šířka ukládaných slov). Rozšíření každé instrukce o dva
bity v&nbsp;porovnání s&nbsp;PIC12 se na návrhu instrukční sady projevilo třemi
způsoby: aritmetické a logické instrukce mohou přímo adresovat až 128 bajtů
operační paměti a registrů speciálních funkcí, skokové instrukce mohou
obsahovat jedenáctibitovou cílovou adresu (0 až 2047) a současně se mohl zvýšit
i celkový počet instrukcí. Přibyly například instrukce pro přičtení či odečtení
osmibitové konstanty od obsahu akumulátoru <strong>W</strong>.</p>

<a href="http://i.iinfo.cz/images/197/pc127-2.png"><img src="http://i.iinfo.cz/images/197/pc127-2-prev.png" width="370" height="168" alt=" " /></a>
<p><i>Obrázek 11: Mezi jedny z&nbsp;nejpoužívanějších mikrořadičů PIC patří řada
PIC16F87, která konstruktérům nabízí příznivý poměr mezi cenou a velikostí čipu
na jedné straně a jeho možnostmi na straně druhé. Písmeno &bdquo;F&ldquo;
v&nbsp;označení čipu naznačuje, že je tento mikrořadič vybaven Flash pamětí,
podobně jako jeho slavný předchůdce PIC16F84.</i></p>

<p>Obecně je možné říci, že mikrořadiče řady <i>PIC16</i> bývají po všech
stránkách výkonnější v&nbsp;porovnání jak s&nbsp;<i>PIC10</i>, tak i
s&nbsp;<i>PIC12</i>. Kapacita programové paměti se již počítá v&nbsp;jednotkách
či desítkách kilobajtů (ovšem kapacity jsou stále na první pohled
&bdquo;divné&ldquo; kvůli 14bitovým slovům), typická kapacita operační paměti
RAM je 128, 256, 512 či 1024 bajtů, hodinová frekvence bývá v&nbsp;rozsahu 16
MHz až 40 MHz a samozřejmě se zvýšil počet GPIO, čítačů, časovačů, komparátorů
a objevují se i analogové I/O či PWM, nemluvě o podpoře sériových sběrnic
atd.</p>

<a href="http://i.iinfo.cz/images/197/pc127-3.png"><img src="http://i.iinfo.cz/images/197/pc127-3-prev.png" width="328" height="270" alt=" " /></a>
<p><i>Obrázek 12: Zapojení vývodů mikrořadiče PIC16F88.</i></p>



<p><a name="k07"></a></p>
<h2 id="k07">7. Řada PIC18</h2>



<p><a name="k08"></a></p>
<h2 id="k08">8. Šestnáctibitové mikrořadiče PIC24 a dsPIC</h2>

<p>Ve druhé části článku se budeme zabývat šestnáctibitovými mikrořadiči PIC24
a taktéž čipy dsPIC, které jsou založeny na PIC24, ovšem kromě toho mají
přidanou podporu pro DSP operace (jinými slovy mají rychlou násobičku a obvody
pro adresování používané v&nbsp;DSP aplikacích). Šestnáctibitové mikrořadiče
PIC24 a dsPIC jsou rozděleny do šesti skupin vypsaných v&nbsp;následující
tabulce:</p>

<table>
<tr><th>Šestnáctibitové mikrořadiče</th></tr>
<tr><td>PIC24F</td></tr>
<tr><td>PIC24H</td></tr>
<tr><td>PIC24E</td></tr>
<tr><th>Šestnáctibitové digitální signálové procesory</th></tr>
<tr><td>dsPIC30F</td></tr>
<tr><td>dsPIC33F</td></tr>
<tr><td>dsPIC33E</td></tr>
</table>

<p>Některé vlastnosti jsou všem šestnáctibitovým PICům společné. Týká se to jak
instrukční sady, která se v&nbsp;mnoha ohledech odlišuje od instrukčních sad
osmibitových mikrořadičů, tak i větší kapacity pamětí EPROM/Flash a RAM.
Vzhledem k&nbsp;tomu, že programový čítač má šířku 23 bitů, je možné vytvářet
mnohem větší programy. Programová paměť navíc používá slova široká celých 24
bitů, nikoli 12, 14 či 16 bitů. Kapacita datové paměti je sice omezena na 32k
slov (tedy 64 kilobajtů), ovšem mnohé mikrořadiče podporují <i>EDS (Extended
Data Space)</i>, takže se i toto omezení může obejít. Mezi další novinky patří
rychlá násobička 17&times;17 bitů se čtyřicetibitovými akumulátory, které
najdeme u řady dsPIC (viz další text). Některé čipy mají i další podpůrné
obvody, například obvod pro rychlé programové smyčky (DO-LOOP) atd.</p>



<p><a name="k09"></a></p>
<h2 id="k09">9. Sada pracovních registrů</h2>

<p>Připomeňme si, že všechny osmibitové mikrořadiče PIC měly de facto pouze
jediný pracovní registr nazvaný <strong>W</strong> (<i>work register</i>).
Ostatní registry, a to včetně programového čítače, stavového registru, registru
<strong>INDF</strong> používaného pro nepřímé adresování atd. byly mapovány
přímo do paměti RAM. Tomuto uspořádání odpovídala i instrukční sada, protože
všechny instrukce se dvěma operandy (ADDWF, SUBWF, ANDWF, IORWF, XORWF)
akceptovaly jako jeden operand vždy registr <strong>W</strong> a druhým
operandem byl libovolný registr <strong>f</strong> mapovaný do RAM (počet
těchto registrů a tím i kapacita RAM je omezen zvolenou instrukční sadou).
Podobně je tomu i u instrukcí pracujících s&nbsp;osmibitovou konstantou,
v&nbsp;nichž je cílovým operandem vždy pracovní registr <strong>W</strong>.
Toto uspořádání však není pro delší programy příliš vhodné, neboť existence
jediného &bdquo;akumulátoru&ldquo; může být limitující a nepříjemná zejména při
překladu céčkových programů.</p>

<p>Naproti tomu u šestnáctibitových mikrořadičů došlo k&nbsp;výrazné změně,
protože je zde k&nbsp;dispozici celkem šestnáct pracovních registrů, přičemž
každý z&nbsp;těchto registrů má pochopitelně šířku šestnáct bitů. Všechny
dostupné registry jsou vypsány v&nbsp;následující tabulce:</p>

<table>
<tr><th>Registr</th><th>Alternativní funkce/jméno</th></tr>
<tr><td>W0</td><td>WREG</td></tr>
<tr><td>W1</td><td>&nbsp;</td></tr>
<tr><td>W2</td><td>&nbsp;</td></tr>
<tr><td>W3</td><td>&nbsp;</td></tr>
<tr><td>W4</td><td>&nbsp;</td></tr>
<tr><td>W5</td><td>&nbsp;</td></tr>
<tr><td>W6</td><td>&nbsp;</td></tr>
<tr><td>W7</td><td>&nbsp;</td></tr>
<tr><td>W8</td><td>&nbsp;</td></tr>
<tr><td>W9</td><td>&nbsp;</td></tr>
<tr><td>W10</td><td>&nbsp;</td></tr>
<tr><td>W11</td><td>&nbsp;</td></tr>
<tr><td>W12</td><td>&nbsp;</td></tr>
<tr><td>W13</td><td>&nbsp;</td></tr>
<tr><td>W14</td><td>Frame pointer</td></tr>
<tr><td>W15</td><td>Stack pointer</td></tr>
</table>

<p>Čítač instrukcí <strong>PC</strong> je od sady pracovních registrů oddělen,
protože má šířku 23 bitů, zatímco pracovní registry mají šířku šestnáct
bitů.</p>

<p>Poznámka: registr <strong>W0</strong> s&nbsp;aliasem <strong>WREG</strong>
je implicitně používán v&nbsp;těch adresovacích režimech, v&nbsp;nichž je
druhým operandem buňka v&nbsp;RAM. V&nbsp;takové situaci totiž již
v&nbsp;instrukčním slovu není dostatek volných bitů pro určení indexu
pracovního registru.</p>



<p><a name="k10"></a></p>
<h2 id="k10">10. Akumulátory u řady dsPIC</h2>

<p>U čipů dsPIC30F, dsPIC33F a dsPIC33E se kromě pracovních registrů setkáme i
s&nbsp;akumulátory pojmenovanými <strong>ACCA</strong> a <strong>ACCB</strong>,
které se používají u mnoha operací pro zpracování signálu. Tyto akumulátory
jsou dva a každý z&nbsp;nich má šířku 40 bitů, což je v&nbsp;oblasti DSP
poměrně obvyklá hodnota (stačí si připomenout články o slavném digitálním
signálovém procesoru TMS320C10). Z&nbsp;pohledu programátora je každý
akumulátor složen ze tří registrů mapovaných do RAM:</p>

<table>
<tr><th>Akumulátor</th><th>Horních 8 bitů</th><th>Prostředních 16 bitů</th><th>Spodních 16 bitů</th></tr>
<tr><td>ACCA</td><td>ACCAU</td><td>ACCAH</td><td>ACCAL</td></tr>
<tr><td>ACCB</td><td>ACCBU</td><td>ACCBH</td><td>ACCBL</td></tr>
</table>

<p>U čipů dsPIC33E je možné uložit výsledek operace MUL přímo do akumulátoru,
takže se násobení může provádět paralelně s&nbsp;další instrukcí.</p>



<p><a name="k11"></a></p>
<h2 id="k11">11. Stavový registr <strong>SRH</strong>+<strong>SRL</strong></h2>

<p></p>



<p><a name="k12"></a></p>
<h2 id="k12">12. Řídicí registr <strong>CORCON</strong></h2>

<p></p>



<p><a name="k13"></a></p>
<h2 id="k13">13. Podpora pro programové smyčky <strong>RCOUNT</strong></h2>

<p></p>



<p><a name="k14"></a></p>
<h2 id="k14">14. DSP modul</h2>

<p></p>



<p><a name="k15"></a></p>
<h2 id="k15">15. Instrukční soubor mikrořadičů PIC24 a dsPIC</h2>

<p>Jak jsme si již naznačili <a href="#k08">v&nbsp;osmé kapitole</a>, je
instrukční soubor mikrořadičů PIC24/dsPIC v&nbsp;několika ohledech odlišný od
osmibitových mikrořadičů řady PIC10/12/16/18. Tvůrci PIC24 se rozhodli, že
instrukční slova budou mít šířku 24 bitů, což umožnilo jak použití většího
množství pracovních registrů, tak i přidání nových adresních režimů, zcela
nových instrukcí apod.</p>



<p><a name="k16"></a></p>
<h2 id="k16">16. Odkazy na Internetu</h2>

<ol>

<li>Stránky společnosti Microchip<br />
<a href="http://www.microchip.com/">http://www.microchip.com/</a>
</li>

<li>Mikrořadiče řady PIC10<br />
<a href="http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=1009">http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=1009</a>
</li>

<li>Mikrořadiče řady PIC12<br />
<a href="http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=1001">http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=1001</a>
</li>

<li>Mikrořadiče řady PIC16<br />
<a href="http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=1002">http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=1002</a>
</li>

<li>Mikrořadiče řady PIC18<br />
<a href="http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=1004">http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=1004</a>
</li>

<li>Šestnáctibitové mikrořadiče PIC<br />
<a href="http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=20">http://www.microchip.com/ParamChartSearch/chart.aspx?branchID=20</a>
</li>

<li>Microchip's 32-bit MCUs<br />
<a href="http://www.microchip.com/design-centers/32-bit">http://www.microchip.com/design-centers/32-bit</a>
</li>

<li>Development Tools (oficiálně dostupné nástroje pro PIC)<br />
<a href="http://www.microchip.com/development-tools/">http://www.microchip.com/development-tools/</a>
</li>

<li>Vývojové nástroje pro osmibitové mikrořadiče PIC<br />
<a href="https://www.root.cz/clanky/vyvojove-nastroje-pro-osmibitove-mikroradice-pic/">https://www.root.cz/clanky/vyvojove-nastroje-pro-osmibitove-mikroradice-pic/</a>
</li>

<li>Mikroprocesory s&nbsp;architekturou MIPS<br />
<a href="https://www.root.cz/clanky/procesory-s-architekturou-risc-v-pracovnich-stanicich-a-serverech/">https://www.root.cz/clanky/procesory-s-architekturou-risc-v-pracovnich-stanicich-a-serverech/</a>
</li>

<li>gpsim Home Page<br />
<a href="http://gpsim.sourceforge.net/gpsim.html">http://gpsim.sourceforge.net/gpsim.html</a>
</li>

<li>Gpsim (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/Gpsim">https://en.wikipedia.org/wiki/Gpsim</a>
</li>

<li>Digital Signal Processors (stránky TI)<br />
<a href="http://www.ti.com/lsds/ti/processors/dsp/overview.page">http://www.ti.com/lsds/ti/processors/dsp/overview.page</a>
</li>

<li>C674x Low Power DSP (stránky TI)<br />
<a href="http://www.ti.com/lsds/ti/processors/dsp/c6000_dsp/c674x/overview.page">http://www.ti.com/lsds/ti/processors/dsp/c6000_dsp/c674x/overview.page</a>
</li>

<li>TMS320C30 (stránky TI)<br />
<a href="http://www.ti.com/product/tms320c30">http://www.ti.com/product/tms320c30</a>
</li>

<li>TMS320C6722B<br />
<a href="http://www.ti.com/product/tms320c6722b/description">http://www.ti.com/product/tms320c6722b/description</a>
</li>

<li>Introduction to DSP<br />
<a href="http://www.ti.com/lit/wp/spry281/spry281.pdf">http://www.ti.com/lit/wp/spry281/spry281.pdf</a>
</li>

<li>The Evolution of TMS (Family of DSPs)<br />
<a href="http://www.slideshare.net/moto_modx/theevo1">http://www.slideshare.net/moto_modx/theevo1</a>
</li>

<li>ST10 16-bit MCUs<br />
<a href="http://www.st.com/en/microcontrollers/st10-16-bit-mcus.html?querycriteria=productId=LN1111">http://www.st.com/en/microcontrollers/st10-16-bit-mcus.html?querycriteria=productId=LN1111</a>
</li>

<li>XC800 family<br />
<a href="https://en.wikipedia.org/wiki/XC800_family">https://en.wikipedia.org/wiki/XC800_family</a>
</li>

<li>C166 (stránky společnosti Infineon)<br />
<a href="https://www.infineon.com/cms/en/product/microcontroller/16-bit-c166-microcontroller/channel.html?channel=ff80808112ab681d0112ab6b2eaf0759#ispnTab3">https://www.infineon.com/cms/en/product/microcontroller/16-bit-c166-microcontroller/channel.html?channel=ff80808112ab681d0112ab6b2eaf0759#ispnTab3</a>
</li>

<li>C166 Family<br />
<a href="https://en.wikipedia.org/wiki/C166_family">https://en.wikipedia.org/wiki/C166_family</a>
</li>

<li>Zero-power Microcontrollers for Low-power and High-temperature Applications<br />
<a href="http://en.wikichip.org/w/images/1/17/Atmel_MARC4_brochure.pdf">http://en.wikichip.org/w/images/1/17/Atmel_MARC4_brochure.pdf</a>
</li>

<li>MARC4 Micro-Controller (Wikipedia)<br />
<a href="https://en.wikipedia.org/wiki/MARC4_Micro-Controller">https://en.wikipedia.org/wiki/MARC4_Micro-Controller</a>
</li>

<li>MARC4 - Atmel<br />
<a href="https://en.wikichip.org/wiki/atmel/marc4">https://en.wikichip.org/wiki/atmel/marc4</a>
</li>

<li>MARC 4bit Microcontrollers Programmer's Guide<br />
<a href="https://en.wikichip.org/w/images/4/44/MARC4_4-bit_Microcontrollers_Programmer%27s_Guide.pdf">https://en.wikichip.org/w/images/4/44/MARC4_4-bit_Microcontrollers_Programmer%27s_Guide.pdf</a>
</li>

<li>MARC4 User's Guide qFORTH Compiler<br />
<a href="https://en.wikichip.org/w/images/2/25/MARC4_User%27s_Guide_qFORTH_Compiler.pdf">https://en.wikichip.org/w/images/2/25/MARC4_User%27s_Guide_qFORTH_Compiler.pdf</a>
</li>

<li>Programovací jazyk Forth a zásobníkové procesory<br />
<a href="http://www.root.cz/clanky/programovaci-jazyk-forth-a-zasobnikove-procesory/">http://www.root.cz/clanky/programovaci-jazyk-forth-a-zasobnikove-procesory/</a>
</li>

<li>Seriál Programovací jazyk Forth<br />
<a href="http://www.root.cz/serialy/programovaci-jazyk-forth/">http://www.root.cz/serialy/programovaci-jazyk-forth/</a>
</li>

<li>Programovací jazyk Factor<br />
<a href="http://www.root.cz/clanky/programovaci-jazyk-factor/">http://www.root.cz/clanky/programovaci-jazyk-factor/</a>
</li>

<li>PMOS<br />
<a href="https://en.wikipedia.org/wiki/PMOS_logic">https://en.wikipedia.org/wiki/PMOS_logic</a>
</li>

<li>NMOS<br />
<a href="https://en.wikipedia.org/wiki/NMOS_logic">https://en.wikipedia.org/wiki/NMOS_logic</a>
</li>

<li>CMOS<br />
<a href="https://en.wikipedia.org/wiki/CMOS">https://en.wikipedia.org/wiki/CMOS</a>
</li>

<li>Computer History Museum: TMS 1000 4-Bit microcontroller<br />
<a href="http://www.computerhistory.org/collections/catalog/102711697">http://www.computerhistory.org/collections/catalog/102711697</a>
</li>

<li>Texas Instruments TMS1000 microcontroller family<br />
<a href="http://www.cpu-world.com/CPUs/TMS1000/">http://www.cpu-world.com/CPUs/TMS1000/</a>
</li>

<li>Invention History of Microcontroller<br />
<a href="http://www.circuitstoday.com/microcontroller-invention-history">http://www.circuitstoday.com/microcontroller-invention-history</a>
</li>

<li>TMS1000 Series - TI<br />
<a href="https://en.wikichip.org/wiki/ti/tms1000">https://en.wikichip.org/wiki/ti/tms1000</a>
</li>

<li>TMX1795 - TI<br />
<a href="https://en.wikichip.org/wiki/ti/tmx1795">https://en.wikichip.org/wiki/ti/tmx1795</a>
</li>

<li>Milton Bradley Microvision (U.S.) (1979, LCD, 9 Volt (1 or 2), Model# 4952)<br />
<a href="http://www.handheldmuseum.com/MB/uVUS.htm">http://www.handheldmuseum.com/MB/uVUS.htm</a>
</li>

<li>8051 Microcontroller<br />
<a href="http://www.circuitstoday.com/8051-microcontroller">http://www.circuitstoday.com/8051-microcontroller</a>
</li>

<li>4-bit (computer architectures)<br />
<a href="https://en.wikipedia.org/wiki/4-bit">https://en.wikipedia.org/wiki/4-bit</a>
</li>

<li>TMS 1000 Data Manual<br />
<a href="http://blog.kevtris.org/blogfiles/TMS_1000_Data_Manual.pdf">http://blog.kevtris.org/blogfiles/TMS_1000_Data_Manual.pdf</a>
</li>

<li>Considerations for 4-bit processing<br />
<a href="http://www.embeddedinsights.com/channels/2010/12/10/considerations-for-4-bit-processing/">http://www.embeddedinsights.com/channels/2010/12/10/considerations-for-4-bit-processing/</a>
</li>

<li>Are you, or would you consider, using a 4-bit microcontroller?<br />
<a href="http://www.embeddedinsights.com/channels/2010/11/24/are-you-or-would-you-consider-using-a-4-bit-microcontroller/">http://www.embeddedinsights.com/channels/2010/11/24/are-you-or-would-you-consider-using-a-4-bit-microcontroller/</a>
</li>

<li>MARC4 Micro-Controller<br />
<a href="https://en.wikipedia.org/wiki/MARC4_Micro-Controller">https://en.wikipedia.org/wiki/MARC4_Micro-Controller</a>
</li>

<li>The Texas Instruments TMX 1795: the (almost) first, forgotten microprocessor <br />
<a href="http://www.righto.com/2015/05/the-texas-instruments-tmx-1795-first.html">http://www.righto.com/2015/05/the-texas-instruments-tmx-1795-first.html</a>
</li>

<li>O2 Homepage<br />
<a href="http://www.the-nextlevel.com/odyssey2/">http://www.the-nextlevel.com/odyssey2/</a>
</li>

<li>Magnavox Odyssey2 (1978), Philips Videopac G7000 / C52 (1979)<br />
<a href="http://www.mess.org/sysinfo:odyssey2">http://www.mess.org/sysinfo:odyssey2</a>
</li>

<li>The Video Game Critic's Odyssey 2 Reviews <br />
<a href="http://videogamecritic.net/odd.htm">http://videogamecritic.net/odd.htm</a>
</li>

<li>Computer Closet Collection: Magnavox Odyssey^2<br />
<a href="http://www.computercloset.org/MagnavoxOdyssey2.htm">http://www.computercloset.org/MagnavoxOdyssey2.htm</a>
</li>

<li>PHILIPS Videopac C52<br />
<a href="http://old-computers.com/museum/computer.asp?c=1060">http://old-computers.com/museum/computer.asp?c=1060</a>
</li>

<li>O2 Tech. Manual V.1.1 (PDF dokument)<br />
<a href="http://www.atarihq.com/danb/files/o2doc.pdf">http://www.atarihq.com/danb/files/o2doc.pdf</a>
</li>

<li>Magnavox Odyssey<sup>2</sup><br />
<a href="http://www.game-machines.com/consoles/odyssey2.php">http://www.game-machines.com/consoles/odyssey2.php</a>
</li>

<li>Magnavox Odyssey<sup>2</sup> (Wikipedia EN)<br />
<a href="http://en.wikipedia.org/wiki/Odyssey_2">http://en.wikipedia.org/wiki/Odyssey_2</a>
</li>

<li>Magnavox Odyssey<sup>2</sup> Games (Wikipedia EN)<br />
<a href="http://en.wikipedia.org/wiki/List_of_Videopac_games">http://en.wikipedia.org/wiki/List_of_Videopac_games</a>
</li>

<li>TI 16-bit and 32-bit microcontrollers<br />
<a href="http://www.ti.com/lsds/ti/microcontrollers_16-bit_32-bit/overview.page">http://www.ti.com/lsds/ti/microcontrollers_16-bit_32-bit/overview.page</a>
</li>

<li>TMS 32010 Assembly Language Programmer's Guide (kniha na Amazonu)<br />
<a href="https://www.amazon.com/32010-Assembly-Language-Programmers-Guide/dp/0904047423">https://www.amazon.com/32010-Assembly-Language-Programmers-Guide/dp/0904047423</a>
</li>

</ol>



<p></p><p></p>
<p><small>Autor: <a href="http://www.fit.vutbr.cz/~tisnovpa">Pavel Tišnovský</a> &nbsp; 2017</small></p>
</body>
</html>

